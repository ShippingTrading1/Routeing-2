(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{103:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor(t){this.type=t}createActionCreator(){return t=>({payload:t,type:this.type})}createEmptyActionCreator(){return()=>({type:this.type})}}},1410:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return a}));var n=i(143);const o=(t,e,i)=>t.common.voyageSensitivityAnalysis.voyageSensitivityAnalysisCalculation[Object(n.b)(e,i)],a={getVoyageSensitivityAnalysisParams:t=>t.common.voyageSensitivityAnalysis.voyageSensitivityAnalysisParameters,getVoyageAnalysisCalculation:o}},143:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"d",(function(){return r})),i.d(e,"c",(function(){return c}));var n,o=i(195);!function(t){t.FREIGHT_RATE="Freight Rate",t.BUNKER_DO_LS="LS DO Price / MT",t.BUNKER_DO="DO Price / MT",t.BUNKER_FO_LS="LS FO Price / MT",t.BUNKER_FO="FO Price / MT",t.TCE="TCE"}(n||(n={}));const a=(t,e)=>t+"_"+e,r="common.state.voyageSensitivityAnalysisParameters",c=Object(o.a)(r)},1568:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));const n=t=>e=>e.type in t||!e.payload||"object"!=typeof e.payload?e:Array.isArray(e.payload)?Object.assign(Object.assign({},e),{payload:"Array with keys [...] was loaded"}):Object.assign(Object.assign({},e),{payload:`Object with key: ${e.payload.key?e.payload.key:"..."} was loaded`})},1587:function(t,e,i){"use strict";i.d(e,"a",(function(){return I}));i(59),i(109),i(163);var n,o,a,r,c=i(1588),s=i.n(c),u=i(9),l=i(1),d=i(43),f=i(189),y=i(666),h=i(419),g=i(807),p=i(32),b=i(7),v=i(29),A=i(1393),j=i(31),O=i(48),m=i(78),S=i(84),w=i(103),P=function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},R=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},C=function(t,e){return function(i,n){e(i,n,t)}},k=function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{s(n.next(t))}catch(t){a(t)}}function c(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,c)}s((n=n.apply(t,e||[])).next())}))};let I=n=class{constructor(t,e,i){this.store=t,this.authenticateActions=e,this.tsmodelActions=i,this.webAuth=null,this.identityProviderConfiguration=null,this.setUserDataAction=new w.a(f.a.SET_USER_DATA).createActionCreator(),this.setAuthenticateAction=new w.a(f.a.LOGIN_SUCCESS).createActionCreator(),this.init()}login(){var t;this.webAuth&&this.webAuth.checkSession({connection:null===(t=this.identityProviderConfiguration)||void 0===t?void 0:t.databaseName},(t,e)=>{e&&e.accessToken?this.storeAuthData(e.accessToken,e.expiresIn,!0):t&&("login_required"===t.error||"consent_required"===t.error?this.webAuth&&this.identityProviderConfiguration&&this.webAuth.authorize({connection:this.identityProviderConfiguration.databaseName,scope:"openid profile email"}):S.a.error(t))})}logout(){this.webAuth&&this.identityProviderConfiguration&&this.webAuth.logout({clientID:this.identityProviderConfiguration.clientId,returnTo:n.getLogoutCallbackUri()})}handleAuthentication(){const t=window.location.hash.split("#")[2];this.webAuth&&this.webAuth.parseHash({hash:"#"+t},(t,e)=>k(this,void 0,void 0,(function*(){if(e&&e.accessToken&&e.expiresIn){yield this.storeAuthData(e.accessToken,e.expiresIn,!0);const t=Object(p.a)(this.store.getState());yield this.tsmodelActions.updateSingleAction({data:{lastLoginDate:m.a.getLocalDate(new Date)},fields:{lastLoginDate:"*"},key:t.key,type:l.a.user})}else t&&this.store.dispatch(this.authenticateActions.setLoginFailedAction(t.errorDescription))})))}checkAccessToken(){const t=localStorage.getItem("refreshToken");t&&this.expiresSoon()?this.refreshAccessToken(t,!1):this.webAuth&&this.expiresSoon()&&this.webAuth.checkSession({},(t,e)=>{e&&e.accessToken&&e.expiresIn&&this.updateRefreshedAuth0Token(e.accessToken,1e3*e.expiresIn+(new Date).getTime())})}refreshAccessToken(t,e){return k(this,void 0,void 0,(function*(){if(this.identityProviderConfiguration&&t&&(yield this.authenticateActions.refreshAuth0AccessTokenAction(this.identityProviderConfiguration.domain,this.identityProviderConfiguration.clientId,t),e)){const t=A.a.get(this.store.getState());t&&(window.location.href=t)}}))}expiresSoon(){const t=Object(h.b)(this.store.getState());return!(!Object(h.c)(this.store.getState())||!t)&&t-(new Date).getTime()<O.a.AUTH0_SESSION_TIMER_INTERVAL+5e3}storeAuthData(t,e,i){return k(this,void 0,void 0,(function*(){try{if(yield this.authenticateActions.auth0LoginAction(t,e),i){const t=A.a.get(this.store.getState());t&&(window.location.href=t)}}catch(t){S.a.error(t)}}))}updateRefreshedAuth0Token(t,e){return k(this,void 0,void 0,(function*(){let i=Object(p.a)(this.store.getState());i=new d.a(i),i.authdata="Bearer "+t,this.store.dispatch(this.authenticateActions.setUserDataAction(i)),this.store.dispatch(this.authenticateActions.setExpiresInAction(e))}))}init(){const t=this.store.subscribe(()=>{this.identityProviderConfiguration=Object(g.a)(this.store.getState()),this.identityProviderConfiguration&&(this.webAuth=new s.a.WebAuth({audience:this.identityProviderConfiguration.audience,clientID:this.identityProviderConfiguration.clientId,domain:this.identityProviderConfiguration.domain.replace("https://","").replace("/",""),redirectUri:n.getLoginCallbackUri(),responseType:"token"}),this.checkAccessToken(),t())})}static getLoginCallbackUri(){return window.location.origin+window.location.pathname+"login-callback.html"}static getLogoutCallbackUri(){return window.location.origin+window.location.pathname+"#/logout-callback"}};I=n=P([Object(u.injectable)(),C(0,Object(u.inject)(b.a.Store)),C(1,Object(u.inject)(b.a.IAuthenticateActions)),C(2,Object(u.inject)(b.a.ITSModelActionsAsync)),R("design:paramtypes",["function"==typeof(o=void 0!==j.Store&&j.Store)?o:Object,"function"==typeof(a=void 0!==y.IAuthenticateActions&&y.IAuthenticateActions)?a:Object,"function"==typeof(r=void 0!==v.ITSModelActionsAsync&&v.ITSModelActionsAsync)?r:Object])],I)},1589:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n,o,a=i(9),r=i(666),c=i(7),s=i(873),u=i(356),l=function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},d=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(t,e){return function(i,n){e(i,n,t)}};let y=class{constructor(t,e){this.authenticateActions=t,this.auth0=e}logOut(){u.b.getActiveWebsockets().forEach(t=>t.closeConnection()),this.authenticateActions.logout(()=>{this.auth0.logout()}),this.authenticateActions.logout()}};y=l([Object(a.injectable)(),f(0,Object(a.inject)(c.a.IAuthenticateActions)),f(1,Object(a.inject)(c.a.IAuth0)),d("design:paramtypes",["function"==typeof(n=void 0!==r.IAuthenticateActions&&r.IAuthenticateActions)?n:Object,"function"==typeof(o=void 0!==s.IAuth0&&s.IAuth0)?o:Object])],y)},1749:function(t,e,i){"use strict";function n(t,e,i){const n=JSON.stringify(e);return void 0===t[n]&&(t[n]=i),t[n]}i.d(e,"a",(function(){return n}))},2053:function(t,e,i){"use strict";i.d(e,"a",(function(){return k}));i(59),i(10),i(11);var n=i(7),o=i(31),a=i(343),r=i(9),c=i(916),s=i(143),u=i(62),l=i(83),d=i(104),f=i(32),y=i(196),h=i(3),g=i(192),p=i(64),b=i(1),v=i(58),A=i(60);const j={[s.a.BUNKER_DO]:{fields:{doPrice:"*",tcResultDay:"*"},type:b.a.voyage,adjust:(t,e)=>{t.doPrice+=e},getPayload:t=>({doPrice:t.doPrice}),query:"doNotStore=true"},[s.a.BUNKER_DO_LS]:{fields:{dlPrice:"*",tcResultDay:"*"},type:b.a.voyage,adjust:(t,e)=>{t.dlPrice+=e},getPayload:t=>({dlPrice:t.dlPrice}),query:"doNotStore=true"},[s.a.BUNKER_FO]:{fields:{foPrice:"*",tcResultDay:"*"},type:b.a.voyage,adjust:(t,e)=>{t.foPrice+=e},getPayload:t=>({foPrice:t.foPrice}),query:"doNotStore=true"},[s.a.BUNKER_FO_LS]:{fields:{flPrice:"*",tcResultDay:"*"},type:b.a.voyage,adjust:(t,e)=>{t.flPrice+=e},getPayload:t=>({flPrice:t.flPrice}),query:"doNotStore=true"},[s.a.TCE]:{fields:{tcResultDay:"*",cargos:{cargoQuantity:"*",cargoPorts:{cargoPortSequence:"*",freightRate:"*",reasonForCall:{reasonForCall:"*"}}}},type:b.a.voyage,adjust:(t,e)=>{t.tcResultDay+=e},getPayload:t=>({tcResultDay:t.tcResultDay}),query:"doNotStore=true&inReverseMode=true"},[s.a.FREIGHT_RATE]:{fields:{freightRate:"*",portCall:{voyage:{tcResultDay:"*"}},reasonForCall:{reasonForCall:"*"},cargo:{cargoQuantity:"*"},cargoPortSequence:"*"},type:b.a.cargoport,adjust:(t,e)=>{t.freightRate+=e},getAdjustmentEntity:t=>{var e;const i=null!==(e=v.a.getFirstDischargeCargoPort(A.a.getPerformanceCargo(t.cargos).cargoPorts))&&void 0!==e?e:{};return new p.a(i)},getPayload:t=>({freightRate:t.freightRate}),query:"doNotStore=true",convert:t=>{var e;return new u.a(Object.assign(Object.assign({},null===(e=t.portCall)||void 0===e?void 0:e.voyage),{cargos:[Object.assign(Object.assign({},t.cargo),{cargoPorts:[t]})]}))}}};var O,m,S,w=function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},P=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},R=function(t,e){return function(i,n){e(i,n,t)}},C=function(t,e,i,n){return new(i||(i=Promise))((function(o,a){function r(t){try{s(n.next(t))}catch(t){a(t)}}function c(t){try{s(n.throw(t))}catch(t){a(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(r,c)}s((n=n.apply(t,e||[])).next())}))};let k=class{constructor(t,e,i){this.api=t,this.store=e,this.i=i}calculate(t,{parameter:e,variance:i},n=7){return C(this,void 0,void 0,(function*(){let o=new u.a(t);const r=j;r[e].getAdjustmentEntity&&(o=r[e].getAdjustmentEntity(t));const l=new Array(n).fill(o).map((t,n)=>{const o=new r[e].type.class(t);return r[e].adjust(o,i*-(n+1)),o}),d=new Array(n).fill(o).map((t,n)=>{const o=new r[e].type.class(t);return r[e].adjust(o,i*(n+1)),o}),h=l.concat(d).concat(o).map(t=>{var i;return this.api.put({type:r[e].type,key:t.key,data:r[e].getPayload(t),authdata:null!==(i=Object(f.a)(this.store.getState()).authdata)&&void 0!==i?i:"",fields:r[e].fields,query:r[e].query})});try{let n=yield Promise.all(h);r[e].convert&&(n=n.map(t=>r[e].convert(t))),this.store.dispatch({type:a.a.ADD_ENTITY(c.c),payload:{_key:Object(s.b)(t.key,e),voyages:n,parameters:{parameter:e,variance:i}}})}catch(t){y.a.next({type:"snackbar",notification:{id:666,message:this.i.lang().voyages.voyageAnalysisCalculationError,type:"error"}})}}))}};k=w([Object(r.injectable)(),R(0,Object(r.inject)(l.a.ITSModelApi)),R(1,Object(r.inject)(n.a.Store)),R(2,Object(r.inject)(h.a.IInternationalization)),P("design:paramtypes",["function"==typeof(O=void 0!==d.ITSModelApi&&d.ITSModelApi)?O:Object,"function"==typeof(m=void 0!==o.Store&&o.Store)?m:Object,"function"==typeof(S=void 0!==g.IInternationalization&&g.IInternationalization)?S:Object])],k)},262:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(7),o=i(14);function a(t){const e=o.a.get(n.a.KeySetActions);o.a.get(n.a.Store).dispatch(e.setKeysAction({identifier:t,keys:[]}))}},536:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(1527),o=i.n(n),a=i(1008),r=i(48),c=(i(59),i(84));const s=t=>{const e=t&&t._persist?t._persist.version:"";return c.a.info(`Current version: ${r.a.VERSION}, cached version: ${e}`),r.a.VERSION!==e?(c.a.info("New version. Ignoring cache."),Promise.resolve({})):Promise.resolve(t)};function u(t,e){return{key:t,migrate:s,stateReconciler:a.a,storage:o.a,version:r.a.VERSION,whitelist:e}}},793:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return c}));var n=i(967),o=i(725);const a=new n.a;let r=!1;function c(t){const e=Object(o.a)(()=>{a.next()},25);r||(t.subscribe(()=>{e()}),r=!0)}},872:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));i(10),i(11);var n,o=i(9),a=i(1390),r=i(1),c=function(t,e,i,n){var o,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(r=(a<3?o(r):a>3?o(e,i,r):o(e,i))||r);return a>3&&r&&Object.defineProperty(e,i,r),r},s=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};const u={_key:"*",createdBy:{userName:"*",userCode:"*"},$tsmodelClassName:"*"};let l=n=class{constructor(){}getBuildCalls(){return n.buildCalls}setBuildCalls(t){return n.buildCalls=t}buildObjectRecurse(t,e,i,o){const c={};let s,l;if(o=Object.assign(Object.assign({},o),u),null==i)return null;c._key=i._key;for(const d in o)if(n.buildCalls++,s=i["_"+d],void 0!==s)if(s instanceof Date)c[d]=s;else if("object"==typeof s&&null!==s)if(s instanceof Array&&s.length>0){if(void 0===s[0].$tsmodelClassName){c[d]=[];continue}l=r.a[s[0].$tsmodelClassName];let i=o[d];if("string"==typeof i&&(i=u),void 0!==i){const n=[];for(let o=0;o<s.length;o++){e(t,l,s[o]._key)?n.push(this.buildObjectRecurse(t,e,e(t,l,s[o]._key),i)):n.push(new a.a(s[o]))}c[d]=n}}else{if(void 0===s.$tsmodelClassName){c[d]=s;continue}l=r.a[s.$tsmodelClassName];let i=o[d];if("string"==typeof i&&(i=u),void 0!==i){const n=e(t,l,s._key);c[d]=n?Object.assign({},this.buildObjectRecurse(t,e,n,i)):new a.a(s)}}else c[d]=s;return c.$tsmodelClassName=i.$tsmodelClassName,c._key=i._key,c}buildObject(t,e,i,n){const o=r.a[i.$tsmodelClassName],a=this.buildObjectRecurse(t,e,i,n);return new o.class(a)}buildObjects(t,e,i,n,o){const a=[];for(const i of n){const n=this.buildObject(t,e,i,o);a.push(n)}return a}};l.buildCalls=0,l=n=c([Object(o.injectable)(),s("design:paramtypes",[])],l)},873:function(t,e,i){},916:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return c})),i.d(e,"b",(function(){return s}));var n=i(31),o=i(143),a=i(22);const r={voyageSensitivityAnalysisParameters:null,voyageSensitivityAnalysisCalculation:{}},c="voyageSensitivityAnalysisCalculation",s=Object(n.combineReducers)({voyageSensitivityAnalysisParameters:o.c,voyageSensitivityAnalysisCalculation:Object(a.b)(c)})},958:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(14),o=i(7),a=i(81),r=i(21),c=i(87);function s(t,e,i,s){var u;const l=n.a.get(o.a.Store);return null!==(u=Object(a.a)(r.a.getTSModelBuilt(l.getState(),t,e,Object(c.a)([i]),!0),i))&&void 0!==u?u:s}}}]);