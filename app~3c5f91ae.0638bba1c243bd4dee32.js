(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1297:function(e,a,t){"use strict";t.d(a,"a",(function(){return R}));t(10),t(11);var o=t(274),n=t.n(o),r=t(0),l=t.n(r),i=t(100),c=t.n(i),s=t(5),d=t(14),u=t(3);const{model:m,common:g,cargoes:y}=d.a.get(u.a.IInternationalization).getLanguageFile();const p={getHeaders:function(){return[{content:m.cargoReference,contentType:s.a.TEXT},{content:m.noOfParcels,contentType:s.a.NUMBER},{content:m.quantity,contentType:s.a.NUMBER,numberFormatOptions:{minDecimals:3,maxDecimals:3}},{content:m.unitOfMeasurement,contentType:s.a.TEXT},{content:m.commodity,contentType:s.a.TEXT},{content:m.freightRate,contentType:s.a.NUMBER,numberFormatOptions:{minDecimals:3,maxDecimals:3}},{content:m.cargoText,contentType:s.a.TEXT}]},getPrimaryTableActions:function(e,a,t,o){return[{disabled:t,icon:c.a,iconButtonProps:{color:"primary","aria-label":null!=o?o:g.create+" "+y.subCargo},label:t?"":null!=o?o:g.create+" "+y.subCargo,onClick:a,reactKeyPrefix:e}]},getRowContentProperties:function(){return["cargo.cargoReference","noOfParcels","actualQuantity","subCargoMeasurement.measurementCode","commodity.commodityName","freightRate","cargoText"]}};var b=t(67),v=t(6),f=t(1),C=t(7),h=t(136),k=t(20),j=t(21),O=t(23),T=t(74),P=t(122),S=t(1293);function R({userLocale:e,cargo:a,subCargos:t,readOnly:o=!1,disableDelete:i,onClickCreate:c,createTooltip:s,reactKeyPrefix:d}){var m;const[g,y,R]=Object(v.a)([u.a.IInternationalization,C.a.ITSModelActionsAsync,k.a.ICargoDrawerController]),{common:x,cargoes:A}=g.getLanguageFile(),w=Object(r.useRef)(!1),[E,I]=Object(r.useState)(!0),[M,F]=Object(r.useState)(void 0),[D,N]=Object(r.useState)(!1),[L,K]=Object(r.useState)(null);Object(r.useEffect)(()=>{a.key?R.loadSubCargos(a.key,()=>w.current=!0):w.current=!0},[a.key,R]);const{subCargos:U}=null!==(m=Object(O.a)(j.a.getTSModelBuilt,f.a.cargo,a.key,P.l))&&void 0!==m?m:new T.a({}),q=null!=t?t:U,B=Object(r.useCallback)(()=>N(!0),[]),W=Object(r.useCallback)(()=>{I(!0),N(!1),K(null)},[]),V=Object(r.useCallback)(e=>{const a=q.find(a=>a.key===e);a&&(I(!1),F(void 0),K(a),B())},[B,q]),Q=Object(r.useCallback)((e,a)=>{var t,o;if(!e&&a){const e=null!==(t=a.subCargos[a.subCargos.length-1])&&void 0!==t?t:void 0;F(null!==(o=e._key)&&void 0!==o?o:void 0)}},[]),$=Object(r.useCallback)(e=>{a&&y.copyMultipleAction({callback:()=>R.loadSubCargos(a.key),keys:e,type:f.a.subcargo})},[a,R,y]),H=Object(r.useMemo)(()=>[{disabled:!1,icon:n.a,iconButtonProps:{"aria-label":x.duplicate+" "+A.subCargoes},label:x.duplicate+" "+A.subCargoes,onClick:$,reactKeyPrefix:d+"selected-actions"}],[A.subCargoes,x.duplicate,$,d]);return w.current?l.a.createElement(l.a.Fragment,null,l.a.createElement(b.a,{title:A.subCargoes,headers:p.getHeaders(),userLocale:e,reactKeyPrefix:"sub-cargo-list-table",data:Object(h.b)(q,p.getRowContentProperties()),primaryActions:p.getPrimaryTableActions(d,null!=c?c:B,o&&!c,s),onRowClick:V,selectable:!o,selectedActions:H,customisation:{responsive:!0},preSelectedRow:M}),D&&l.a.createElement(S.a,{reactKeyPrefix:d+"-create",closeModal:W,showModal:D,selectedSubCargo:L,setSelectedSubCargo:K,disableDelete:i,cargo:a,isCreate:E,onCreateCallback:Q})):l.a.createElement(l.a.Fragment,null)}},1298:function(e,a,t){"use strict";t.d(a,"a",(function(){return B}));t(10),t(11);var o=t(81),n=t(19),r=t(0),l=t.n(r),i=t(122),c=t(1229),s=t(375),d=t(6),u=t(74),m=t(1),g=t(58),y=t(7),p=t(3),b=t(37),v=t(12),f=t(130),C=t(147),h=t(50),k=t(78),j=t(213),O=t(187);const T=Object(j.a)(e=>Object(O.a)({laytimeRange:{cursor:"pointer",fontSize:".85rem",whiteSpace:"nowrap"},laytimeUsed:{whiteSpace:"nowrap"},reasonForCall:{fontSize:"0.875rem"},textContainer:{display:"flex",justifyContent:"space-between",flexFlow:"row wrap",alignItems:"center",marginBottom:e.spacing(2)}}));function P(e){const[a]=Object(d.a)([p.a.IInternationalization]),t=T({}),n=Object(o.a)(e.obj,"portCall.eventLogs",[]),i=Object(r.useMemo)(()=>h.a.getEventLogDate(n,"ARR"),[n]),c=Object(r.useMemo)(()=>h.a.getEventLogDate(n,"DEP"),[n]),s=Object(r.useMemo)(()=>k.a.getDateAndTimeAsString(i,e.userLocale),[i,e.userLocale]),u=Object(r.useMemo)(()=>k.a.getDateAndTimeAsString(c,e.userLocale),[c,e.userLocale]),m=a.formatNumber(Object(o.a)(e.obj,"laytimeUsed"),{maxDecimals:2});return s&&u?l.a.createElement(l.a.Fragment,null,l.a.createElement(f.a,{variant:"subtitle2",className:t.laytimeRange},s," ",l.a.createElement("wbr",null)," - ",u),l.a.createElement(f.a,{variant:"body2",color:"textSecondary"},a.lang().model.laytimeUsed,":"," ",l.a.createElement("span",{className:t.laytimeUsed},m," ",a.lang().common.daysLowercase))):null}function S(e){const[a]=Object(d.a)([p.a.IInternationalization]),t=T({}),{cargoPort:n,cargo:r}=e.obj,i=Object(o.a)(n,"port.portName",""),c=Object(o.a)(n,"terminal.terminalName",""),s=Object(o.a)(n,"reasonForCall.reasonForCallDesc",""),u=Object(o.a)(n,"cargoQuantity"),m=Object(o.a)(r,"cargoMeasurement.measurementCode","");let g;return void 0!==u&&(g=`${a.formatNumber(u)} ${m}`),i&&s?l.a.createElement(l.a.Fragment,null,l.a.createElement(f.a,{variant:"subtitle2"},i),c&&l.a.createElement(f.a,{variant:"subtitle2"},c),l.a.createElement("div",{className:t.textContainer},l.a.createElement(f.a,{color:"textSecondary",className:t.reasonForCall},s),l.a.createElement(f.a,{variant:"body2",color:"textSecondary"},g))):null}var R=t(469),x=t(250),A=t.n(x),w=t(149),E=t.n(w),I=t(100),M=t.n(I),F=t(283),D=t.n(F),N=t(1283),L=t(218),K=t(246),U=t(180);function q(e){var a,t,f;const{userLocale:h,cargo:k,reactKeyPrefix:j,onChangeLaycanFrom:O,onChangeLaycanTo:T,onChangeTargetLaycanFrom:x,onChangeTargetLaycanTo:w,onChangeArrivalWindowStart:I,onChangeArrivalWindowEnd:F}=e,[q,B]=Object(d.a)([p.a.IInternationalization,y.a.ITSModelActions]),W=Object(r.useRef)(null),{common:V,model:Q,cargoes:$}=q.getLanguageFile(),[H,z]=Object(r.useState)(null),[X,G]=Object(r.useState)(!1),[_,J]=Object(r.useState)(!1),[Y,Z]=Object(r.useState)(!1),[ee,ae]=Object(r.useState)(!1),[te,oe]=Object(r.useState)([]),ne="desktop"===D.a.getParser(window.navigator.userAgent).getPlatformType(!0),re=Object(o.a)(k,"cargoPorts"),le=Object(r.useMemo)(()=>function(e){const a=[];if(e){let t;t=e.cargoPorts.length>0&&e.cargoPorts[0].portCall?C.a.sortByPortCallSequence(e.cargoPorts):C.a.sortByCargoPortSequence(e.cargoPorts);for(const o of t){const t={obj:o},n={obj:{cargoPort:o,cargo:e}},r={id:o.key,content:{leftContainer:t,rightContainer:n},disableDelete:!C.a.allowDelete(e,o)};a.push(r)}}return a}(k),[k]),ie=Object(r.useCallback)(()=>{z(null),Z(!Y)},[Y]),ce=Object(r.useCallback)(e=>{var a;ne||(J(!0),z(null!==(a=k.cargoPorts.find(a=>a.key===e))&&void 0!==a?a:null))},[k.cargoPorts,ne]),se=Object(r.useCallback)(e=>{const{cargoPort:a}=e,t=Object(o.a)(k,"cargoPorts").find(e=>e.key===a.key);t&&(z(t),Z(!0))},[k]),de=Object(r.useCallback)(()=>{z(null),Z(!0)},[]),ue=Object(r.useCallback)(e=>{const a=re.find(a=>a.key===e);if(a){const e=Object(o.a)(k,"voyage");z(a),oe(g.a.getLastLinkedPortCall(a,e)),ae(!0)}},[k,re]),me=Object(r.useCallback)((e,a)=>{B.loadSingleAction({fields:i.c,key:e,type:a})},[B]),ge=Object(r.useCallback)(()=>{if(H&&null!==H.key&&null!==k.key){const e={cargoPorts:k.cargoPorts.filter(e=>e.key!==H.key).map(e=>({key:e.key}))};B.updateSingleAction({key:k.key,type:m.a.cargo,data:e,callback:()=>{if(X&&te.length>0){const e=Object(o.a)(k,"voyage");B.deleteAction({key:te[0].key,type:m.a.portcall,callback:()=>{e&&me(e.key,m.a.voyage)}})}me(k.key,m.a.cargo),z(null)}})}ae(!1)},[k,X,te,me,H,B]),ye=Object(r.useMemo)(()=>function(e,a,t,o,n,r,l){const[i]=Object(d.a)([p.a.IInternationalization]),{alerts:c,model:s}=i.getLanguageFile(),u=c.bothDatesRequiredLaycan,m=c.bothDatesRequiredTarget,g=c.bothDatesRequiredArrival;return[{fieldName:"laycanFrom",label:s.laydaysCommences,dateInputProps:{error:!!e.laycanTo&&!e.laycanFrom,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:e.laycanTo&&!e.laycanFrom?u:void 0,onUpdateOverride:e=>a(e)},{fieldName:"laycanTo",label:s.laydaysCancelling,dateInputProps:{error:!!e.laycanFrom&&!e.laycanTo,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:!e.laycanTo&&e.laycanFrom?u:void 0,onUpdateOverride:e=>t(e)},{fieldName:"laycanTargetFrom",label:s.layTargetLong,dateInputProps:{error:!!e.laycanTargetTo&&!e.laycanTargetFrom,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:e.laycanTargetTo&&!e.laycanTargetFrom?m:void 0,onUpdateOverride:e=>o(e)},{fieldName:"laycanTargetTo",label:s.canTargetLong,dateInputProps:{error:!!e.laycanTargetFrom&&!e.laycanTargetTo,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:!e.laycanTargetTo&&e.laycanTargetFrom?m:void 0,onUpdateOverride:e=>n(e)},{fieldName:"arrivalWindowFrom",label:s.arrivalWindowStart,dateInputProps:{error:!!e.arrivalWindowTo&&!e.arrivalWindowFrom,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:e.arrivalWindowTo&&!e.arrivalWindowFrom?g:void 0,onUpdateOverride:e=>r(e)},{fieldName:"arrivalWindowTo",label:s.arrivalWindowEnd,dateInputProps:{error:!!e.arrivalWindowFrom&&!e.arrivalWindowTo,showTime:!0,showShortDate:!0,fullWidth:!1},formHelperText:!e.arrivalWindowTo&&e.arrivalWindowFrom?g:void 0,onUpdateOverride:e=>l(e)},{fieldName:"placeOfOrigin"},{fieldName:"finalDestination"}]}(k,O,T,x,w,I,F),[k,O,T,x,w,I,F]),pe=Object(r.useMemo)(()=>Object(n.a)({reactKeyPrefix:j,fieldOptions:ye,object:k,parentData:{key:k.key,type:m.a.cargo},type:m.a.cargo,userLocale:h,smartResponse:!0}),[k,ye,j,h]),be=Object(r.useMemo)(()=>l.a.createElement(b.a,{reactKeyPrefix:j+"-cargo-overview-h-list",key:j+"horizontal_list",items:pe,breakpoints:v.h}),[pe,j]);return l.a.createElement(U.a,{title:`${Q.cargoPort} ${V.timeline}`,reactKeyPrefix:j+"-cargo-port-timeline-section"},l.a.createElement(L.a,{title:V.create},l.a.createElement(K.a,{onClick:()=>de(),color:"primary",sx:{float:"right"}},l.a.createElement(M.a,{color:"primary"}))),l.a.createElement(s.a,{reactKeyPrefix:j+"cargo-port-timeline",data:le,userLocale:h,type:m.a.cargoport,LeftContainerLayout:P,RightContainerLayout:S,onEdit:se,onDelete:ue,onClickRow:ce,toolbarRef:W,hideAdd:!0,disableBackground:!0,hidePortCostHistory:!0}),Y&&l.a.createElement(N.a,{reactKeyPrefix:j+"create-cargo-port-from-port-call",closeDialog:ie,showModal:Y,cargo:new u.a(k),selectedCargoPort:H}),l.a.createElement(R.a,{reactKeyPrefix:j+"-cp-action-menu",open:_,onClose:()=>{z(null),J(!1)},anchorEl:null!==(a=W.current)&&void 0!==a?a:void 0},l.a.createElement(R.b,{hidden:ne,key:j+"-cp-action-menu-edit",onClick:()=>Z(!0),disabled:null===(t=le[k.cargoPorts.findIndex(e=>e.key===(null==H?void 0:H.key))])||void 0===t?void 0:t.disableEdit},l.a.createElement(A.a,null),q.lang().common.editPort),l.a.createElement(R.b,{key:j+"-cp-action-menu-delete",hidden:ne,onClick:()=>ae(!0),disabled:null===(f=le[k.cargoPorts.findIndex(e=>e.key===(null==H?void 0:H.key))])||void 0===f?void 0:f.disableDelete},l.a.createElement(E.a,null),q.lang().common.delete)),l.a.createElement(c.a,{reactKeyPrefix:j+"delete-cargo-cargo-port",cargo:k,title:`${V.delete} ${Q.cargoPort}`,lastLinkedPCs:te,showModal:ee,checkboxLabel:$.deletePortCall,onClose:()=>ae(!1),onDelete:ge,onCheckboxInputChange:e=>G(e),selectedCargoPort:H}),be)}const B=l.a.memo(q)},1651:function(e,a,t){"use strict";t.d(a,"a",(function(){return y}));var o,n,r=t(9),l=t(122),i=t(1),c=t(29),s=t(7),d=t(222),u=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},m=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},g=function(e,a){return function(t,o){a(t,o,e)}};let y=class{constructor(e,a){this.tsmodelActions=e,this.cachecontroller=a}loadBunkerAdjustments(e){e&&e.key&&this.tsmodelActions.loadSingleAction({key:e.key,fields:l.a,type:i.a.cargo})}loadAdjustmentTypes(){this.cachecontroller.initCache({type:i.a.adjustmenttype,fields:{adjustmentTypeCode:"*",adjustmentTypeDesc:"*"},objectPaths:["adjustmentTypeCode","adjustmentTypeDesc"],forceUseCache:!0})}};y=u([Object(r.injectable)(),g(0,Object(r.inject)(s.a.ITSModelActionsAsync)),g(1,Object(r.inject)(s.a.ITypeaheadCacheController)),m("design:paramtypes",["function"==typeof(o=void 0!==c.ITSModelActionsAsync&&c.ITSModelActionsAsync)?o:Object,"function"==typeof(n=void 0!==d.ITypeaheadCacheController&&d.ITypeaheadCacheController)?n:Object])],y)},1875:function(e,a,t){"use strict";t.d(a,"a",(function(){return Oa}));t(10),t(11);var o=t(274),n=t.n(o),r=t(1220),l=t.n(r),i=t(0),c=t.n(i),s=t(97),d=t(122),u=t(35),m=t(37),g=t(12),y=t(6),p=t(3),b=t(28),v=t(19),f=t(1),C=t(260);const h=e=>{switch(e){case"V":return C.a.getVolumeMeasurementCode();default:return C.a.getWeightMeasurementCode()}},k=(e,a,t,o)=>{var n,r,l,i,c,s,d,u,m,y,p,C,k;const{model:j,common:O}=t.getLanguageFile(),{dimensionMeasurement:T,stowageUnit:P,weightUnit:S,volumeMeasurement:R}=e;let x=0;e.subCargos.forEach(e=>{x+=e.grossWeight});const A=[{fieldName:"onDeckOption",label:j.onDeckOption,breakpoints:g.d},{fieldName:"isOnDeck",label:j.stowedOnDeck,breakpoints:g.d},{fieldName:"isCradleRequired",label:j.cradleRequired,breakpoints:g.d},{fieldName:"stowageFactor",label:O.stowageFactor,InputProps:{endAdornment:h("V")+"/"+(null!==(l=null===(r=null===(n=e.commodity)||void 0===n?void 0:n.stowageUnit)||void 0===r?void 0:r.measurementCode)&&void 0!==l?l:"MT")},numberInputProps:{maskSettings:b.a.mask1},breakpoints:g.h},{fieldName:"stowageUnit",label:j.stowageUnit,typeaheadProps:{shouldPreload:!0,defaultSelectedOptions:null!==(c=null===(i=e.commodity)||void 0===i?void 0:i.stowageUnit)&&void 0!==c?c:P,isClearable:!1}},{fieldName:"weightFactor",label:O.weightFactor,InputProps:{endAdornment:h("W")+"/"+(null!==(d=null===(s=e.weightUnit)||void 0===s?void 0:s.measurementCode)&&void 0!==d?d:"MT")},numberInputProps:{maskSettings:b.a.mask12},breakpoints:g.h},{fieldName:"weightUnit",label:j.weightUnit,typeaheadProps:{shouldPreload:!0,defaultSelectedOptions:null!==(m=null===(u=e.commodity)||void 0===u?void 0:u.weightUnit)&&void 0!==m?m:S,isClearable:!1}},{fieldName:"weight",label:j.grossWeight,InputProps:{endAdornment:h("W")},disabled:!!e&&!!e.subCargos&&e.subCargos.length>0&&x>0,numberInputProps:{maskSettings:b.a.mask1},breakpoints:g.h},{fieldName:"volume",label:j.volume,InputProps:{endAdornment:null!==(y=null==R?void 0:R.measurementCode)&&void 0!==y?y:""},numberInputProps:{maskSettings:b.a.mask1},breakpoints:g.h},{fieldName:"length",label:j.length,InputProps:{endAdornment:null!==(p=null==T?void 0:T.measurementCode)&&void 0!==p?p:""},numberInputProps:{maskSettings:b.a.mask2},breakpoints:g.f},{fieldName:"width",label:j.width,InputProps:{endAdornment:null!==(C=null==T?void 0:T.measurementCode)&&void 0!==C?C:""},numberInputProps:{maskSettings:b.a.mask2},breakpoints:g.f},{fieldName:"height",label:j.height,InputProps:{endAdornment:null!==(k=null==T?void 0:T.measurementCode)&&void 0!==k?k:""},numberInputProps:{maskSettings:b.a.mask2},breakpoints:g.f},{fieldName:"area",label:j.areaDescription,InputProps:{endAdornment:j.sqm},breakpoints:g.f,disabled:!0}];return Object(v.a)({reactKeyPrefix:a,fieldOptions:A,object:e,parentData:{key:e.key,type:f.a.cargo},type:f.a.cargo,userLocale:o,smartResponse:!0})};var j=t(180);const O=e=>{const{cargo:a,userLocale:t,reactKeyPrefix:o,marginTop:n}=e,[r]=Object(y.a)([p.a.IInternationalization]),{common:l}=r.getLanguageFile();return c.a.createElement(j.a,{marginTop:n,title:l.stowage,reactKeyPrefix:o+"-stowage-section"},c.a.createElement(m.a,{reactKeyPrefix:o+"-stowage-field-list",items:k(a,o,r,t),breakpoints:g.a}))};var T=t(63),P=t(64),S=t(58),R=t(85),x=t(147),A=t(7),w=t(301),E=t(86),I=t(1227),M=t(96),F=t(30),D=t(27),N=t(15),L=t(20);function K(e,a,t,o,n){var r,l,i,c,s,d,u,m,v,C,h,k;const[j,O,K,U]=Object(y.a)([p.a.IInternationalization,A.a.ICargoQuantityActions,A.a.ICargoFreightRateActions,L.a.ICargoDrawerController]),{model:q}=j.getLanguageFile(),B=S.a.getFirstLoadCargoPort(e.cargoPorts)||new P.a({}),W=S.a.getFirstDischargeCargoPort(e.cargoPorts)||new P.a({}),V=Object(I.a)(e,B,W),Q=e.subCargos.length>0,$=e.freightRates.length>0,H=e.commissions.some(e=>null!==e.broker),z=S.a.cargoPortsHaveDifferentFreightRates(e),X="FIX"===(null===(r=e.bookingStatus)||void 0===r?void 0:r.statusTypeCode),G="MOLOO"===(null===(l=e.quantityOption)||void 0===l?void 0:l.quantityOption),_=["MOLCO","LCOPT"].includes(null!==(c=null===(i=e.quantityOption)||void 0===i?void 0:i.quantityOption)&&void 0!==c?c:""),J=S.a.isTranshipPreshipTransferOrRelet(e),Y={cargoMeasurement:Q||V,cargoQuantity:Q||V,minimumQuantity:!G,commissionbroker:H,freightRate:Q||z||$,tolerancePercentage:!(_||G),demurrageRate:!x.a.cargoPortsHaveEqualDemurrageRates(e.cargoPorts),despatchRate:!x.a.cargoPortsHaveEqualDespatchRates(e.cargoPorts),isPerformanceCargo:!e.voyage,flatRate:!e.isWorldscale},Z={demurrageRate:Y.demurrageRate?j.lang().cargoes.averageFromCargoPorts:void 0,despatchRate:Y.despatchRate?j.lang().cargoes.averageFromCargoPorts:void 0};return[{fieldName:"charterer",label:J?q.owner:q.charterer,typeaheadProps:{shouldPreload:!0,objectPaths:E.b.businessPartner,query:J?M.c:M.b,fields:E.a.businessPartner},openObject:{permissions:[F.a.BusinessPartnerGET],onOpen:D.a.openDrawer.bind(null,null!==(d=null===(s=e.charterer)||void 0===s?void 0:s.key)&&void 0!==d?d:-1,N.a.businessPartnerDrawer)},breakpoints:g.e},{fieldName:"cpDate",label:q.cpDate,breakpoints:g.h},{fieldName:"blDate",label:q.blDate,breakpoints:g.h},{disabled:Y.cargoQuantity,breakpoints:g.f,fieldName:"cargoQuantity",label:X?q.actualQuantity:q.bookedQuantity,numberInputProps:{maskSettings:b.a.mask1},onUpdateOverride:a=>O.onChangeActualQuantity(a,e)},{disabled:Y.minimumQuantity,fieldName:"minimumQuantity",numberInputProps:{maskSettings:b.a.mask1},breakpoints:g.f},{disabled:Y.cargoMeasurement,fieldName:"cargoMeasurement",label:q.measurement,breakpoints:g.f,typeaheadProps:{shouldPreload:!0,defaultSelectedOptions:e.cargoMeasurement,isClearable:!1}},{fieldName:"commodity",typeaheadProps:{shouldPreload:!0},breakpoints:g.f,openObject:{permissions:[F.a.CommodityGET],onOpen:D.a.openDrawer.bind(null,null!==(m=null===(u=e.commodity)||void 0===u?void 0:u.key)&&void 0!==m?m:-1,N.a.commodityDrawer)}},{InputProps:{disabled:Y.freightRate},fieldName:"freightRate",numberInputProps:{maskSettings:b.a.mask19},breakpoints:g.f,onUpdateOverride:a=>K.onChangeFreightRate(a,e)},{fieldName:"freightCurrency",label:q.currency,breakpoints:g.f,typeaheadProps:{shouldPreload:!0,isClearable:!1}},{fieldName:"isWorldscale",disabled:$,overrideFieldType:"object",label:q.rule,typeaheadProps:{options:Object(w.a)(j),defaultSelectedOptions:Object(w.d)(j,e),isClearable:!1},breakpoints:g.f,onUpdateOverride:t=>{const o=Object(w.c)(j,t,e);a(Object.assign({},o))}},{InputProps:{disabled:Y.flatRate},fieldName:"flatRate",label:q.flatRate,breakpoints:g.f,typeaheadProps:{shouldPreload:!0}},{InputProps:{disabled:Y.tolerancePercentage,endAdornment:T.a.Percent},fieldName:"quantityOptionPct",label:q.tolerance,numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:b.a.mask3},breakpoints:g.f},{fieldName:"quantityOption",label:q.toleranceOption,typeaheadProps:{shouldPreload:!0,defaultSelectedOptions:e.quantityOption},breakpoints:g.f},{fieldName:"pctOverage",label:q.overageRate,numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:b.a.mask6},InputProps:{endAdornment:T.a.Percent},breakpoints:g.f},{fieldName:"deadfreightRate",breakpoints:g.f,label:q.deadfreightRate},{InputProps:{endAdornment:T.a.Percent,disabled:Y.commissionbroker},fieldName:"commissionBroker",numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:b.a.mask2}},{InputProps:{endAdornment:T.a.Percent},fieldName:"commissionAddress",numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:b.a.mask2}},{fieldName:"laytimeTermsValue",label:q.loadRate,breakpoints:g.f,numberInputProps:{maskSettings:b.a.mask2,reactKeyPrefix:o+"-load-laytimeterms-value"},overrideObject:B,overrideType:f.a.cargoport,onUpdateOverride:a=>U.updateLaytimeTermsValue(B.key,a,e.voyage,n)},{fieldName:"laytimeTermsMeasurement",label:q.rule,overrideObject:B,overrideType:f.a.cargoport,breakpoints:g.f,typeaheadProps:{objectPaths:["laytimeTermsMeasurementName"],shouldPreload:!0,reactKeyPrefix:o+"-load-laytimetermsmeasurement",isClearable:!1}},{fieldName:"laytimeTerms",label:q.loadLaytimeTerms,overrideObject:B,overrideType:f.a.cargoport,typeaheadProps:{objectPaths:["laytimeTerms"],shouldPreload:!0,reactKeyPrefix:o+"-load-laytimeterms"},openObject:{permissions:[F.a.LaytimeTermsGET],onOpen:D.a.openDrawer.bind(null,null!==(C=null===(v=B.laytimeTerms)||void 0===v?void 0:v.key)&&void 0!==C?C:-1,N.a.laytimeTermsDrawer)}},{fieldName:"laytimeTermsValue",label:q.dischargeRate,numberInputProps:{maskSettings:b.a.mask2,reactKeyPrefix:o+"-discharge-laytimeterms-value"},breakpoints:g.f,overrideObject:W,overrideType:f.a.cargoport,onUpdateOverride:a=>U.updateLaytimeTermsValue(W.key,a,e.voyage,n)},{fieldName:"laytimeTermsMeasurement",label:q.rule,overrideObject:W,overrideType:f.a.cargoport,breakpoints:g.f,typeaheadProps:{objectPaths:["laytimeTermsMeasurementName"],shouldPreload:!0,reactKeyPrefix:o+"-discharge-laytimetermsmeasurement",isClearable:!1}},{fieldName:"laytimeTerms",label:q.dischargeLaytimeTerms,overrideObject:W,overrideType:f.a.cargoport,typeaheadProps:{objectPaths:["laytimeTerms"],shouldPreload:!0,reactKeyPrefix:o+"-discharge-laytimeterms"},openObject:{permissions:[F.a.LaytimeTermsGET],onOpen:D.a.openDrawer.bind(null,null!==(k=null===(h=W.laytimeTerms)||void 0===h?void 0:h.key)&&void 0!==k?k:-1,N.a.laytimeTermsDrawer)}},{disabled:Y.demurrageRate,fieldName:"demurrageRate",label:q.demurrageRate,formHelperText:Z.demurrageRate,onUpdateOverride:e=>t("demurrageRate",e)},{disabled:Y.despatchRate,fieldName:"despatchRate",label:q.despatchRate,formHelperText:Z.despatchRate,onUpdateOverride:e=>t("despatchRate",e)},{label:q.reversibleLaytime,fieldName:"isReversible",breakpoints:g.g},{disabled:Y.isPerformanceCargo,fieldName:"isPerformanceCargo",label:q.performanceCargo,breakpoints:g.g},{fieldName:"isIssuedLoi",label:q.loi,breakpoints:g.g}]}function U(e){const{cargo:a,userLocale:t,onChangeDemurrageRateOrDespatchRate:o,onChange:n,reactKeyPrefix:r,isOpenedFromFas:l}=e,[s]=Object(y.a)([p.a.IInternationalization]),{model:d}=s.getLanguageFile(),u=Object(i.useMemo)(()=>Object(v.a)({reactKeyPrefix:r,fieldOptions:K(a,n,o,r,l),object:a,parentData:{key:a.key,type:f.a.cargo},type:f.a.cargo,userLocale:t,smartResponse:!0}),[a,l,n,o,r,t]),b=Object(i.useMemo)(()=>c.a.createElement(m.a,{reactKeyPrefix:r+"-field-list",items:u,breakpoints:g.h}),[u,r]);return c.a.createElement(j.a,{title:d.mainCargoDetails,reactKeyPrefix:r+"-section"},b)}var q=t(1298),B=t(273);function W(e){const[a,t]=Object(y.a)([p.a.IInternationalization,L.a.ICargoDrawerController]),{vessel:o}=a.getLanguageFile(),{cargo:n,userLocale:r,reactKeyPrefix:l,marginTop:s}=e,d=Object(B.a)({companyRequired:!1,businessUnitRequired:!1,selectedCompany:n.company,selectedBusinessUnit:n.businessUnit}),u=Object(i.useCallback)((e,a)=>{if("companyBusinessUnit"===e){const e={company:(null==a?void 0:a.company)?{key:a.company}:null,businessUnit:(null==a?void 0:a.businessUnit)?{key:a.businessUnit}:null};t.update(n.key,e)}},[n.key,t]),b=Object(i.useMemo)(()=>function(e,a,t){var o,n,r,l,i;const[c]=Object(y.a)([p.a.IInternationalization]),{common:s,model:d,cargoes:u}=c.getLanguageFile(),m=null!==(o=null==t?void 0:t.find(a=>{var t,o,n,r;return a.company===(null!==(o=null===(t=null==e?void 0:e.company)||void 0===t?void 0:t.key)&&void 0!==o?o:void 0)&&a.businessUnit===(null!==(r=null===(n=null==e?void 0:e.businessUnit)||void 0===n?void 0:n.key)&&void 0!==r?r:void 0)}))&&void 0!==o?o:null;return[{fieldName:"externalReference"},{disabled:!!e.voyage,fieldName:"leg",label:d.trade,typeaheadProps:{shouldPreload:!0}},{fieldName:"cargoText",label:d.cargoText,textInputProps:{multiline:!0,rows:2}},{fieldName:"comments",label:d.comment,textInputProps:{multiline:!0,rows:2}},{fieldName:"company",label:s.companyBusinessUnit,breakpoints:g.e,openObject:{permissions:[F.a.CompanyGET],onOpen:D.a.openDrawer.bind(null,null!==(r=null===(n=e.company)||void 0===n?void 0:n.key)&&void 0!==r?r:-1,N.a.companyDrawer)},typeaheadProps:{options:null!=t?t:[],defaultSelectedOptions:m,resolver:e=>null==e?void 0:e.label},onUpdateOverride:a.bind(null,"companyBusinessUnit")},{fieldName:"cargoOperator",label:d.cargoOperator,breakpoints:g.e,openObject:{permissions:[F.a.UserGET],onOpen:D.a.openDrawer.bind(null,null!==(i=null===(l=e.cargoOperator)||void 0===l?void 0:l.key)&&void 0!==i?i:-1,N.a.userDrawer)}}]}(n,u,d),[n,d,u]),C=Object(i.useMemo)(()=>Object(v.a)({reactKeyPrefix:l,fieldOptions:b,object:n,parentData:{key:n.key,type:f.a.cargo},type:f.a.cargo,userLocale:r,smartResponse:!0}),[n,b,l,r]);return c.a.createElement(j.a,{reactKeyPrefix:l+"-miscellaneous-section",title:o.miscellaneous,marginTop:s},c.a.createElement(m.a,{reactKeyPrefix:l+"-cargo-text",key:l+"horizontal_list",items:C,breakpoints:g.h}))}var V=t(14),Q=t(209),$=t(5),H=t(67),z=t(23),X=t(21),G=t(50),_=t(71),J=t(487),Y=t(303);function Z(e){const{cargo:a,userLocale:t,reactKeyPrefix:o}=e,[n,r]=Object(y.a)([p.a.IInternationalization,A.a.ITSModelActionsAsync]),l=Object(s.g)(),u=Object(s.h)(),m=a.cargoPorts.map(e=>e.key);Object(i.useEffect)(()=>{var e,t;r.loadMultipleAction({type:f.a.cargo,fields:d.e,query:"filter=reletOfCargo(EQ)"+a.key+((null===(e=a.tsOfCargoPort)||void 0===e?void 0:e.cargo)?"&filter=(OR)&filter=key(EQ)"+(null===(t=a.tsOfCargoPort)||void 0===t?void 0:t.cargo.key):"")+(m.length?`&filter=(OR)&filter=tsOfCargoPort(IN)(${m})`:"")})},[a.key,r]);const g=function(e){return Object(i.useMemo)(()=>[{content:e.lang().model.reference,contentType:$.a.TEXT},{content:e.lang().model.loadPort,contentType:$.a.TEXT},{content:e.lang().model.dischargePort,contentType:$.a.TEXT},{content:e.lang().model.owner,contentType:$.a.TEXT},{content:e.lang().model.commodity,contentType:$.a.TEXT},{content:e.lang().model.quantity,contentType:$.a.NUMBER},{content:e.lang().model.unitOfMeasurement,contentType:$.a.TEXT},{content:e.lang().model.etaVsLaycan,contentType:$.a.ELEMENT},{content:e.lang().model.cargoType,contentType:$.a.ELEMENT}],[e])}(n),b=function(e,a){var t;const o=null!==(t=Object(z.a)(X.a.getTSModelsBuilt,f.a.cargo,d.e))&&void 0!==t?t:[];return Object(i.useMemo)(()=>[...S.a.reletsOfCargo(o,e),...S.a.hasTransfersOfCargo(o,e)].map(e=>{var t,o,n,r,l,i,s,d,u,m,g,y,p,b;const v=S.a.getFirstLoadCargoPort(e.cargoPorts),f=S.a.getPortCallFromCargoPort(null!==(o=null===(t=e.voyage)||void 0===t?void 0:t.portCallsFromVoyage)&&void 0!==o?o:[],null!=v?v:new P.a({})),C=G.a.getEventLogDateFromPC(f,"ARR");return{content:[e.cargoReference,null!==(r=null===(n=null==v?void 0:v.port)||void 0===n?void 0:n.portName)&&void 0!==r?r:"",null!==(s=null===(i=null===(l=S.a.getFirstDischargeCargoPort(e.cargoPorts))||void 0===l?void 0:l.port)||void 0===i?void 0:i.portName)&&void 0!==s?s:"",null!==(u=null===(d=e.charterer)||void 0===d?void 0:d.businessPartnerName)&&void 0!==u?u:"",null!==(g=null===(m=e.commodity)||void 0===m?void 0:m.commodityName)&&void 0!==g?g:"",e.cargoQuantity,null!==(p=null===(y=e.cargoMeasurement)||void 0===y?void 0:y.measurementCode)&&void 0!==p?p:"",{rawValue:e.laycanMissedBy,content:c.a.createElement(Y.a,{eta:null!=C?C:new Date,laycanFrom:e.laycanFrom,laycanTo:e.laycanTo,laycanMissedBy:e.laycanMissedBy,reactKeyPrefix:a})},{rawValue:null===(b=e.cargoType)||void 0===b?void 0:b.cargoTypeName,content:c.a.createElement(J.a,{cargo:e})}],id:e.key}}),[o,e,a])}(a,o);return c.a.createElement(_.a,null,c.a.createElement(H.a,{headers:g,data:b,reactKeyPrefix:o+"-cargo-relet-table",userLocale:t,title:n.lang().model.cargoReletsAndTransshipments,customisation:{responsive:!0},onRowClick:e=>D.a.openDrawer(e,N.a.cargoDrawer,u,l)}))}var ee=t(214),ae=t(841);var te=t(323),oe=t(130),ne=t(250),re=t.n(ne),le=t(38),ie=t(100),ce=t.n(ie),se=t(51),de=t(47),ue=t(1327),me=t(312);function ge(e,a,t,o,n,r){var l,i,s,d,u,m,y,p,C,h;const{common:k,model:j,fas:O,vessel:T}=n.getLanguageFile(),P=null!==(s=null===(i=null===(l=null==a?void 0:a.cargo)||void 0===l?void 0:l.freightCurrency)||void 0===i?void 0:i.currencyCode)&&void 0!==s?s:j.usd,S=null!==(m=null===(u=null===(d=null==a?void 0:a.cargo)||void 0===d?void 0:d.cargoMeasurement)||void 0===u?void 0:u.measurementCode)&&void 0!==m?m:k.mt,{adjustmentTypes:R}=r;const x=[{fieldName:"adjustmentType",formControlProps:{required:!0},overrideComponent:c.a.createElement(c.a.Fragment,null,c.a.createElement(oe.a,{variant:"h6"}," ",n.lang().cargoes.adjustmentType),c.a.createElement(me.a,{reactKeyPrefix:e+"-adjustment-type",onChange:function(e){const a=e.target.value;t("adjustmentType",R.find(e=>e.adjustmentTypeCode===a)),a===be.FRE&&t("agreedConsumption",0),a===be.CONS&&t("adjustmentFactor",0)},selectedValue:null!==(p=null===(y=a.adjustmentType)||void 0===y?void 0:y.adjustmentTypeCode)&&void 0!==p?p:be.FRE,options:[{label:j.freight,value:be.FRE},{label:T.consumption,value:be.CONS}]}))},{fieldName:"bunkerCategory",overrideFieldType:"object",label:j.bunkerType,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!0,objectPaths:["bunkerCategoryCode"],resolver:e=>Object(ae.a)(e.bunkerCategoryCode)},onUpdateOverride:e=>t("bunkerCategory",e)},{overrideComponent:c.a.createElement("div",null,c.a.createElement(ue.a,null),c.a.createElement(oe.a,{variant:"h6",sx:{paddingTop:1}},O.range("")))},{fieldName:"rangeMin",label:k.minPrice,breakpoints:g.h,formControlProps:{required:!0},numberInputProps:{maskSettings:b.a.mask3},InputProps:{endAdornment:P},onUpdateOverride:e=>{t("rangeMin",e),a.rangeMin=e,e>a.rangeMax&&(t("rangeMax",e),a.rangeMax=e),t("price",(a.rangeMin+a.rangeMax)/2)}},{fieldName:"rangeMax",label:k.maxPrice,breakpoints:g.h,formControlProps:{required:!0},numberInputProps:{maskSettings:b.a.mask3},InputProps:{endAdornment:P},onUpdateOverride:e=>{t("rangeMax",e),a.rangeMax=e,e<a.rangeMin&&(t("rangeMin",e),a.rangeMin=e),t("price",(a.rangeMin+a.rangeMax)/2)}},{overrideComponent:c.a.createElement("div",{style:{paddingTop:6,paddingBottom:6}},c.a.createElement(ue.a,null))}];(null===(C=null==a?void 0:a.adjustmentType)||void 0===C?void 0:C.adjustmentTypeCode)===be.FRE?x.push({fieldName:"adjustmentFactor",label:O.adjustmentFactor,breakpoints:g.h,numberInputProps:{maskSettings:b.a.mask19},InputProps:{endAdornment:P+"/"+S},onUpdateOverride:t.bind(null,"adjustmentFactor")}):(null===(h=null==a?void 0:a.adjustmentType)||void 0===h?void 0:h.adjustmentTypeCode)===be.CONS&&x.push({fieldName:"agreedConsumption",label:O.agreedConsumption,breakpoints:g.h,InputProps:{endAdornment:k.mt},onUpdateOverride:t.bind(null,"agreedConsumption")}),x.push({fieldName:"price",label:j.price,breakpoints:g.h,formControlProps:{required:!0},numberInputProps:{maskSettings:b.a.mask3},InputProps:{endAdornment:P},onUpdateOverride:t.bind(null,"price")});const A={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:x,object:a,type:f.a.bunkeradjustment,userLocale:o};return Object(v.a)(A)}function ye(e){const{cargo:a,reactKeyPrefix:t,state:{adjustmentTypes:o},onToggleModal:n,showCreateEditModal:r,selectedAdjustment:l,setSelectedAdjustment:s}=e,[d,u]=Object(y.a)([p.a.IInternationalization,L.a.ICargoBunkerAdjustmentController]);Object(i.useEffect)(()=>{u.loadAdjustmentTypes()},[]);const m=(null==l?void 0:l.key)?d.lang().cargoes.editAdjustment:d.lang().cargoes.createAdjustment,b=(null==l?void 0:l.key)?d.lang().common.save:d.lang().common.create,v=Object(i.useCallback)(e=>!(e.adjustmentType&&e.rangeMin&&e.rangeMax&&e.price&&e.bunkerCategory),[]),C={adjustmentTypes:o};return c.a.createElement(se.a,{modalProps:{reactKeyPrefix:t+"-create-edit-bunker-adjustment-modal",maxWidth:"xs",open:r,title:m,confirmBtnName:b,onCloseModal:()=>{n(),s(void 0)},onDelete:()=>{u.loadBunkerAdjustments(a)}},getColSpec:ge,contextData:C,isConfirmDisabled:v,createProps:(null==l?void 0:l.key)?void 0:{type:f.a.bunkeradjustment,callback:(e,t)=>{t&&u.loadBunkerAdjustments(a)}},updateProps:(null==l?void 0:l.key)?{type:f.a.bunkeradjustment,objToUpdate:l,callback:(e,t)=>{t&&u.loadBunkerAdjustments(a)}}:void 0,selectedObject:l,breakpoints:g.e,allowDelete:!!(null==l?void 0:l.key),propertiesToSet:{cargo:a,adjustmentType:o[0]}})}const pe=Object(de.a)((function(e){return{adjustmentTypes:X.a.getTSModelsBuilt(e,f.a.adjustmenttype,{adjustmentTypeCode:"*",adjustmentTypeDesc:"*"})}}),Object(i.memo)(ye));var be;!function(e){e.CONS="CONS",e.FRE="FRE"}(be||(be={}));const ve={priceAndEditIcon:{display:"flex",alignItems:"left",flexDirection:"row",justifyContent:"end"}};function fe(e){const{cargo:a,userLocale:t,reactKeyPrefix:o}=e,[n]=Object(y.a)([p.a.IInternationalization,L.a.ICargoBunkerAdjustmentController]),[r,l]=Object(i.useState)(!1),[s,d]=Object(i.useState)(),u=Object(i.useMemo)(()=>function(e,a){const t=(null==a?void 0:a.freightCurrency)?" ("+a.freightCurrency.currencyCode+")":"";return[{content:e.lang().model.bunkerType,contentType:$.a.TEXT},{content:e.lang().fas.range(t),contentType:$.a.TEXT},{content:e.lang().fas.adjustmentFactor,contentType:$.a.TEXT,alignHeaderContent:$.c.RIGHT},{content:e.lang().fas.agreedConsumption,contentType:$.a.TEXT,alignHeaderContent:$.c.RIGHT},{content:e.lang().fas.adjustmentPrice(t),contentType:$.a.TEXT}]}(n,a),[a,n]),m=Object(i.useCallback)(()=>{l(!r)},[r]),g=Object(i.useCallback)(()=>{d(void 0),m()},[m]),b=[{disabled:!1,icon:ce.a,iconButtonProps:{color:"primary"},label:n.lang().common.create,onClick:g,reactKeyPrefix:o+"primary-actions"}],v=Object(i.useCallback)(e=>c.a.createElement(te.a,{sx:ve.priceAndEditIcon},c.a.createElement(oe.a,{display:"inline",fontSize:"12px",sx:{pt:1,color:le.b.bergenRain.secondary[11]}},n.formatNumber(e,{maxDecimals:2})),c.a.createElement(re.a,{key:"bunker-adjustment-edit-icon",sx:{pl:2,height:"35px",width:"35px",color:le.b.bergenRain.secondary[7]}})),[n]),f=Object(i.useMemo)(()=>function(e,a,t){return a.map(a=>{var o,n;const r=Object(ae.a)(null!==(n=null===(o=a.bunkerCategory)||void 0===o?void 0:o.bunkerCategoryCode)&&void 0!==n?n:""),{rangeMin:l,rangeMax:i,adjustmentFactor:c,adjustmentType:s,agreedConsumption:d,price:u}=a,m=null==s?void 0:s.adjustmentTypeCode;return{content:[null!=r?r:null,l&&i?e.formatNumber(l)+" - "+e.formatNumber(i):"",0===c&&m!==be.FRE?"":e.formatNumber(c,{minDecimals:4,maxDecimals:4}),0===d&&m!==be.CONS?"":e.formatNumber(d)+" "+e.lang().common.mt,{rawValue:u,content:t(null!=u?u:0)}],id:a.key}})}(n,a.bunkerAdjustments,v),[n,a.bunkerAdjustments,v]),C=Object(i.useCallback)(e=>{const t=a.bunkerAdjustments.find(a=>a.key===e);t&&(d(t),m())},[a.bunkerAdjustments,m]);return c.a.createElement(_.a,{marginTop:!0},c.a.createElement(H.a,{headers:u,data:f,reactKeyPrefix:o+"-cargo-bunker-adjustment-table",userLocale:t,title:n.lang().fas.bunkerAdjustments,customisation:{disableSorting:!0,responsive:!1},onRowClick:C,primaryActions:b}),r&&c.a.createElement(pe,{reactKeyPrefix:o+"-create-edit-bunker-adjustments",cargo:a,onToggleModal:m,showCreateEditModal:r,setSelectedAdjustment:d,selectedAdjustment:s}))}const Ce=e=>{var a,t,o,n,r,l,s;const{cargo:d,userLocale:u,onChange:m,onChangeLaycanFrom:g,onChangeLaycanTo:y,onChangeLaycanTargetFrom:b,onChangeLaycanTargetTo:v,onChangeDemurrageRateOrDespatchRate:f,onChangeArrivalWindowStart:C,onChangeArrivalWindowEnd:h,reactKeyPrefix:k,isOpenedFromFas:j}=e,T=V.a.get(p.a.IInternationalization),{model:P,common:S,fas:R}=T.getLanguageFile(),x=Object(i.useCallback)((e,a)=>{var t;return null!==(t=T.formatNumber(e,{minDecimals:a,maxDecimals:a,locale:u.isoCode}))&&void 0!==t?t:""},[T,u.isoCode]),A=null!==(a=T.formatNumber(d.cargoQuantity,{minDecimals:0,maxDecimals:3,locale:u.isoCode}))&&void 0!==a?a:"",w=null!==(t=T.formatNumber(d.bookedQuantity,{minDecimals:0,maxDecimals:3,locale:u.isoCode}))&&void 0!==t?t:"",E=null!==(o=T.formatNumber(d.minimumQuantity,{minDecimals:0,maxDecimals:3,locale:u.isoCode}))&&void 0!==o?o:"",I=null!==(r=null===(n=d.cargoMeasurement)||void 0===n?void 0:n.measurementCode)&&void 0!==r?r:"",M=x(d.freight,0),F=x(d.variousRevenue,0),D=null!==(s=null===(l=d.freightCurrency)||void 0===l?void 0:l.currencyCode)&&void 0!==s?s:"",N=x(d.netFio,2),L=x(d.commission,0),K=x(d.handlingCost,0),B=x(d.variousCost,0),$=0!==d.overrage?P.overage:P.deadFreight,H=x(0!==d.overrage?d.overrage:d.deadfreight,0),z=P.bunkerAdjustment,X=x(d.adjustment,0),G=x(d.eeoi,2),_=x(d.euEtsCost,2),J=Object(i.useMemo)(()=>[{primaryTitle:{text:P.cargoQuantity},primaryText:{text:`${A} ${I}`,tooltip:P.actualQuantity},secondaryTitle:{text:S.booked},secondaryText:{text:`${w} ${I}`,tooltip:P.bookedQuantity},tertiaryTitle:{text:S.minimum},tertiaryText:{text:`${E} ${I}`,tooltip:`${S.minimum} ${P.quantity}`}},{primaryTitle:{text:P.freight},primaryText:{text:`${M} ${D}`,tooltip:P.freight},secondaryTitle:{text:S.variousRevenue},secondaryText:{text:`${F} ${D}`,tooltip:S.variousRevenue},tertiaryTitle:{text:$},tertiaryText:{text:`${H} ${D}`,tooltip:$},quaternaryTitle:{text:z},quaternaryText:{text:`${X} ${D}`,tooltip:z}},{primaryTitle:{text:P.commission},primaryText:{text:`${L} ${D}`,tooltip:P.commission},secondaryTitle:{text:P.handlingCost},secondaryText:{text:`${K} ${D}`,tooltip:P.handlingCost},tertiaryTitle:{text:P.variousCost},tertiaryText:{text:`${B} ${D}`,tooltip:P.variousCost}},{primaryTitle:{text:P.netFio},primaryText:{text:`${N} ${D}`,tooltip:P.netFio},secondaryTitle:{text:P.eeoi},secondaryText:{text:`${G} ${S.eeoiUnit}`,tooltip:P.eeoi},tertiaryTitle:{text:P.euEtsCost},tertiaryText:{text:`${_} ${D}`,tooltip:P.euEtsCost}}],[P.cargoQuantity,P.actualQuantity,P.bookedQuantity,P.quantity,P.freight,P.commission,P.handlingCost,P.variousCost,P.netFio,P.eeoi,P.euEtsCost,A,I,S.booked,S.minimum,S.variousRevenue,S.eeoiUnit,w,E,M,D,F,$,H,z,X,L,K,B,N,G,_]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(Q.a,{data:J,breakpoints:{xs:8,sm:6,md:6,lg:3,xl:3},reactKeyPrefix:k+"tile-group"}),c.a.createElement(ee.a,{container:!0,spacing:2},c.a.createElement(ee.a,{item:!0,sm:6,xs:12},c.a.createElement(U,{reactKeyPrefix:k+"cargo-overview",cargo:d,userLocale:u,onChange:m,onChangeDemurrageRateOrDespatchRate:f,isOpenedFromFas:j}),c.a.createElement(O,{reactKeyPrefix:k+"cargo-stowage",cargo:d,userLocale:u,marginTop:!0})),c.a.createElement(ee.a,{item:!0,sm:6,xs:12},c.a.createElement(q.a,{reactKeyPrefix:k+"cargo-port-timeline",cargo:d,userLocale:u,onChangeLaycanFrom:g,onChangeLaycanTo:y,onChangeTargetLaycanFrom:b,onChangeTargetLaycanTo:v,onChangeArrivalWindowEnd:h,onChangeArrivalWindowStart:C}),c.a.createElement(fe,{reactKeyPrefix:k+"cargo-bunker-adjustments",cargo:d,userLocale:u}),c.a.createElement(W,{reactKeyPrefix:k+"cargo-text",cargo:d,userLocale:u,marginTop:!0}))),c.a.createElement(Z,{reactKeyPrefix:k,cargo:d,userLocale:u}))},he=c.a.memo(Ce);var ke=t(74);function je(e,a,t,o){const{cargoes:n,model:r,common:l}=o.lang(),i={reactKeyPrefix:e,fieldOptions:[{fieldName:"payee",label:r.invoiceTo,typeaheadProps:{shouldPreload:!0,objectPaths:E.b.businessPartner}},{fieldName:"pctPrepaid",InputProps:{endAdornment:T.a.Percent},label:l.prePaid,numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:{allowNegative:!1,decimalScale:0}}},{fieldName:"paymentTerms",label:l.paymentTerm,typeaheadProps:{objectPaths:["paymentTermsDesc"],shouldPreload:!0,defaultSelectedOptions:a.paymentTerms}},{fieldName:"baselineTerm",label:r.baselineTerm,typeaheadProps:{objectPaths:["baselineTermDesc"],shouldPreload:!0,defaultSelectedOptions:a.baselineTerm}},{disabled:!0,fieldName:"pctPrepaid",InputProps:{value:-1*(a.pctPrepaid-100),endAdornment:T.a.Percent},label:l.balance,numberInputProps:{validation:[{type:R.a.RANGE,max:100}],maskSettings:{allowNegative:!1,decimalScale:0}},onUpdateOverride:()=>null},{fieldName:"paymentTerms2",label:n.paymentTerms2,typeaheadProps:{objectPaths:["paymentTermsDesc"],shouldPreload:!0,defaultSelectedOptions:a.paymentTerms2}},{fieldName:"baselineTerm2",label:r.baselineTerm2,typeaheadProps:{objectPaths:["baselineTermDesc"],shouldPreload:!0,defaultSelectedOptions:a.baselineTerm2}}],object:a,type:f.a.cargo,userLocale:t,smartResponse:!0};return Object(v.a)(i)}const Oe=Object(y.b)([p.a.IInternationalization],e=>{const{cargoKey:a,userLocale:t,deps:[o],reactKeyPrefix:n}=e,[r]=Object(y.a)([L.a.ICargoDrawerController]),l=Object(i.useRef)(!1);Object(i.useEffect)(()=>{a&&r.loadPaymentTerms(a,()=>l.current=!0)},[a,r]);const s=Object(z.a)(X.a.getTSModelBuilt,f.a.cargo,a,d.h);return l.current?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.a,{reactKeyPrefix:n+"-cargo-payment-terms",items:je(n,null!=s?s:new ke.a({}),t,o),breakpoints:Object.assign(Object.assign({},g.a),{lg:4,xl:4})})):c.a.createElement(c.a.Fragment,null)});var Te=t(1297),Pe=t(82),Se=t(174),Re=t(46),xe=t(44),Ae=t(42),we=t(964),Ee=t(1229),Ie=t(217),Me=t(2361),Fe=t(81),De=t(508),Ne=t(142),Le=t(159),Ke=t(33),Ue=t(383),qe=t(850);const Be=({cargoKey:e,currency:a,userLocale:t,reactKeyPrefix:o})=>{var n;const[r]=Object(y.a)([L.a.ICargoDrawerController]),{variouses:l=[]}=null!==(n=Object(z.a)(X.a.getTSModelBuilt,f.a.cargo,e,{variouses:Ue.a}))&&void 0!==n?n:{},s=Object(i.useRef)(!1),d=Object(i.useMemo)(()=>new ke.a({key:e,variouses:l}),[e,l]);Object(i.useEffect)(()=>{r.loadVariouses(e,()=>s.current=!0)},[r,e]);const u={userLocale:t,rootObject:d,defaults:{currency:a},tsModelType:f.a.cargo,smartResponse:!0};return l&&s.current?c.a.createElement(qe.a,{variousTables:[Object.assign(Object.assign({},u),{reactKeyPrefix:o+"-cost",typeCode:"C"}),Object.assign(Object.assign({},u),{reactKeyPrefix:o+"-revenue",typeCode:"R"})]}):c.a.createElement(c.a.Fragment,null)};var We=t(1282);const Ve=e=>{const{reactKeyPrefix:a,userLocale:t,cargoKey:o,state:{cargo:n}}=e,[r]=Object(y.a)([L.a.ICargoDrawerController]),[l,s]=Object(i.useState)(!1);Object(i.useEffect)(()=>{r.loadCommissions(o,()=>s(!0))},[o]);const d=Object(i.useCallback)(()=>{r.loadCommissions(o)},[o,r]);return l&&n?c.a.createElement(We.a,{reactKeyPrefix:a,userLocale:t,tsModelObj:n,tsModelObjType:f.a.cargo,commissions:n.commissions,onDelete:d}):null},Qe=Object(de.a)((e,a)=>{var t;return{cargo:X.a.getTSModelBuilt(e,f.a.cargo,null!==(t=a.cargoKey)&&void 0!==t?t:0,d.f)}},Object(i.memo)(Ve));var $e=t(208),He=(t(118),t(624)),ze=t(149),Xe=t.n(ze),Ge=t(123);const[_e]=Object(y.a)([p.a.IInternationalization]),{model:Je,common:Ye}=_e.lang(),Ze=[{content:Ye.fromQuantity,contentType:$.a.NUMBER,numberFormatOptions:{minDecimals:0,maxDecimals:0}},{content:Ye.toQuantity,contentType:$.a.TEXT},{content:Je.freightRate,contentType:$.a.NUMBER,numberFormatOptions:{minDecimals:4,maxDecimals:4}},{content:Je.lumpsum,contentType:$.a.NUMBER,numberFormatOptions:{minDecimals:2,maxDecimals:2}}];var ea=t(102);const aa=({reactKeyPrefix:e,cargoKey:a,freightRates:t,callback:o})=>{const[n,r]=Object(y.a)([p.a.IInternationalization,L.a.ICargoDrawerController]),{model:l}=n.getLanguageFile(),i=[l.tiered,l.volume],s=t.find(e=>e.applyToTotalQuantity);return c.a.createElement(ea.a,{reactKeyPrefix:e+"type-ahead",options:i,defaultSelectedOptions:s?i[1]:i[0],overrideDefaultSelectedOptions:!0,isClearable:!1,placeholder:l.rateModel,onChange:e=>{const n=i.findIndex(e=>e===l.volume);t.length>0&&r.update(a,{freightRates:t.map(a=>({key:a.key,applyToTotalQuantity:e===i[n]}))}),o()},label:l.rateModel})};var ta=t(2069),oa=t(92);const na=({reactKeyPrefix:e,cargo:a,userLocale:t,readOnly:o=!1})=>{var n,r;const[l,s]=Object(y.a)([L.a.ICargoDrawerController,p.a.IInternationalization]),{common:u}=s.getLanguageFile(),[m,g]=Object(i.useState)(!1),[b,v]=Object(i.useState)(),[C,h]=Object(i.useState)(void 0),[k,j]=Object(i.useState)(!1),[O,T]=Object(i.useState)([]),P=Object(i.useRef)(!1);Object(i.useEffect)(()=>{l.loadFreightRates(a.key,()=>P.current=!0)},[a.key,l]);let{freightRates:S=[]}=null!==(n=Object(z.a)(X.a.getTSModelBuilt,f.a.cargo,a.key,{freightRates:d.m}))&&void 0!==n?n:{};const[R,x]=Object(i.useState)(null!==(r=!!S.find(e=>e.applyToTotalQuantity))&&void 0!==r&&r),A=[{disabled:!1,icon:ce.a,iconButtonProps:{color:"primary","aria-label":u.create},label:u.create,onClick:()=>{const e={applyToTotalQuantity:R,value:0,quantity:0,lumpsum:0,source:a.key};S=[...S,e],v(e),g(e=>!e)},reactKeyPrefix:e+"-create-button"}],w=()=>{j(e=>!e)},E=Object(i.useMemo)(()=>[{disabled:!1,icon:Xe.a,iconButtonProps:{"aria-label":u.delete},label:u.delete,onClick:e=>{T(e),w()},reactKeyPrefix:e+"-selected-actions"}],[u.delete,e]),I=Object(i.useMemo)(()=>S.sort((e,a)=>e.quantity-a.quantity).map((e,a)=>{var t,o,n,r;return n=e,r=null!==(o=null===(t=S[a+1])||void 0===t?void 0:t.quantity)&&void 0!==o?o:void 0,{content:[n.quantity,r?Ge.a.formatNumber(r-1,{minDecimals:0,maxDecimals:0}):Ye.andAbove,n.value,n.lumpsum],id:n.key}}),[S]);return P.current?c.a.createElement(c.a.Fragment,null,c.a.createElement(aa,{cargoKey:a.key,reactKeyPrefix:e,freightRates:S,callback:()=>{x(e=>!e)}}),c.a.createElement(H.a,{headers:Ze,userLocale:t,reactKeyPrefix:e+"-freight-rate-tiers-table",data:I,selectable:!o,selectedActions:E,primaryActions:A,onRowClick:e=>{const a=S.filter(a=>a.key===e);a&&1===a.length&&(h(void 0),v(a[0]),g(e=>!e))},customisation:{disableSorting:!0},preSelectedRow:C}),c.a.createElement(ta.a,{reactKeyPrefix:e,applyToTotalQuantity:R,cargo:{key:a.key,freightRates:S},selectedFreightRate:null!=b?b:new He.a({applyToTotalQuantity:R,value:0,quantity:0,lumpsum:0,source:a.key}),onCloseModal:()=>{v(void 0),g(e=>!e)},showModal:m,onCreateCallback:(e,a)=>{var t,o;if((null===(t=a)||void 0===t?void 0:t.freightRates.length)>0){const e=null===(o=a.freightRates[a.freightRates.length-1])||void 0===o?void 0:o._key;e&&h(e)}}}),c.a.createElement(xe.a,{reactKeyPrefix:e+"-delete-rate-tiers-modal",open:k,onCloseModal:w,onConfirm:()=>{if(a){const e=S.filter(e=>!O.includes(e.key));oa.a.getUpdateFieldFunction({fieldToSet:"freightRates",fields:{},key:a.key,type:f.a.cargo,smartResponse:!0})(e)}w(),T([])},title:u.delete,maxWidth:"xs",fullWidth:!0,confirmBtnName:u.delete},u.deleteItemsConfirmation)):c.a.createElement(c.a.Fragment,null)};var ra=t(40),la=t(245),ia=t(187),ca=t(213);const sa=Object(ca.a)(e=>Object(ia.a)(Object.assign({},(e=>Object(ia.a)({container:{backgroundColor:Object(la.a)(e.palette.primary.main,.05),borderRadius:"10px",padding:"20px"},containerTitle:{flexDirection:"column"},scheduleTable:{marginTop:e.spacing(2)},labelChip:{marginRight:e.spacing(1),borderRadius:e.spacing(4),padding:e.spacing(1.3,.5)}}))(e))));var da=t(218);const ua=e=>{var a,t,o,n;const{voyage:r,reactKeyPrefix:l}=e,[d]=Object(y.a)([p.a.IInternationalization]),{common:u}=d.getLanguageFile(),m=sa(),g=Object(s.g)(),b=Object(s.h)(),v=Object(i.useCallback)(()=>{r&&D.a.openDrawer(r.key,N.a.voyageDrawer,b,g)},[g,b,r]),f=Object(i.useCallback)(()=>{(null==r?void 0:r.vessel)&&D.a.openDrawer(r.vessel.key,N.a.vesselDrawer,b,g)},[g,b,r]);if(r){const e=null!==(t=null===(a=null==r?void 0:r.voyageHeader)||void 0===a?void 0:a.referenceNo)&&void 0!==t?t:"",i=null!==(n=null===(o=null==r?void 0:r.vessel)||void 0===o?void 0:o.vesselName)&&void 0!==n?n:"";return c.a.createElement(c.a.Fragment,null,c.a.createElement(da.a,{title:u.goToVessel},c.a.createElement("div",null,c.a.createElement(ra.a,{id:l+"-vessel-label-chip",className:m.labelChip,label:i,onClick:f}))),c.a.createElement(da.a,{title:u.goToVoyage},c.a.createElement("div",null,c.a.createElement(ra.a,{id:l+"-voyage-label-chip",className:m.labelChip,label:e,onClick:v}))),"| ")}return null};var ma=t(234),ga=t(651),ya=t(240),pa=t(1950),ba=t(296),va=t(450),fa=t(1781),Ca=t(341),ha=t(331);const ka="doc-common-components-drawer-cargo-drawer";function ja(e){var a;const[t,o,r,d,u,m]=Object(y.a)([p.a.IInternationalization,A.a.ITSModelActions,L.a.ICargoDrawerController,L.a.ICargoDrawerControllerPortCall,A.a.ISelectedCargoActions,A.a.ISimpleReducerActions]),{model:g,common:b,cargoes:v,alerts:C,coa:h}=t.getLanguageFile(),{dispatchAction:k,state:{cargo:j,selectedCargoVoyageDrawer:O,selectedScenarioKey:T,skipLoadingDrawerKey:P,userLocale:R}}=e,x=Object(s.g)(),w=Object(s.h)(),{drawerId:E,tabId:I}=Object(s.i)(),{isOpenedFromFas:M}=Object(ha.b)(),{setSelectedCard:F}=Object(i.useContext)(ma.a),[K,U]=Object(i.useState)(),[q,B]=Object(i.useState)(!1),[W,V]=Object(i.useState)(!1),[Q,$]=Object(i.useState)(!1),[H,z]=Object(i.useState)(!1),[X,G]=Object(i.useState)(!1),[_,Y]=Object(i.useState)(null),[Z,ee]=Object(i.useState)(!1),[ae,te]=Object(i.useState)([]),[oe,ne]=Object(i.useState)(!1),[re,le]=Object(i.useState)(!1),ie=w.pathname.includes(N.a.voyageDrawer),ce=Object(i.useCallback)(()=>V(!W),[W]),se=Object(i.useCallback)(()=>B(!q),[q]),de=Object(i.useCallback)(()=>ee(!Z),[Z]),ue=Object(i.useCallback)(()=>{z(!H),te(S.a.getLastLinkedCargoPorts(j))},[j,H]),me=Object(i.useCallback)(e=>{Y(e),G(!X)},[X]);Object(i.useEffect)(()=>{k(u.setAction(E)),m.setAction(ya.a,null),E&&Number(E)!==P&&(r.loadCargo(E),M&&F(Number(E))),ie&&Number(E)!==Number(O)&&m.setAction(ba.a,Number(E))},[E]);const ge=Object(i.useCallback)(()=>{j&&r.unallocateCargo(j,Re.a.next)},[j,r]),ye=Object(i.useCallback)(e=>{o.loadSingleAction({key:e.key,type:f.a.voyage})},[o]),pe=Object(i.useCallback)(()=>{(null==j?void 0:j.isTemplate)?x.push(D.a.splitRoute("cargo")):ie&&(null==j?void 0:j.voyage)?Q?Re.a.next():ye(j.voyage):x.goBack()},[j,ie,x,Q,ye]),be=Object(i.useCallback)(()=>{d.deletePortCalls(ae).then(()=>{(null==j?void 0:j.voyage)&&ye(null==j?void 0:j.voyage)})},[j,ae,d,ye]),ve=Object(i.useCallback)(()=>{j&&r.deleteCargo(j.key,()=>{Q&&be(),pe()}),z(!1)},[Q,j,r,be,pe]),fe=Object(i.useCallback)((e,a)=>{var t,o;if(j){const n=(null===(t=j.voyage)||void 0===t?void 0:t.scenarios)&&(null===(o=j.voyage)||void 0===o?void 0:o.scenarios.length)>0;r.updateLayCan(j,e,a,()=>{if(T&&n){const e=Object(Ca.d)(w.pathname,Ke.a.budgets.url),a=Object(Ca.d)(w.pathname,Ke.a.fleetPlans.url);e?Re.a.next():a&&r.refreshFleetPlan()}})}},[j,r,w.pathname,T]),Ce=Object(i.useCallback)(e=>{ce(),U(e)},[ce]),ke=Object(i.useCallback)(e=>r.update(null==j?void 0:j.key,e),[j,r]),je=Object(i.useCallback)(e=>{Object(Ie.c)(e,null==j?void 0:j.laycanTo)?fe("laycanFrom",e):Ce(C.cancellingAfterCommencement)},[C.cancellingAfterCommencement,j,Ce,fe]),Ae=Object(i.useCallback)(e=>{Object(Ie.c)(null==j?void 0:j.laycanFrom,e)?fe("laycanTo",e):Ce(C.cancellingAfterCommencement)},[C.cancellingAfterCommencement,j,Ce,fe]),Ne=Object(i.useCallback)(e=>{Object(Ie.c)(e,null==j?void 0:j.laycanTargetTo)?fe("laycanTargetFrom",e):Ce(C.cancellingAfterCommencementTarget)},[C.cancellingAfterCommencementTarget,j,Ce,fe]),Ue=Object(i.useCallback)(e=>{Object(Ie.c)(null==j?void 0:j.laycanTargetFrom,e)?fe("laycanTargetTo",e):Ce(C.cancellingAfterCommencementTarget)},[C.cancellingAfterCommencementTarget,j,Ce,fe]),qe=Object(i.useCallback)(e=>{Object(Ie.c)(e,null==j?void 0:j.arrivalWindowTo)?fe("arrivalWindowFrom",e):Ce(C.cancellingAfterCommencementTarget)},[C.cancellingAfterCommencementTarget,j,Ce,fe]),We=Object(i.useCallback)(e=>{Object(Ie.c)(null==j?void 0:j.arrivalWindowFrom,e)?fe("arrivalWindowTo",e):Ce(C.windowEndAfterWindowStart)},[C.windowEndAfterWindowStart,j,Ce,fe]),Ve=Object(i.useCallback)((e,a)=>{j&&("demurrageRate"===e?j.despatchRate=r.updateDemurrageRateAndDespatchRate(j,a):r.updateDespatchRate(j,a))},[j,r]),He=Object(i.useCallback)(e=>{j&&e&&(Object(Me.a)(j,"bookingStatus.statusTypeCode",e.statusTypeCode),r.updateCargoStatus(j.key,e))},[j,r]),ze=Object(i.useCallback)(()=>{j&&r.copyCargo(j,(e,a)=>{a&&(D.a.openDrawer(a.key,N.a.cargoDrawer,w,x),Re.a.next(),!j.voyage&&M&&r.refreshCargoCommitments())})},[j,r,x,M,w]),Xe=Object(i.useCallback)(()=>{var e;(null===(e=null==j?void 0:j.coaLine)||void 0===e?void 0:e.coa)&&D.a.openDrawer(j.coaLine.coa.key,N.a.coaDrawer,w,x)},[x,w,j]),Ge=Object(i.useCallback)(e=>{if(null==j?void 0:j.key){const a={cargoReference:e};r.update(j.key,a)}},[j,r]),_e=Object(i.useCallback)(()=>{j&&ne(!oe)},[j,oe]),Je=Object(i.useCallback)(()=>{j&&le(!re)},[j,re]),Ye=Object(i.useCallback)(()=>{(null==j?void 0:j.key)&&r.removeCoaFromCargo(j)},[j,r]),Ze=Object(i.useMemo)(()=>{var e;return(null===(e=null==j?void 0:j.cargoType)||void 0===e?void 0:e.cargoTypeCode)===Le.a.TRANSFER},[j]),ea=Object(i.useMemo)(()=>{var e;return[{disabled:!1,onClick:()=>{var e;return r.printBooking(null!==(e=null==j?void 0:j.key)&&void 0!==e?e:0)},icon:l.a,label:`${b.print} ${v.bookingConfirmation}`},{disabled:Ze||(null===(e=null==j?void 0:j.cargoType)||void 0===e?void 0:e.cargoTypeCode)===Le.a.TRANSSHIPMENT,icon:n.a,label:v.copyCargo,onClick:ze}]},[j,r,v.bookingConfirmation,v.copyCargo,b.print,Ze,ze]),aa=Object(i.useCallback)(()=>{le(!re)},[re]),ta=Object(i.useMemo)(()=>{var e,a;const t=Object(Fe.a)(j,"voyage.voyageHeader.voyageStatus.statusTypeCode",""),o=["SCH","NOM","OPR","EST","SCU"].some(e=>t.includes(e)),n=!!(null==j?void 0:j.isTemplate),r=!!(null==j?void 0:j.voyage)&&!o,l=(null===(e=null==j?void 0:j.cargoType)||void 0===e?void 0:e.cargoTypeCode)===Le.a.HAS_TRANSFER,i=null===(a=null==j?void 0:j.voyage)||void 0===a?void 0:a.isTc;return[{disabled:!o||n||i,onClick:ge,text:v.unallocateCargo,tooltipText:r?v.voyageStatusMustBeSchNomOpr:void 0},{disabled:n||i,onClick:se,text:`${b.allocate} ${g.cargo}`},{disabled:!1,onClick:ue,text:b.delete},{disabled:i,onClick:me.bind(null,De.a.Relet),text:g.relet},{disabled:l||i,onClick:me.bind(null,De.a.Transship),text:g.transship},{disabled:Ze||i,onClick:me.bind(null,De.a.Preship),text:g.preship},{disabled:l||i,onClick:de,text:b.transfer},{disabled:!1,onClick:_e,text:v.editCargoReferenceAction},{disabled:!1,onClick:Je,text:h.connectToCoa},{disabled:null===(null==j?void 0:j.coaLine),onClick:Ye,text:h.removeCoa}]},[j,ge,v.unallocateCargo,v.voyageStatusMustBeSchNomOpr,v.editCargoReferenceAction,se,b.allocate,b.delete,b.transfer,g.cargo,g.relet,g.transship,g.preship,ue,me,Ze,de,_e,Je,h.connectToCoa,h.removeCoa,Ye]),oa=Object(i.useMemo)(()=>{var e,a,t,o;if((null===(e=null==j?void 0:j.cargoType)||void 0===e?void 0:e.cargoTypeCode)===Le.a.TRANSFER){if(null===(t=null===(a=j.tsOfCargoPort)||void 0===a?void 0:a.cargo)||void 0===t?void 0:t.subCargos)return null===(o=j.tsOfCargoPort)||void 0===o?void 0:o.cargo}return null},[j]),la=Object(i.useMemo)(()=>{if(j&&j.key===Number(E)){const{key:e,freightCurrency:a}=j;return[{id:"main-details",content:()=>c.a.createElement(he,{reactKeyPrefix:ka+"-main-details",cargo:j,userLocale:R,onChange:ke,onChangeLaycanFrom:je,onChangeLaycanTo:Ae,onChangeLaycanTargetFrom:Ne,onChangeLaycanTargetTo:Ue,onChangeDemurrageRateOrDespatchRate:Ve,onChangeArrivalWindowStart:qe,onChangeArrivalWindowEnd:We,isOpenedFromFas:M}),label:b.mainDetails},{id:"sub-cargo",content:()=>c.a.createElement(Te.a,{reactKeyPrefix:ka+"-sub-cargo-list",cargo:oa||j,userLocale:R}),label:v.subCargoes},{id:"various-cost-revenue",content:()=>c.a.createElement(Be,{cargoKey:e,currency:a,reactKeyPrefix:ka,userLocale:R}),label:b.variousCostRevenue},{id:"commissions",content:()=>c.a.createElement(Qe,{cargoKey:e,reactKeyPrefix:ka+"-commissions-table",userLocale:R}),label:g.commissions},{id:"freight-rate-tiers",content:()=>c.a.createElement(na,{reactKeyPrefix:ka+"-freight-rate-tiers-list",cargo:j,userLocale:R}),label:g.freightRateTiers},{id:"payment-terms",content:()=>c.a.createElement(Oe,{reactKeyPrefix:ka+"-payment-terms",cargoKey:e,userLocale:R}),label:b.paymentTerms}]}return[]},[j,E,v.subCargoes,b.mainDetails,b.paymentTerms,b.variousCostRevenue,M,g.commissions,g.freightRateTiers,ke,We,qe,Ve,je,Ne,Ue,Ae,oa,R]),ia=Object(i.useMemo)(()=>({statusObject:null==j?void 0:j.bookingStatus,type:Se.b.TRANSITION,onClick:He}),[null==j?void 0:j.bookingStatus,He]),ca=Object(i.useMemo)(()=>{var e;return c.a.createElement(ua,{voyage:null!==(e=null==j?void 0:j.voyage)&&void 0!==e?e:null,reactKeyPrefix:ka+"-cargo-subject-component"})},[j]),sa=Object(i.useMemo)(()=>{var e,a,o;return j?"COA"===(null===(e=j.cargoType)||void 0===e?void 0:e.cargoTypeCode)?c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{cargo:j}),c.a.createElement(da.a,{title:t.lang().common.goToCOA},c.a.createElement("div",null,c.a.createElement(ra.a,{id:ka+"-coa-contract-chip",label:null===(o=null===(a=j.coaLine)||void 0===a?void 0:a.coa)||void 0===o?void 0:o.contractNo,rounded:!0,onClick:Xe})))):c.a.createElement(c.a.Fragment,null,c.a.createElement(J.a,{cargo:j})):null},[t,j,Xe]);return j?c.a.createElement(Pe.a,{size:"medium",reactKeyPrefix:ka,status:ia,drawerKey:Number(E),drawerRoute:N.a.cargoDrawer,key:N.a.cargoDrawer+E,subject:g.cargo,subjectLoaded:j.key===Number(E),subjectName:null!==(a=j.cargoReference)&&void 0!==a?a:"",tabs:la,tabId:I,secondaryActions:ta,primaryActions:ea,tsModelType:f.a.cargo,subjectComponentRight:sa,subjectComponentLeft:ca},q&&c.a.createElement(we.a,{reactKeyPrefix:ka+"-allocate-cargo",showDialog:q,onCloseDialog:se,cargo:j,history:x,location:w,isOpenedFromFas:M}),Z&&c.a.createElement(we.a,{reactKeyPrefix:ka+"-transfer-cargo",showDialog:Z,onCloseDialog:de,cargo:j,isTransfer:!0,history:x,location:w,isOpenedFromFas:M}),W&&c.a.createElement(xe.a,{reactKeyPrefix:ka+"-date-warning-modal",open:W,title:b.invalidDates,onCloseModal:ce,hideConfirmBtn:!0,cancelBtnName:b.close},K),H&&c.a.createElement(Ee.a,{reactKeyPrefix:ka+"-delete-cargo-cargo-port",cargo:j,title:v.deleteCargo,lastLinkedPCs:ae,showModal:H,checkboxLabel:v.deletelinkedPortCalls,onClose:ue,onDelete:ve,onCheckboxInputChange:$}),X&&c.a.createElement(De.b,{cargo:j,reactKeyPrefix:ka+"-relet-cargo-modal",open:X,maxWidth:"xs",fullWidth:!0,onCloseModal:me.bind(null,null),actionType:_}),oe&&c.a.createElement($e.a,{reactKeyPrefix:ka+"-edit-cargo-reference-modal",title:v.editCargoReference,value:j.cargoReference,showModal:oe,onClose:_e,onConfirm:Ge,required:!0}),re&&c.a.createElement(pa.a,{cargo:j,open:re,reactKeyPrefix:ka+"-connect-cargo-to-coa-line-modal",onClose:aa})):null}const Oa=Object(de.a)(e=>{var a;const t=fa.a.get(e),o=X.a.getTSModelBuilt(e,f.a.cargo,null!=t?t:0,d.c),n=ga.a.get(e);return{cargo:o,selectedCargoVoyageDrawer:va.a.get(e),selectedScenarioKey:Number(null!==(a=Ne.a.get(e,f.a.scenario))&&void 0!==a?a:0),skipLoadingDrawerKey:n?Number(n):null,userLocale:Ae.a.getUserLocale(e)||u.f[0]}},Object(i.memo)(ja))},223:function(e,a,t){"use strict";t.d(a,"a",(function(){return U}));t(59);var o,n,r,l,i,c,s,d=t(9),u=t(7),m=t(29),g=t(122),y=t(1),p=t(114),b=t(192),v=t(3),f=t(48),C=t(714),h=t(31),k=t(206),j=t(131),O=t(383),T=t(104),P=t(83),S=t(32),R=t(89),x=t(316),A=t(20),w=t(74),E=t(142),I=t(588),M=t(387),F=t(21),D=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},N=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},L=function(e,a){return function(t,o){a(t,o,e)}},K=function(e,a,t,o){return new(t||(t=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}c((o=o.apply(e,a||[])).next())}))};let U=class extends C.a{constructor(e,a,t,o,n,r,l){super(e,a,n),this.store=e,this.tsmodelActions=a,this.objectApi=t,this.i=o,this.scenarioActions=n,this.ctrlVoyage=r,this.fasCargoApi=l}update(e,a,t){return e?this.tsmodelActions.updateSingleAction({callback:t,data:a,key:e,type:y.a.cargo,headers:j.a.smartJson}):Promise.reject()}updateCargoPort(e,a,t){return e?this.tsmodelActions.updateSingleAction({callback:t,data:a,key:e,type:y.a.cargoport,headers:j.a.smartJson}):Promise.reject()}loadCargo(e){this.tsmodelActions.loadSingleAction({fields:g.b,key:e,type:y.a.cargo,headers:Object(f.b)()?j.a.serializeCache:void 0})}loadCommissions(e,a){this.tsmodelActions.loadSingleAction({fields:g.f,key:e,type:y.a.cargo,callback:a})}deleteCargo(e,a){this.tsmodelActions.deleteAction({key:e,type:y.a.cargo,callback:a})}copyCargo(e,a){Object(p.a)(this.i.lang().cargoes.copyCargo,this.i.lang().common.copyConfirmation,this.i.lang().common.copy).then(t=>{t&&this.tsmodelActions.copySingleAction({key:e.key,type:y.a.cargo,fields:g.g,callback:a})})}updateLayCan(e,a,t,o){this.tsmodelActions.updateSingleAction({callback:o,data:{[a]:t},key:e.key,type:y.a.cargo,headers:j.a.smartJson})}updateDemurrageRateAndDespatchRate(e,a){var t,o,n,r;if(e.demurrageRate!==a){const l="BULK"===(null===(r=null===(n=null===(o=null===(t=e.voyage)||void 0===t?void 0:t.vessel)||void 0===o?void 0:o.vesselType)||void 0===n?void 0:n.vesselCategory)||void 0===r?void 0:r.vesselCategoryCode);e.despatchRate=l?a/2:e.despatchRate;const i=e.cargoPorts.map(t=>({key:t.key,demurrageRate:a,despatchRate:e.despatchRate}));this.tsmodelActions.updateSingleAction({data:{demurrageRate:a,despatchRate:e.despatchRate,cargoPorts:i},key:e.key,type:y.a.cargo,headers:j.a.smartJson})}return e.despatchRate}updateDespatchRate(e,a){if(e.despatchRate!==a){const t=e.cargoPorts.map(e=>({key:e.key,despatchRate:a}));this.tsmodelActions.updateSingleAction({data:{despatchRate:a,cargoPorts:t},key:e.key,type:y.a.cargo,headers:j.a.smartJson})}}updateCargoStatus(e,a){this.tsmodelActions.updateSingleAction({data:{bookingStatus:a.statusTypeCode},key:e,type:y.a.cargo,headers:j.a.smartJson})}loadVariouses(e,a){this.tsmodelActions.loadSingleAction({fields:{variouses:O.a},key:e,type:y.a.cargo,callback:(e,t)=>{!e&&a&&t&&a(t)}})}loadPaymentTerms(e,a){this.tsmodelActions.loadSingleAction({fields:g.h,key:e,type:y.a.cargo,callback:a})}printBooking(e){const a=[f.a.BASE_URL?f.a.BASE_URL:"production"===f.a.NODE_ENV?"":"http://platform-dev.dataloy.com","/birt?username=dataloyreport","&password=BEyeTOnKAble","/preview","?__report=booking_confirmation.rptdesign","&__format=pdf","&cargo_id="+e].join("");window.open(a)}loadSubCargos(e,a){this.tsmodelActions.loadSingleAction({fields:g.l,type:y.a.cargo,key:e,callback:a})}loadFreightRates(e,a){this.tsmodelActions.loadSingleAction({fields:{freightRates:g.m},type:y.a.cargo,key:e,callback:a})}calculateSubCargo(e){var a;return K(this,void 0,void 0,(function*(){return yield this.objectApi.put({authdata:null!==(a=Object(S.a)(this.store.getState()).authdata)&&void 0!==a?a:"",data:Object(R.a)(e),fields:Object.assign(Object.assign({},g.k),{cargo:g.c}),key:e.key,query:"doNotStore=true",type:y.a.subcargo})}))}calculateNewSubCargo(e){var a;return K(this,void 0,void 0,(function*(){return yield this.objectApi.post({authdata:null!==(a=Object(S.a)(this.store.getState()).authdata)&&void 0!==a?a:"",data:Object(R.a)(e),fields:Object.assign(Object.assign({},g.k),{cargo:g.c}),query:"doNotStore=true",type:y.a.subcargo})}))}cargoPortFields(){return{cargoPorts:{cargoPortSequence:"*",cargoQuantity:"*",reasonForCall:{reasonForCall:"*"}}}}triggerPortCallBLs(e){const a=F.a.getTSModelBuilt(this.store.getState(),y.a.cargo,e.key,this.cargoPortFields());if(null==a?void 0:a.cargoPorts){const t=a.cargoPorts.filter(e=>{var a;return"L"===(null===(a=e.reasonForCall)||void 0===a?void 0:a.reasonForCall)}).find(e=>1===e.cargoPortSequence);t&&this.tsmodelActions.updateSingleAction({data:{cargoQuantity:t.cargoQuantity},fields:g.j,key:t.key,type:y.a.cargoport,callback:()=>{e.voyage&&this.refreshCargo(e,!1)}})}}refreshCargo(e,a){const t=Object(R.a)(new w.a(e)),o=a?this.cargoPortFields():g.c;this.tsmodelActions.loadSingleAction({fields:o,key:t.key,type:y.a.cargo,callback:t=>{e.voyage&&(!t&&a?this.triggerPortCallBLs(e):this.ctrlVoyage&&this.ctrlVoyage.refreshVoyage(e.voyage))}})}refreshCargoCommitments(){const e=E.a.get(this.store.getState(),y.a.scenario);this.fasCargoApi.loadUnallocatedCargos(e,I.b)}updateLaytimeTermsValue(e,a,t,o){var n,r,l,i;return K(this,void 0,void 0,(function*(){if(e){const c={laytimeTermsValue:a};yield this.updateCargoPort(e,c);const s=null!==(l=null===(r=null===(n=null==t?void 0:t.voyageHeader)||void 0===n?void 0:n.voyageStatus)||void 0===r?void 0:r.statusTypeCode)&&void 0!==l?l:"",d=["EST","SCU"].includes(s);if((null===(i=null==t?void 0:t.vessel)||void 0===i?void 0:i.key)&&o&&!d)this.scenarioActions.refreshScenarioFleetPlanData([t.vessel.key],!0,d);else if(t)return this.tsmodelActions.loadSingleAction({key:t.key,type:y.a.voyage,fields:g.i});return Promise.resolve()}return Promise.reject()}))}removeCoaFromCargo(e){var a,t,o;(null==e?void 0:e.key)&&this.tsmodelActions.updateSingleAction({key:e.key,type:y.a.cargo,data:{coaLine:null,voyage:{voyageHeader:{templateVoyageHeader:null,key:null===(t=null===(a=e.voyage)||void 0===a?void 0:a.voyageHeader)||void 0===t?void 0:t.key},key:null===(o=e.voyage)||void 0===o?void 0:o.key}},fields:{cargoType:{cargoTypeCode:"*"},coaLine:"*",voyage:{voyageHeader:{templateVoyageHeader:"*"}}}})}};U=D([Object(d.injectable)(),L(0,Object(d.inject)(u.a.Store)),L(1,Object(d.inject)(u.a.ITSModelActionsAsync)),L(2,Object(d.inject)(P.a.ITSModelApi)),L(3,Object(d.inject)(v.a.IInternationalization)),L(4,Object(d.inject)(u.a.IScenarioActions)),L(5,Object(d.inject)(A.a.ICargoDrawerControllerVoyage)),L(6,Object(d.inject)(u.a.IFasCargoApi)),N("design:paramtypes",["function"==typeof(o=void 0!==h.Store&&h.Store)?o:Object,"function"==typeof(n=void 0!==m.ITSModelActionsAsync&&m.ITSModelActionsAsync)?n:Object,"function"==typeof(r=void 0!==T.ITSModelApi&&T.ITSModelApi)?r:Object,"function"==typeof(l=void 0!==b.IInternationalization&&b.IInternationalization)?l:Object,"function"==typeof(i=void 0!==k.IScenarioActions&&k.IScenarioActions)?i:Object,"function"==typeof(c=void 0!==x.ICargoDrawerControllerVoyage&&x.ICargoDrawerControllerVoyage)?c:Object,"function"==typeof(s=void 0!==M.IFasCargoApi&&M.IFasCargoApi)?s:Object])],U)},316:function(e,a,t){"use strict";t.d(a,"a",(function(){return T}));t(59);var o,n,r,l,i=t(9),c=t(31),s=t(7),d=t(83),u=t(104),m=t(32),g=t(1),y=t(84),p=t(107),b=t(20),v=t(389),f=t(29),C=t(62),h=t(892),k=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},j=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},O=function(e,a){return function(t,o){a(t,o,e)}};let T=class{constructor(e,a,t,o){this.store=e,this.objectApi=a,this.ctrlPortCall=t,this.tsModelActions=o}onUpdateVoyage(e,a){const t=this.ctrlPortCall.generatePostablePortCalls(e.portCallsFromVoyage);return Object(h.a)(t)?Promise.resolve():this.objectApi.put({authdata:Object(m.a)(this.store.getState()).authdata||"",key:e.key,type:g.a.voyage,fields:{portCalls:{port:{key:"*"},reasonForCall:{reasonForCall:"*"},portCallSequence:"*",vesselPcSequence:"*"},portCallsFromVoyage:{port:{key:"*"},reasonForCall:{reasonForCall:"*"},portCallSequence:"*",vesselPcSequence:"*"}},data:{portCallsFromVoyage:t}}).then(t=>{if(!a)return t;a(t,e)}).catch(e=>{y.a.error(e)})}refreshVoyage(e){const a=new C.a(e);null!==a&&this.tsModelActions.loadSingleAction({fields:p.n,key:a.key,type:g.a.voyage})}};T=k([Object(i.injectable)(),O(0,Object(i.inject)(s.a.Store)),O(1,Object(i.inject)(d.a.ITSModelApi)),O(2,Object(i.inject)(b.a.ICargoDrawerControllerPortCall)),O(3,Object(i.inject)(s.a.ITSModelActionsAsync)),j("design:paramtypes",["function"==typeof(o=void 0!==c.Store&&c.Store)?o:Object,"function"==typeof(n=void 0!==u.ITSModelApi&&u.ITSModelApi)?n:Object,"function"==typeof(r=void 0!==v.ICargoDrawerControllerPortCall&&v.ICargoDrawerControllerPortCall)?r:Object,"function"==typeof(l=void 0!==f.ITSModelActionsAsync&&f.ITSModelActionsAsync)?l:Object])],T)},389:function(e,a,t){"use strict";t.d(a,"a",(function(){return f}));t(59);var o,n=t(9),r=t(68),l=t(271),i=t(221),c=t(81),s=t(29),d=t(7),u=t(1),m=t(575),g=t(50),y=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},p=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},b=function(e,a){return function(t,o){a(t,o,e)}},v=function(e,a,t,o){return new(t||(t=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}c((o=o.apply(e,a||[])).next())}))};let f=class{constructor(e){this.tsmodelActions=e}setNewPortCallSequenceOnCargoPortPortCall(e,a){return e.forEach(e=>{var t,o;e&&(a.portCall&&a.portCall.key>0&&e.key===a.portCall.key?a.portCall=new r.a(Object.assign(Object.assign({},a.portCall),{portCallSequence:e.portCallSequence})):a.portCall&&m.a.isCargoPortPortAndTerminalEqual(e,a.portCall)&&(null===(t=e.reasonForCall)||void 0===t?void 0:t.key)===(null===(o=a.portCall.reasonForCall)||void 0===o?void 0:o.key)&&(a.portCall=new r.a({key:e.key,portCallSequence:e.portCallSequence})))}),a}generatePostablePortCalls(e,a){return e.map(e=>{var t,o,n,r,l,i;return e.key<0?{portCallSequence:e.portCallSequence,eventLogs:g.a.getDefaultEventLogs(),reasonForCall:(null===(t=e.reasonForCall)||void 0===t?void 0:t.key)?e.reasonForCall.key:null===(o=e.reasonForCall)||void 0===o?void 0:o.reasonForCall,port:null===(n=e.port)||void 0===n?void 0:n.key,terminal:null===(r=e.terminal)||void 0===r?void 0:r.key,voyage:null!==(i=null===(l=e.voyage)||void 0===l?void 0:l.key)&&void 0!==i?i:null==a?void 0:a.key}:{key:e.key,portCallSequence:e.portCallSequence}})}generatePostablePortCall(e,a,t){var o,n,r,l,i;return e.key<0?{portCallSequence:e.portCallSequence,eventLogs:t?[]:g.a.getDefaultEventLogs(),reasonForCall:null===(o=e.reasonForCall)||void 0===o?void 0:o.key,port:null===(n=e.port)||void 0===n?void 0:n.key,terminal:null===(r=e.terminal)||void 0===r?void 0:r.key,voyage:null!==(i=null===(l=e.voyage)||void 0===l?void 0:l.key)&&void 0!==i?i:null==a?void 0:a.key}:{portCallSequence:e.portCallSequence}}createPortCallObject(e,a){var t;const o=new l.a,n=Object(c.a)(e,"reasonForCall"),r=new i.a({reasonForCall:null==n?void 0:n.reasonForCall,reasonForCallDesc:null==n?void 0:n.reasonForCallDesc});return{key:-Math.abs(o.getNextKey()),port:e.port,terminal:e.terminal,reasonForCall:r,voyage:null===(t=null==a?void 0:a.voyage)||void 0===t?void 0:t.key,portCallSequence:void 0,eventLogs:g.a.getDefaultEventLogs(),cargoPorts:[e]}}deletePortCalls(e){return v(this,void 0,void 0,(function*(){yield e.forEach(e=>{this.tsmodelActions.deleteAction({key:e.key,type:u.a.portcall})})}))}};f=y([Object(n.injectable)(),b(0,Object(n.inject)(d.a.ITSModelActionsAsync)),p("design:paramtypes",["function"==typeof(o=void 0!==s.ITSModelActionsAsync&&s.ITSModelActionsAsync)?o:Object])],f)},674:function(e,a,t){"use strict";t.d(a,"a",(function(){return j}));var o,n,r,l=t(9),i=t(122),c=t(316),s=t(20),d=t(1),u=t(62),m=t(7),g=t(29),y=t(575),p=t(89),b=t(64),v=t(131),f=t(223),C=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},h=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},k=function(e,a){return function(t,o){a(t,o,e)}};let j=class{constructor(e,a,t){this.tsmodelActions=e,this.ctrlVoyage=a,this.ctrlCargo=t}createCargoPortAndUpdateCargo(e,a){e&&this.tsmodelActions.updateSingleAction({key:a,fields:{cargoPorts:i.d,voyage:"*"},data:e,type:d.a.cargo,callback:(e,a)=>{a&&this.ctrlCargo.refreshCargo(a,!0)}})}updateCargoCargoPorts(e,a){this.tsmodelActions.updateSingleAction({data:{cargoPorts:e},key:a.key,type:d.a.cargo,callback:(e,t)=>{e?this.ctrlVoyage.onUpdateVoyage(new u.a(Object.assign({},a.voyage))):t.voyage&&(this.ctrlVoyage.refreshVoyage(t.voyage),this.ctrlCargo.refreshCargo(a,!0))},headers:v.a.smartJson})}generatePostableCargoPorts(e,a,t,o){return e.map(e=>{var n,r,l,i,c,s,d,u,m,g,v,f,C,h,k,j,O,T,P,S,R,x,A,w,E,I,M,F;if(a&&a.key===e.key&&o){let j=o;return y.a.isCargoPortPortAndTerminalEqual(a,e)||(j=null!=t?t:{key:o,port:null!==(r=null===(n=e.port)||void 0===n?void 0:n.key)&&void 0!==r?r:null,terminal:(null===(l=e.terminal)||void 0===l?void 0:l.key)?e.terminal.key:null}),Object(p.a)(new b.a({cargoPortSequence:e.cargoPortSequence,cargoQuantity:e.cargoQuantity,demurrageRate:e.demurrageRate,despatchRate:e.despatchRate,freightRate:e.freightRate,handlingCostCurrency:null!==(c=null===(i=e.handlingCostCurrency)||void 0===i?void 0:i.key)&&void 0!==c?c:null,handlingCostRate:e.handlingCostRate,hcMeasurement:null!==(d=null===(s=e.hcMeasurement)||void 0===s?void 0:s.key)&&void 0!==d?d:null,indexRate:e.indexRate,isFreeDespatch:e.isFreeDespatch,isHandlingCostLumpsum:e.isHandlingCostLumpsum,isWorking:e.isWorking,key:e.key,laytimeTerms:null===(u=e.laytimeTerms)||void 0===u?void 0:u.key,laytimeTermsMeasurement:null===(m=e.laytimeTermsMeasurement)||void 0===m?void 0:m.key,laytimeTermsValue:e.laytimeTermsValue,laytimeUsed:e.laytimeUsed,port:null!==(v=null===(g=e.port)||void 0===g?void 0:g.key)&&void 0!==v?v:null,portCall:j,reasonForCall:null===(f=e.reasonForCall)||void 0===f?void 0:f.key,tcRateIndex:null!==(h=null===(C=e.tcRateIndex)||void 0===C?void 0:C.key)&&void 0!==h?h:null,terminal:(null===(k=e.terminal)||void 0===k?void 0:k.key)?e.terminal.key:null}),!0)}if(e.key>0)return Object(p.a)(new b.a({key:e.key,cargoPortSequence:e.cargoPortSequence,reasonForCall:null!==(j=e.reasonForCall)&&void 0!==j?j:null}));{const a=null!=t?t:o;return{port:null!==(T=null===(O=e.port)||void 0===O?void 0:O.key)&&void 0!==T?T:null,terminal:null!==(S=null===(P=e.terminal)||void 0===P?void 0:P.key)&&void 0!==S?S:null,reasonForCall:null!==(x=null===(R=e.reasonForCall)||void 0===R?void 0:R.reasonForCall)&&void 0!==x?x:null,cargoPortSequence:e.cargoPortSequence,portCall:a,cargoQuantity:e.cargoQuantity,laytimeTermsValue:e.laytimeTermsValue,laytimeTerms:null===(A=e.laytimeTerms)||void 0===A?void 0:A.key,laytimeTermsMeasurement:null===(w=e.laytimeTermsMeasurement)||void 0===w?void 0:w.key,freightRate:e.freightRate,isHandlingCostLumpsum:e.isHandlingCostLumpsum,handlingCostCurrency:null!==(I=null===(E=e.handlingCostCurrency)||void 0===E?void 0:E.key)&&void 0!==I?I:null,handlingCostRate:e.handlingCostRate,hcMeasurement:null!==(F=null===(M=e.hcMeasurement)||void 0===M?void 0:M.key)&&void 0!==F?F:null}}})}};j=C([Object(l.injectable)(),k(0,Object(l.inject)(m.a.ITSModelActionsAsync)),k(1,Object(l.inject)(s.a.ICargoDrawerControllerVoyage)),k(2,Object(l.inject)(s.a.ICargoDrawerController)),h("design:paramtypes",["function"==typeof(o=void 0!==g.ITSModelActionsAsync&&g.ITSModelActionsAsync)?o:Object,"function"==typeof(n=void 0!==c.ICargoDrawerControllerVoyage&&c.ICargoDrawerControllerVoyage)?n:Object,"function"==typeof(r=void 0!==f.ICargoDrawerController&&f.ICargoDrawerController)?r:Object])],j)},740:function(e,a,t){"use strict";t.d(a,"e",(function(){return l})),t.d(a,"c",(function(){return i})),t.d(a,"d",(function(){return c})),t.d(a,"a",(function(){return d})),t.d(a,"f",(function(){return u})),t.d(a,"b",(function(){return m}));t(268),t(269),t(10),t(11);var o=t(151),n=t(159),r=t(89);function l({commodity:e,subCargoMeasurement:a}){return!!e&&!!a}function i(e){return!l(e)}function c(e){return["actualQuantity","bookedQuantity","freightRate","freightRateMeasurement","grossWeight","grossWeightFixed","isLumpsum","netWeight","subCargoMeasurement"].includes(e)}function s(e){var a,t,o;let r=e;return(null===(a=null==e?void 0:e.cargoType)||void 0===a?void 0:a.cargoTypeCode)===n.a.TRANSFER&&(r=null!==(o=null===(t=null==e?void 0:e.tsOfCargoPort)||void 0===t?void 0:t.cargo)&&void 0!==o?o:e),r}function d(e,a){return a.flatMap(({key:a})=>a!==e?[{key:a}]:[])}function u(e,a){var t,o,n;const l=Object(r.a)(a);return null!==(t=l.dimensionMeasurement)&&void 0!==t||(l.dimensionMeasurement=l.dimensionMeasurement.measurementCode),null!==(o=l.freightRateMeasurement)&&void 0!==o||(l.freightRateMeasurement=l.freightRateMeasurement.measurementCode),null!==(n=l.subCargoMeasurement)&&void 0!==n||(l.subCargoMeasurement=l.subCargoMeasurement.measurementCode),l.isLumpsum=!!l.isLumpsum,{subCargos:[...d(a.key,e),l]}}function m(e){var a,t,n,r;return{cargo:null===(a=s(e))||void 0===a?void 0:a.key,dimensionMeasurement:new o.a(null!==(t=e.dimensionMeasurement)&&void 0!==t?t:{measurementCode:"M"}),freightRateMeasurement:new o.a(null!==(n=e.freightMeasurement)&&void 0!==n?n:{measurementCode:"MT"}),subCargoMeasurement:new o.a(null!==(r=e.cargoMeasurement)&&void 0!==r?r:{measurementCode:"MT"})}}}}]);