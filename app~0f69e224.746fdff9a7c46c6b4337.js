(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1233:function(e,a,t){"use strict";t.d(a,"a",(function(){return y}));t(10),t(11);var o=t(6),n=t(3),r=t(0),l=t.n(r),i=t(534),c=t(456),s=t(225),d=t(44),u=t(331);function y({reactKeyPrefix:e,voyage:a,cargoTemplateToUse:t,showCreateModal:r,showErrorModal:y,showCreateCargoFromCoaModal:g,onCreateCargo:m,onCreateCargoFromCoa:v,onCloseCreateCargoFromCoaModal:b,onCloseErrorModal:f,onCloseCreateCargoModal:p}){const[h]=Object(o.a)([n.a.IInternationalization]),{common:O,voyages:k}=h.getLanguageFile(),{isOpenedFromFas:C}=Object(u.b)();return l.a.createElement(l.a.Fragment,null,r&&l.a.createElement(i.a,{reactKeyPrefix:e+"-create-cargo-modal",showModal:r,onCloseModal:p,voyage:a,callback:m,cargoTemplateToUse:t}),g&&l.a.createElement(c.a,{reactKeyPrefix:e+"-create-cargo-from-template-mmodal",showDialog:g,closeDialog:b,type:s.c.Coa,voyage:a,isOpenedFromFas:C,callback:v,useAllocateModal:!1,shouldOpenDrawer:!1}),y&&l.a.createElement(d.a,{reactKeyPrefix:e+"-error-modal",fullWidth:!0,hideConfirmBtn:!0,cancelBtnName:O.ok,maxWidth:"xs",onCloseModal:f,open:y,title:k.tcVoyageCargoMandatoryPortCallsTitle},k.tcVoyageCargoMandatoryPortCalls))}},1723:function(e,a,t){"use strict";t.d(a,"a",(function(){return k}));t(59),t(10),t(11);var o,n,r,l=t(9),i=t(31),c=t(83),s=t(104),d=t(1),u=t(32),y=t(29),g=t(7),m=t(107),v=t(144),b=t(62),f=function(e,a,t,o){var n,r=arguments.length,l=r<3?a:null===o?o=Object.getOwnPropertyDescriptor(a,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,a,t,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(a,t,l):n(a,t))||l);return r>3&&l&&Object.defineProperty(a,t,l),l},p=function(e,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,a)},h=function(e,a){return function(t,o){a(t,o,e)}},O=function(e,a,t,o){return new(t||(t=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}c((o=o.apply(e,a||[])).next())}))};let k=class{constructor(e,a,t){this.store=e,this.tsModelActions=a,this.objectApi=t}calculate(e,a){return O(this,void 0,void 0,(function*(){if(e.voyageHeader){const{authdata:t}=Object(u.a)(this.store.getState()),{foStocks:o,flStocks:n,doStocks:r,dlStocks:l}=yield this.fetchOpeningBalances(e),i=this.buildBunkerStocks({voyage:e,foStocks:o,flStocks:n,doStocks:r,dlStocks:l,onTheFly:a});return yield this.objectApi.put({authdata:t||"",data:{voyageHeader:{key:e.voyageHeader.key,bunkerStocks:i}},fields:m.t,key:e.key,query:"doNotStore=true",type:d.a.voyage})}return Promise.reject()}))}buildBunkerStocks(e){var a,t;const{voyage:o,foStocks:n,flStocks:r,doStocks:l,dlStocks:i,onTheFly:c}=e,s=null!==(t=null===(a=new b.a(o).voyageHeader)||void 0===a?void 0:a.bunkerStocks)&&void 0!==t?t:[],d=[];for(const e of s)n.some(a=>a.key===e.key)?d.push({key:e.key,quantity:c[v.a.FO]}):r.some(a=>a.key===e.key)?d.push({key:e.key,quantity:c[v.a.FL]}):l.some(a=>a.key===e.key)?d.push({key:e.key,quantity:c[v.a.DO]}):i.some(a=>a.key===e.key)?d.push({key:e.key,quantity:c[v.a.DL]}):d.push({key:e.key});return d}fetchOpeningBalances(e){return O(this,void 0,void 0,(function*(){let a=[],t=[],o=[],n=[];return yield Promise.all([this.fetchOpeningBalance(e,v.a.FO).then(e=>{var t;a=null!==(t=null==e?void 0:e.entities)&&void 0!==t?t:[]}),this.fetchOpeningBalance(e,v.a.FL).then(e=>{var a;t=null!==(a=null==e?void 0:e.entities)&&void 0!==a?a:[]}),this.fetchOpeningBalance(e,v.a.DO).then(e=>{var a;o=null!==(a=null==e?void 0:e.entities)&&void 0!==a?a:[]}),this.fetchOpeningBalance(e,v.a.DL).then(e=>{var a;n=null!==(a=null==e?void 0:e.entities)&&void 0!==a?a:[]})]),{foStocks:a,flStocks:t,doStocks:o,dlStocks:n}}))}fetchOpeningBalance(e,a){return O(this,void 0,void 0,(function*(){if(e.voyageHeader){const t=["filter=voyageHeader.key(EQ)"+e.voyageHeader.key,"filter=description(LKIC)Opening balance","filter=bunkerCategory.bunkerCategoryCode(EQ)"+a].join("&");return yield this.tsModelActions.loadMultipleAction({query:t,fields:{},type:d.a.bunkerstock})}}))}};k=f([Object(l.injectable)(),h(0,Object(l.inject)(g.a.Store)),h(1,Object(l.inject)(g.a.ITSModelActionsAsync)),h(2,Object(l.inject)(c.a.ITSModelApi)),p("design:paramtypes",["function"==typeof(o=void 0!==i.Store&&i.Store)?o:Object,"function"==typeof(n=void 0!==y.ITSModelActionsAsync&&y.ITSModelActionsAsync)?n:Object,"function"==typeof(r=void 0!==s.ITSModelApi&&s.ITSModelApi)?r:Object])],k)},1800:function(e,a,t){"use strict";t.d(a,"a",(function(){return R}));t(10),t(11);var o=t(100),n=t.n(o),r=t(81),l=t(0),i=t.n(l),c=t(97),s=t(15),d=t(5),u=t(67),y=t(6),g=t(64),m=t(1),v=t(58),b=t(50),f=t(27),p=t(3),h=t(487),O=t(303),k=t(2080),C=t(20),j=t(21),S=t(62),x=t(107),E=t(47),T=t(1233);function w(e){const{voyageKey:a,userLocale:t,reactKeyPrefix:o,state:{voyage:m}}=e,j=Object(c.g)(),S=Object(c.h)(),[x,E]=Object(y.a)([p.a.IInternationalization,C.a.IVoyageDrawerController]),{model:w,common:R,cargoes:F}=x.getLanguageFile(),[M,P]=Object(l.useState)(!1),[V,I]=Object(l.useState)(!1),[D,L]=Object(l.useState)(!1),[N,A]=Object(l.useState)(null),[B,W]=Object(l.useState)(void 0),[H,K]=(Object(c.j)(),Object(l.useState)(!1)),z=Object(l.useCallback)(()=>{E.loadCargos(a,()=>K(!0))},[E,a]);Object(l.useEffect)(()=>{z()},[]);const U=Object(l.useCallback)((e,a,o,n)=>e?`${x.formatNumber(e,{locale:t.isoCode,maxDecimals:o,minDecimals:a})} ${null!=n?n:""}`:"",[x,t.isoCode]),q=Object(l.useMemo)(()=>[{content:w.reference,contentType:d.a.TEXT},{content:w.loadPort,contentType:d.a.TEXT},{content:w.dischargePortShortened,contentType:d.a.TEXT},{content:w.charterer,contentType:d.a.TEXT},{content:w.commodity,contentType:d.a.TEXT},{content:w.quantity,contentType:d.a.NUMBER},{content:w.unitOfMeasurement,contentType:d.a.TEXT},{content:w.etaVsLaycan,contentType:d.a.ELEMENT},{content:w.arrivalWindowMissedBy,contentType:d.a.ELEMENT},{content:w.cargoType,contentType:d.a.ELEMENT},{content:w.freightRate,contentType:d.a.TEXT,alignHeaderContent:d.c.RIGHT,hiddenByDefault:!0},{content:w.freight,contentType:d.a.TEXT,alignHeaderContent:d.c.RIGHT,hiddenByDefault:!0}],[w]),X=Object(l.useMemo)(()=>{var e,a,t;const n=[];for(const l of m.cargos){let c=null,s=null;const d=l.cargoReference?l.cargoReference:"",u=v.a.getFirstLoadCargoPort(l.cargoPorts)||new g.a({}),y=Object(r.a)(u,"port.portName",""),f=v.a.getFirstDischargeCargoPort(l.cargoPorts)||new g.a({}),p=Object(r.a)(f,"port.portName",""),k=l.charterer?l.charterer.businessPartnerName:"",C=l.commodity?l.commodity.commodityName:"",j=l.cargoQuantity?l.cargoQuantity:"",S=l.cargoMeasurement?l.cargoMeasurement.measurementCode:"",x=v.a.getPortCallFromCargoPort(m.partOfSchedule,u),E=b.a.getEventLogDateFromPC(x,"ARR"),T=null===(e=l.cargoType)||void 0===e?void 0:e.cargoTypeCode,w=i.a.createElement(h.a,{cargo:l,"data-cell-value":T}),R=null!==(t=null===(a=l.freightCurrency)||void 0===a?void 0:a.currencyCode)&&void 0!==t?t:"",F=l.freightRate?U(l.freightRate,0,4,R&&S?`${R}/${S}`:""):"",M=l.freight?U(l.freight,0,4,R):"";l.laycanFrom&&l.laycanTo&&(c=i.a.createElement(O.a,{eta:E||new Date,laycanFrom:l.laycanFrom,laycanTo:l.laycanTo,laycanMissedBy:l.laycanMissedBy,reactKeyPrefix:o})),l.arrivalWindowFrom&&l.arrivalWindowTo&&(s=i.a.createElement(O.a,{eta:E||new Date,laycanFrom:l.arrivalWindowFrom,laycanTo:l.arrivalWindowTo,laycanMissedBy:l.arrivalWindowMissedBy,reactKeyPrefix:o}));const P={content:[d,y,p,k,C,j,S,c,s,w,F,M],id:l.key};n.push(P)}return n},[U,o,m.cargos,m.partOfSchedule]),$=Object(l.useCallback)(e=>{f.a.openDrawer(e,s.a.cargoDrawer,S,j),W("string"==typeof e?Number.parseInt(e):e)},[j,S]),_=Object(l.useCallback)(()=>{P(!M)},[M]),Q=Object(l.useCallback)(()=>{L(!D)},[D]),Y=Object(l.useCallback)(()=>{I(!V)},[V]),J=Object(l.useMemo)(()=>{const{partOfSchedule:e}=m;let a=!1,t=!1;return e&&e.forEach(e=>{const o=Object(r.a)(e,"reasonForCall.reasonForCall",null);o&&"L"===o?a=!0:o&&"D"===o&&(t=!0)}),a&&t},[m]),G=Object(l.useMemo)(()=>[{onClick:m.isTc&&!J?Q:_,text:F.createCargo},{onClick:Y,text:F.createCargoFromCoaTemplate,disabled:m.isTc}],[F.createCargo,F.createCargoFromCoaTemplate,J,Y,_,Q,m.isTc]),Z=Object(l.useMemo)(()=>[{disabled:!1,onClick:_,icon:n.a,iconButtonProps:{color:"primary","aria-label":`${R.create} ${w.cargo}`},label:`${R.create} ${w.cargo}`,reactKeyPrefix:o+"create-cargo",secondaryActions:G}],[R.create,G,w.cargo,o,_]),ee={responsive:Object(k.a)(e=>e.breakpoints.down("sm"))},ae=Object(l.useCallback)(()=>{A(null),_()},[_]),te=Object(l.useCallback)(()=>{Q()},[Q]),oe=Object(l.useCallback)(e=>{const a=f.a.getCurrentlyOpenedDrawers();(null==e?void 0:e.voyage)&&a.some(e=>e.hash===s.a.voyageDrawer)&&E.refreshVoyage(e.voyage)},[E]),ne=Object(l.useCallback)(e=>{oe(e),A(e),Y(),_(),W(e.key)},[oe,Y,_]),re=Object(l.useCallback)(e=>f.a.openDrawer(e,s.a.cargoDrawer,S,j),[j,S]),le=Object(l.useCallback)(e=>{oe(e),re(e.key),setTimeout(z,500),W(e.key)},[z,re,oe]);return H?i.a.createElement(l.Fragment,null,i.a.createElement(u.a,{headers:q,data:X,reactKeyPrefix:o,userLocale:t,onRowClick:$,title:w.cargo,primaryActions:Z,customisation:ee,preSelectedRow:B}),i.a.createElement(T.a,{reactKeyPrefix:o+"-create-cargo",cargoTemplateToUse:N,voyage:m,onCreateCargo:le,onCreateCargoFromCoa:ne,onCloseCreateCargoFromCoaModal:Y,onCloseCreateCargoModal:ae,onCloseErrorModal:te,showCreateModal:M,showCreateCargoFromCoaModal:V,showErrorModal:D})):null}const R=Object(E.a)((e,{voyageKey:a})=>{var t;return{voyage:null!==(t=j.a.getTSModelBuilt(e,m.a.voyage,a,x.o))&&void 0!==t?t:new S.a({})}},Object(l.memo)(w))},1951:function(e,a,t){"use strict";t.d(a,"a",(function(){return Q}));t(59),t(10),t(11);var o=t(0),n=t.n(o),r=t(3),l=t(28),i=t(1),c=t(37),s=t(19),d=t(108),u=t(6),y=t(12),g=t(63),m=t(144);function v({voyage:e,userLocale:a,reactKeyPrefix:t,calculate:v}){var b,f,p,h,O,k,C;const[j]=Object(u.a)([r.a.IInternationalization]),S=j.getLanguageFile(),x="EST"===(null===(f=null===(b=e.voyageHeader)||void 0===b?void 0:b.voyageStatus)||void 0===f?void 0:f.statusTypeCode),E=null===(p=e.voyageHeader)||void 0===p?void 0:p.key,T=Object(o.useMemo)(()=>({numberInputProps:{maskSettings:l.a.mask4}}),[]),w=Object(o.useMemo)(()=>{var a,t,o,n,r,l,c,s,u,y,b,f;const p={[m.a.FO]:null!==(t=null===(a=null==e?void 0:e.voyageHeader)||void 0===a?void 0:a.foRobVoyageStart)&&void 0!==t?t:0,[m.a.FL]:null!==(n=null===(o=null==e?void 0:e.voyageHeader)||void 0===o?void 0:o.flRobVoyageStart)&&void 0!==n?n:0,[m.a.DO]:null!==(l=null===(r=null==e?void 0:e.voyageHeader)||void 0===r?void 0:r.doRobVoyageStart)&&void 0!==l?l:0,[m.a.DL]:null!==(s=null===(c=null==e?void 0:e.voyageHeader)||void 0===c?void 0:c.dlRobVoyageStart)&&void 0!==s?s:0};return[Object.assign(Object.assign({disabled:!x,fieldName:"foRobVoyageStart",label:S.model.foRobVoyageStart},T),{overrideObject:new d.a({key:E,foRobVoyageStart:null===(u=null==e?void 0:e.voyageHeader)||void 0===u?void 0:u.foRobVoyageStart}),overrideType:i.a.voyageheader,InputProps:{endAdornment:g.a.Weight},onUpdateOverride:e=>v(Object.assign(Object.assign({},p),{[m.a.FO]:e}))}),Object.assign(Object.assign({disabled:!x,fieldName:"dlRobVoyageStart",label:S.model.lsmgoRobVoyageStart},T),{overrideObject:new d.a({key:E,dlRobVoyageStart:null===(y=null==e?void 0:e.voyageHeader)||void 0===y?void 0:y.dlRobVoyageStart}),overrideType:i.a.voyageheader,InputProps:{endAdornment:g.a.Weight},onUpdateOverride:e=>v(Object.assign(Object.assign({},p),{[m.a.DL]:e}))}),Object.assign(Object.assign({disabled:!x,fieldName:"doRobVoyageStart",label:S.model.mgoRobVoyageStart},T),{overrideObject:new d.a({key:E,doRobVoyageStart:null===(b=null==e?void 0:e.voyageHeader)||void 0===b?void 0:b.doRobVoyageStart}),overrideType:i.a.voyageheader,InputProps:{endAdornment:g.a.Weight},onUpdateOverride:e=>v(Object.assign(Object.assign({},p),{[m.a.DO]:e}))}),Object.assign(Object.assign({disabled:!x,fieldName:"flRobVoyageStart",label:S.model.lsfoRobVoyageStart},T),{overrideObject:new d.a({key:E,flRobVoyageStart:null===(f=null==e?void 0:e.voyageHeader)||void 0===f?void 0:f.flRobVoyageStart}),overrideType:i.a.voyageheader,InputProps:{endAdornment:g.a.Weight},onUpdateOverride:e=>v(Object.assign(Object.assign({},p),{[m.a.FL]:e}))})]},[v,x,S.model.foRobVoyageStart,S.model.lsfoRobVoyageStart,S.model.lsmgoRobVoyageStart,S.model.mgoRobVoyageStart,T,null===(h=null==e?void 0:e.voyageHeader)||void 0===h?void 0:h.dlRobVoyageStart,null===(O=null==e?void 0:e.voyageHeader)||void 0===O?void 0:O.doRobVoyageStart,null===(k=null==e?void 0:e.voyageHeader)||void 0===k?void 0:k.flRobVoyageStart,null===(C=null==e?void 0:e.voyageHeader)||void 0===C?void 0:C.foRobVoyageStart,E]),R=Object(o.useMemo)(()=>Object(s.a)({fieldOptions:w,object:e,type:i.a.voyage,userLocale:a,reactKeyPrefix:t,smartResponse:!0}),[w,e,a,t]);return n.a.createElement(c.a,{reactKeyPrefix:t+"_horizontal_list",key:t+"_horizontal_list",items:R,breakpoints:y.f})}t(118),t(268),t(269);var b=t(414),f=t(60),p=t(50),h=t(181),O=t(38);function k(e){const{voyage:a,userLocale:t}=e,[l]=Object(u.a)([r.a.IInternationalization]),i=null==a?void 0:a.portCallsFromVoyage.sort(p.a.sortByPortCallSequence),c=Object(o.useMemo)(()=>f.a.getQobMap(a),[a]),s=Object(o.useCallback)(e=>f.a.getQobArrival(a,e,c),[a,c]),d=Object(o.useCallback)(e=>f.a.getQobDeparture(a,e,c),[a,c]),y=Object(o.useMemo)(()=>{const e=function(e,a){return{chart:{height:400,type:"bar",stacked:!0},stroke:{width:1,colors:[O.b.bergenRain.secondary[1]]},plotOptions:{bar:{horizontal:!0,dataLabels:{hideOverflowingLabels:!0}}},tooltip:{x:{show:!1},y:{formatter:function(a){return a+" "+e.lang().common.mt}}},legend:{position:"top",horizontalAlign:"center",offsetY:-10},yaxis:{labels:{maxWidth:180}},xaxis:{title:{text:"#",style:{color:O.b.bergenRain.secondary[1]}}},title:{text:e.lang().vessel.cargoCapacity+" ("+e.lang().common.mt+")",align:"right",offsetY:380,style:{fontSize:"12px"}}}}(l),a=i.flatMap(e=>{var a,t,o,n,r,i;return[[null!==(t=null===(a=e.port)||void 0===a?void 0:a.portName)&&void 0!==t?t:"",l.lang().model.arrival],[null!==(n=null===(o=e.port)||void 0===o?void 0:o.portName)&&void 0!==n?n:"",(null!==(i=(null===(r=e.reasonForCall)||void 0===r?void 0:r.reasonForCallDesc)+" | ")&&void 0!==i?i:"")+l.lang().model.departure]]});return e.xaxis.categories=a,e},[l,i,t]),g=Object(o.useMemo)(()=>{const e=i.flatMap(e=>[e,e]),t=[];t.push({name:l.lang().model.constantReduction,type:"bar",color:O.b.sunriseYellow.secondary[2],data:[]}),t.push({name:l.lang().model.draftReduction,type:"bar",color:O.b.orangeSky.secondary[2],data:[]}),t.push({name:l.lang().model.freshWaterReduction,type:"bar",color:O.b.sunriseYellow.secondary[3],data:[]}),t.push({name:l.lang().model.bunkerReduction,type:"bar",color:O.b.sunsetRed.secondary[2],data:[]}),t.push({name:l.lang().model.quantity,type:"bar",color:O.b.navigator.secondary[4],data:[]}),t.push({name:l.lang().model.availableForCargo,type:"bar",color:O.b.navigator.secondary[2],data:[]});for(let o=0;o<e.length;o++){const{constantReduction:n,draftReduction:r,freshWaterReduction:l,zone:i}=e[o];let c=p.a.getBunkerReductionArrival(e[o]),u=p.a.getBunkerReductionDeparture(e[o]);c<0&&(c=0),u<0&&(u=0);const y=s(e[o]),g=d(e[o]);let m=0;a.vessel&&i&&(m=h.a.getDwt(a.vessel,i));const v=m-n-r-l-c-y,b=m-n-r-l-u-g;t[0].data.push(n.toFixed(0)),t[1].data.push(r.toFixed(0)),t[2].data.push(l.toFixed(0)),o%2==0?(t[3].data.push(c.toFixed(0)),t[4].data.push(y.toFixed(0)),t[5].data.push(v.toFixed(0))):(t[3].data.push(u.toFixed(0)),t[4].data.push(g.toFixed(0)),t[5].data.push(b.toFixed(0)))}return t},[i,l,s,d,a.vessel]);return n.a.createElement(b.a,{elevation:2,reactKeyPrefix:"doc-voyage-voyage-intake-chart",type:"bar",height:400,options:y,series:g})}var C=t(68),j=t(44),S=t(1813),x=t(1284),E=t(213),T=t(187),w=t(245),R=t(214),F=t(130),M=t(2383),P=t(107),V=t(7),I=t(62),D=t(40),L=t(20),N=t(261);const A=[{label:"Summer",value:"S"},{label:"Winter",value:"W"},{label:"Tropical",value:"T"}],B={SW:{label:"Saltwater",value:"SW"},BW:{label:"Brackish Water",value:"BW"},FT:{label:"Fresh Water",value:"FT"}},W={numberInputProps:{maskSettings:l.a.mask7}},H={numberInputProps:{maskSettings:l.a.mask5}};var K=t(131),z=function(e,a,t,o){return new(t||(t=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}c((o=o.apply(e,a||[])).next())}))};function U({portCall:e,userLocale:a,reactKeyPrefix:t,updatePortCallOnVoyage:l}){const[d,g]=Object(u.a)([V.a.ITSModelActionsAsync,r.a.IInternationalization]),m=Object(o.useCallback)(a=>z(this,void 0,void 0,(function*(){d.updateSingleAction({data:a,key:e.key,type:i.a.portcall,headers:Object.assign({},K.a.smartJson),callback:(e,a)=>{a&&l(a)}})})),[e.key,d,l]),v=Object(o.useMemo)(()=>function(e,a,t,o,r){const l=o.getLanguageFile(),c=[{fieldName:"zone",formControlProps:{required:!0},overrideComponent:n.a.createElement(N.a,{reactKeyPrefix:e+"zone",options:A,label:l.model.zone,value:a.zone,variant:"standard",onInputChange:e=>r({zone:e})})},{fieldName:"waterSalinity",overrideComponent:n.a.createElement(N.a,{reactKeyPrefix:e+"waterSalinity",options:Object.values(B),label:l.model.waterSalinity,value:a.waterSalinity,variant:"standard",onInputChange:e=>r({waterSalinity:B[String(e)].value})})},Object.assign(Object.assign({fieldName:"waterDensity",label:l.model.waterDensity},H),{onUpdateOverride:e=>r({waterDensity:e})}),Object.assign(Object.assign({fieldName:"draft",label:l.model.draft},W),{InputProps:{endAdornment:a.draftMeasurement},onUpdateOverride:e=>r({draft:e})}),Object.assign(Object.assign({fieldName:"safetyMargin",label:l.model.safetyMargin},W),{onUpdateOverride:e=>r({safetyMargin:e})}),Object.assign(Object.assign({fieldName:"constantReduction",label:l.model.constantReduction},W),{onUpdateOverride:e=>r({constantReduction:e})}),Object.assign(Object.assign({fieldName:"freshWaterReduction",label:l.model.freshWaterReduction},W),{onUpdateOverride:e=>r({freshWaterReduction:e})})];return Object(s.a)({fieldOptions:c,object:a,type:i.a.portcall,userLocale:t,reactKeyPrefix:e,smartResponse:!0})}(t,e,a,g,m),[g,m,e,t,a]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(c.a,{reactKeyPrefix:t+"_horizontal_list",key:t+"_horizontal_list",items:v,breakpoints:y.d}))}var q=function(e,a,t,o){return new(t||(t=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}c((o=o.apply(e,a||[])).next())}))};const X=Object(E.a)(e=>Object(T.a)({noShrink:{flexShrink:0}})),$={skeleton:{transform:"none"},header:{fontsize:"1rem",fontWeight:"500",color:e=>Object(w.a)(e.palette.common.black,.54)}},_=new C.a({});function Q({storeVoyage:e,userLocale:a,reactKeyPrefix:t,open:l,onCloseModal:c}){var s,d,y,g;const[m,b,f]=Object(u.a)([r.a.IInternationalization,V.a.ITSModelActionsAsync,L.a.IVoyageIntakeController]),[p,h]=Object(o.useState)(new I.a({vessel:null==e?void 0:e.vessel,voyageHeader:null==e?void 0:e.voyageHeader})),[O,C]=Object(o.useState)(!1),[E,T]=Object(o.useState)(!1),[w,N]=Object(o.useState)(_),A=m.getLanguageFile(),B=X({});Object(o.useEffect)(()=>{b.loadSingleAction({fields:P.t,key:e.key,type:i.a.voyage,callback:(e,a)=>{a&&(h(a),C(!0))}})},[]);const W=Object(o.useCallback)(e=>q(this,void 0,void 0,(function*(){const a=p.portCallsFromVoyage.map(a=>a.key===e.key?Object.assign(Object.assign({},a),e):a);h(new I.a(Object.assign(Object.assign(Object.assign({},p),null==e?void 0:e.voyage),{portCallsFromVoyage:a})))})),[p]),H=Object(o.useCallback)(e=>{var a;const t=null!==(a=null==p?void 0:p.portCallsFromVoyage.find(a=>a.key===e))&&void 0!==a?a:_;N(t),T(!0)},[null==p?void 0:p.portCallsFromVoyage]);Object(o.useEffect)(()=>{if(null==w?void 0:w.key){const e=null==p?void 0:p.portCallsFromVoyage.find(e=>e.key===w.key);e&&N(e)}},[w.key,null==p?void 0:p.portCallsFromVoyage]);const K=(null===(s=w.port)||void 0===s?void 0:s.portName)+" - "+(null===(d=w.reasonForCall)||void 0===d?void 0:d.reasonForCallDesc),z=Object(o.useMemo)(()=>{var e,a;return n.a.createElement(R.a,{container:!0,spacing:2,sx:{pt:.5}},n.a.createElement(R.a,{item:!0,container:!0,direction:"row"},n.a.createElement(D.a,{id:t+"-vessel-name-chip",label:null===(e=p.vessel)||void 0===e?void 0:e.vesselName,rounded:!0}),n.a.createElement(F.a,{sx:$.header},"| ",null===(a=p.voyageHeader)||void 0===a?void 0:a.referenceNo)))},[t,null===(y=p.vessel)||void 0===y?void 0:y.vesselName,null===(g=p.voyageHeader)||void 0===g?void 0:g.referenceNo]),Q=Object(o.useCallback)(e=>q(this,void 0,void 0,(function*(){C(!1);const a=yield f.calculate(p,e);h(a),C(!0)})),[f,p]);return n.a.createElement(j.a,{reactKeyPrefix:t+"-modal",open:l,onCloseModal:c,title:A.voyages.voyageIntakeCalculation,maxWidth:"lg",fullWidth:!0,hideConfirmBtn:!0,cancelBtnName:A.common.close,titleContent:z},O?n.a.createElement(n.a.Fragment,null,n.a.createElement(R.a,{container:!0,spacing:2},n.a.createElement(R.a,{item:!0,container:!0},n.a.createElement(v,{reactKeyPrefix:t+"-header-details",voyage:p,userLocale:a,calculate:Q})),n.a.createElement(R.a,{item:!0,container:!0},n.a.createElement(S.a,{reactKeyPrefix:t+"-schedule-table",className:B.noShrink,voyage:p,userLocale:a,onRowClick:H})),n.a.createElement(R.a,{item:!0,container:!0},n.a.createElement(k,{voyage:p,userLocale:a})),n.a.createElement(R.a,{item:!0,container:!0},n.a.createElement(x.a,{reactKeyPrefix:t+"-load-line-table",className:B.noShrink,userLocale:a,vessel:p.vessel,disableRowClick:!0}))),E&&n.a.createElement(j.a,{reactKeyPrefix:t+"-port-call-modal",open:E,onCloseModal:()=>T(!1),title:A.model.portCall,maxWidth:"md",fullWidth:!0,hideConfirmBtn:!0,cancelBtnName:A.common.close},n.a.createElement(F.a,{variant:"h6"},K),n.a.createElement(U,{reactKeyPrefix:t+"-port-call-details",portCall:w,userLocale:a,updatePortCallOnVoyage:W}))):n.a.createElement(R.a,{container:!0,spacing:2},n.a.createElement(R.a,{item:!0,xs:3},n.a.createElement(M.a,{variant:"text",height:50,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:3},n.a.createElement(M.a,{variant:"text",height:50,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:3},n.a.createElement(M.a,{variant:"text",height:50,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:3},n.a.createElement(M.a,{variant:"text",height:50,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:12},n.a.createElement(M.a,{height:400,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:12},n.a.createElement(M.a,{height:400,sx:$.skeleton})),n.a.createElement(R.a,{item:!0,xs:12},n.a.createElement(M.a,{height:150,sx:$.skeleton}))))}}}]);