(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{1229:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));a(10),a(11);var o=a(0),r=a.n(o),n=a(44),l=a(130),s=a(213),i=a(187),c=a(6),d=a(3),u=a(169),y=a(660),p=a(81),m=a(58),v=a(159),f=a(26);const b=Object(s.a)(e=>Object(i.a)({confirmText:{marginBottom:e.spacing(2)},top:{lineHeight:.8},bottom:{marginBottom:e.spacing(2)},redFont:{color:e.palette.warning.main}}));function g(e){const t=b({}),[a]=Object(c.a)([d.a.IInternationalization]),{common:s}=a.getLanguageFile(),{showModal:i,checkboxLabel:g,cargo:h,title:C,lastLinkedPCs:O,selectedCargoPort:P,onClose:j,onDelete:T,onCheckboxInputChange:k,reactKeyPrefix:S}=e,[I,E]=Object(o.useState)(!1),A=O.length>0,M=Object(o.useCallback)(()=>{E(!1),j()},[j]),w=Object(o.useCallback)(()=>{E(!I),k(!I)},[I,k]),x=r.a.memo((function(e){var a,o;const{obj:n}=e;if(n&&A){const e=h.cargoPorts.find(e=>e.key===n.key),s=P?n.key===P.key:e;return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{className:t.top,color:s?"error":void 0,noWrap:!0},s?"-":""," ",null===(a=n.port)||void 0===a?void 0:a.portName),r.a.createElement(l.a,{className:t.bottom,color:"textSecondary"},null===(o=n.reasonForCall)||void 0===o?void 0:o.reasonForCallDesc))}return null})),F=r.a.memo((function(e){var a,o;const{obj:n}=e;if(n&&A){const e=!!O.find(e=>e.key===n.key);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,{className:t.top,color:I&&e?"error":void 0,noWrap:!0},I&&e?"- ":"",null===(a=n.port)||void 0===a?void 0:a.portName,e?"*":""),r.a.createElement(l.a,{className:t.bottom,color:"textSecondary"},null===(o=n.reasonForCall)||void 0===o?void 0:o.reasonForCallDesc))}return null})),D=Object(o.useMemo)(()=>{if(A&&h){const e=Object(p.a)(h,"voyage");if(e)return r.a.createElement(y.a,{reactKeyPrefix:S+"cargo-port-port-call-timeline",selectedCargo:h,voyage:e,displayMatches:!1,LeftContainerLayout:x,RightContainerLayout:F})}return null},[A,h,S,x,F]),N=Object(o.useMemo)(()=>{if(A)return r.a.createElement(u.a,{reactKeyPrefix:S+"has-deletable-port-calls",checked:I,onInputChange:()=>w(),label:g||"",color:"primary"})},[A,S,I,g,w]),R=Object(o.useMemo)(()=>s.deleteItemConfirmation+(A?" "+s.reviewTimeline:""),[s.deleteItemConfirmation,s.reviewTimeline,A]),V=Object(o.useMemo)(()=>{var e;const t=null===(e=h.cargoType)||void 0===e?void 0:e.cargoTypeCode;return m.a.hasRelet(h)||t===v.a.HAS_TRANSFER||m.a.hasPreshipment(h)||m.a.hasTransshipment(h)?" "+s.deleteConnectedCargoConfirmation:""},[h,s.deleteConnectedCargoConfirmation]);return r.a.createElement(n.a,{reactKeyPrefix:S,open:i,title:C,onCloseModal:M,onConfirm:T,confirmBtnName:s.delete,maxWidth:"md",disableDraggable:!0},r.a.createElement(l.a,{className:t.confirmText},R),r.a.createElement(l.a,{className:Object(f.default)(t.confirmText,t.redFont)},V),D,N)}},1238:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var o=a(0),r=a.n(o),n=a(719),l=a(57),s=a(19),i=a(288),c=a(1);function d(e,t,a,o,d,u){var y,p;const{model:m}=d.getLanguageFile(),{showPassword:v,setShowPassword:f,setUsername:b}=u,g=r.a.createElement(l.b,{reactKeyPrefix:e+"channel-info-password-input",type:v?void 0:"password",onInputBlur:e=>a("channelInfo.password",e),InputProps:{endAdornment:r.a.createElement(n.a,{reactKeyPrefix:e+"pw-confirm-adornment",allowTogglePasswordVisibility:!0,showPassword:v,togglePasswordVisibility:()=>{f(!v)},key:"password_confirm__end_adornment"})}}),h={reactKeyPrefix:e,fieldOptions:[{fieldName:"userName",label:m.userName,overrideObject:new i.a(null!==(y=t.channelInfo)&&void 0!==y?y:{}),overrideType:c.a.channelinfo,onUpdateOverride:e=>{b(e),a.bind(null,"channelInfo.userName")}},{label:m.password,overrideObject:new i.a(null!==(p=t.channelInfo)&&void 0!==p?p:{}),overrideType:c.a.channelinfo,overrideComponent:g}],userLocale:o,object:t,type:c.a.webhooksubscription};return Object(s.a)(h)}},1239:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var o=a(1),r=a(19),n=a(0),l=a.n(n),s=a(500);function i(e,t,a,n,i,c){var d;const{model:u}=i.getLanguageFile(),y=l.a.createElement(s.a,{reactKeyPrefix:e+"-access-token",value:null!==(d=t.accessToken)&&void 0!==d?d:"",label:"",multiline:!0,disabled:!1,onChange:e=>{a.bind(null,"accessToken")}}),p={reactKeyPrefix:e,fieldOptions:[{fieldName:"accessToken",label:u.accessToken,overrideComponent:null!==t.accessToken&&""!==t.accessToken?y:void 0,onUpdateOverride:e=>{a.bind(null,"accessToken"),c.onChangeAccessToken(e)},overrideObject:t,overrideType:o.a.webhooksubscription}],userLocale:n,object:t,type:o.a.webhooksubscription};return Object(r.a)(p)}},1240:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var o=a(1),r=a(19),n=a(0),l=a.n(n),s=a(500);function i(e,t,a,n,i,c){var d,u;const{model:y}=i.getLanguageFile(),p=l.a.createElement(s.a,{reactKeyPrefix:e+"-request-url",value:null!==(d=t.accessTokenRequestUrl)&&void 0!==d?d:"",label:"",multiline:!0,disabled:!1,onChange:a.bind(null,"accessTokenRequestUrl")}),m=l.a.createElement(s.a,{reactKeyPrefix:e+"-request-body",value:null!==(u=t.accessTokenRequestBody)&&void 0!==u?u:"",label:"",multiline:!0,disabled:!1,onChange:a.bind(null,"accessTokenRequestBody")}),v={reactKeyPrefix:e,fieldOptions:[{fieldName:"accessTokenRequestUrl",label:y.accessTokenRequestUrl,onUpdateOverride:a.bind(null,"accessTokenRequestUrl"),overrideComponent:null!==t.accessTokenRequestUrl&&""!==t.accessTokenRequestUrl?p:void 0},{fieldName:"accessTokenRequestBody",label:y.accessTokenRequestBody,textInputProps:{multiline:!0,maxRows:4},onUpdateOverride:a.bind(null,"accessTokenRequestBody"),overrideComponent:null!==t.accessTokenRequestBody&&""!==t.accessTokenRequestBody?m:void 0}],userLocale:n,object:t,type:o.a.webhooksubscription};return Object(r.a)(v)}},1251:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return y}));var o=a(83),r=a(7),n=a(14),l=a(32),s=a(1),i=a(78),c=a(960),d=a(168);function u(){const e=n.a.get(o.a.ITSModelApi),t=n.a.get(r.a.Store),{authdata:a=""}=Object(l.a)(t.getState()),d=["filter=releaseDate(GT)"+i.a.getDateStringWithoutUTC(new Date),"filter=isObjectActive(IN)(true,false)","filter=releaseDate(NOTNULL)&sort=releaseDate(ASI)"].join("&");return e.getMultiple({authdata:a,type:s.a.entityrelease,fields:c.a,query:d}).then(e=>e).catch(()=>[])}function y(e){let t=[];return e&&e.length>0&&(t=Object(d.c)(e,"releaseNumber")),t}},1262:function(e,t,a){"use strict";a.d(t,"a",(function(){return se}));a(59),a(10),a(11);var o=a(0),r=a.n(o),n=a(97),l=a(6),s=a(47),i=a(7),c=a(3),d=a(44),u=a(42),y=a(1),p=a(21),m=a(87),v=a(5),f=a(2517),b=a(130),g=a(323),h=a(214),C=a(473),O=a(67),P=a(58),j=a(35),T=a(60),k=a(64);const[S]=Object(l.a)([c.a.IInternationalization]),{model:I,coa:E}=S.getLanguageFile(),A=[{content:I.charterer,contentType:v.a.TEXT},{content:I.vessel,contentType:v.a.TEXT},{content:E.coaDate,contentType:v.a.DATE,dateTimeFormatOptions:j.a.shortLocalizedDate},{content:E.coaNumber,contentType:v.a.TEXT},{content:I.loadPort,contentType:v.a.TEXT},{content:I.dischargePort,contentType:v.a.TEXT},{content:I.commodity,contentType:v.a.TEXT},{content:I.cargoQuantity,contentType:v.a.NUMBER,numberFormatOptions:{minDecimals:3,maxDecimals:3}}];function M(e){var t,a,o,r,n,l,s,i,c,d,u,y,p,m,v;const f=T.a.getPerformanceCargo(null==e?void 0:e.cargos),b=null!==(a=null===(t=f.charterer)||void 0===t?void 0:t.businessPartnerName)&&void 0!==a?a:"",g=null!==(n=null===(r=null===(o=f.coaLine)||void 0===o?void 0:o.coa)||void 0===r?void 0:r.contractNo)&&void 0!==n?n:"",h=P.a.getFirstLoadCargoPort(f.cargoPorts||new k.a({})),C=null!==(s=null===(l=null==h?void 0:h.port)||void 0===l?void 0:l.portName)&&void 0!==s?s:"",O=P.a.getLastDischargeCargoPort(f.cargoPorts||new k.a({})),j=null!==(c=null===(i=null==O?void 0:O.port)||void 0===i?void 0:i.portName)&&void 0!==c?c:"",S=null!==(u=null===(d=f.commodity)||void 0===d?void 0:d.commodityName)&&void 0!==u?u:"",{cargoQuantity:I}=f,{vessel:E}=e;return{content:[b,null!==(y=null==E?void 0:E.vesselName)&&void 0!==y?y:"",null!==(v=null===(m=null===(p=f.coaLine)||void 0===p?void 0:p.coa)||void 0===m?void 0:m.coaDate)&&void 0!==v?v:null,g,C,j,S,I],id:e.key}}var w=a(24),x=a(4);const F=e=>{const t={field:"voyageHeader.businessUnit.key",filterGroupCode:e,operator:x.c.IN,type:x.d.STRING};return[{filterObjectValuePath:"key",typeaheadProps:{type:y.a.businessunit,objectPaths:["businessUnitName"],includeDisabledQuery:!0},filters:[t]}]};var D=a(96);const N=e=>{const t={field:"cargos.charterer.key",filterGroupCode:e,operator:x.c.IN,type:x.d.STRING};return[{filterObjectValuePath:"key",typeaheadProps:{type:y.a.businesspartner,objectPaths:["businessPartnerName"],includeDisabledQuery:!0,query:D.b},filters:[t]}]},R=e=>{const t={field:"cargos.commodity.key",filterGroupCode:e,operator:x.c.IN,type:x.d.STRING};return[{filterObjectValuePath:"key",typeaheadProps:{type:y.a.commodity,objectPaths:["commodityName"],includeDisabledQuery:!0},filters:[t]}]},V=e=>{const t={field:"cargos.cargoPorts.port.key",filterGroupCode:e,operator:x.c.IN,type:x.d.STRING};return[{filterObjectValuePath:"key",typeaheadProps:{type:y.a.port,objectPaths:["portName"],includeDisabledQuery:!0,query:D.d},filters:[t]}]},L=e=>{const t={field:"vessel.key",filterGroupCode:e,operator:x.c.IN,type:x.d.STRING};return[{filterObjectValuePath:"key",typeaheadProps:{type:y.a.vessel,objectPaths:["vesselName"]},filters:[t]}]},U=({reactKeyPrefix:e,FILTERS_GROUP_CODE:t})=>{const[a]=Object(l.a)([c.a.IInternationalization]),{model:o}=a.getLanguageFile();return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{reactKeyPrefix:e+"-vessel",configs:L(t),type:x.b.TYPEAHEAD,label:o.vessel,filterCode:t+"_VESSEL",clearOnMount:!0}),r.a.createElement(w.a,{reactKeyPrefix:e+"-business-unit",configs:F(t),type:x.b.TYPEAHEAD,label:o.businessUnit,filterCode:t+"_BUSINESS_UNIT",clearOnMount:!0}),r.a.createElement(w.a,{reactKeyPrefix:e+"-charterer",configs:N(t),type:x.b.TYPEAHEAD,label:o.charterer,filterCode:t+"_CHARTERER",clearOnMount:!0}),r.a.createElement(w.a,{reactKeyPrefix:e+"-port",configs:V(t),type:x.b.TYPEAHEAD,label:o.port,filterCode:t+"_PORT",clearOnMount:!0}),r.a.createElement(w.a,{reactKeyPrefix:e+"-commodity",configs:R(t),type:x.b.TYPEAHEAD,label:o.commodity,filterCode:t+"_COMMODITY",clearOnMount:!0}))},B=r.a.memo(U);var K=a(94),q=a(422),H=a(262),_=a(16);const W=[{field:"cargos.charterer.businessPartnerName",groupCode:"VOYAGE_FROM_TEMPLATE_LIST_SORT_GROUP_CODE",operator:_.b.ASC,queryParamName:"cargos.charterer%2B.businessPartnerName"},{field:"cargos.coaLine.coa.coaDate",groupCode:"VOYAGE_FROM_TEMPLATE_LIST_SORT_GROUP_CODE",operator:_.b.DESC,queryParamName:"cargos.coaLine%2B.coa%2B.coaDate"}];var G=a(27),Q=a(15),$=a(142),z=a(129),Y=a(443),X=a(20),J=a(46),Z=a(330),ee=a(107),te=a(240),ae=a(331),oe=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};const re=Object(m.a)(["cargos.charterer.businessPartnerName","cargos.coaLine.coa.coaDate","cargos.coaLine.coa.contractNo","cargos.cargoPorts.reasonForCall.reasonForCall","cargos.cargoPorts.port.portName","cargos.cargoPorts.cargoPortSequence","cargos.commodity.commodityName","cargos.cargoQuantity","voyageHeader","vessel.vesselName"]),ne={container:{display:"flex",flexDirection:"column",height:"100%"},helperText:{fontStyle:"italic"},footer:{height:"50px",marginTop:1}};function le(e){const{showDialog:t,closeDialog:a,reactKeyPrefix:l,selectedVessel:s,deps:[i,c,u,m,P,j,T],state:{userLocale:k,templateVoyages:S,storedFilters:I}}=e,E=i.getLanguageFile(),w=Object(n.g)(),x=Object(n.h)(),{isOpenedFromFas:F}=Object(ae.b)(),[D,N]=Object(o.useState)(1),[R,V]=Object(o.useState)(!1),[L,U]=Object(o.useState)(I),[K,_]=Object(o.useState)(Object(q.a)(L,I)),[X,le]=Object(o.useState)(null),[se,ie]=Object(o.useState)(!1);Object(q.a)(L,I)&&(N(1),_(!0),U(I));Object(o.useEffect)(()=>{R||(K&&Object(H.a)("CREATE_VOYAGE_FROM_TEMPLATE_LIST"),V(!0),u.loadMultipleAction({fields:re,query:"filter=voyageHeader.isTemplate(EQ)true",type:y.a.voyage,identifier:"CREATE_VOYAGE_FROM_TEMPLATE_LIST",sorts:W,filters:L,pageItemLimit:15,pageNumber:D}).then(()=>{V(!1),_(!1)}))},[L,D]);const ce=Object(o.useCallback)(e=>{T.setAction(te.a,e.key),a(),G.a.openDrawer(e.key,Q.a.voyageDrawer,x,w),J.a.next()},[a,w,x,T]),de=Object(o.useCallback)(()=>{var e;if(X){ie(!0);const t=$.a.get(c.getState(),y.a.scenario),a=p.a.getTSModelBuilt(c.getState(),y.a.scenario,t||0,{fleetPlan:{key:"*"}}),o=S.find(e=>e.key===X);u.copySingleAction({key:X,type:y.a.voyage,fields:ee.n,data:{voyageHeader:{isTemplate:!1,isBudget:!1,templateVoyageHeader:null===(e=null==o?void 0:o.voyageHeader)||void 0===e?void 0:e.key},vessel:s||void 0},callback:(e,o)=>oe(this,void 0,void 0,(function*(){o&&(yield P.allocateToScenario(o,t,F),s&&t&&F?(yield P.createAndAllocateFpv(o,a),j.reloadColumnData(z.a.NONE,new Y.a({voyage:o,vessel:o.vessel}),null)):F&&t&&m.loadVoyages(t),ce(o))}))})}},[X,c,S,u,s,P,F,ce,j,m]),ue=Object(o.useMemo)(()=>S.map(M),[S]),ye=r.a.createElement(f.a,{colSpan:A.length,align:"center"},r.a.createElement(b.a,null,E.common.noResults)),pe=L.length>0&&!R&&0===ue.length,me=!X&&ue.length>0;return r.a.createElement(d.a,{reactKeyPrefix:l,title:E.voyages.createVoyageFromTemplate,open:t,maxWidth:"lg",fullWidth:!0,confirmBtnName:E.common.create,disableConfirmBtn:!X||se,onCloseModal:a,onConfirm:de},r.a.createElement(g.a,{sx:ne.container},r.a.createElement(Z.a,null,r.a.createElement(B,{reactKeyPrefix:l+"-filter",FILTERS_GROUP_CODE:"CREATE_VOYAGE_FROM_TEMPLATE_LIST_FILTER"})),r.a.createElement(O.a,{data:ue,headers:A,footer:pe&&ye,userLocale:k,reactKeyPrefix:l+"-table",selectable:!0,singleSelect:!0,customisation:{responsive:!0,disableToolbar:!0,disableSorting:!0,height:{type:v.d.PX,value:500}},onRowClick:le}),r.a.createElement(g.a,{sx:ne.footer},r.a.createElement(h.a,{justifyContent:"center",container:!0},r.a.createElement(C.a,{id:l+"-load-more",variant:"outlined",color:"primary",onClick:()=>{N(D+1)},disabled:R},E.common.loadMore)),me&&r.a.createElement(b.a,{sx:ne.helperText},E.fas.selectTemplateByClickingRow))))}const se=Object(s.a)(e=>{var t,a;const o=u.a.getUserLocale(e),r=null!==(t=K.a.getFiltersByGroupCode(e,"CREATE_VOYAGE_FROM_TEMPLATE_LIST_FILTER"))&&void 0!==t?t:[];return{userLocale:o,templateVoyages:null!==(a=p.a.getTSModelsBuilt(e,y.a.voyage,re,"CREATE_VOYAGE_FROM_TEMPLATE_LIST"))&&void 0!==a?a:[],storedFilters:r}},Object(l.b)([c.a.IInternationalization,i.a.Store,i.a.ITSModelActionsAsync,i.a.IFasVoyageApi,X.a.ICreateVoyageFromTemplateController,i.a.IScenarioActions,i.a.ISimpleReducerActions],Object(n.k)(Object(o.memo)(le))))},1662:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));a(59);var o,r=a(9),n=a(48),l=a(90),s=a(3),i=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(a,o){t(a,o,e)}},u=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};let y=class{constructor(e){this.http=e}getAccessibleObjectTypesForUser(e,t){var a;return u(this,void 0,void 0,(function*(){try{if(null!==e&&null!==t){const o=yield this.http.get(`${n.a.API_BASE_URL}/WebhookSubscription/getAccessibleObjectTypesForUser/${e.key}`,{headers:new Headers({authorization:null!==(a=t.authdata)&&void 0!==a?a:""})});return yield o.json()}return[""]}catch(e){if(e instanceof Error)throw new Error(e.message);throw new Error("API call to get accessible object types failed")}}))}};y=i([Object(r.injectable)(),d(0,Object(r.inject)(s.a.IHttp)),c("design:paramtypes",["function"==typeof(o=void 0!==l.IHttp&&l.IHttp)?o:Object])],y)},1690:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var o=a(425),r=a(9),n=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l};let l=class extends o.c{};l=n([Object(r.injectable)()],l)},1691:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));var o,r,n,l,s,i,c,d=a(9),u=a(29),y=a(7),p=a(223),m=a(20),v=a(425),f=a(185),b=a(300),g=a(31),h=a(21),C=a(1),O=a(592),P=a(83),j=a(104),T=a(222),k=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(e,t){return function(a,o){t(a,o,e)}};let E=class extends v.c{constructor(e,t,a,o,r,n,l){super(e,t,a,o,r,n,l),this.tsModelActions=e,this.fleetPlanVoyageApi=t,this.voyageController=a,this.store=o,this.cargoDrawerController=r,this.tsmodelApi=n,this.cacheController=l}getPostableVoyageHeader(e,{referenceNo:t,leg:a,budgetVersionKey:o},r){return{voyageStatus:"EST",referenceNo:t,leg:null==a?void 0:a.key,budgetVersion:o,isBudget:r,isTemplate:!0}}overrideGetPostableData(e,t,a,o){var r,n,l,s;const{vessel:i,loadPorts:c,loadCurrency:d,dischargePorts:u,dischargeCurrency:y,scenarioKey:p,loadPortCost:m,dischargePortCost:v,loadDaysExtraInPort:f,dischargeDaysExtraInPort:b}=t;if(!i||!(null==c?void 0:c.length)||!(null==u?void 0:u.length))return;null===(r=null==t?void 0:t.laycanFrom)||void 0===r||r.setHours(0),null===(n=null==t?void 0:t.laycanFrom)||void 0===n||n.setMinutes(0),null===(l=null==t?void 0:t.laycanTo)||void 0===l||l.setHours(23),null===(s=null==t?void 0:t.laycanTo)||void 0===s||s.setMinutes(59),t.isTemplate=!0;const g=O.a.generatePortCalls({loadPorts:c,loadCurrency:d,dischargePorts:u,dischargeCurrency:y,loadPortCost:null!=m?m:0,dischargePortCost:null!=v?v:0,daysExtraInPort:f,dischargeDaysExtraInPort:b}),P=this.getPostableCargoPorts(null!=a?a:void 0,t,void 0,g),j=O.a.generateDefaultVoyageObject(t,a,null!=P?P:[]),T=h.a.getTSModelBuilt(this.store.getState(),C.a.scenario,p||0,{isBudget:"*"});return Object.assign(Object.assign({},j),{voyageHeader:this.getPostableVoyageHeader(e,t,null==T?void 0:T.isBudget)})}getModalTitle(e){const{voyages:t}=e.getLanguageFile();return t.createTemplateVoyage}};E=k([Object(d.injectable)(),I(0,Object(d.inject)(y.a.ITSModelActionsAsync)),I(1,Object(d.inject)(y.a.IFasFleetPlanVoyageApi)),I(2,Object(d.inject)(y.a.IVoyageController)),I(3,Object(d.inject)(y.a.Store)),I(4,Object(d.inject)(m.a.ICargoDrawerController)),I(5,Object(d.inject)(P.a.ITSModelApi)),I(6,Object(d.inject)(y.a.ITypeaheadCacheController)),S("design:paramtypes",["function"==typeof(o=void 0!==u.ITSModelActionsAsync&&u.ITSModelActionsAsync)?o:Object,"function"==typeof(r=void 0!==f.IFasFleetPlanVoyageApi&&f.IFasFleetPlanVoyageApi)?r:Object,"function"==typeof(n=void 0!==b.IVoyageController&&b.IVoyageController)?n:Object,"function"==typeof(l=void 0!==g.Store&&g.Store)?l:Object,"function"==typeof(s=void 0!==p.ICargoDrawerController&&p.ICargoDrawerController)?s:Object,"function"==typeof(i=void 0!==j.ITSModelApi&&j.ITSModelApi)?i:Object,"function"==typeof(c=void 0!==T.ITypeaheadCacheController&&T.ITypeaheadCacheController)?c:Object])],E)},1693:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));a(59);var o,r,n,l,s=a(29),i=a(9),c=a(7),d=a(1),u=a(185),y=a(300),p=a(117),m=a(62),v=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e,t){return function(a,o){t(a,o,e)}},g=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};let h=class{constructor(e,t,a,o){this.tsModelActionsAsync=e,this.tsModelActions=t,this.fasFpvApi=a,this.voyageController=o}allocateToScenario(e,t,a){var o;return g(this,void 0,void 0,(function*(){const r=Object.assign({voyageHeader:{voyageStatus:t&&a?"SCU":"EST",key:null===(o=e.voyageHeader)||void 0===o?void 0:o.key}},t&&a?{scenarios:[{key:t}]}:{});return yield this.tsModelActionsAsync.updateSingleAction({key:e.key,type:d.a.voyage,fields:{key:"*"},data:r,callback:()=>{const t=new m.a(Object.assign(Object.assign({},r),{key:e.key}));this.tsModelActions.addMultipleAction(t)}})}))}createAndAllocateFpv(e,t){var a,o;return g(this,void 0,void 0,(function*(){if(e.vessel&&t){const r=yield this.fasFpvApi.getLastFleetPlanVoyage(e.vessel,t.key),n=r.length>0?r[0].sequence+1:1,l={refreshFleetPlan:!1,status:new p.a({statusTypeCode:"SCH"})};return yield this.voyageController.allocateVoyage(e,e.vessel,n,!1,null!==(o=null===(a=null==t?void 0:t.fleetPlan)||void 0===a?void 0:a.key)&&void 0!==o?o:null,l)}}))}};h=v([Object(i.injectable)(),b(0,Object(i.inject)(c.a.ITSModelActionsAsync)),b(1,Object(i.inject)(c.a.ITSModelActions)),b(2,Object(i.inject)(c.a.IFasFleetPlanVoyageApi)),b(3,Object(i.inject)(c.a.IVoyageController)),f("design:paramtypes",["function"==typeof(o=void 0!==s.ITSModelActionsAsync&&s.ITSModelActionsAsync)?o:Object,"function"==typeof(r=void 0!==s.ITSModelActions&&s.ITSModelActions)?r:Object,"function"==typeof(n=void 0!==u.IFasFleetPlanVoyageApi&&u.IFasFleetPlanVoyageApi)?n:Object,"function"==typeof(l=void 0!==y.IVoyageController&&y.IVoyageController)?l:Object])],h)},1801:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));a(93);var o=a(0),r=a.n(o),n=a(28),l=a(1),s=a(19),i=a(14),c=a(3),d=a(51),u=a(85);const y=i.a.get(c.a.IInternationalization),{common:p}=y.getLanguageFile(),m=e=>{const{selectedBunkerStock:t,reactKeyPrefix:a,open:o,bunkerCurrency:i,userLocale:c,onClose:y,onConfirm:m,onUpdateOverride:v,onDelete:f,showDelete:b}=e,g=()=>((e,t,a,o,r)=>{const i={object:e,fieldOptions:[{fieldName:"quantity",numberInputProps:{maskSettings:n.a.mask1,validation:[{type:u.a.RANGE,min:0}]},InputProps:{endAdornment:p.mt},onUpdateOverride:e=>{r("quantity",e)}},{fieldName:"price",numberInputProps:{maskSettings:n.a.mask2,validation:[{type:u.a.RANGE,min:0}]},InputProps:{endAdornment:t},onUpdateOverride:e=>{r("price",e)}}],type:l.a.bunkerstock,userLocale:a,reactKeyPrefix:o};return Object(s.a)(i)})(t,i,c,a,v),h={reactKeyPrefix:a+"edit-bunkerstock-modal",open:o,title:t.description,onCloseModal:y};if(t.bunkerCategory){return r.a.createElement(d.a,{allowDelete:b,modalProps:h,getColSpec:g,overrideOnConfirm:m,overrideOnDelete:f})}return r.a.createElement(r.a.Fragment,null)}},1853:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=a(1252),u=a(879);function y({reactKeyPrefix:e,closeModal:t,showModal:a,onUpdate:y,entityRelease:p,blGraph:m}){const[v]=Object(s.a)([c.a.IInternationalization]),{common:f,model:b}=v.getLanguageFile(),[g,h]=Object(o.useState)(m),C=Object(o.useMemo)(()=>({entityRelease:p}),[p]),O=Object(o.useCallback)(()=>Object(u.a)(g,null!=p?p:void 0),[g,p]),P=Object(o.useCallback)((e,t,a)=>(h(new i.a.blgraph.class(Object.assign(Object.assign({},e),{[t]:a}))),new i.a.blgraph.class(Object.assign(Object.assign({},e),{[t]:a}))),[]),j=Object(o.useMemo)(()=>({callback:y,type:i.a.blgraph}),[y]);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:e+"-edit-modal",maxWidth:"xs",onCloseModal:t,open:a,title:`${f.edit} ${b.blGraph}`,confirmBtnName:f.update},getColSpec:d.a,breakpoints:l.e,updateProps:j,selectedObject:m,contextData:C,isConfirmDisabled:u.b,overrideUpdateEntity:P,allowDelete:!!m,overrideGetData:O})}},1855:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=a(880),u=a(1253);function y({reactKeyPrefix:e,closeModal:t,showModal:a,onUpdate:y,entityRelease:p,blClass:m}){const[v]=Object(s.a)([c.a.IInternationalization]),{common:f,model:b}=v.getLanguageFile(),[g,h]=Object(o.useState)(m),C=Object(o.useMemo)(()=>({entityRelease:p}),[p]),O=Object(o.useCallback)(()=>Object(d.a)(g,null!=p?p:void 0),[g,p]),P=Object(o.useCallback)((e,t,a)=>(h(new i.a.blclass.class(Object.assign(Object.assign({},e),{[t]:a}))),new i.a.blclass.class(Object.assign(Object.assign({},e),{[t]:a}))),[]),j=Object(o.useMemo)(()=>({callback:y,type:i.a.blclass}),[y]);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:e+"-edit-modal",maxWidth:"xs",onCloseModal:t,open:a,title:`${f.edit} ${b.blClass}`,confirmBtnName:f.update},getColSpec:u.a,breakpoints:l.e,updateProps:j,contextData:C,isConfirmDisabled:d.b,overrideUpdateEntity:P,selectedObject:m,allowDelete:!!m,overrideGetData:O})}},1857:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=a(881),u=a(1254);function y({reactKeyPrefix:e,closeModal:t,showModal:a,onUpdate:y,entityRelease:p,blSkipGraph:m}){const[v]=Object(s.a)([c.a.IInternationalization]),{common:f,model:b}=v.getLanguageFile(),[g,h]=Object(o.useState)(m),C=Object(o.useMemo)(()=>({entityRelease:p}),[p]),O=Object(o.useCallback)(()=>Object(d.a)(g,null!=p?p:void 0),[g,p]),P=Object(o.useCallback)((e,t,a)=>(h(new i.a.blskipgraph.class(Object.assign(Object.assign({},e),{[t]:a}))),new i.a.blskipgraph.class(Object.assign(Object.assign({},e),{[t]:a}))),[]),j=Object(o.useMemo)(()=>({callback:y,type:i.a.blskipgraph}),[y]);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:e+"-edit-modal",maxWidth:"xs",onCloseModal:t,open:a,title:`${f.edit} ${b.blSkipGraph}`,confirmBtnName:f.update},getColSpec:u.a,breakpoints:l.e,updateProps:j,selectedObject:m,contextData:C,isConfirmDisabled:d.b,overrideUpdateEntity:P,allowDelete:!!m,overrideGetData:O})}},190:function(e,t,a){"use strict";var o;a.d(t,"a",(function(){return o})),function(e){e.FROM_TEMPLATE="From Template",e.TEMPLATE="Template",e.TC="Tc",e.CARGO="Cargo",e.WITHOUT_CARGO="Without Cargo"}(o||(o={}))},1912:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));a(10),a(11);var o=a(0),r=a.n(o),n=a(810),l=a(51),s=a(12),i=a(6),c=a(23),d=a(1),u=a(241),y=a(7),p=a(232),m=a(153),v=a(648),f=a(3),b=a(20);var g=a(57),h=a(19),C=a(288),O=a(70);function P(e,t,a,o,r,n){var l;const{model:s}=r.getLanguageFile(),{setChannelInfoUrl:i}=n,c={reactKeyPrefix:e,fieldOptions:[{fieldName:"url",label:s.email,onUpdateOverride:e=>{a.bind(null,"channelInfo.url"),i(e)},overrideObject:new C.a(null!==(l=t.channelInfo)&&void 0!==l?l:{}),overrideType:d.a.channelinfo,textInputProps:{letterCase:g.a.LOWERCASE,validation:O.b.EmailOnClient}}],userLocale:o,object:t,type:d.a.webhooksubscription};return Object(h.a)(c)}var j=a(28),T=a(312),k=a(43),S=a(463),I=a(66),E=a(95);function A(e,t,a,o,n,l){var i;const{model:c,common:u}=n.getLanguageFile(),{channelType:y,setChannelType:p,setObjectType:v,setChannelInfoUrl:f,accessibleObjectTypes:b,onLoadObjectTypes:g}=l,C=Object.values(d.a).map(e=>e.name),O={[S.a.CREATE]:u.create,[S.a.UPDATE]:u.update,[S.a.DELETE]:u.delete},P={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{fieldName:"user",formControlProps:{required:!0},label:c.user,onUpdateOverride:e=>{a("user",e),g(e)},breakpoints:s.h,typeaheadProps:{objectPaths:["userName"],defaultSelectedOptions:t.user,shouldPreload:!0},disabled:!Object(I.c)([E.a.ADMINISTRATOR],null!==(i=l.user)&&void 0!==i?i:new k.a({}))},{fieldName:"objectType",disabled:!!t.dlpAlertScript,label:c.objectType,onUpdateOverride:e=>{a("objectType",e),v(e)},overrideFieldType:"object",typeaheadProps:{options:null!=b?b:C,shouldPreload:!0},breakpoints:s.h},{fieldName:"dataloyObject",disabled:!!t.dlpAlertScript,label:c.dataloyObjectKey,breakpoints:s.h,numberInputProps:{maskSettings:j.a.mask14,onChange:a.bind(null,"dataloyObject")}},{fieldName:"eventType",disabled:!!t.dlpAlertScript,label:c.eventType,onUpdateOverride:a.bind(null,"eventType"),breakpoints:s.h,overrideFieldType:"object",typeaheadProps:{options:Object.keys(O),resolver:e=>O[e]}},{fieldName:"dlpAlertScript",disabled:!!t.objectType||!!t.eventType,label:c.dlpAlertScript,onUpdateOverride:a.bind(null,"dlpAlertScript"),breakpoints:s.e},{fieldName:"channelType",label:c.channelType,formControlProps:{required:!0},overrideComponent:r.a.createElement(T.a,{reactKeyPrefix:e+"-channel-type-code",onChange:e=>{const t=e.target.value;p(m.a[t]);let a="";t===m.a.WSOC&&(a="."),f(a)},selectedValue:y,name:"channelTypeCode",options:[{label:n.lang().model.http,value:m.a.HTTP},{label:n.lang().model.email,value:m.a.EMAIL},{label:n.lang().webhooks.webSocket,value:m.a.WSOC}]})}],object:t,type:d.a.webhooksubscription,userLocale:o};return Object(h.a)(P)}var M=a(656),w=a(202),x=a(1850);function F(e,t,a,o,n,l){var s;const{model:i,webhooks:c}=n.getLanguageFile(),{expressionText:u,onChangeExpressionText:y,objectType:p,onEmptyTextArea:m}=l,v={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{overrideComponent:r.a.createElement(w.a,null)},{fieldName:"templateMsg",label:c.templateMsg,textInputProps:{onInputChange:a.bind(null,"templateMsg")}},{fieldName:"json",label:i.json,textInputProps:{onInputChange:a.bind(null,"json"),multiline:!0,maxRows:4}},{fieldName:"expression",label:i.expression,overrideComponent:r.a.createElement(M.a,{reactKeyPrefix:e+"-text-area",value:u,objectType:p,onChange:e=>{a.bind(null,"expression"),y(e.target.value)},onEmptyTextArea:m,onEdit:!1})},{fieldName:"doNotUnsubscribe",overrideComponent:r.a.createElement(x.a,{reactKeyPrefix:e+"-doNotUnsubscribe",check:null!==(s=t.doNotUnsubscribe)&&void 0!==s&&s,onInputChange:a.bind(null,"doNotUnsubscribe")})},{fieldName:"onlyMainObject",label:i.onlyMainObject,onUpdateOverride:a.bind(null,"onlyMainObject")},{fieldName:"rawObject",label:i.rawObject,onUpdateOverride:a.bind(null,"rawObject")},{fieldName:"staticMsg",label:i.staticMsg,onUpdateOverride:a.bind(null,"staticMsg")}],object:t,type:d.a.webhooksubscription,userLocale:o};return Object(h.a)(v)}var D=a(545),N=a(1239),R=a(1238),V=a(1240);function L(e,t,a,o,n,l){var s;const{model:i}=n.getLanguageFile(),{httpAuthType:c,setHttpAuthType:u,setChannelInfoUrl:y,editAuthTypeContextData:m}=l,v={reactKeyPrefix:e,fieldOptions:[{fieldName:"url",label:i.url,overrideObject:new C.a(null!==(s=t.channelInfo)&&void 0!==s?s:{}),overrideType:d.a.channelinfo,onUpdateOverride:e=>{a.bind(null,"channelInfo.url"),y(e)}},{fieldName:"httpOptions",overrideComponent:r.a.createElement(T.a,{reactKeyPrefix:e+"-http-auth-type",onChange:e=>{u(p.a[e.target.value])},selectedValue:c,name:"httpAuthType",options:[{label:n.lang().model.password,value:p.a.PASSWORD},{label:n.lang().model.accessToken,value:p.a.TOKEN},{label:n.lang().model.requestAccessToken,value:p.a.TOKEN_REQUEST}]})}],userLocale:o,object:t,type:d.a.webhooksubscription},f={[p.a.PASSWORD]:R.a,[p.a.TOKEN]:N.a,[p.a.TOKEN_REQUEST]:V.a};return[...Object(h.a)(v),...f[c](e,t,a,o,n,m)]}function U({reactKeyPrefix:e,open:t,onCloseModal:a,onCreate:g}){const[h,C,O,j]=Object(i.a)([f.a.IInternationalization,b.a.ICreateWebhookSubscriptionController,y.a.ITSModelActionsAsync,f.a.IWebsocketUtils]),{common:T,webhooks:k}=h.lang(),S=Object(c.a)(u.a.getUserData),[I,E]=Object(o.useState)(""),[M,w]=Object(o.useState)(m.a.HTTP),[x,N]=Object(o.useState)(p.a.PASSWORD),[R,V]=Object(o.useState)(""),[U,B]=Object(o.useState)(""),[K,q]=Object(o.useState)(""),[H,_]=Object(o.useState)(!1),W=Object(o.useRef)(M),[G,Q]=Object(o.useState)([""]),[$,z]=Object(o.useState)(""),[Y,X]=Object(o.useState)(""),J=Object(o.useCallback)(e=>{V(e)},[]),Z=Object(o.useCallback)(()=>{V("")},[]);Object(o.useEffect)(()=>{M===m.a.WSOC&&(W.current=M)},[M]);const ee=Object(o.useCallback)(e=>{C.getAccessibleObjectTypesForUser(e,S).then(e=>Q(e))},[C,S]);Object(o.useEffect)(()=>{C.getAccessibleObjectTypesForUser(S,S).then(e=>Q(e))},[]);const te={user:S,channelType:M,setChannelType:w,httpAuthType:x,setHttpAuthType:N,expressionText:R,onChangeExpressionText:J,objectType:I,setObjectType:E,onEmptyTextArea:Z,setChannelInfoUrl:B,editAuthTypeContextData:{showPassword:null!=H&&H,setShowPassword:_,username:K,setUsername:q,accessToken:$,onChangeAccessToken:z},accessibleObjectTypes:G,onLoadObjectTypes:ee},ae=Object(o.useCallback)((e,t,a,o)=>{const r=M===m.a.HTTP?L:M===m.a.EMAIL?P:void 0,n=r=>r?r(e,t,a,o,h,te):[];return[...n(A),...n(r),...n(F)]},[M,te,h]),oe=Object(o.useCallback)((e,t)=>{if(t){if(W.current===m.a.WSOC){const e=Object(D.a)(t,!1);O.createAction({data:e,type:d.a.webhooksubscription,callback:e=>{if(e)throw new Error("Subscription for channel type DB cannot be created")}});const a=null!==t.dataloyObject?"/"+t.dataloyObject:"";j.createWebsocketSubscription(`${j.getBaseUrlForSocket()}/${j.WebsocketEndpoint.objectSubscription}/${t.objectType}/${t.eventType}${a}`,[v.a])}g&&g(e,t)}},[g,O,j]),re=Object(o.useCallback)(e=>m.a.EMAIL===M||m.a.WSOC===M?Object(D.c)(e,!1):m.a.HTTP===M?Object(D.b)(e,x,!1):void 0,[M,x]);Object(o.useEffect)(()=>{E(I)},[I]);const ne=Object(o.useCallback)(()=>{a(),q(""),_(!1)},[a]);return r.a.createElement(l.a,{modalProps:{confirmBtnName:T.create,maxWidth:"sm",onCloseModal:ne,open:t,reactKeyPrefix:e,title:k.createSubscription},breakpoints:s.e,isConfirmDisabled:e=>function(e,t){const{user:a,channelInfo:o,objectType:r,eventType:n,dlpAlertScript:l}=e,s=(t===m.a.HTTP||t===m.a.EMAIL)&&!(null==o?void 0:o.url);return!a||s||!((r&&n||l)&&(!r&&!n||!l))}(e,M),propertiesToSet:{user:S},propertiesToOverwrite:{channelInfo:{channelType:{channelTypeCode:M},userName:""!==K?K:null,url:U},expression:""!==R?Object(n.b)(R):null,accessToken:""!==$?$:null},getColSpec:ae,createProps:{callback:oe,type:d.a.webhooksubscription},overrideGetData:re})}},1949:function(e,t,a){"use strict";a.d(t,"a",(function(){return se}));var o=a(9),r=a(29),n=a(7),l=a(81),s=a(276),i=a(220),c=a(172),d=a(1193),u=a(89),y=a(50),p=a(592);function m(e){var t,a,o,r;const{vessel:n,loadPorts:y,dischargePorts:p,laycanFrom:m,laycanTo:v,charterer:f,tcRateDuration:b,tcRate:g,commissionAddress:h,commissionBroker:C,ballastBonusRevenue:O}=e;if(!n||!y||!p)return;const P=Object(l.a)(n,"vesselCodes[0].key"),j=Object(l.a)(n,"vesselCodes[0].defaultBusinessUnit.key"),T=Object(l.a)(n,"vesselCodes[0].defaultCompany.key"),k=Object(l.a)(n,"vesselCodes[0].vessel?.owner.key"),S=d.a.generateDefaultTcObject(!1,n);return null==m||m.setHours(0),null==m||m.setMinutes(0),null==v||v.setHours(23),null==v||v.setMinutes(59),Object(u.a)(new c.a(Object.assign(Object.assign({},S),{charterer:f,laycanFrom:m,laycanTo:v,vesselCode:P,businessUnit:j,company:T,owner:k,deliveryPort:null===(a=null===(t=y[0])||void 0===t?void 0:t.port)||void 0===a?void 0:a.key,redeliveryPort:null===(r=null===(o=p[0])||void 0===o?void 0:o.port)||void 0===r?void 0:r.key,tcDurations:[new s.a({sequenceNo:1,tcDuration:b,tcRates:[new i.a({sequenceNo:1,tcRateDuration:b,tcRate:g})]})],commissionBroker:C,commissionAddress:h,ballastBonus:O})),!0)}function v(e,t,a){const o=y.a.getDefaultEventLogs();return[{eventLogs:o,port:null==e?void 0:e.key,portCallSequence:1,reasonForCall:"DEL"},{eventLogs:o,port:null==t?void 0:t.key,portCallSequence:2,reasonForCall:"RED"}]}const f={generateDefaultTcVoyageObject:function(e){var t,a;const{vessel:o,loadPorts:r,dischargePorts:n,percentExtraAtSea:l}=e;if(o&&r&&n)return Object.assign(Object.assign({},p.a.generateCommonVoyageObject(e)),{isTc:!0,portCallsFromVoyage:v(null===(t=r[0])||void 0===t?void 0:t.port,null===(a=n[0])||void 0===a?void 0:a.port,l),tcs:[m(e)]})}};var b=a(223),g=a(20),h=a(425),C=a(185),O=a(300),P=a(31),j=(a(59),a(1)),T=a(62),k=a(19),S=a(235),I=a(96),E=a(86),A=a(198),M=a(12),w=a(530),x=a(64),F=a(63),D=a(85),N=a(146),R=a(28),V=a(101),L=a(60),U=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};function B(e){var t,a,o,r;const{reactKeyPrefix:n,voyageModalState:s,updateVoyageModalState:d,controller:u,userLocale:y,i:p,selectedVessel:m,vesselIsFocused:v,setVesselIsFocused:f,isOpenedFromFas:b}=e,{model:g,alerts:h}=p.getLanguageFile(),C=Object(l.a)(s,"vessel",void 0);let O=new V.a({currencyCode:"USD"});C&&(O=new V.a({currencyCode:L.a.getDefaultVoyageCurrency(C)}));const P=Object(l.a)(s,"scenarioKey",void 0),B=Object(l.a)(s,"laycanFrom",void 0),K=Object(l.a)(s,"laycanTo",void 0),q=!(!B||!K)&&B>K,H=(P?"filter=scenarios(EQ)"+P:"filter=scenarios.scenarioCode(EQ)MASTER")+"&";const _={reactKeyPrefix:n,disableUpdate:!0,fieldOptions:[{fieldName:"vessel",formControlProps:{required:!0},label:g.vessel,typeaheadProps:{fields:{vesselName:"*"},defaultSelectedOptions:C,shouldPreload:!0,query:(b?H:"")+"sort=vesselName(ASI)",onFocus:()=>f(!0)},onUpdateOverride:e=>{e&&function(e){U(this,void 0,void 0,(function*(){const t=yield u.loadVesselValues(e.key);t&&d("vessel",t)}))}(e)},disabled:!!m,breakpoints:M.h,autoFocus:!0},{fieldName:"ballastPort",label:g.ballastPort,typeaheadProps:{objectPaths:["portName"],fields:S.a,defaultSelectedOptions:s.ballastPort,query:I.d},onUpdateOverride:e=>d("ballastPort",e),disabled:!v&&!C,breakpoints:M.h},{fieldName:"port",formControlProps:{required:!0},label:g.deliveryPort,overrideObject:new x.a({}),overrideType:j.a.cargoport,typeaheadProps:{fields:S.a,defaultSelectedOptions:null===(a=(null!==(t=s.loadPorts)&&void 0!==t?t:[])[0])||void 0===a?void 0:a.port,query:I.d},onUpdateOverride:e=>d("loadPorts",[{port:e}]),breakpoints:M.h},{fieldName:"port",formControlProps:{required:!0},label:g.redeliveryPort,overrideObject:new x.a({}),overrideType:j.a.cargoport,typeaheadProps:{fields:S.a,defaultSelectedOptions:null===(r=(null!==(o=null==s?void 0:s.dischargePorts)&&void 0!==o?o:[])[0])||void 0===r?void 0:r.port,query:I.d},onUpdateOverride:e=>d("dischargePorts",[{port:e}]),breakpoints:M.h},{fieldName:"charterer",label:p.lang().model.charterer,overrideObject:new c.a({}),overrideType:j.a.tc,typeaheadProps:{objectPaths:E.b.businessPartner,query:I.b,fields:E.a.businessPartner},onUpdateOverride:e=>d("charterer",e)},{fieldName:"tcRateDuration",label:p.lang().model.duration,overrideObject:new i.a({}),overrideType:j.a.tcrate,InputProps:{endAdornment:Object(w.a)(p)[A.b.DAY]},numberInputProps:{maskSettings:R.a.mask3},breakpoints:M.f,onUpdateOverride:e=>d("tcRateDuration",e)},{fieldName:"tcRate",label:p.lang().model.rate,overrideObject:new i.a({}),overrideType:j.a.tcrate,InputProps:{endAdornment:O.currencyCode},numberInputProps:{maskSettings:R.a.mask3},breakpoints:M.f,onUpdateOverride:e=>d("tcRate",e)},{fieldName:"ballastBonusRevenue",label:g.ballastBonus,InputProps:{endAdornment:null==O?void 0:O.currencyCode},numberInputProps:{maskSettings:R.a.mask3},breakpoints:M.i,onUpdateOverride:e=>d("ballastBonusRevenue",e)},{fieldName:"commissionBroker",label:p.lang().model.commissionBroker,InputProps:{endAdornment:F.a.Percent},overrideObject:new c.a({}),overrideType:j.a.tc,numberInputProps:{validation:[{type:D.a.RANGE,min:0,max:100}],maskSettings:{decimalScale:2,allowNegative:!1}},breakpoints:M.h,onUpdateOverride:e=>d("commissionBroker",e)},{fieldName:"commissionAddress",label:p.lang().model.commissionAddress,InputProps:{endAdornment:F.a.Percent},overrideObject:new c.a({}),overrideType:j.a.tc,numberInputProps:{validation:[{type:D.a.RANGE,min:0,max:100}],maskSettings:{decimalScale:2,allowNegative:!1}},breakpoints:M.h,onUpdateOverride:e=>d("commissionAddress",e)},{dateInputProps:{error:q},fieldName:"eventLogDate",formHelperText:q?h.cancellingAfterCommencement:void 0,label:g.laydaysCommences,onUpdateOverride:e=>d("laycanFrom",e),overrideObject:new N.a({eventLogDate:B}),overrideType:j.a.eventlog,breakpoints:M.h},{dateInputProps:{error:q},fieldName:"eventLogDate",formHelperText:q?h.cancellingAfterCommencement:void 0,label:g.laydaysCancelling,onUpdateOverride:e=>d("laycanTo",e),overrideObject:new N.a({eventLogDate:K}),overrideType:j.a.eventlog,breakpoints:M.h}],object:new T.a({}),type:j.a.voyage,userLocale:y};return Object(k.a)(_)}var K=a(78),q=a(130),H=a(0),_=a.n(H);function W(e){var t,a;const{reactKeyPrefix:o,voyageModalState:r,updateVoyageModalState:n,userLocale:l,i:s}=e,{model:i,tc:d}=s.getLanguageFile(),{currency:u,tcIn:y}=r,p={reactKeyPrefix:o,disableUpdate:!0,fieldOptions:y?[{label:i.tcInContract,overrideComponent:_.a.createElement(q.a,{variant:"subtitle1"},`${null!==(a=null===(t=y.owner)||void 0===t?void 0:t.businessPartnerName)&&void 0!==a?a:d.noOwnerOnTCContract}, ${K.a.getFormattedDateString(y.cpDate,l,!0)}`),breakpoints:M.e}]:[{fieldName:"tcRate",label:i.dailyHire,InputProps:{endAdornment:null==u?void 0:u.currencyCode},numberInputProps:{maskSettings:R.a.mask3},disabled:!!y,breakpoints:M.h,onUpdateOverride:e=>n("dailyHire",e)},{fieldName:"ballastBonus",label:i.ballastBonus,overrideObject:new c.a({ballastBonus:r.ballastBonus}),overrideType:j.a.tc,InputProps:{endAdornment:null==u?void 0:u.currencyCode},numberInputProps:{maskSettings:R.a.mask3},disabled:!!y,breakpoints:M.h,onUpdateOverride:e=>n("ballastBonus",e)},{fieldName:"commissionAddress",label:i.commissionAddress,disabled:!!y,overrideObject:new c.a({commissionAddress:r.tcHireCommission}),overrideType:j.a.tc,breakpoints:M.h,InputProps:{endAdornment:F.a.Percent},numberInputProps:{maskSettings:R.a.mask2},onUpdateOverride:e=>n("tcHireCommission",e)}],object:new T.a({}),type:j.a.voyage,userLocale:l};return Object(k.a)(p)}var G=a(83),Q=a(104),$=a(108);function z(e){const{reactKeyPrefix:t,voyageModalState:a,updateVoyageModalState:o,userLocale:r,i:n}=e,{model:l}=n.getLanguageFile(),s={reactKeyPrefix:t,disableUpdate:!0,fieldOptions:[{fieldName:"leg",formControlProps:{required:!1},label:l.trade,overrideObject:new $.a({}),overrideType:j.a.voyageheader,typeaheadProps:{defaultSelectedOptions:a.leg,shouldPreload:!0},onUpdateOverride:e=>o("leg",e)},{fieldName:"referenceNo",overrideObject:new $.a({}),onUpdateOverride:e=>o("referenceNo",e),overrideType:j.a.voyageheader}],object:new T.a({}),type:j.a.voyage,userLocale:r};return Object(k.a)(s)}var Y,X,J,Z,ee,te,ae,oe=a(222),re=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},ne=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},le=function(e,t){return function(a,o){t(a,o,e)}};let se=class extends h.c{constructor(e,t,a,o,r,n,l){super(e,t,a,o,r,n,l),this.tsModelActions=e,this.fleetPlanVoyageApi=t,this.voyageController=a,this.store=o,this.cargoDrawerController=r,this.tsmodelApi=n,this.cacheController=l}overrideGetPostableData(e,t,a,o){const{vessel:r,loadPorts:n,dischargePorts:l,scenarioKey:s}=t;if(!r||!(null==n?void 0:n.length)||!(null==l?void 0:l.length))return;const i=f.generateDefaultTcVoyageObject(t);return Object.assign(Object.assign({},i),{voyageHeader:this.getPostableVoyageHeader(e,t,o),scenarios:s?[{key:s}]:void 0})}getModalTitle(e){const{voyages:t}=e.getLanguageFile();return t.createTimeCharter}getSections(e){const{common:t}=e.i.getLanguageFile();return[{breakpoints:{md:8,xs:12},sections:[{fields:B(e)}]},{breakpoints:{md:4,xs:12},sections:[{title:t.timeCharterIn,fields:W(e)},{fields:z(e)}]}]}};se=re([Object(o.injectable)(),le(0,Object(o.inject)(n.a.ITSModelActionsAsync)),le(1,Object(o.inject)(n.a.IFasFleetPlanVoyageApi)),le(2,Object(o.inject)(n.a.IVoyageController)),le(3,Object(o.inject)(n.a.Store)),le(4,Object(o.inject)(g.a.ICargoDrawerController)),le(5,Object(o.inject)(G.a.ITSModelApi)),le(6,Object(o.inject)(n.a.ITypeaheadCacheController)),ne("design:paramtypes",["function"==typeof(Y=void 0!==r.ITSModelActionsAsync&&r.ITSModelActionsAsync)?Y:Object,"function"==typeof(X=void 0!==C.IFasFleetPlanVoyageApi&&C.IFasFleetPlanVoyageApi)?X:Object,"function"==typeof(J=void 0!==O.IVoyageController&&O.IVoyageController)?J:Object,"function"==typeof(Z=void 0!==P.Store&&P.Store)?Z:Object,"function"==typeof(ee=void 0!==b.ICargoDrawerController&&b.ICargoDrawerController)?ee:Object,"function"==typeof(te=void 0!==Q.ITSModelApi&&Q.ITSModelApi)?te:Object,"function"==typeof(ae=void 0!==oe.ITypeaheadCacheController&&oe.ITypeaheadCacheController)?ae:Object])],se)},2033:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=(a(93),a(19)),u=a(57),y=a(70);function p(e,t,a,o,r,n){const{common:l}=r.getLanguageFile(),s={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{label:l.description,fieldName:"variousText"},{label:l.code,fieldName:"variousCode",textInputProps:{letterCase:u.a.UPPERCASE,validation:y.b.VariousCode,onInputChange:(e,t)=>n.onChangeVariousCode(t)}},{label:l.type,fieldName:"variousType",typeaheadProps:{objectPaths:["variousTypeDesc"],shouldPreload:!0}},{label:l.calculationRule,fieldName:"variousRule",typeaheadProps:{objectPaths:["variousRuleDesc"],shouldPreload:!0}}].map(e=>Object.assign(Object.assign({},e),{formControlProps:{required:!0},onUpdateOverride:a.bind(null,e.fieldName)})),object:t,type:i.a.varioustext,userLocale:o};return Object(d.a)(s)}function m({reactKeyPrefix:e,closeModal:t,showModal:a,onCreate:d}){const[u]=Object(s.a)([c.a.IInternationalization]),{common:y}=u.getLanguageFile(),[m,v]=Object(o.useState)(!1);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:e+"-create-modal",maxWidth:"xs",onCloseModal:t,open:a,title:y.createVariousCostRevenue,confirmBtnName:y.create},getColSpec:p,breakpoints:l.e,contextData:{onChangeVariousCode:v},createProps:{callback:d,type:i.a.varioustext},isConfirmDisabled:e=>!(e.variousText&&e.variousCode&&e.variousType&&e.variousRule&&m)})}},2034:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=(a(93),a(19)),u=a(57),y=a(70);function p(e,t,a,o,r,n){const l=r.getLanguageFile(),s={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{fieldName:"vesselTypeDesc",label:l.common.description,formControlProps:{required:!0},onUpdateOverride:a.bind(null,"vesselTypeDesc")},{fieldName:"vesselTypeCode",label:l.common.code,formControlProps:{required:!0},onUpdateOverride:a.bind(null,"vesselTypeCode"),textInputProps:{letterCase:u.a.UPPERCASE,validation:y.b.VesselTypeCode,onInputChange:(e,t)=>n.onChangeVesselTypeCode(t)}},{fieldName:"vesselCategory",label:l.common.category,formControlProps:{required:!0},onUpdateOverride:a.bind(null,"vesselCategory"),typeaheadProps:{objectPaths:["vesselCategoryDesc"],shouldPreload:!0}}],object:t,type:i.a.vesseltype,userLocale:o};return Object(d.a)(s)}function m({reactKeyPrefix:e,closeModal:t,showModal:a,onCreate:d}){const[u]=Object(s.a)([c.a.IInternationalization]),[y,m]=Object(o.useState)(!1),v=u.getLanguageFile(),f=Object(o.useCallback)(({vesselTypeDesc:e,vesselTypeCode:t,vesselCategory:a})=>!(e&&t&&a&&y),[y]);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:e+"-create-modal",maxWidth:"xs",onCloseModal:t,open:a,title:v.common.createVesselType,confirmBtnName:v.common.create},getColSpec:p,breakpoints:l.e,createProps:{callback:d,type:i.a.vesseltype},contextData:{onChangeVesselTypeCode:m},isConfirmDisabled:f})}},2038:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));a(10),a(11);var o=a(0),r=a.n(o),n=a(51),l=a(12),s=a(6),i=a(1),c=a(3),d=a(19),u=a(193),y=a(1251),p=a(102);function m(e,t,a,o,n,l){const{model:s,common:c}=n.getLanguageFile(),m=Object(y.b)(l.releases),v=0===m.length?c.noOptionsFound:m[0],f={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{fieldName:"releaseNumber",formControlProps:{required:!0},overrideComponent:r.a.createElement(p.a,{reactKeyPrefix:e+"release",options:m,label:s.releaseNumber,variant:"standard",onChange:e=>{a("releaseNumber",e)},overrideDefaultSelectedOptions:!0,defaultSelectedOptions:v,disabled:0===m.length})}],object:new u.a(t),type:i.a.entityrelease,userLocale:o,smartResponse:!0};return Object(d.a)(f)}var v=a(20),f=a(46),b=a(97);function g(e){const[t,a]=Object(s.a)([c.a.IInternationalization,v.a.IEntityReleaseController]),d=Object(b.g)(),u=Object(o.useCallback)(()=>{f.a.next()},[]),{reactKeyPrefix:y,showModal:p,closeModal:g,list:h}=e,C=Object(o.useCallback)(e=>{let t=null;t=null===e.releaseNumber||""===e.releaseNumber&&1===h.length?h.find(e=>e.releaseNumber===h[0].releaseNumber):h.find(t=>t.releaseNumber===e.releaseNumber),t&&t.key&&(a.deleteEntityRelease(t.key),u(),d.goBack())},[h,a,u,d]),{common:O,model:P}=t.getLanguageFile(),j=Object(o.useCallback)(()=>{g()},[g]),T=Object(o.useCallback)(e=>null===e.releaseNumber||e.releaseNumber===O.noOptionsFound||0===h.length,[O.noOptionsFound,h.length]);return r.a.createElement(n.a,{modalProps:{reactKeyPrefix:y+"delete-release-modal",confirmBtnName:O.delete,maxWidth:"xs",onCloseModal:j,open:p,title:P.deleteRelease},createProps:{type:i.a.entityrelease},breakpoints:l.e,getColSpec:m,overrideOnConfirm:C,contextData:{releases:h},isConfirmDisabled:T})}},2055:function(e,t,a){"use strict";a.d(t,"a",(function(){return K}));var o=a(425),r=a(9),n=(a(59),a(81)),l=a(1),s=a(62),i=a(19),c=a(235),d=a(96),u=a(12),y=a(68),p=a(285),m=a(255),v=a(260),f=a(60),b=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};function g(e){var t,a,o,r,g,h,C,O,P,j;const{reactKeyPrefix:T,voyageModalState:k,updateVoyageModalState:S,controller:I,userLocale:E,i:A,selectedVessel:M,vesselIsFocused:w,setVesselIsFocused:x,isOpenedFromFas:F}=e,{model:D}=A.getLanguageFile(),N=Object(n.a)(k,"vessel",void 0),R=Object(n.a)(k,"scenarioKey",void 0),V=(R?"filter=scenarios(EQ)"+R:"filter=scenarios.scenarioCode(EQ)MASTER")+"&",L=m.a.isBunkeringExtraPortVoyageWithoutCargo(k),U=m.a.isDryDockVoyageWithoutCargo(k);let B=v.a.getCurrencyCode();N&&(B=f.a.getDefaultVoyageCurrency(N));const K={reactKeyPrefix:T,disableUpdate:!0,fieldOptions:[{fieldName:"vessel",formControlProps:{required:!0},label:D.vessel,typeaheadProps:{fields:{vesselName:"*"},defaultSelectedOptions:N,shouldPreload:!0,query:(F?V:"")+"sort=vesselName(ASI)",onFocus:()=>x(!0)},onUpdateOverride:e=>{e&&function(e){b(this,void 0,void 0,(function*(){const t=yield I.loadVesselValues(e.key);t&&S("vessel",t)}))}(e)},disabled:!!M,breakpoints:u.h,autoFocus:!0},{fieldName:"ballastPort",label:D.ballastPort,typeaheadProps:{objectPaths:["portName"],fields:c.a,defaultSelectedOptions:k.ballastPort,query:d.d},onUpdateOverride:e=>S("ballastPort",e),disabled:!w&&!N,breakpoints:u.h},{fieldName:"port",formControlProps:{required:!0},label:D.port,overrideObject:new y.a({}),overrideType:l.a.portcall,typeaheadProps:{fields:c.a,defaultSelectedOptions:null===(t=k.portCall)||void 0===t?void 0:t.port,query:d.d},onUpdateOverride:e=>S("portCall",{port:e}),breakpoints:u.h},{fieldName:"reasonForCall",formControlProps:{required:!0},label:D.reasonForCall,overrideObject:new y.a({}),overrideType:l.a.portcall,typeaheadProps:{shouldPreload:!0,defaultSelectedOptions:null===(a=k.portCall)||void 0===a?void 0:a.reasonForCall,query:"expression=reasonForCall not in ('L','D')"},onUpdateOverride:e=>S("portCall",{reasonForCall:e}),breakpoints:u.h},{disabled:!L,fieldName:"portCostCurrency",InputProps:{endAdornment:B},label:D.portCost,overrideObject:new y.a({}),overrideType:l.a.portcall,typeaheadProps:{defaultSelectedOptions:null!==(r=null===(o=k.portCall)||void 0===o?void 0:o.portCostCurrency)&&void 0!==r?r:0},onUpdateOverride:e=>S("portCall",{portCostCurrency:e}),breakpoints:u.f},{disabled:!L,fieldName:"daysExtraInPort",label:D.daysExtraInPort,overrideObject:new y.a({}),overrideType:l.a.portcall,typeaheadProps:{defaultSelectedOptions:null!==(h=null===(g=k.portCall)||void 0===g?void 0:g.daysExtraInPort)&&void 0!==h?h:0},onUpdateOverride:e=>S("portCall",{daysExtraInPort:e}),breakpoints:u.f},{disabled:!U,fieldName:"offhireStartDate",formControlProps:{required:U},dateInputProps:{showTime:!0},label:D.offhireStartDate,overrideObject:new p.a({offhireStartDate:null===(C=k.offhire)||void 0===C?void 0:C.offhireStartDate}),overrideType:l.a.offhire,typeaheadProps:{defaultSelectedOptions:null===(O=k.offhire)||void 0===O?void 0:O.offhireStartDate},onUpdateOverride:e=>S("offhire",{offhireStartDate:e}),breakpoints:u.f},{disabled:!U,fieldName:"offhireEndDate",formControlProps:{required:U},dateInputProps:{showTime:!0},label:D.offhireEndDate,overrideObject:new p.a({offhireEndDate:null===(P=k.offhire)||void 0===P?void 0:P.offhireEndDate}),overrideType:l.a.offhire,typeaheadProps:{defaultSelectedOptions:null===(j=k.offhire)||void 0===j?void 0:j.offhireEndDate},onUpdateOverride:e=>S("offhire",{offhireEndDate:e}),breakpoints:u.f}],object:new s.a({}),type:l.a.voyage,userLocale:E};return Object(i.a)(K)}var h,C,O,P,j,T,k,S=a(7),I=a(29),E=a(185),A=a(300),M=a(31),w=a(20),x=a(223),F=a(83),D=a(104),N=a(222),R=a(50),V=a(21),L=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},U=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},B=function(e,t){return function(a,o){t(a,o,e)}};let K=class extends o.c{constructor(e,t,a,o,r,n,l){super(e,t,a,o,r,n,l),this.tsModelActions=e,this.fleetPlanVoyageApi=t,this.voyageController=a,this.store=o,this.cargoDrawerController=r,this.tsmodelApi=n,this.cacheController=l}getModalTitle(e){const{voyages:t}=e.getLanguageFile();return t.createVoyageWithoutCargo}getSections(e){return[{breakpoints:{md:12,xs:6},sections:[{fields:g(e)}]}]}overrideGetPostableData(e,t,a,o){var r,n,s,i,c,d;const{vessel:u,ballastPort:y,portCall:p,offhire:v,scenarioKey:f}=t;if(!u||!p)return;const b=m.a.isBunkeringExtraPortVoyageWithoutCargo(t),g=m.a.isDryDockVoyageWithoutCargo(t),h={eventLogs:R.a.getDefaultEventLogs(),port:null===(r=null==p?void 0:p.port)||void 0===r?void 0:r.key,portCallSequence:1,reasonForCall:null===(n=null==p?void 0:p.reasonForCall)||void 0===n?void 0:n.key,portCostCurrency:b?null==p?void 0:p.portCostCurrency:0,daysExtraInPort:b?null==p?void 0:p.daysExtraInPort:0},C={reasonForOffhire:null===(s=V.a.getTSModelsBuilt(this.store.getState(),l.a.reasonforoffhire,{reasonForOffhire:"*"}).find(e=>"DD"===e.reasonForOffhire))||void 0===s?void 0:s.key,offhireStartDate:null==v?void 0:v.offhireStartDate,offhireEndDate:null==v?void 0:v.offhireEndDate,port:null===(i=p.port)||void 0===i?void 0:i.key};return{vessel:u.key,ballastPort:null!==(c=null==y?void 0:y.key)&&void 0!==c?c:null===(d=null==p?void 0:p.port)||void 0===d?void 0:d.key,portCallsFromVoyage:[h],voyageHeader:{isVoyageStartFixed:!e,voyageStatus:e?o?"SCH":"SCU":void 0,offhires:g?[C]:[],voyageStartDate:g?null==v?void 0:v.offhireStartDate:void 0},scenarios:f?[{key:f}]:void 0}}isConfirmDisabled(e){var t;const{portCall:a,offhire:o}=e,r=null===(t=null==a?void 0:a.reasonForCall)||void 0===t?void 0:t.reasonForCallDesc,n=r&&["Extra Port","Bunkering"].includes(null!=r?r:""),l=r&&"Dry Dock"===(null!=r?r:""),s=!!a&&(!!a.port&&!!a.reasonForCall&&(!n||void 0!==a.daysExtraInPort&&void 0!==a.portCostCurrency)),i=!l||!!o&&(!!o.offhireStartDate&&!!o.offhireEndDate&&o.offhireStartDate<=o.offhireEndDate);return!(e.vessel&&s&&i)}};K=L([Object(r.injectable)(),B(0,Object(r.inject)(S.a.ITSModelActionsAsync)),B(1,Object(r.inject)(S.a.IFasFleetPlanVoyageApi)),B(2,Object(r.inject)(S.a.IVoyageController)),B(3,Object(r.inject)(S.a.Store)),B(4,Object(r.inject)(w.a.ICargoDrawerController)),B(5,Object(r.inject)(F.a.ITSModelApi)),B(6,Object(r.inject)(S.a.ITypeaheadCacheController)),U("design:paramtypes",["function"==typeof(h=void 0!==I.ITSModelActionsAsync&&I.ITSModelActionsAsync)?h:Object,"function"==typeof(C=void 0!==E.IFasFleetPlanVoyageApi&&E.IFasFleetPlanVoyageApi)?C:Object,"function"==typeof(O=void 0!==A.IVoyageController&&A.IVoyageController)?O:Object,"function"==typeof(P=void 0!==M.Store&&M.Store)?P:Object,"function"==typeof(j=void 0!==x.ICargoDrawerController&&x.ICargoDrawerController)?j:Object,"function"==typeof(T=void 0!==D.ITSModelApi&&D.ITSModelApi)?T:Object,"function"==typeof(k=void 0!==N.ITypeaheadCacheController&&N.ITypeaheadCacheController)?k:Object])],K)},255:function(e,t,a){"use strict";a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h}));a(59),a(10),a(11);var o=a(14),r=a(101),n=a(151),l=a(1),s=a(111),i=a(21),c=a(7),d=a(58),u=a(181),y=a(60),p=a(87),m=a(425),v=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};const f=Object(p.a)(["defaultBusinessUnit.businessUnitName","defaultBusinessUnit.voyageCurrency.currencyCode","defaultCompany.companyName","defaultCompany.voyageCurrency.currencyCode","vessel.owner.businessPartnerName","vessel.vesselName","isSchedulable","vesselCode"]),b={cubicGrain:"*",doAtSea:"*",doInerting:"*",doInPort:"*",doInPortWorking:"*",draftMeasurement:"*",draftSummer:"*",dwtMeasurement:{measurementCode:"*"},dwtSummer:"*",foCleaning:"*",foGeneratorAtSea:"*",foGeneratorDischarging:"*",foGeneratorLoading:"*",foHeatingPerDay:"*",foInerting:"*",foInPort:"*",foInPortWorking:"*",scrubberFittedMe:"*",speeds:{foConsumption:"*",isActive:"*",isBallast:"*",isLoaded:"*",speed:"*"},vesselCodes:{isSchedulable:"*",vesselCode:"*"},vesselType:{vesselTypeDesc:"*",laytimeTermsMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"}},vesselName:"*",voyageCurrency:{currencyCode:"*"}},g={ballastPort:null,budgetVersionKey:null,cargoQuantity:0,charterer:null,commissionAddress:null,commissionBroker:null,commodity:null,currency:null,dischargePortCost:null,dischargePorts:null,dischargeCurrency:null,euaPrice:null,freightRate:null,isLumpsum:!1,isTemplate:!1,isWorldscale:!1,laycanFrom:null,laycanTo:null,leg:null,loadCurrency:null,loadPorts:null,loadPortCost:null,loadingPorts:null,cargoMeasurement:new n.a({measurementCode:"MT"}),referenceNo:null,scenarioKey:null,status:void 0,vessel:null,voyageVariousCost:null,ballastBonusRevenue:void 0,ballastBonus:void 0,tcHireCommission:void 0,percentExtraAtSea:void 0,dailyHire:void 0,portCall:null,offhire:null};const h={createVoyageFields:{vessel:"*",voyageHeader:"*",voyageCurrency:"*",cargos:"*",scenarios:"*"},defaultVoyageModalState:g,onClearCoaTemplate:e=>Object.assign(Object.assign({},e),{cargoQuantity:g.cargoQuantity,freightRate:g.freightRate,commissionBroker:g.commissionBroker,commissionAddress:g.commissionAddress,voyageVariousCost:g.voyageVariousCost,leg:g.leg,laycanFrom:g.laycanFrom,laycanTo:g.laycanTo,loadPorts:g.loadPorts,dischargePorts:g.dischargePorts,charterer:g.charterer,commodity:g.commodity,isLumpsum:g.isLumpsum,isWorldscale:g.isWorldscale,currency:g.currency}),onSelectCoaTemplate:(e,t)=>{const a=d.a.getLoadingPorts(t),o=d.a.getDischargingPorts(t);return Object.assign(Object.assign({},e),{cargoQuantity:t.cargoQuantity,freightRate:t.freightRate,commissionBroker:t.commissionBroker,commissionAddress:t.commissionAddress,voyageVariousCost:t.variousCost,loadPorts:a,dischargePorts:o,leg:t.leg,laycanFrom:t.laycanFrom,laycanTo:t.laycanTo,charterer:t.charterer,commodity:t.commodity,isLumpsum:t.isLumpsum,isWorldscale:t.isWorldscale,currency:t.freightCurrency})},onVesselChange:(e,t,a,n)=>v(void 0,void 0,void 0,(function*(){var d,p,f,b,g,h,C,O,P,j,T,k,S,I,E,A,M,w,x,F,D,N,R,V,L,U,B,K,q,H,_,W,G,Q,$,z,Y,X,J,Z,ee;const te=null!==(p=null===(d=null==e?void 0:e.vessel)||void 0===d?void 0:d.key)&&void 0!==p?p:-1;let ae=e;const oe=u.a.getDefaultLaytimeTermsMeasurementFromVessel(ae.vessel),re=y.a.getDefaultVoyageCurrency(null!==(f=null==e?void 0:e.vessel)&&void 0!==f?f:new s.a({}));ae=Object.assign(Object.assign({},ae),{currency:new r.a({currencyCode:re}),loadCurrency:new r.a({currencyCode:re}),dischargeCurrency:new r.a({currencyCode:re})});const[ne]=null!==(b=ae.loadPorts)&&void 0!==b?b:[],[le]=null!==(g=ae.dischargePorts)&&void 0!==g?g:[];for(const e of null!==(h=ae.loadPorts)&&void 0!==h?h:[]){const a=t.getVesselCargoHandlingRate(null!==(O=null===(C=null==e?void 0:e.port)||void 0===C?void 0:C.key)&&void 0!==O?O:0,te,null===(P=e.terminal)||void 0===P?void 0:P.key);a&&!n?(e.laytimeTermsValue=null!==(j=null==a?void 0:a.loadRate)&&void 0!==j?j:0,e.laytimeTermsMeasurement=null!==(T=null==a?void 0:a.loadRateMeasurement)&&void 0!==T?T:null,e.laytimeTerms=null!==(k=null==a?void 0:a.loadRateTerms)&&void 0!==k?k:null):n?(null!==(S=e.laytimeTermsValue)&&void 0!==S||(e.laytimeTermsValue=null!==(I=null==a?void 0:a.loadRate)&&void 0!==I?I:0),null!==(E=e.laytimeTermsMeasurement)&&void 0!==E||(e.laytimeTermsMeasurement=(null!==(A=null==a?void 0:a.loadRateMeasurement)&&void 0!==A?A:ne.key===e.key)?oe:null),null!==(M=e.laytimeTerms)&&void 0!==M||(e.laytimeTerms=null!==(w=null==a?void 0:a.loadRateTerms)&&void 0!==w?w:null)):(e.laytimeTermsMeasurement=ne.key===e.key?oe:null,e.laytimeTermsValue=0,e.laytimeTerms=null)}for(const e of null!==(x=ae.dischargePorts)&&void 0!==x?x:[]){const a=t.getVesselCargoHandlingRate(null!==(D=null===(F=null==e?void 0:e.port)||void 0===F?void 0:F.key)&&void 0!==D?D:0,te,null===(N=e.terminal)||void 0===N?void 0:N.key);a&&!n?(e.laytimeTermsValue=null!==(R=null==a?void 0:a.dischargeRate)&&void 0!==R?R:0,e.laytimeTermsMeasurement=null!==(V=null==a?void 0:a.dischargeRateMeasurement)&&void 0!==V?V:null,e.laytimeTerms=null!==(L=null==a?void 0:a.dischargeRateTerms)&&void 0!==L?L:null):n?(null!==(U=e.laytimeTermsValue)&&void 0!==U||(e.laytimeTermsValue=null!==(B=null==a?void 0:a.dischargeRate)&&void 0!==B?B:0),null!==(K=e.laytimeTermsMeasurement)&&void 0!==K||(e.laytimeTermsMeasurement=(null!==(q=null==a?void 0:a.dischargeRateMeasurement)&&void 0!==q?q:le.key===e.key)?oe:null),null!==(H=e.laytimeTerms)&&void 0!==H||(e.laytimeTerms=null!==(_=null==a?void 0:a.dischargeRateTerms)&&void 0!==_?_:null)):(e.laytimeTermsMeasurement=le.key===e.key?oe:null,e.laytimeTermsValue=0,e.laytimeTerms=null)}const se=o.a.get(c.a.Store);if(a){const e=i.a.getTSModelsBuilt(se.getState(),l.a.fleetplanvoyage,m.d,m.a);if(e&&e.length>0){const t=y.a.getLastPortCall(null!==(Q=null===(G=null===(W=e[0])||void 0===W?void 0:W.voyage)||void 0===G?void 0:G.portCalls)&&void 0!==Q?Q:[]);return ae=Object.assign(Object.assign({},ae),{ballastPort:null==t?void 0:t.port}),ae}}else if(te){const e=yield((e,t)=>v(void 0,void 0,void 0,(function*(){return yield e.getVesselFleetPlans(t)})))(t,te),a=e?y.a.getLastPortCall(null!==(Y=null===(z=null===($=e[0])||void 0===$?void 0:$.voyage)||void 0===z?void 0:z.portCalls)&&void 0!==Y?Y:[]):{};if((null===(Z=null===(J=null===(X=e[0])||void 0===X?void 0:X.voyage)||void 0===J?void 0:J.voyageHeader)||void 0===Z?void 0:Z.isLastVoyage)&&null!==ae.tcIn)ae=Object.assign(Object.assign({},ae),{ballastPort:null,tcIn:null});else if(a)return ae=Object.assign(Object.assign({},ae),{ballastPort:null==a?void 0:a.port}),ae}else{const e=i.a.getTSModelsBuilt(se.getState(),l.a.vesselopenposition,m.e,m.b);e&&e.length>0&&(ae=Object.assign(Object.assign({},ae),{ballastPort:"AT SEA"===(null===(ee=e[0].openPositionPort)||void 0===ee?void 0:ee.portName)?null:e[0].openPositionPort}))}return ae})),daysExtraFields:{dataloyPreferenceName:"Days extra in port",fields:{prefName:"*",prefDefault:"*"}},percentExtraFields:{dataloyPreferenceName:"Percent extra at sea",fields:{prefName:"*",prefDefault:"*"}},selectedCoaFields:{cargoPorts:{laytimeTerms:{laytimeTerms:"*"},laytimeTermsMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},laytimeTermsValue:"*",port:{portName:"*"},reasonForCall:{reasonForCall:"*"},cargoPortSequence:"*",freightRate:"*"},cargoQuantity:"*",commissionAddress:"*",commissionBroker:"*",freightRate:"*",freightCurrency:{currencyCode:"*",currencyName:"*"},laycanFrom:"*",laycanTo:"*",leg:"*",variousCost:"*",charterer:{businessPartnerName:"*"},commodity:{commodityName:"*"}},vesselCodeFields:f,currencyPrefFields:{dataloyPreferenceName:"Use port currency",fields:{prefName:"*",prefDefault:"*"}},isBunkeringExtraPortVoyageWithoutCargo:function(e){var t,a;const{portCall:o}=e;return["Bunkering","Extra Port"].includes(null!==(a=null===(t=null==o?void 0:o.reasonForCall)||void 0===t?void 0:t.reasonForCallDesc)&&void 0!==a?a:"")},isDryDockVoyageWithoutCargo:function(e){var t;const{portCall:a}=e;return"Dry Dock"===(null===(t=null==a?void 0:a.reasonForCall)||void 0===t?void 0:t.reasonForCallDesc)}}},425:function(e,t,a){"use strict";a.d(t,"e",(function(){return de})),a.d(t,"d",(function(){return ue})),a.d(t,"b",(function(){return pe})),a.d(t,"a",(function(){return me})),a.d(t,"c",(function(){return ve}));a(59);var o=a(107),r=a(29),n=a(9),l=a(7),s=a(1),i=a(223),c=a(20),d=a(185),u=a(300),y=a(31),p=a(21),m=a(142),v=a(111),f=a(235),b=a(12),g=a(68),h=a(96),C=a(28),O=a(64),P=a(62),j=a(19),T=a(60),k=a(101),S=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};function I(e){var t,a,o,r;const{reactKeyPrefix:n,voyageModalState:l,updateVoyageModalState:i,controller:c,userLocale:d,i:u,selectedVessel:y,portTerminals:p,vesselIsFocused:m,setVesselIsFocused:v,isOpenedFromFas:f}=e,{model:I,common:E}=u.getLanguageFile(),{vessel:A,scenarioKey:M}=l,w=(null!==(t=l.loadPorts)&&void 0!==t?t:[]).map(e=>{const{terminal:t,port:a}=e;return{port:a,terminal:t,label:t?`${null==a?void 0:a.portName} - ${null==t?void 0:t.terminalName}`:null==a?void 0:a.portName,key:t?Number(`${null==a?void 0:a.key}${t.key}`):null==a?void 0:a.key,sequence:e.cargoPortSequence}}),x=(null!==(a=l.dischargePorts)&&void 0!==a?a:[]).map(e=>{const{terminal:t,port:a}=e,o=t?`${null==a?void 0:a.portName} - ${null==t?void 0:t.terminalName}`:null==a?void 0:a.portName,r=t?Number(`${null==a?void 0:a.key}${t.key}`):null==a?void 0:a.key,n=e.cargoPortSequence;return{port:e.port,terminal:null==e?void 0:e.terminal,label:o,key:r,sequence:n}});let F=new k.a({currencyCode:"USD"});A&&(F=new k.a({currencyCode:T.a.getDefaultVoyageCurrency(A)}));const D=(M?"filter=scenarios(EQ)"+M:"filter=scenarios.scenarioCode(EQ)MASTER")+"&";const N={reactKeyPrefix:n,disableUpdate:!0,fieldOptions:[{fieldName:"vessel",disabled:!!y,formControlProps:{required:!0},label:I.vessel,typeaheadProps:{fields:{vesselName:"*"},defaultSelectedOptions:A,shouldPreload:!0,query:(f?D:"")+"sort=vesselName(ASI)",onFocus:()=>v(!0)},onUpdateOverride:e=>{e&&function(e){S(this,void 0,void 0,(function*(){const t=yield c.loadVesselValues(e.key);t&&i("vessel",t)}))}(e)},breakpoints:b.h,autoFocus:!0},{fieldName:"ballastPort",label:I.ballastPort,typeaheadProps:{fields:{portName:"*"},defaultSelectedOptions:l.ballastPort,query:h.d},onUpdateOverride:e=>i("ballastPort",e),disabled:!m&&!A,breakpoints:b.h},{fieldName:"port",disabled:!A,overrideFieldType:"multiple",formControlProps:{required:!0},label:I.loadPorts,overrideObject:new O.a({}),overrideType:s.a.cargoport,multipleValuesInputProps:{options:p,optionLabelField:"label",selectedValues:w,allowDuplicates:!0},onUpdateOverride:e=>i("loadPorts",e)},{fieldName:"port",disabled:!l.vessel,overrideFieldType:"multiple",formControlProps:{required:!0},label:I.dischargePorts,overrideObject:new O.a({}),overrideType:s.a.cargoport,multipleValuesInputProps:{options:p,optionLabelField:"label",selectedValues:x,allowDuplicates:!0},onUpdateOverride:e=>i("dischargePorts",e)},{fieldName:"portCost",label:E.loadingPortCost,numberInputProps:{maskSettings:C.a.mask4},breakpoints:{lg:4,xl:4,md:4,sm:4,xs:4},overrideObject:new g.a({}),overrideType:s.a.portcall,onUpdateOverride:e=>i("loadPortCost",e)},{fieldName:"voyageCurrency",label:I.currency,overrideObject:new k.a({}),breakpoints:{lg:2,xl:2,md:2,sm:2,xs:2},typeaheadProps:{objectPaths:["currencyCode"],shouldPreload:!0,defaultSelectedOptions:null!==(o=l.loadCurrency)&&void 0!==o?o:F,isClearable:!1},onUpdateOverride:e=>i("loadCurrency",e)},{fieldName:"portCost",label:E.dischargingPortCost,numberInputProps:{maskSettings:C.a.mask4},breakpoints:{lg:4,xl:4,md:4,sm:4,xs:4},overrideObject:new g.a({}),overrideType:s.a.portcall,onUpdateOverride:e=>i("dischargePortCost",e)},{fieldName:"voyageCurrency",label:I.currency,overrideObject:new k.a({}),breakpoints:{lg:2,xl:2,md:2,sm:2,xs:2},typeaheadProps:{objectPaths:["currencyCode"],shouldPreload:!0,defaultSelectedOptions:null!==(r=l.dischargeCurrency)&&void 0!==r?r:F,isClearable:!1},onUpdateOverride:e=>i("dischargeCurrency",e)},{InputProps:{endAdornment:F.currencyCode},fieldName:"euaPrice",label:E.euaPrice,numberInputProps:{maskSettings:C.a.mask2},breakpoints:b.g,onUpdateOverride:e=>i("euaPrice",e)}],object:new P.a({}),type:s.a.voyage,userLocale:d};return Object(j.a)(N)}var E=a(74),A=a(81);function M(e){var t;const{reactKeyPrefix:a,voyageModalState:o,updateVoyageModalState:r,userLocale:n,i:l}=e,{model:i}=l.getLanguageFile(),c=Object(A.a)(o,"loadPorts[0]",void 0),d=Object(A.a)(o,"dischargePorts[0]",void 0),u={reactKeyPrefix:a,disableUpdate:!0,fieldOptions:[{fieldName:"laytimeTermsValue",label:i.loadRate,disabled:!c,numberInputProps:{maskSettings:C.a.mask4},overrideObject:new O.a({laytimeTermsValue:null!==(t=null==c?void 0:c.laytimeTermsValue)&&void 0!==t?t:0}),overrideType:s.a.cargoport,breakpoints:b.h,onUpdateOverride:e=>{r("loadPorts[0].laytimeTermsValue",e)}},{fieldName:"laytimeTermsMeasurement",disabled:!c,typeaheadProps:{fields:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},defaultSelectedOptions:null==c?void 0:c.laytimeTermsMeasurement,reactKeyPrefix:a+"-load-laytimeterms",shouldPreload:!0},label:i.rule,overrideObject:new O.a({}),overrideType:s.a.cargoport,breakpoints:b.h,onUpdateOverride:e=>{r("loadPorts[0].laytimeTermsMeasurement",e)}},{fieldName:"laytimeTerms",disabled:!c,typeaheadProps:{defaultSelectedOptions:null==c?void 0:c.laytimeTerms,shouldPreload:!0,objectPaths:["laytimeTerms"]},label:i.loadLaytimeTerms,overrideObject:new E.a({}),overrideType:s.a.cargo,breakpoints:b.h,onUpdateOverride:e=>{r("loadPorts[0].laytimeTerms",e)}},{fieldName:"daysExtraInPort",disabled:!c,label:i.daysExtraInPort,numberInputProps:{maskSettings:C.a.mask2},breakpoints:b.h,overrideObject:new g.a({daysExtraInPort:o.loadDaysExtraInPort}),overrideType:s.a.portcall,onUpdateOverride:e=>r("loadDaysExtraInPort",e)},{fieldName:"laytimeTermsValue",disabled:!d,label:i.dischargeRate,numberInputProps:{maskSettings:C.a.mask4},overrideObject:new O.a({laytimeTermsValue:null==d?void 0:d.laytimeTermsValue}),overrideType:s.a.cargoport,breakpoints:b.h,onUpdateOverride:e=>{r("dischargePorts[0].laytimeTermsValue",e)}},{fieldName:"laytimeTermsMeasurement",disabled:!d,typeaheadProps:{fields:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},defaultSelectedOptions:null==d?void 0:d.laytimeTermsMeasurement,reactKeyPrefix:a+"-discharge-laytimeterms"},label:i.rule,overrideObject:new O.a({}),overrideType:s.a.cargoport,breakpoints:b.h,onUpdateOverride:e=>{r("dischargePorts[0].laytimeTermsMeasurement",e)}},{fieldName:"laytimeTerms",disabled:!d,typeaheadProps:{defaultSelectedOptions:null==d?void 0:d.laytimeTerms,shouldPreload:!0,objectPaths:["laytimeTerms"]},label:i.dischargeLaytimeTerms,overrideObject:new E.a({}),overrideType:s.a.cargo,breakpoints:b.h,onUpdateOverride:e=>{r("dischargePorts[0].laytimeTerms",e)}},{fieldName:"daysExtraInPort",disabled:!d,label:i.daysExtraInPort,numberInputProps:{maskSettings:C.a.mask2},breakpoints:b.h,overrideObject:new g.a({daysExtraInPort:o.dischargeDaysExtraInPort}),overrideType:s.a.portcall,onUpdateOverride:e=>r("dischargeDaysExtraInPort",e)}],object:new P.a({}),type:s.a.voyage,userLocale:n};return Object(j.a)(u)}var w=a(255),x=a(592),F=a(4),D=a(83),N=a(104),R=a(241),V=a(108),L=a(146);function U(e){const{reactKeyPrefix:t,voyageModalState:a,updateVoyageModalState:o,userLocale:r,i:n}=e,{model:l,alerts:i}=n.getLanguageFile(),c=Object(A.a)(a,"laycanFrom",void 0),d=Object(A.a)(a,"laycanTo",void 0),u=!(!c||!d)&&c>d,y={reactKeyPrefix:t,disableUpdate:!0,fieldOptions:[{fieldName:"leg",formControlProps:{required:!1},label:l.trade,overrideObject:new E.a({}),overrideType:s.a.cargo,typeaheadProps:{defaultSelectedOptions:a.leg,shouldPreload:!0},onUpdateOverride:e=>o("leg",e)},{dateInputProps:{error:u},fieldName:"eventLogDate",formHelperText:u?i.cancellingAfterCommencement:void 0,label:l.laydaysCommences,onUpdateOverride:e=>o("laycanFrom",e),overrideObject:new L.a({eventLogDate:c}),overrideType:s.a.eventlog,breakpoints:b.h},{dateInputProps:{error:u},fieldName:"eventLogDate",formHelperText:u?i.cancellingAfterCommencement:void 0,label:l.laydaysCancelling,onUpdateOverride:e=>o("laycanTo",e),overrideObject:new L.a({eventLogDate:d}),overrideType:s.a.eventlog,breakpoints:b.h},{fieldName:"referenceNo",overrideObject:new V.a({}),onUpdateOverride:e=>o("referenceNo",e),overrideType:s.a.voyageheader}],object:new P.a({}),type:s.a.voyage,userLocale:r};return Object(j.a)(y)}var B=a(63),K=a(0),q=a.n(K),H=a(130),_=a(78),W=a(172);function G(e){var t,a;const{reactKeyPrefix:o,voyageModalState:r,updateVoyageModalState:n,userLocale:l,i:i}=e,{model:c,tc:d}=i.getLanguageFile(),{currency:u,tcIn:y}=r,p={reactKeyPrefix:o,disableUpdate:!0,fieldOptions:y?[{label:c.tcInContract,overrideComponent:q.a.createElement(H.a,{variant:"subtitle1"},`${null!==(a=null===(t=y.owner)||void 0===t?void 0:t.businessPartnerName)&&void 0!==a?a:d.noOwnerOnTCContract}, ${_.a.getFormattedDateString(null==y?void 0:y.cpDate,l,!0)}`),breakpoints:b.h}]:[{fieldName:"tcRate",label:c.dailyHire,InputProps:{endAdornment:null==u?void 0:u.currencyCode},numberInputProps:{maskSettings:C.a.mask3},disabled:!!y,breakpoints:b.h,onUpdateOverride:e=>n("dailyHire",e)},{fieldName:"ballastBonus",label:c.ballastBonus,overrideObject:new W.a({ballastBonus:r.ballastBonus}),overrideType:s.a.tc,InputProps:{endAdornment:null==u?void 0:u.currencyCode},numberInputProps:{maskSettings:C.a.mask3},disabled:!!y,breakpoints:b.h,onUpdateOverride:e=>n("ballastBonus",e)},{fieldName:"commissionAddress",label:c.commissionAddress,disabled:!!y,overrideObject:new W.a({commissionAddress:r.tcHireCommission}),overrideType:s.a.tc,breakpoints:b.h,InputProps:{endAdornment:B.a.Percent},numberInputProps:{maskSettings:C.a.mask2},onUpdateOverride:e=>n("tcHireCommission",e)}],object:new P.a({}),type:s.a.voyage,userLocale:l};return Object(j.a)(p)}var Q=a(301),$=a(86),z=a(260);function Y(e){var t;const{reactKeyPrefix:a,voyageModalState:o,updateVoyageModalState:r,userLocale:n,i:l}=e,{model:i}=l.getLanguageFile(),{vessel:c}=o;let d=new k.a({currencyCode:z.a.getCurrencyCode()});c&&(d=new k.a({currencyCode:T.a.getDefaultVoyageCurrency(c)}));const u={reactKeyPrefix:a,disableUpdate:!0,fieldOptions:[{fieldName:"charterer",label:i.charterer,overrideObject:new E.a({charterer:o.charterer}),overrideType:s.a.cargo,typeaheadProps:{reactKeyPrefix:a+"-charterer",defaultSelectedOptions:o.charterer,shouldPreload:!0,objectPaths:$.b.businessPartner,query:h.b,fields:$.a.businessPartner},onUpdateOverride:e=>r("charterer",e),breakpoints:b.e},{fieldName:"cargoQuantity",label:i.quantity,numberInputProps:{maskSettings:C.a.mask4},overrideObject:new O.a({cargoQuantity:o.cargoQuantity}),overrideType:s.a.cargoport,onUpdateOverride:e=>{r("cargoQuantity",e)},breakpoints:b.h},{fieldName:"cargoMeasurement",label:i.measurement,overrideObject:new E.a({}),overrideType:s.a.cargo,breakpoints:b.h,typeaheadProps:{reactKeyPrefix:a+"-cargo-measurement",defaultSelectedOptions:o.cargoMeasurement,shouldPreload:!0,isClearable:!1,objectPaths:["measurementCode"]},onUpdateOverride:e=>{r("cargoMeasurement",e)}},{fieldName:"commodity",label:i.commodity,overrideObject:new E.a({commodity:o.commodity}),overrideType:s.a.cargo,typeaheadProps:{reactKeyPrefix:a+"-commodity",defaultSelectedOptions:o.commodity,shouldPreload:!0,fields:{commodityMeasurement:{measurementCode:"*"},commodityName:"*"},objectPaths:["commodityName"]},breakpoints:b.e,onUpdateOverride:e=>{r("commodity",e),e&&e.commodityMeasurement&&r("cargoMeasurement",null==e?void 0:e.commodityMeasurement)}},{fieldName:"freightRate",label:i.freightRate,numberInputProps:{maskSettings:C.a.mask19},overrideObject:new O.a({freightRate:o.freightRate}),overrideType:s.a.cargoport,breakpoints:b.f,onUpdateOverride:e=>{r("freightRate",e)}},{fieldName:"freightCurrency",label:i.currency,overrideObject:new E.a({}),overrideType:s.a.cargo,breakpoints:b.f,typeaheadProps:{reactKeyPrefix:a+"-freight-currency",defaultSelectedOptions:null!==(t=o.currency)&&void 0!==t?t:d,shouldPreload:!0,isClearable:!1,objectPaths:["currencyCode"]},onUpdateOverride:e=>r("currency",e)},{fieldName:"isWorldscale",label:i.rule,overrideObject:new E.a({}),overrideType:s.a.cargo,overrideFieldType:"object",breakpoints:b.h,typeaheadProps:{isClearable:!1,options:Object(Q.a)(l),defaultSelectedOptions:Object(Q.d)(l,new E.a({isWorldScale:o.isWorldscale,isLumpsum:o.isLumpsum}))},onUpdateOverride:e=>{r("isWorldscale",e)}},{InputProps:{endAdornment:B.a.Percent},fieldName:"commissionBroker",label:i.brokerCom,numberInputProps:{maskSettings:C.a.mask2},overrideObject:new E.a({commissionBroker:o.commissionBroker}),overrideType:s.a.cargo,breakpoints:b.f,onUpdateOverride:e=>r("commissionBroker",e)},{InputProps:{endAdornment:B.a.Percent},fieldName:"commissionAddress",label:i.addressCom,numberInputProps:{maskSettings:C.a.mask2},overrideObject:new E.a({commissionAddress:o.commissionAddress}),overrideType:s.a.cargo,breakpoints:b.f,onUpdateOverride:e=>r("commissionAddress",e)},{InputProps:{endAdornment:d.currencyCode},fieldName:"variousCost",label:i.variousCost,numberInputProps:{maskSettings:C.a.mask4},overrideObject:new E.a({commissionAddress:o.voyageVariousCost}),overrideType:s.a.cargo,breakpoints:b.h,onUpdateOverride:e=>r("voyageVariousCost",e)}],object:new P.a({}),type:s.a.voyage,userLocale:n};return Object(j.a)(u)}var X,J,Z,ee,te,ae,oe,re=a(117),ne=a(222),le=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l},se=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ie=function(e,t){return function(a,o){t(a,o,e)}},ce=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};const de={openPositionPort:{portName:"*"}},ue={voyage:{portCalls:{portCallSequence:"*",port:{portName:"*"}}}},ye={dischargeRate:"*",dischargeRateTerms:{laytimeTerms:"*"},dischargeRateMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},loadRate:"*",loadRateTerms:{laytimeTerms:"*"},loadRateMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},port:f.a,terminal:"*",vessel:"*"},pe="CREATE_VOYAGE_OPEN_PORT_ID",me="CREATE_VOYAGE_OPEN_PORT_FPVS_ID";let ve=class{constructor(e,t,a,o,r,n,l){this.tsModelActions=e,this.fleetPlanVoyageApi=t,this.voyageController=a,this.store=o,this.cargoDrawerController=r,this.tsmodelApi=n,this.cacheController=l}loadVesselCargoHandlingRates(e){return ce(this,void 0,void 0,(function*(){const t="filter=vessel.key(EQ)"+e;yield this.tsModelActions.loadMultipleAction({fields:ye,query:t,type:s.a.vesselcargohandlingrate})}))}loadVesselValues(e){return ce(this,void 0,void 0,(function*(){const t=Object.assign(Object.assign({},w.b),{vesselCodes:w.a.vesselCodeFields});return yield this.tsModelActions.loadSingleAction({fields:t,key:e,type:s.a.vessel}),p.a.getTSModelBuilt(this.store.getState(),s.a.vessel,e,t)}))}loadPortValues(e){return ce(this,void 0,void 0,(function*(){const t=s.a.port;return yield this.tsModelActions.loadSingleAction({fields:{country:{currency:"*"}},key:e,type:t}),p.a.getTSModelBuilt(this.store.getState(),t,e,{country:{currency:{currencyCode:"* "}}})}))}loadOpenPort(e,t,a){return ce(this,void 0,void 0,(function*(){return a&&(yield this.loadOpenPortFleetPlanVoyage(e,t,a)),yield this.loadOpenPortOpenPosition(e,t,a),Promise.resolve()}))}loadOpenPortOpenPosition(e,t,a){return ce(this,void 0,void 0,(function*(){const o=[{field:"vessel.key",queryParamName:"vessel.key",value:a||e,operator:F.c.EQUALS,type:F.d.NUMBER,filterGroupCode:""},{field:t?"scenario.key":"scenario.scenarioCode",queryParamName:t?"scenario.key":"scenario.scenarioCode",value:t||"MASTER",operator:F.c.EQUALS,type:F.d.STRING,filterGroupCode:""}];yield this.tsModelActions.loadMultipleAction({fields:de,filters:o,type:s.a.vesselopenposition,identifier:pe,overwriteKeysOnLoad:!0})}))}loadOpenPortFleetPlanVoyage(e,t,a){const o=[{field:"vessel.key",queryParamName:"vessel.key",value:a||e,operator:F.c.EQUALS,type:F.d.NUMBER,filterGroupCode:""},{field:t?"fleetPlan.scenario.key":"fleetPlan.scenario.scenarioCode",queryParamName:t?"fleetPlan.scenario.key":"fleetPlan.scenario.scenarioCode",value:t||"MASTER",operator:F.c.EQUALS,type:F.d.STRING,filterGroupCode:""}];return this.tsModelActions.loadMultipleAction({fields:ue,filters:o,type:s.a.fleetplanvoyage,identifier:me,overwriteKeysOnLoad:!0,query:"pageNumber=1&limit=1&sort=fleetPlanSequence(DS)"})}getVesselCargoHandlingRate(e,t,a){const o=p.a.getAllTSModelsBuilt(this.store.getState(),s.a.vesselcargohandlingrate,ye);return(null==o?void 0:o.length)?o.filter(o=>{var r,n,l,s,i;return a?(null===(r=null==o?void 0:o.terminal)||void 0===r?void 0:r.key)===a&&(null===(n=null==o?void 0:o.port)||void 0===n?void 0:n.key)===e&&(null===(l=null==o?void 0:o.vessel)||void 0===l?void 0:l.key)===t:null===(null==o?void 0:o.terminal)&&(null===(s=null==o?void 0:o.port)||void 0===s?void 0:s.key)===e&&(null===(i=null==o?void 0:o.vessel)||void 0===i?void 0:i.key)===t})[0]:null}getVesselFromRedux(e){return p.a.getTSModelBuilt(this.store.getState(),s.a.vessel,e,Object.assign(Object.assign({},w.b),{vesselCodes:w.a.vesselCodeFields}))}handleFleetPlanVoyage(e,t){var a,o;return ce(this,void 0,void 0,(function*(){const r=m.a.get(this.store.getState(),s.a.scenario),n=p.a.getTSModelBuilt(this.store.getState(),s.a.scenario,null!=r?r:0,{key:"*",fleetPlan:{key:"*"}}),l={refreshFleetPlan:!1,status:new re.a({statusTypeCode:"SCH"})};if(t&&t.voyageHeader&&t.vessel&&(null==n?void 0:n.fleetPlan)&&e){const r=new v.a({key:e}),s=yield this.fleetPlanVoyageApi.getLastFleetPlanVoyage(r,n.key),i=s.length>0?s[0].sequence+1:1;return yield this.voyageController.allocateVoyage(t,r,i,!1,null!==(o=null===(a=null==n?void 0:n.fleetPlan)||void 0===a?void 0:a.key)&&void 0!==o?o:null,l)}}))}getPostableVoyageHeader(e,{referenceNo:t,leg:a},o){const r=e?o?"SCH":"SCU":void 0;if(t||r||a)return{voyageStatus:r,referenceNo:t,leg:null==a?void 0:a.key}}overrideGetPostableData(e,t,a,o){var r,n,l,s;const{vessel:i,loadPorts:c,dischargePorts:d,scenarioKey:u,loadPortCost:y,dischargePortCost:p,loadDaysExtraInPort:m,dischargeDaysExtraInPort:v,loadCurrency:f,dischargeCurrency:b}=t;if(!i||!(null==c?void 0:c.length)||!(null==d?void 0:d.length))return;null===(r=null==t?void 0:t.laycanFrom)||void 0===r||r.setHours(0),null===(n=null==t?void 0:t.laycanFrom)||void 0===n||n.setMinutes(0),null===(l=null==t?void 0:t.laycanTo)||void 0===l||l.setHours(23),null===(s=null==t?void 0:t.laycanTo)||void 0===s||s.setMinutes(59);const g=x.a.generatePortCalls({loadPorts:c,loadCurrency:f,loadPortCost:null!=y?y:0,dischargePorts:d,dischargePortCost:null!=p?p:0,dischargeCurrency:b,daysExtraInPort:m,dischargeDaysExtraInPort:v}),h=this.getPostableCargoPorts(null!=a?a:void 0,t,void 0,g),C=x.a.generateDefaultVoyageObject(t,a,null!=h?h:[]);return Object.assign(Object.assign({},C),{voyageHeader:this.getPostableVoyageHeader(e,t,o),scenarios:u?[{key:u}]:void 0})}getPostableCargoPorts(e,t,a,o){var r,n,l,s;const i=a?null!==(r=null==a?void 0:a.portCallsFromVoyage)&&void 0!==r?r:[]:null!==(s=null!==(l=null===(n=null==e?void 0:e.voyage)||void 0===n?void 0:n.portCallsFromVoyage)&&void 0!==l?l:o)&&void 0!==s?s:[],c=[],d=[];i.forEach(e=>{var t;const a=null===(t=e.reasonForCall)||void 0===t?void 0:t.reasonForCall;"L"===a?c.push(e):"D"===a&&d.push(e)});let u=[];return c&&d&&(u=x.a.generateCargoPortArray(c,d,e,t)),u}getVesselFleetPlans(e){return ce(this,void 0,void 0,(function*(){return yield this.fleetPlanVoyageApi.getFleetPlanVoyage(e).then(e=>e)}))}getModalTitle(e){const{voyages:t}=e.getLanguageFile();return t.createVoyageCharter}deleteCopiedCoaTemplate(e){this.cargoDrawerController.deleteCargo(e.key)}getSections(e){const{common:t,model:a}=e.i.getLanguageFile();return[{breakpoints:{xs:12,sm:6},sections:[{fields:I(e)},{title:a.cargo,fields:Y(e)}]},{breakpoints:{xs:12,sm:6},sections:[{fields:M(e)},{title:t.timeCharterIn,fields:G(e)},{fields:U(e)}]}]}getTcFromVessel(e){var t;return ce(this,void 0,void 0,(function*(){const a=R.a.getUserData(this.store.getState());return null!==a?yield this.tsmodelApi.getMultiple({authdata:null!==(t=a.authdata)&&void 0!==t?t:"",fields:o.i,type:s.a.tc,query:"sort=cpDate(DSI)&filter=isTcIn(EQ)true&filter=vesselCode.vessel.key(EQ)"+e,pageItemLimit:1,pageNumber:1}).then(e=>e.length>0?e[0]:null):Promise.reject()}))}preloadReasonForOffhire(){this.cacheController.initCache({type:s.a.reasonforoffhire,objectPaths:["reasonForOffhire"],fields:{key:"*",reasonForOffhire:"*"},forceUseCache:!0})}isConfirmDisabled(e){const{laycanFrom:t,laycanTo:a,dischargePorts:o,loadPorts:r}=e,n=!t||!a||a>=t;return!(e.vessel&&(null==o?void 0:o.length)&&(null==r?void 0:r.length)&&n)}};ve=le([Object(n.injectable)(),ie(0,Object(n.inject)(l.a.ITSModelActionsAsync)),ie(1,Object(n.inject)(l.a.IFasFleetPlanVoyageApi)),ie(2,Object(n.inject)(l.a.IVoyageController)),ie(3,Object(n.inject)(l.a.Store)),ie(4,Object(n.inject)(c.a.ICargoDrawerController)),ie(5,Object(n.inject)(D.a.ITSModelApi)),ie(6,Object(n.inject)(l.a.ITypeaheadCacheController)),se("design:paramtypes",["function"==typeof(X=void 0!==r.ITSModelActionsAsync&&r.ITSModelActionsAsync)?X:Object,"function"==typeof(J=void 0!==d.IFasFleetPlanVoyageApi&&d.IFasFleetPlanVoyageApi)?J:Object,"function"==typeof(Z=void 0!==u.IVoyageController&&u.IVoyageController)?Z:Object,"function"==typeof(ee=void 0!==y.Store&&y.Store)?ee:Object,"function"==typeof(te=void 0!==i.ICargoDrawerController&&i.ICargoDrawerController)?te:Object,"function"==typeof(ae=void 0!==N.ITSModelApi&&N.ITSModelApi)?ae:Object,"function"==typeof(oe=void 0!==ne.ITypeaheadCacheController&&ne.ITypeaheadCacheController)?oe:Object])],ve)},435:function(e,t,a){"use strict";a.d(t,"a",(function(){return Y}));a(59),a(10),a(11);var o=a(0),r=a.n(o),n=a(97),l=a(46),s=a(6),i=a(1),c=a(3),d=a(15),u=a(27),y=a(20),p=a(456),m=a(502),v=a(7),f=a(230),b=a(129),g=a(443),h=a(62),C=a(877),O=a(417),P=a(2361),j=a(981),T=a(44),k=a(47),S=a(42),I=a(255),E=a(190),A=a(14),M=a(221),w=a(301),x=a(595),F=a(68),D=a(285),N=a(181),R=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};const V={createUpdateDischargePorts:function(e,t,a,o){var r,n,l,s;const i=null!==(n=null===(r=null==t?void 0:t.vessel)||void 0===r?void 0:r.key)&&void 0!==n?n:-1;let{dischargeCurrency:c}=t;const d=new M.a({reasonForCall:"D",reasonForCallDesc:"Discharging"}),{updatedCargoPorts:u,newCargoPort:y}=x.a.handlePorts(a,null!==(l=null==t?void 0:t.dischargePorts)&&void 0!==l?l:[],d,null!=o?o:void 0);let p=null;return i>0&&(null==y?void 0:y.port)&&(p=e.getVesselCargoHandlingRate(y.port.key,i,null===(s=null==y?void 0:y.terminal)||void 0===s?void 0:s.key)),p?u.forEach(e=>{var t,a,o;e.key===(null==y?void 0:y.key)&&(e.laytimeTermsValue=null!==(t=null==p?void 0:p.dischargeRate)&&void 0!==t?t:0,e.laytimeTermsMeasurement=null!==(a=null==p?void 0:p.dischargeRateMeasurement)&&void 0!==a?a:null,e.laytimeTerms=null!==(o=null==p?void 0:p.dischargeRateTerms)&&void 0!==o?o:null)}):1===u.length&&u.forEach(e=>{var a,o,r;e.key===(null==y?void 0:y.key)&&(e.laytimeTermsMeasurement=N.a.getDefaultLaytimeTermsMeasurementFromVessel(t.vessel),t.usePortCurrency&&(c=null!==(r=null===(o=null===(a=e.port)||void 0===a?void 0:a.country)||void 0===o?void 0:o.currency)&&void 0!==r?r:t.loadCurrency))}),Object.assign(Object.assign({},t),{dischargePorts:u,dischargeCurrency:c})},createUpdateLoadPorts:function(e,t,a,o){var r,n,l,s,i,c,d;return R(this,void 0,void 0,(function*(){const u=null!==(n=null===(r=null==t?void 0:t.vessel)||void 0===r?void 0:r.key)&&void 0!==n?n:-1;let{loadCurrency:y}=t;const p=new M.a({reasonForCall:"L",reasonForCallDesc:"Loading"}),{updatedCargoPorts:m,newCargoPort:v}=x.a.handlePorts(a,null!==(l=null==t?void 0:t.loadPorts)&&void 0!==l?l:[],p,null!=o?o:void 0);let f=null;(null===(s=null==v?void 0:v.port)||void 0===s?void 0:s.key)&&(f=yield e.loadPortValues(null==v?void 0:v.port.key));let b=null;if(u>0&&(null==v?void 0:v.port)&&(b=e.getVesselCargoHandlingRate(v.port.key,u,null===(i=null==v?void 0:v.terminal)||void 0===i?void 0:i.key)),b)m.forEach(e=>{var t,a,o;e.key===(null==v?void 0:v.key)&&(e.laytimeTermsValue=null!==(t=null==b?void 0:b.loadRate)&&void 0!==t?t:0,e.laytimeTermsMeasurement=null!==(a=null==b?void 0:b.loadRateMeasurement)&&void 0!==a?a:null,e.laytimeTerms=null!==(o=null==b?void 0:b.loadRateTerms)&&void 0!==o?o:null)});else if(1===m.length){const e=null!==(d=null===(c=null==f?void 0:f.country)||void 0===c?void 0:c.currency)&&void 0!==d?d:t.loadCurrency;m.forEach(a=>{a.key===(null==v?void 0:v.key)&&(a.laytimeTermsMeasurement=N.a.getDefaultLaytimeTermsMeasurementFromVessel(t.vessel),t.usePortCurrency&&(y=e))})}return Object.assign(Object.assign({},t),{loadPorts:m,loadCurrency:y})}))},updateFreightRate:function(e,t){const a=t>9999;return Object.assign(Object.assign({},e),{freightRate:t,isLumpsum:a})},updateIsWorldscale:function(e,t){const a=A.a.get(c.a.IInternationalization),{isWorldscale:o,isLumpsum:r}=Object(w.b)(a,t);return Object.assign(Object.assign({},e),{isWorldscale:o,isLumpsum:r})},updateLoadCurrency:function(e,t){return Object.assign(Object.assign({},e),{loadCurrency:t})},updateDischargeCurrency:function(e,t){return Object.assign(Object.assign({},e),{dischargeCurrency:t})},updatePortCall:function(e,t){var a;const o=null!==(a=e.portCall)&&void 0!==a?a:new F.a({});return void 0!==t.port?o.port=t.port:void 0!==t.reasonForCall?o.reasonForCall=t.reasonForCall:void 0!==t.daysExtraInPort?o.daysExtraInPort=t.daysExtraInPort:void 0!==t.portCostCurrency&&(o.portCostCurrency=t.portCostCurrency),Object.assign(Object.assign({},e),{portCall:o})},updateOffhire:function(e,t){var a;const o=null!==(a=e.offhire)&&void 0!==a?a:new D.a({});return void 0!==t.offhireStartDate?o.offhireStartDate=t.offhireStartDate:void 0!==t.offhireEndDate&&(o.offhireEndDate=t.offhireEndDate),Object.assign(Object.assign({},e),{offhire:o})}};var L=a(214),U=a(37),B=a(12),K=a(75),q=a(71),H=a(532);function _(e){const{reactKeyPrefix:t,controller:a,voyageModalState:n,updateVoyageModalState:l,userLocale:i,vesselIsFocused:d,isOpenedFromFas:u,setVesselIsFocused:y,selectedVessel:p}=e,[m]=Object(s.a)([c.a.IInternationalization]),v=Object(H.a)(),f=Object(o.useMemo)(()=>a.getSections({reactKeyPrefix:t,voyageModalState:n,updateVoyageModalState:l,controller:a,userLocale:i,i:m,selectedVessel:p,portTerminals:v,vesselIsFocused:d,setVesselIsFocused:y,isOpenedFromFas:u}),[a,m,u,v,t,p,y,l,i,d,n]);return r.a.createElement(L.a,{container:!0,spacing:2},f.map((e,a)=>r.a.createElement(L.a,Object.assign({container:!0,item:!0,key:a,spacing:2},e.breakpoints,{direction:"column",sx:{flexFlow:"column"}}),e.sections.map((e,o)=>{var n,l;return r.a.createElement(L.a,{key:`${a}${o}`,item:!0},r.a.createElement(q.a,null,e.title?r.a.createElement(K.a,{title:null!==(n=e.title)&&void 0!==n?n:""}):r.a.createElement(r.a.Fragment,null),r.a.createElement(U.a,{reactKeyPrefix:`${t}-${null!==(l=e.title)&&void 0!==l?l:`list-${a}${o}`}`,items:e.fields,breakpoints:B.e})))}))))}var W=a(107),G=a(240),Q=a(225),$=a(331),z=function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function l(e){try{i(o.next(e))}catch(e){n(e)}}function s(e){try{i(o.throw(e))}catch(e){n(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};const Y=Object(o.memo)(Object(k.a)((function(e){var t,a,o;return{userLocale:S.a.getUserLocale(e),daysExtraInPort:null!==(t=C.a.getDataloyPreference(e,I.a.daysExtraFields))&&void 0!==t?t:[],percentExtraAtSea:null!==(a=C.a.getDataloyPreference(e,I.a.percentExtraFields))&&void 0!==a?a:[],currencyPref:null!==(o=C.a.getDataloyPreference(e,I.a.currencyPrefFields))&&void 0!==o?o:[]}}),Object(s.b)([c.a.IInternationalization,y.a.ICreateVoyageFactory,v.a.IFasVoyageApi,v.a.IScenarioActions,v.a.ITSModelActionsAsync,v.a.ISimpleReducerActions],(function(e){const{showModal:t,closeModal:a,scheduledUnallocated:s,callback:c,reactKeyPrefix:y,createVoyageType:v,scenarioKey:C=null,budgetVersionKey:j=null,selectedVessel:k=null,cargoTemplateToUse:S=null,state:{userLocale:A,daysExtraInPort:M,percentExtraAtSea:w,currencyPref:x},deps:[F,D,N,R,L,U]}=e,B=D.getController(v),K=Object(n.g)(),q=Object(n.h)(),{common:H,voyages:Y}=F.getLanguageFile(),[X,J]=Object(o.useState)(Object.assign(Object.assign({},I.a.defaultVoyageModalState),{vessel:k?B.getVesselFromRedux(k):null,scenarioKey:C,budgetVersionKey:j})),[Z,ee]=Object(o.useState)(!1),[te,ae]=Object(o.useState)(null),[oe,re]=Object(o.useState)(!1),[ne,le]=Object(o.useState)(!1),{isOpenedFromFas:se}=Object($.b)();Object(o.useEffect)(()=>{(()=>{z(this,void 0,void 0,(function*(){oe&&(yield I.a.onVesselChange(X,B,k,!!te).then(e=>J(e)))}))})(),re(!1)},[oe]),Object(o.useEffect)(()=>{var e,t,a;const o=Object(O.a)(null===(e=M[0])||void 0===e?void 0:e.prefDefault),r=Object(O.a)(null===(t=w[0])||void 0===t?void 0:t.prefDefault),n="true"===(null===(a=x[0])||void 0===a?void 0:a.prefDefault);J(e=>{var t,a,l;return Object.assign(Object.assign({},e),{loadDaysExtraInPort:null!==(t=[e.loadDaysExtraInPort,o].filter(e=>!isNaN(Number(e)))[0])&&void 0!==t?t:void 0,dischargeDaysExtraInPort:null!==(a=[e.dischargeDaysExtraInPort,o].filter(e=>!isNaN(Number(e)))[0])&&void 0!==a?a:void 0,percentExtraAtSea:null!==(l=[e.percentExtraAtSea,r].filter(e=>!isNaN(Number(e)))[0])&&void 0!==l?l:void 0,usePortCurrency:n})})},[x,M,w]);const ie=Object(o.useCallback)(e=>z(this,void 0,void 0,(function*(){const t=yield B.getTcFromVessel(e.key);J(a=>Object.assign(Object.assign({},a),{ballastBonus:null==t?void 0:t.ballastBonus,tcHireCommission:null==t?void 0:t.commissionAddress,dailyHire:t?void 0:a.dailyHire,tcIn:t,vessel:e}))})),[B]),ce=Object(o.useCallback)((e,t)=>z(this,void 0,void 0,(function*(){if("vessel"===e){const e=t;yield ie(e);const a=[v!==E.a.TC?B.loadVesselCargoHandlingRates(e.key):void 0,B.loadOpenPort(e.key,C,k)];Promise.all(a).then(()=>re(!0))}else if("loadPorts"===e){const e=yield V.createUpdateLoadPorts(B,X,t,null!=te?te:void 0);J(e)}else J("loadCurrency"===e?e=>V.updateLoadCurrency(e,t):"dischargePorts"===e?e=>V.createUpdateDischargePorts(B,e,t,null!=te?te:void 0):"dischargeCurrency"===e?e=>V.updateDischargeCurrency(e,t):"freightRate"===e?e=>V.updateFreightRate(e,t):"isWorldscale"===e?e=>V.updateIsWorldscale(e,t):"portCall"===e?e=>V.updatePortCall(e,t):"offhire"===e?e=>V.updateOffhire(e,t):a=>Object(P.a)(Object.assign({},a),e,t))})),[ie,v,B,C,k,X,te]),de=Object(o.useCallback)(e=>{q.pathname.includes("ve")?u.a.openDrawer(e.key,d.a.voyageDetail,q,K):(u.a.openDrawer(e.key,d.a.voyageDrawer,q,K),l.a.next())},[K,q]),ue=Object(o.useCallback)(e=>z(this,void 0,void 0,(function*(){if(e&&K&&q){if(se)if(k)yield B.handleFleetPlanVoyage(k,new h.a(e)),R.reloadColumnData(b.a.NONE,new g.a({voyage:e,vessel:null==e?void 0:e.vessel}),null);else{const[t]=e.scenarios;N.loadVoyages(t.key)}(!se&&e.key||se&&!k)&&U.setAction(G.a,e.key),de(e),c&&c()}})),[K,q,se,U,de,c,k,B,R,N]),ye=Object(o.useCallback)(()=>{te&&B.deleteCopiedCoaTemplate(te),ae(null),J(e=>I.a.onClearCoaTemplate(e))},[B,te]),pe=Object(o.useCallback)(e=>{ae(e),J(t=>I.a.onSelectCoaTemplate(t,e)),re(!0)},[]);Object(o.useEffect)(()=>{S&&pe(S),k&&B.loadOpenPort(k,C,k).then(()=>re(!0)),v===E.a.WITHOUT_CARGO&&B.preloadReasonForOffhire()},[]);const me=Object(o.useCallback)(()=>{null!==te?ye():ee(!Z)},[ye,te,Z]),ve=Object(o.useCallback)(()=>{te&&B.deleteCopiedCoaTemplate(te),a()},[a,B,te]),fe=Object(o.useMemo)(()=>({callback:(e,t)=>{ue(t)},fields:W.n,type:i.a.voyage}),[ue]),be=Object(o.useCallback)(()=>{Object(m.b)(fe,L,X,()=>B.overrideGetPostableData(s,X,te,!!k)),a()},[a,B,fe,s,te,k,L,X]),ge=te?Y.clearCoaTemplateCargo:Y.useCoaTemplateCargo,he=v===E.a.CARGO;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{open:t,onCloseModal:ve,reactKeyPrefix:y+"modal",confirmBtnName:H.create,maxWidth:"md",title:B.getModalTitle(F),disableConfirmBtn:B.isConfirmDisabled(X),onConfirm:be},!S&&he?r.a.createElement("div",{style:{paddingBottom:"4px"}},r.a.createElement(f.a,{reactKeyPrefix:y+"-use-coa-template-cargo",selected:!!te,label:ge,onClick:me,disabled:!X.vessel})):r.a.createElement("span",null),r.a.createElement(_,{reactKeyPrefix:y+"-create-section",controller:B,voyageModalState:X,updateVoyageModalState:ce,userLocale:A,vesselIsFocused:ne,isOpenedFromFas:se,setVesselIsFocused:le,selectedVessel:k,currencyPref:x})),Z&&r.a.createElement(p.a,{reactKeyPrefix:y+"-use-template-cargo",showDialog:Z,closeDialog:me,type:Q.c.Coa,scenarioKey:C,callback:pe,shouldOpenDrawer:!1,overrideReturnFields:I.a.selectedCoaFields}))}))),j.a)},545:function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"c",(function(){return h})),a.d(t,"a",(function(){return C}));var o=a(345),r=a(81),n=a(1432),l=a(153),s=a(89),i=a(135);const c=["channelInfo.userName","channelInfo.password","accessToken","accessTokenRequestUrl","accessTokenRequestBody"],d={PASSWORD:["accessToken","accessTokenRequestUrl","accessTokenRequestBody"],TOKEN:["channelInfo.userName","channelInfo.password","accessTokenRequestUrl","accessTokenRequestBody"],TOKEN_REQUEST:["channelInfo.userName","channelInfo.password","accessToken"]},u=["unsubscriptionDate","isObjectActive","remarks","subscriptionDate","isSubscriptionActive"],y=["key","dataloyObject","dlpAlertScript","doNotUnsubscribe","eventType","expression","isObjectActive","isOldValueNeeded","isScheduled","isSubscriptionActive","json","objectype","onlyMainObject","postableObject","remarks","scriptParameterValues","staticMsg","unsubscribed","unsubscriptionDate","url","useMsg","user","webhookPassword","webhookUsername","xsl","objectType","rawObject"];function p(e){return e.accessTokenRequestBody&&!function(e){if(""===e||""===e.trim())return!1;try{return btoa(atob(e))===e}catch(e){return!1}}(e.accessTokenRequestBody)&&(e.accessTokenRequestBody=btoa(e.accessTokenRequestBody)),e}function m(e){return e.accessToken&&(e.accessToken=btoa(e.accessToken)),e}function v(e){return e.json?(e.json=btoa(Object(i.c)(e.json)),e):Object(o.a)(e,"json")}function f(e){return Object(o.a)(e,"channelInfo.key")}function b(e){return""!==e.templateMsg?e.templateMsg:null}function g(e,t,a){const l=Object(r.a)(e,"channelInfo.password"),i=Object(n.a)([s.a,v,p,m])(e);return i.channelInfo.password=l,i.templateMsg=b(e),a?Object(o.a)(i,d[t].concat(y)):Object(o.a)(i,d[t])}function h(e,t){const a=Object(n.a)([s.a,v])(e);return a.templateMsg=b(e),a.accessToken=null,t?Object(o.a)(a,c.concat(y)):Object(o.a)(a,c)}function C(e,t){const a=Object(n.a)([s.a,v,f])(e);return a.channelInfo.channelType=l.a.DB,a.channelInfo.url=".",a.templateMsg=b(e),t?Object(o.a)(a,c.concat(y)):Object(o.a)(a,c.concat(u))}},592:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));a(118),a(10),a(11);var o=a(181),r=a(50),n=a(68),l=a(221);function s(e){const{ballastPort:t,vessel:a,voyageVariousCost:r,dailyHire:n,ballastBonus:l,tcHireCommission:s,tcIn:i,euaPrice:c}=e;return a?{daysWaiting:0,isDaysWaitingFixed:!0,ballastBonus:l,ballastPort:null==t?void 0:t.key,comments:null,doAtSea:a.doAtSea,doInerting:0,daysInertingDo:0,daysInertingFo:0,doInPort:a.doInPort,doInPortWorking:a.doInPortWorking,euaPrice:c,foBallast:o.a.getFoBallast(a)+a.foGeneratorAtSea,foCleaning:a.foCleaning,foHeating:a.foHeatingPerDay,foInerting:0,foInPort:a.foInPort+a.foGeneratorLoading,foInPortWorking:a.foInPortWorking+a.foGeneratorDischarging,foLoaded:o.a.getFoLoaded(a)+a.foGeneratorAtSea,tcHireCommission:s,tcIn:i?{key:i.key}:void 0,tcRate:n,vessel:a?a.key:"",variousCost:r||0}:{}}function i({loadPorts:e,dischargePorts:t,loadPortCost:a,dischargePortCost:o,daysExtraInPort:n,dischargeDaysExtraInPort:l,loadCurrency:s,dischargeCurrency:i}){var c,d,u,y;let p=1;const m=r.a.getDefaultEventLogs(),v=[];if(!e||!t)return v;for(let t=0;t<e.length;t++)v.push({eventLogs:m,port:null===(c=e[t].port)||void 0===c?void 0:c.key,terminal:null===(d=e[t].terminal)||void 0===d?void 0:d.key,portCallSequence:p,reasonForCall:"L",portCostCurrency:0===t?a:void 0,daysExtraInPort:n,currency:0===t?null==s?void 0:s.currencyCode:void 0}),p++;for(let e=0;e<t.length;e++)v.push({eventLogs:m,port:null===(u=t[e].port)||void 0===u?void 0:u.key,terminal:null===(y=t[e].terminal)||void 0===y?void 0:y.key,portCallSequence:p,reasonForCall:"D",portCostCurrency:0===e?o:void 0,daysExtraInPort:l,currency:0===e?null==i?void 0:i.currencyCode:void 0}),p++;return v}function c(e,t,a,o,r,n,l,s,i,c,d,u,y,p,m){var v;return[{cargoMeasurement:null!==(v=null==m?void 0:m.measurementCode)&&void 0!==v?v:"MT",weightMeasurement:"MT",weightUnit:"MT",stowageUnit:"MT",cargoMatch:"1",volumeMeasurement:"CBM",freightCurrency:null==y?void 0:y.currencyCode,laycanFrom:n,laycanTo:l,cargoType:"SPOT",isTemplate:e,scenarios:r?[{key:r}]:void 0,leg:s?{key:s.key}:void 0,commissionAddress:i,commissionBroker:c,charterer:d?{key:d.key}:void 0,commodity:u?{key:u.key}:void 0,isWorldscale:!!a,isLumpsum:!!t,freightRate:o,cargoPorts:p}]}const d={generateCargoPortArray:function(e,t,a,o){var n,l,s,i,c,d,u,y,p,m,v,f,b,g,h,C,O,P;e.sort(r.a.sortByPortCallSequence),t.sort(r.a.sortByPortCallSequence);const j=[],T=null!==(n=null==o?void 0:o.loadPorts)&&void 0!==n?n:[],[k]=T;for(let t=0;t<e.length;t++){const a=T[t],r=e[t],n=(null===(l=a.laytimeTermsMeasurement)||void 0===l?void 0:l.key)?a.laytimeTermsMeasurement.key:null===(s=a.laytimeTermsMeasurement)||void 0===s?void 0:s.laytimeTermsMeasurementCode;j.push(Object.assign(Object.assign({cargoPortSequence:t+1},a.key>0?{key:a.key}:{}),{port:null===(i=r.port)||void 0===i?void 0:i.key,terminal:null===(c=r.terminal)||void 0===c?void 0:c.key,portCall:r.key>0?r.key:null,reasonForCall:"L",cargoQuantity:0===t?null==o?void 0:o.cargoQuantity:0,laytimeTerms:(null===(d=null==a?void 0:a.laytimeTerms)||void 0===d?void 0:d.key)?null===(u=null==a?void 0:a.laytimeTerms)||void 0===u?void 0:u.key:null===(y=k.laytimeTerms)||void 0===y?void 0:y.key,laytimeTermsMeasurement:null!=n?n:null===(p=k.laytimeTermsMeasurement)||void 0===p?void 0:p.laytimeTermsMeasurementCode,laytimeTermsValue:(null==a?void 0:a.laytimeTermsValue)?a.laytimeTermsValue:k.laytimeTermsValue}))}const S=null!==(m=null==o?void 0:o.dischargePorts)&&void 0!==m?m:[],[I]=S;for(let e=0;e<t.length;e++){const r=S[e],n=t[e],l=(null===(v=r.laytimeTermsMeasurement)||void 0===v?void 0:v.key)?r.laytimeTermsMeasurement.key:null===(f=r.laytimeTermsMeasurement)||void 0===f?void 0:f.laytimeTermsMeasurementCode;j.push(Object.assign(Object.assign({cargoPortSequence:e+1},S[e].key>0?{key:S[e].key}:{}),{port:null===(b=n.port)||void 0===b?void 0:b.key,terminal:null===(g=n.terminal)||void 0===g?void 0:g.key,portCall:n.key>0?n.key:null,reasonForCall:"D",cargoQuantity:0===e?null==o?void 0:o.cargoQuantity:0,freightRate:(null==a?void 0:a.isLumpsum)?0:0===(null==o?void 0:o.freightRate)?r.freightRate:null==o?void 0:o.freightRate,laytimeTerms:(null===(h=null==r?void 0:r.laytimeTerms)||void 0===h?void 0:h.key)?null===(C=null==r?void 0:r.laytimeTerms)||void 0===C?void 0:C.key:null===(O=I.laytimeTerms)||void 0===O?void 0:O.key,laytimeTermsMeasurement:null!=l?l:null===(P=I.laytimeTermsMeasurement)||void 0===P?void 0:P.laytimeTermsMeasurementCode,laytimeTermsValue:(null==r?void 0:r.laytimeTermsValue)?r.laytimeTermsValue:I.laytimeTermsValue}))}return j},generateCommonVoyageObject:s,generateDefaultVoyageObject:function(e,t,a){const{loadPorts:o,loadPortCost:r,loadCurrency:n,dischargePorts:l,dischargePortCost:d,dischargeCurrency:u,leg:y,laycanFrom:p,laycanTo:m,isTemplate:v=!1,scenarioKey:f,commissionAddress:b,commissionBroker:g,voyageVariousCost:h,loadDaysExtraInPort:C,dischargeDaysExtraInPort:O,cargoQuantity:P,freightRate:j,charterer:T,commodity:k,currency:S,isLumpsum:I,isWorldscale:E,cargoMeasurement:A}=e;return Object.assign(Object.assign({},s(e)),{cargos:t?[{key:t.key,cargoQuantity:P,freightRate:j,isTemplate:v,variousCost:h,scenarios:f?[{key:f}]:void 0,laycanFrom:null!=p?p:void 0,laycanTo:null!=m?m:void 0,leg:y?{key:y.key}:void 0,commissionAddress:null!=b?b:0,commissionBroker:null!=g?g:0,freightCurrency:null==S?void 0:S.currencyCode,charterer:T?{key:T.key}:void 0,commodity:k?{key:k.key}:void 0,isWorldscale:E,isLumpsum:I,cargoPorts:a}]:c(v,I,E,j,f,null!=p?p:void 0,null!=m?m:void 0,y,null!=b?b:0,null!=g?g:0,T,k,S,a,A),portCallsFromVoyage:i({loadPorts:o,loadPortCost:null!=r?r:0,loadCurrency:n,dischargePorts:l,dischargePortCost:null!=d?d:0,dischargeCurrency:u,daysExtraInPort:C,dischargeDaysExtraInPort:O})})},generatePortCalls:function({loadPorts:e,dischargePorts:t,loadPortCost:a,dischargePortCost:o,daysExtraInPort:s,dischargeDaysExtraInPort:i}){var c,d,u,y;let p=1;const m=r.a.getDefaultEventLogs(),v=[];if(!e||!t)return v;const f=new l.a({reasonForCall:"L"}),b=new l.a({reasonForCall:"D"});for(let t=0;t<e.length;t++)v.push(new n.a({eventLogs:m,port:null===(c=e[t].port)||void 0===c?void 0:c.key,terminal:null===(d=e[t].terminal)||void 0===d?void 0:d.key,portCallSequence:p,reasonForCall:f,portCostCurrency:0===t?a:void 0,daysExtraInPort:s})),p++;for(let e=0;e<t.length;e++)v.push(new n.a({eventLogs:m,port:null===(u=t[e].port)||void 0===u?void 0:u.key,terminal:null===(y=t[e].terminal)||void 0===y?void 0:y.key,portCallSequence:p,reasonForCall:b,portCostCurrency:0===e?o:void 0,daysExtraInPort:i})),p++;return v}}},889:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return i}));var o=a(9),r=a(14),n=a(20),l=function(e,t,a,o){var r,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(l=(n<3?r(l):n>3?r(t,a,l):r(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l};function s(e){return n.a.ICreateVoyageFactory.toString()+e+"Controller"}let i=class{getController(e){try{return r.a.get(s(e))}catch(t){throw new Error(`There is no controller registered for creating voyage with a ${e}. Please register one with the inversify container.`)}}};i=l([Object(o.injectable)()],i)}}]);