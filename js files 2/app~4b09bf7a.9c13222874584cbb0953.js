(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1268:function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));a(10),a(11);var n=a(130),o=a(0),s=a.n(o),i=a(140),l=a(352),r=(a(93),a(100)),c=a.n(r),d=a(473),u=a(44),p=a(6),m=a(1),g=a(3),b=a(102);class v extends s.a.Component{constructor(e){super(e),this.state={bunkerTypeCode:"",bunkerTypeKey:null,selectedItem:e.selectedBunkerType},this.onSelectBunkerTypeCode=this.onSelectBunkerTypeCode.bind(this);const[t]=this.props.deps;this.lang=t.getLanguageFile()}UNSAFE_componentWillReceiveProps(e){this.setState({bunkerTypeCode:e.selectedBunkerType?e.selectedBunkerType.bunkerTypeCode:"",selectedItem:e.selectedBunkerType})}isRequiredFieldsOK(){const{selectedItem:e}=this.state;return null!==e}onSelectBunkerTypeCode(e){const t=e?parseInt(e.key.toString(),10):null;this.setState({bunkerTypeCode:e?e.bunkerTypeCode:"",bunkerTypeKey:t,selectedItem:e})}getSaveButton(){const{onConfirm:e,index:t}=this.props,{bunkerTypeKey:a}=this.state,n=!this.isRequiredFieldsOK();return s.a.createElement(d.a,{key:"save-button",disabled:n,onClick:()=>e(t,a),variant:"contained",color:"primary"},this.lang.common.save)}getCancelButton(){return s.a.createElement(d.a,{key:"cancel-button",onClick:this.props.onClose,color:"primary"},this.lang.common.cancel)}getDeleteButton(){const{index:e}=this.props;return-1!==e?s.a.createElement(d.a,{key:"delete-button",onClick:this.props.onDelete,color:"primary"},this.lang.common.delete):null}render(){const e=[this.getDeleteButton(),this.getCancelButton(),this.getSaveButton()],t=this.state.selectedItem?this.state.selectedItem:null,[a]=this.props.deps,n=a.getLanguageFile();return s.a.createElement(u.a,{reactKeyPrefix:this.props.reactKeyPrefix,actionButtons:e,maxWidth:"xs",fullWidth:!0,open:this.props.showDialog,onCloseModal:this.props.onClose,title:n.common.addBunkerType,fullscreenOnMobile:!0},s.a.createElement(b.b,{reactKeyPrefix:this.props.reactKeyPrefix+"bunker-type-code-typeahead",shouldPreload:!0,label:n.model.bunkerTypeCode,defaultSelectedOptions:t,type:m.a.bunkertype,objectPaths:["bunkerTypeCode"],isMulti:!1,onChange:this.onSelectBunkerTypeCode}))}}const y=Object(p.b)([g.a.IInternationalization],v);var f=a(5),h=a(67),C=a(517);class O extends s.a.Component{constructor(e){super(e),this.state={selectedBunkerType:null,selectedBunkerTypeIndex:-1,showDialog:!1},this.onAddBunkerType=this.onAddBunkerType.bind(this),this.getHeaders=this.getHeaders.bind(this),this.getTableRows=this.getTableRows.bind(this),this.onCloseDialog=this.onCloseDialog.bind(this),this.onConfirmDialog=this.onConfirmDialog.bind(this),this.onDeleteBunkerType=this.onDeleteBunkerType.bind(this),this.onClickBunkerType=this.onClickBunkerType.bind(this)}getHeaders(){const[e]=this.props.deps,t=e.getLanguageFile();return[{content:t.common.code,contentType:f.a.TEXT},{content:t.common.description,contentType:f.a.TEXT}]}getTableRows(){const{vessel:e}=this.props,t=[];if(e&&e.bunkerTypes)for(const a of e.bunkerTypes){const e=[a.bunkerTypeCode,a.bunkerTypeDesc];t.push({content:e,id:a.key})}return t}onClickBunkerType(e){const{bunkerTypes:t}=this.props,a=t.find(t=>t.key===e);if(a){const n=t.findIndex(t=>t.key===e);this.setState({selectedBunkerType:a,selectedBunkerTypeIndex:n,showDialog:!0})}}onAddBunkerType(){this.setState({selectedBunkerType:null,showDialog:!0})}onCloseDialog(){this.setState({selectedBunkerType:null,selectedBunkerTypeIndex:-1,showDialog:!1})}onConfirmDialog(e,t){const a=[...this.props.vessel.bunkerTypes];-1===e&&(e=a.length);const n=new C.a({key:t});a[e]=n,this.props.onChange(this.props.vessel,a),this.setState({selectedBunkerType:null,selectedBunkerTypeIndex:-1,showDialog:!1})}onDeleteBunkerType(){const{selectedBunkerTypeIndex:e}=this.state,{bunkerTypes:t}=this.props;null!==e&&(t.splice(e,1),this.setState({selectedBunkerTypeIndex:-1,showDialog:!1},()=>this.props.onChange(this.props.vessel,t)))}render(){const{showDialog:e,selectedBunkerType:t,selectedBunkerTypeIndex:a}=this.state,{userLocale:n,reactKeyPrefix:o}=this.props,[i]=this.props.deps,l=i.getLanguageFile(),r=[{disabled:!1,icon:c.a,iconButtonProps:{color:"primary","aria-label":l.common.addBunkerType},label:l.common.addBunkerType,onClick:this.onAddBunkerType,reactKeyPrefix:o+"add-bunker-type"}];return s.a.createElement(s.a.Fragment,null,s.a.createElement(y,{reactKeyPrefix:o+"bunker-types-modal",index:a,selectedBunkerType:t,showDialog:e,onClose:this.onCloseDialog,onConfirm:this.onConfirmDialog,onDelete:this.onDeleteBunkerType}),s.a.createElement(h.a,{data:this.getTableRows(),headers:this.getHeaders(),userLocale:n,primaryActions:r,reactKeyPrefix:o+"table",onRowClick:this.onClickBunkerType,title:l.model.bunkerTypes,customisation:{responsive:!0}}))}}const P=Object(p.b)([g.a.IInternationalization],O);a(118),a(109);var k=a(351),T=a(252),j=a(19);class S extends s.a.Component{constructor(e){super(e),this.state={activeBallastSpeed:!1,activeLadenSpeed:!1,consumption:0,speedBallast:0,speedLaden:0},this.onClickSave=this.onClickSave.bind(this),this.onClickActiveBallast=this.onClickActiveBallast.bind(this),this.onClickActiveLaden=this.onClickActiveLaden.bind(this),this.onChangeBallast=this.onChangeBallast.bind(this),this.onChangeLaden=this.onChangeLaden.bind(this),this.onChangeConsumption=this.onChangeConsumption.bind(this),this.getColspec=this.getColspec.bind(this);const[t]=this.props.deps;this.lang=t.getLanguageFile()}UNSAFE_componentWillReceiveProps(e){let t=0,a=0,n=0,o=!1,s=!1;if(e.selectedMainEngine)for(const i of e.selectedMainEngine)t=i.foConsumption,i.isBallast&&(a=i.speed,o=i.speed>0&&i.isActive),i.isLoaded&&(n=i.speed,s=i.speed>0&&i.isActive);this.setState({activeBallastSpeed:o,activeLadenSpeed:s,consumption:t,speedBallast:a,speedLaden:n})}isRequiredFieldsOK(){const{consumption:e,speedBallast:t,speedLaden:a}=this.state;return!(!e||!t&&!a)}onChangeConsumption(e){this.setState({consumption:e})}onChangeLaden(e){e>0?this.setState({speedLaden:e}):this.setState({activeLadenSpeed:!1,speedLaden:e})}onChangeBallast(e){e>0?this.setState({speedBallast:e}):this.setState({activeBallastSpeed:!1,speedBallast:e})}onClickActiveLaden(){this.setState({activeLadenSpeed:!this.state.activeLadenSpeed})}onClickActiveBallast(){this.setState({activeBallastSpeed:!this.state.activeBallastSpeed})}onClickSave(){const{index:e,selectedMainEngine:t,onConfirm:a}=this.props,{activeBallastSpeed:n,activeLadenSpeed:o,consumption:s}=this.state;let{speedBallast:i,speedLaden:l}=this.state;if("string"==typeof i&&(i=0),"string"==typeof l&&(l=0),t){const r=[];for(const e of t)r.push(e.key);a(e,n,o,s,i,l,r)}else a(e,n,o,s,i,l)}getSaveButton(){const e=!this.isRequiredFieldsOK();return s.a.createElement(d.a,{id:this.props.reactKeyPrefix+"save-btn",key:"save-button",disabled:e,onClick:this.onClickSave,variant:"contained",color:"primary"},this.lang.common.save)}getCancelButton(){return s.a.createElement(d.a,{id:this.props.reactKeyPrefix+"cancel-btn",key:"cancel-button",onClick:this.props.onClose,color:"primary"},this.lang.common.cancel)}getDeleteButton(){const{index:e,selectedMainEngine:t,onDelete:a}=this.props;return-1!==e?s.a.createElement(d.a,{id:this.props.reactKeyPrefix+"delete-btn",key:"delete-button",onClick:t?a.bind(null,t):void 0,color:"primary"},this.lang.common.delete):null}getColspec(){const{activeLadenSpeed:e,activeBallastSpeed:t,consumption:a,speedBallast:n,speedLaden:o}=this.state,{userLocale:s,reactKeyPrefix:i}=this.props,[l]=this.props.deps,r=l.getLanguageFile(),c=[],d=new T.a({foConsumption:a,isActive:e,isBallast:!1,isLoaded:!0,speed:o}),u=new T.a({foConsumption:a,isActive:t,isBallast:!0,isLoaded:!1,speed:n}),p=[];p.push(d),p.push(u);for(const e of p){const t=[{fieldName:"foConsumption",numberInputProps:{maskSettings:{decimalScale:2,fixedDecimalScale:!0},onChange:this.onChangeConsumption}},{fieldName:"speed",label:e.isBallast?r.model.speedBallast:r.model.speedLaden,numberInputProps:{maskSettings:{decimalScale:2,fixedDecimalScale:!0},onChange:e.isBallast?this.onChangeBallast:this.onChangeLaden}},{disabled:e.isBallast?!(n>0):!(o>0),fieldName:"isActive",label:e.isBallast?r.vessel.activeBallast:r.vessel.activeLaden,onUpdateOverride:e.isBallast?this.onClickActiveBallast:this.onClickActiveLaden}];c.push(Object(j.a)({fieldOptions:t,object:e,type:m.a.speed,userLocale:s,reactKeyPrefix:i,smartResponse:!0}))}return c}render(){const{onClose:e,reactKeyPrefix:t}=this.props,[a]=this.props.deps,n=a.getLanguageFile(),o=[this.getDeleteButton(),this.getCancelButton(),this.getSaveButton()],i=this.getColspec(),l=i?i[0][0].value:void 0,r=i?i[0][1].value:void 0,c=i?i[1][1].value:void 0,d=i?i[0][2].value:void 0,p=i?i[1][2].value:void 0;return s.a.createElement(u.a,{reactKeyPrefix:t,actionButtons:o,maxWidth:"xs",fullWidth:!0,open:this.props.showDialog,onCloseModal:e,title:n.common.addMainEngineSpeed,fullscreenOnMobile:!0},l,r,c,d,p)}}const E=Object(p.b)([g.a.IInternationalization],S);function I(e,t){return e.foConsumption-t.foConsumption}const N={maxDecimals:2,minDecimals:2};class A extends s.a.Component{constructor(e){super(e),this.state={selectedMainEngine:null,selectedMainEngineIndex:-1,showDialog:!1},this.onAddMainEngine=this.onAddMainEngine.bind(this),this.getHeaders=this.getHeaders.bind(this),this.getTableRows=this.getTableRows.bind(this),this.onCloseDialog=this.onCloseDialog.bind(this),this.onConfirmDialog=this.onConfirmDialog.bind(this),this.onDeleteMainEngineLine=this.onDeleteMainEngineLine.bind(this),this.onClickMainEngine=this.onClickMainEngine.bind(this)}getHeaders(){const[e]=this.props.deps,t=e.getLanguageFile();return[{content:t.vessel.consumption,contentType:f.a.NUMBER,numberFormatOptions:N},{content:t.model.speedLaden,contentType:f.a.ELEMENT},{content:t.vessel.activeLaden,contentType:f.a.ELEMENT},{content:t.model.speedBallast,contentType:f.a.ELEMENT},{content:t.vessel.activeBallast,contentType:f.a.ELEMENT}]}getTableRows(){const{vessel:e,tc:t}=this.props,a=[];if(t&&t.speeds||e&&e.speeds){const n=[...t?t.speeds:e.speeds];n.sort(I);const o=new Map;for(const e of n){o.get(e.foConsumption)||o.set(e.foConsumption,{ballastActive:null,id:0,ladenActive:null,speedBallast:"-",speedLaden:"-"});const t=o.get(e.foConsumption);t&&(e.isBallast&&(t.ballastActive=e.isActive,t.speedBallast=0!==e.speed?e.speed:"-"),e.isLoaded&&(t.ladenActive=e.isActive,t.speedLaden=0!==e.speed?e.speed:"-"),t.id=e.key)}o.forEach((e,t)=>{let{speedBallast:n,speedLaden:o}=e;if("-"!==e.speedBallast){n=""+e.speedBallast;if(-1===n.indexOf("."))n+=".00";else{const e=n.split(".");e.length>1&&e[1].length<2&&(n+="0")}}if("-"!==e.speedLaden){o=""+e.speedLaden;if(-1===o.indexOf("."))o+=".00";else{const e=o.split(".");e.length>1&&e[1].length<2&&(o+="0")}}const i=[t,{content:s.a.createElement("div",{style:{textAlign:"right"},key:e.id},o),rawValue:e.speedLaden},{content:s.a.createElement(k.a,{color:"secondary",checked:!!e.ladenActive}),rawValue:!!e.ladenActive},{content:s.a.createElement("div",{style:{textAlign:"right"},key:e.id},n),rawValue:e.speedBallast},{content:s.a.createElement(k.a,{color:"secondary",checked:!!e.ballastActive}),rawValue:!!e.ballastActive}];a.push({content:i,id:e.id})})}return a}onClickMainEngine(e){const{vessel:t,tc:a}=this.props,n=a?a.speeds:t.speeds,o=n.find(t=>t.key===e),s=o?o.foConsumption:0,i=n.filter(e=>e.foConsumption===s);if(i){const t=n.findIndex(t=>t.key===e);this.setState({selectedMainEngine:i,selectedMainEngineIndex:t,showDialog:!0})}}onAddMainEngine(){this.setState({selectedMainEngine:null,selectedMainEngineIndex:-1,showDialog:!0})}onCloseDialog(){this.setState({showDialog:!1})}changeActiveBallast(e){for(const t of e)t.isBallast&&(t.isActive=!1);return e}changeActiveLaden(e){for(const t of e)t.isLoaded&&(t.isActive=!1);return e}onConfirmDialog(e,t,a,n,o,s,i){let l=[...this.props.tc?this.props.tc.speeds:this.props.vessel.speeds];-1===e&&(e=l.length);let r,c,d=!1,u=!1;if(t&&(d=!0,l=this.changeActiveBallast(l)),a&&(u=!0,l=this.changeActiveLaden(l)),0!==s?r=new T.a({foConsumption:n,isActive:u,speed:s,speedType:"L"}):0===s&&(r=null),0!==o?c=new T.a({foConsumption:n,isActive:d,speed:o,speedType:"B"}):0===o&&(c=null),i){for(const e in l)if(e)if(i.length<2)l[e].key===i[0]&&(l[e].isBallast&&c&&r&&(l[e]=c,l.push(r)),l[e].isLoaded&&r&&c&&(l[e]=r,l.push(c)),l[e].isBallast&&c&&null===r?l[e]=c:l[e].isBallast&&null===c&&r&&(l[e]=r),l[e].isLoaded&&r&&null===c?l[e]=r:l[e].isLoaded&&c&&null===r&&(l[e]=c));else for(const t of i)l[e].key===t&&(l[e].isBallast&&c?l[e]=c:l[e].isBallast&&null===c&&l.splice(l.indexOf(l[e]),1),l[e].isLoaded&&r?l[e]=r:l[e].isLoaded&&null===r&&l.splice(l.indexOf(l[e]),1))}else c&&r?(l[e]=r,l[e+1]=c):r?l[e]=r:c&&(l[e]=c);this.setState({showDialog:!1},()=>this.props.onChange(this.props.tc?this.props.tc:this.props.vessel,l))}onDeleteMainEngineLine(e){const{selectedMainEngineIndex:t}=this.state,{tc:a,vessel:n}=this.props,o=a?a.speeds:n.speeds,s=[];for(const t of e)for(const e of o)t.foConsumption!==e.foConsumption&&s.push(e);o.splice(t,1),this.setState({selectedMainEngineIndex:-1,showDialog:!1},()=>this.props.onChange(this.props.tc?this.props.tc:this.props.vessel,s))}render(){const{showDialog:e,selectedMainEngine:t,selectedMainEngineIndex:a}=this.state,[n]=this.props.deps,{userLocale:o,reactKeyPrefix:i}=this.props,l=n.getLanguageFile(),r=[{disabled:!1,icon:c.a,iconButtonProps:{color:"primary","aria-label":l.common.addMainEngineSpeed},label:l.common.addMainEngineSpeed,onClick:this.onAddMainEngine,reactKeyPrefix:i+"add-main-engine"}];return s.a.createElement(s.a.Fragment,null,s.a.createElement(E,{reactKeyPrefix:i+"main-engine-lines-modal",index:a,selectedMainEngine:t,onDelete:this.onDeleteMainEngineLine,showDialog:e,userLocale:o,onClose:this.onCloseDialog,onConfirm:this.onConfirmDialog}),s.a.createElement(h.a,{data:this.getTableRows(),headers:this.getHeaders(),primaryActions:r,userLocale:o,reactKeyPrefix:i+"main-engine-lines-table",onRowClick:this.onClickMainEngine,title:l.model.mainEngine,customisation:{responsive:!0}}))}}const x=Object(p.b)([g.a.IInternationalization],A);var D=a(28),w=a(63),L=a(37),R=a(12),M=a(111),B=a(20),F=a(47),U=a(21),K=a(374),V=a(7);const H={title:{pb:2}};function q(e){const{dispatchAction:t,userLocale:a,reactKeyPrefix:r,onChangeBunkerTypes:c,onChangeMainEngines:d,tc:u,vesselId:b,state:{vessel:v}}=e,[y,f,h]=Object(p.a)([g.a.IInternationalization,B.a.IVesselDrawerController,V.a.ISelectedVesselActions]),C=y.getLanguageFile();Object(o.useEffect)(()=>{var e,a,n;u&&t(h.setAction(null!==(n=null===(a=null===(e=u.vesselCode)||void 0===e?void 0:e.vessel)||void 0===a?void 0:a.key)&&void 0!==n?n:null)),f.loadVessel(i.f,b)},[]);return v?s.a.createElement(s.a.Fragment,null,s.a.createElement(x,{reactKeyPrefix:r+"-main-engline-lines",tc:u,vessel:v,userLocale:a,onChange:d}),s.a.createElement("div",null,s.a.createElement(n.a,{variant:"h4",sx:H.title},C.vessel.boilersConsumption),s.a.createElement(L.a,{reactKeyPrefix:r+"-boiler_horizontal_lists",items:Object(j.a)({fieldOptions:[{fieldName:"foInPort",InputProps:{endAdornment:w.a.Weight},label:C.model.foPortIdle,numberInputProps:{maskSettings:D.a.mask2}},{fieldName:"foInPortWorking",InputProps:{endAdornment:w.a.Weight},label:C.model.foPortWorking,numberInputProps:{maskSettings:D.a.mask2}},{fieldName:"foCleaning",InputProps:{endAdornment:w.a.Weight},label:C.model.foTankCleaning,numberInputProps:{maskSettings:D.a.mask2}},{fieldName:"foHeatingPerDay",InputProps:{endAdornment:w.a.Weight},label:C.model.foCargoHeating,numberInputProps:{maskSettings:D.a.mask2}}],object:u||v||new M.a({}),parentData:u?{type:m.a.tc,key:u.key}:v?{type:m.a.vessel,key:v.key}:void 0,type:u?m.a.tc:m.a.vessel,updateResponseFields:u?l.a:i.f,userLocale:a,reactKeyPrefix:r}),breakpoints:R.a})),s.a.createElement("div",null,s.a.createElement(n.a,{variant:"h4",sx:H.title},C.vessel.generatorConsumption),s.a.createElement(L.a,{reactKeyPrefix:r+"-generator_horizontal_lists",items:Object(j.a)({fieldOptions:[{InputProps:{endAdornment:w.a.Weight},fieldName:"foGeneratorLoading",label:C.model.foPortIdle,numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},fieldName:"foGeneratorDischarging",label:C.model.foPortWorking,numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},fieldName:"foGeneratorAtSea",label:C.model.foAtSea,numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},fieldName:"doInPort",label:C.model.mgoPortIdle,numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},fieldName:"doInPortWorking",label:C.model.mgoPortWorking,numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},fieldName:"doAtSea",label:C.model.mgoAtSea,numberInputProps:{maskSettings:D.a.mask2}},...u?[]:[{InputProps:{endAdornment:w.a.Weight},formControlProps:{required:!1},fieldName:"foInerting",numberInputProps:{maskSettings:D.a.mask2}},{InputProps:{endAdornment:w.a.Weight},formControlProps:{required:!1},fieldName:"doInerting",label:C.model.mgoInerting,numberInputProps:{maskSettings:D.a.mask2}}]],object:u||v||new M.a({}),parentData:u?{type:m.a.tc,key:u.key}:v?{type:m.a.vessel,key:v.key}:void 0,type:u?m.a.tc:m.a.vessel,updateResponseFields:u?l.a:i.f,userLocale:a,reactKeyPrefix:r}),breakpoints:R.a})),u?null:s.a.createElement(P,{reactKeyPrefix:r+"-bunker-types",userLocale:a,vessel:v,bunkerTypes:v.bunkerTypes,onChange:c})):null}const _=Object(F.a)((function(e){const t=K.a.get(e);return{vessel:U.a.getTSModelBuilt(e,m.a.vessel,t||0,i.f)}}),Object(o.memo)(q))},1284:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));a(10),a(11);var n,o=a(0),s=a.n(o);!function(e){e[e.DWT=0]="DWT",e[e.Draft=1]="Draft",e[e.Immersion=2]="Immersion"}(n||(n={}));var i=a(473),l=a(140),r=a(28),c=a(37),d=a(44),u=a(6),p=a(1),m=a(111),g=a(181),b=a(19),v=a(3),y=a(199),f=a(47),h=a(32);class C extends s.a.Component{constructor(e){super(e),this.getColspec=(e,t,a,o)=>{const[s]=this.props.deps,{vessel:i,common:c}=s.getLanguageFile(),d=n[a].toLowerCase(),u=Object(y.a)(o,[{fieldName:d+"Summer",label:i.summer,numberInputProps:{maskSettings:r.a.mask1}},{fieldName:d+"Winter",label:i.winter,numberInputProps:{maskSettings:r.a.mask1}},{fieldName:d+"Design",label:i.design,numberInputProps:{maskSettings:r.a.mask1}},{fieldName:d+"Fresh",label:i.fresh,numberInputProps:{maskSettings:r.a.mask1}},{fieldName:d+"Tropical",label:i.tropical,numberInputProps:{maskSettings:r.a.mask1}},{fieldName:d+"TropicalFresh",label:i.tropicalFresh,numberInputProps:{maskSettings:r.a.mask1}}]);0===a?u.push({fieldName:d+"Measurement",label:c.unit,typeaheadProps:{isClearable:!1}}):u.push({fieldName:d+"Measurement",label:c.unit,overrideFieldType:"object",typeaheadProps:{options:g.a.getLoadLineCalculationOptions(s,1===a),resolver:e=>1===a?"M"===e?c.meter:c.feet:e,isClearable:!1}});return[Object(b.a)({fieldOptions:u,object:this.props.vessel||new m.a({}),parentData:this.props.vessel?{type:p.a.vessel,key:this.props.vessel.key}:void 0,type:p.a.vessel,updateResponseFields:l.h,userLocale:t,reactKeyPrefix:e})]},this.getHorizontalLists=this.getHorizontalLists.bind(this)}getCloseButton(){const[e]=this.props.deps,t=e.getLanguageFile();return s.a.createElement(i.a,{id:this.props.reactKeyPrefix+"close-button",key:"close-button",onClick:this.props.onClose,variant:"contained",color:"primary"},t.common.close)}getHorizontalLists(){const{userLocale:e,rowId:t,reactKeyPrefix:a}=this.props,{user:n}=this.props.state,o=this.getColspec(a,e,t,n);return s.a.createElement(c.a,{reactKeyPrefix:`${a}-load_line_horizontal_list_${t}`,key:"load_line_horizontal_list_"+t,items:o[0],breakpoints:{lg:12,md:12,sm:12,xl:12,xs:12}})}render(){const{onClose:e,rowId:t,reactKeyPrefix:a}=this.props,o=[this.getCloseButton()];return s.a.createElement(d.a,{reactKeyPrefix:a,actionButtons:o,maxWidth:"xs",fullWidth:!0,open:this.props.showDialog,onCloseModal:e,title:`Edit ${n[t]} Information`,fullscreenOnMobile:!0},this.getHorizontalLists())}}const O=Object(f.a)(e=>({user:Object(h.a)(e)}),Object(u.b)([v.a.IInternationalization],C));var P=a(5),k=a(67);const T={maxDecimals:3,minDecimals:3},j={height:{type:P.d.STATIC},responsive:!0};function S({className:e,userLocale:t,vessel:a,disableRowClick:i,reactKeyPrefix:l}){const[r,c]=Object(o.useState)(0),[d,p]=Object(o.useState)(!1),[m]=Object(u.a)([v.a.IInternationalization]),{model:{immersion:g,dwt:b,draft:y},vessel:{loadlineInformation:f,tropicalFresh:h,summer:C,winter:S,design:E,fresh:I,tropical:N},common:{unit:A}}=m.getLanguageFile(),x=Object(o.useCallback)(()=>p(!1),[]),D=Object(o.useCallback)(e=>{const t=parseInt(e.toString(),10);c(t),p(!0)},[]),w=Object(o.useMemo)(()=>{var e;if(a){const{dwtSummer:t,dwtWinter:o,dwtDesign:s,dwtFresh:i,dwtTropicalFresh:l,dwtMeasurement:r,draftSummer:c,draftWinter:d,draftDesign:u,draftFresh:p,draftTropical:m,draftTropicalFresh:v,draftMeasurement:f,dwtTropical:h,immersionDesign:C,immersionFresh:O,immersionMeasurement:P,immersionSummer:k,immersionTropical:T,immersionTropicalFresh:j,immersionWinter:S}=a;return[{content:[b,t,o,s,i,h,l,null!==(e=null==r?void 0:r.measurementCode)&&void 0!==e?e:""],id:n.DWT},{content:[y,c,d,u,p,m,v,f],id:n.Draft},{content:[g,k,S,C,O,T,j,P],id:n.Immersion}]}return[]},[y,b,g,a]),L=Object(o.useMemo)(()=>[{content:"",contentType:P.a.TEXT},{content:C,contentType:P.a.NUMBER,numberFormatOptions:T},{content:S,contentType:P.a.NUMBER,numberFormatOptions:T},{content:E,contentType:P.a.NUMBER,numberFormatOptions:T},{content:I,contentType:P.a.NUMBER,numberFormatOptions:T},{content:N,contentType:P.a.NUMBER,numberFormatOptions:T},{content:h,contentType:P.a.NUMBER,numberFormatOptions:T},{content:A,contentType:P.a.TEXT,typeaheadProps:{shouldPreload:!0}}],[E,I,C,N,h,A,S]);return s.a.createElement(s.a.Fragment,null,d&&s.a.createElement(O,{reactKeyPrefix:l+"-modal",showDialog:d,userLocale:t,rowId:r,vessel:a,onClose:x}),s.a.createElement(k.a,{reactKeyPrefix:l+"-table",className:e,data:w,headers:L,userLocale:t,customisation:j,title:f,onRowClick:i?void 0:D}))}},1608:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n,o=a(9),s=a(7),i=a(29),l=a(1),r=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},c=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=function(e,t){return function(a,n){t(a,n,e)}};let u=class{constructor(e){this.tsmodelActions=e}loadPoolEarningPoints(e){e&&this.tsmodelActions.loadSingleAction({key:e,fields:{poolEarningPoints:{earningPoint:"*",validFromDate:"*"}},type:l.a.vesselcode})}};u=r([Object(o.injectable)(),d(0,Object(o.inject)(s.a.ITSModelActionsAsync)),c("design:paramtypes",["function"==typeof(n=void 0!==i.ITSModelActionsAsync&&i.ITSModelActionsAsync)?n:Object])],u)},1665:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n,o,s=a(9),i=a(345),l=a(31),r=a(140),c=a(352),d=a(517),u=a(252),p=a(1),m=a(89),g=a(7),b=a(29),v=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(a,n){t(a,n,e)}};let h=class{constructor(e,t){this.store=e,this.tsmodelActions=t,this.onUpdateBunkerTypes=this.onUpdateBunkerTypes.bind(this),this.onUpdateMainEngines=this.onUpdateMainEngines.bind(this)}onUpdateBunkerTypes(e,t){e&&this.tsmodelActions.updateSingleAction({data:{bunkerTypes:t.map(e=>Object(m.b)(new d.a(e))),key:e.key},fields:r.f,key:e.key,type:p.a.vessel})}onUpdateMainEngines(e,t){if(e){const a=e.$tsmodelClassName===p.a.tc.name.toLowerCase()?c.a:r.f;this.tsmodelActions.updateSingleAction({data:{key:e.key,speeds:t.map(e=>Object(i.a)(Object(m.b)(new u.a(e)),"isBallast","isLoaded"))},fields:a,key:e.key,type:p.a[e.$tsmodelClassName.toLowerCase()]})}}};h=v([Object(s.injectable)(),f(0,Object(s.inject)(g.a.Store)),f(1,Object(s.inject)(g.a.ITSModelActionsAsync)),y("design:paramtypes",["function"==typeof(n=void 0!==l.Store&&l.Store)?n:Object,"function"==typeof(o=void 0!==b.ITSModelActionsAsync&&b.ITSModelActionsAsync)?o:Object])],h)},1668:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n,o=a(9),s=a(1),i=a(7),l=a(29),r=a(641),c=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t){return function(a,n){t(a,n,e)}};let p=class{constructor(e){this.tsmodelActions=e}loadVariousCROverview(e){this.tsmodelActions.loadSingleAction({fields:r.a,key:e,type:s.a.varioustext})}};p=c([Object(o.injectable)(),u(0,Object(o.inject)(i.a.ITSModelActionsAsync)),d("design:paramtypes",["function"==typeof(n=void 0!==l.ITSModelActionsAsync&&l.ITSModelActionsAsync)?n:Object])],p)},1669:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n,o,s=a(9),i=a(31),l=a(821),r=a(1),c=a(29),d=a(7),u=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(a,n){t(a,n,e)}};let g=class{constructor(e,t){this.store=e,this.tsmodelActions=t}loadVesselTypeOverview(e){this.tsmodelActions.loadSingleAction({fields:l.a,key:e,type:r.a.vesseltype})}};g=u([Object(s.injectable)(),m(0,Object(s.inject)(d.a.Store)),m(1,Object(s.inject)(d.a.ITSModelActionsAsync)),p("design:paramtypes",["function"==typeof(n=void 0!==i.Store&&i.Store)?n:Object,"function"==typeof(o=void 0!==c.ITSModelActionsAsync&&c.ITSModelActionsAsync)?o:Object])],g)},1671:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));a(59),a(109);var n,o,s,i,l,r,c=a(9),d=a(289),u=a(1),p=a(7),m=a(29),g=a(668),b=a(495),v=a(31),y=a(434),f=a(196),h=a(3),C=a(192),O=a(48),P=a(90),k=a(32),T=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},j=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},S=function(e,t){return function(a,n){t(a,n,e)}},E=function(e,t,a,n){return new(a||(a=Promise))((function(o,s){function i(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}r((n=n.apply(e,t||[])).next())}))};let I=class{constructor(e,t,a,n,o,s){this.store=e,this.selectedUserActions=t,this.selectedAuditLogActions=a,this.tsmodelActions=n,this.i=o,this.http=s}dispatchSetSelectedAuditLog(e){this.store.dispatch(this.selectedAuditLogActions.setAction({key:e,tsModelType:u.a.user}))}loadUserAndSetSelected(e){const t=d.c;this.store.dispatch(this.selectedUserActions.setAction(e)),this.tsmodelActions.loadSingleAction({fields:t,key:e,type:u.a.user})}createContactInfo(e,t){const a={contactInfo:[{faxNo:t.faxNo,mobileNo:t.mobileNo,phoneNo:t.phoneNo,telexNo:t.telexNo}],key:e};this.tsmodelActions.updateSingleAction({data:a,fields:d.b,key:e,type:u.a.user})}getUserIdFromPath(e){if(e){const t=e.params.drawerId?e.params.drawerId:"0";return parseInt(t,10)}}uploadSignature(e,t){return E(this,void 0,void 0,(function*(){const a=yield Object(y.f)(e),n=Object(y.b)(a),o={signature:n};n&&"image"===e.type.split("/")[0]?this.tsmodelActions.updateSingleAction({data:o,fields:d.c,key:t,type:u.a.user}):f.a.next({type:"snackbar",notification:{id:666,message:this.i.getLanguageFile().common.signatureFileImageWarning,type:"error"}})}))}removeSignature(e){this.tsmodelActions.updateSingleAction({data:{signature:null},fields:d.c,key:e,type:u.a.user})}getDataloyInfo(){var e;return E(this,void 0,void 0,(function*(){try{const t=yield this.http.get(O.a.API_BASE_URL+"/dataloy/info",{headers:new Headers({authorization:null!==(e=Object(k.a)(this.store.getState()).authdata)&&void 0!==e?e:""})});return yield t.json()}catch(e){e instanceof Error&&console.error(e)}return{}}))}};I=T([Object(c.injectable)(),S(0,Object(c.inject)(p.a.Store)),S(1,Object(c.inject)(p.a.ISelectedUserActions)),S(2,Object(c.inject)(p.a.ISelectedAuditLogActions)),S(3,Object(c.inject)(p.a.ITSModelActionsAsync)),S(4,Object(c.inject)(h.a.IInternationalization)),S(5,Object(c.inject)(h.a.IHttp)),j("design:paramtypes",["function"==typeof(n=void 0!==v.Store&&v.Store)?n:Object,"function"==typeof(o=void 0!==b.ISelectedUserActions&&b.ISelectedUserActions)?o:Object,"function"==typeof(s=void 0!==g.ISelectedAuditLogActions&&g.ISelectedAuditLogActions)?s:Object,"function"==typeof(i=void 0!==m.ITSModelActionsAsync&&m.ITSModelActionsAsync)?i:Object,"function"==typeof(l=void 0!==C.IInternationalization&&C.IInternationalization)?l:Object,"function"==typeof(r=void 0!==P.IHttp&&P.IHttp)?r:Object])],I)},1870:function(e,t,a){"use strict";a.d(t,"a",(function(){return Sa}));a(10),a(11);var n=a(1782),o=a.n(n),s=a(892),i=a(81),l=a(0),r=a.n(l),c=a(140),d=a(82),u=a(15),p=a(97),m=a(57),g=a(44),b=a(6),v=a(3);class y extends r.a.Component{constructor(e){super(e),this.i=this.props.deps[0],this.state={vesselName:"",isDirty:!1},this.onSave=this.onSave.bind(this),this.onChange=this.onChange.bind(this),this.handleKeyPress=this.handleKeyPress.bind(this)}onSave(){this.props.onCloseModalOnCreate(this.state.vesselName)}onChange(e){this.setState({isDirty:!0,vesselName:e})}getConfirmButton(){const{vesselName:e,isDirty:t}=this.state;return""===e&&!t||this.checkForError()||this.checkVesselName()}checkForError(){const{vesselName:e,isDirty:t}=this.state;return""===e&&t}handleKeyPress(e){"Enter"!==e.key||!this.props.onCloseModalOnCreate||this.getConfirmButton()||this.checkForError()||this.checkVesselName()||this.props.onCloseModalOnCreate(this.state.vesselName)}checkVesselName(){const{vesselName:e}=this.state,{vessel:t}=this.props;return e.toLowerCase()===t.vesselName.toLowerCase()}render(){const{deps:[e],showDialog:t,reactKeyPrefix:a}=this.props,{model:n,common:o,vessel:s}=e.getLanguageFile(),i=this.getConfirmButton(),l=this.checkForError(),c=this.checkVesselName(),d=c?n.vesselNameUnique:void 0;return r.a.createElement(g.a,{reactKeyPrefix:a,open:t,onCloseModal:this.props.onClose,maxWidth:"sm",fullWidth:!0,title:o.copyVessel,onConfirm:this.onSave,confirmBtnName:o.create,disableConfirmBtn:i,fullscreenOnMobile:!0},r.a.createElement(m.b,{reactKeyPrefix:a+"text-input",onKeyDown:this.handleKeyPress,label:s.vesselName,required:!0,autoFocus:!0,error:l||c,onInputChange:this.onChange,helperText:d,FormHelperTextProps:{error:c}}))}}const f=Object(b.b)([v.a.IInternationalization],Object(p.k)(y));var h=a(1268),C=a(37),O=a(12),P=a(273),k=a(23),T=a(148),j=a(134),S=a(1),E=a(43),I=a(229),N=a(32),A=a(7),x=a(19),D=a(199),w=a(70);const L=e=>{const{reactKeyPrefix:t,userLocale:a,vessel:n,showDialog:o,onClose:s}=e,i=Object(k.a)(N.a),[d,u]=Object(b.a)([v.a.IInternationalization,A.a.ITSModelActionsAsync]),[p,y]=Object(l.useState)(!0),[f,h]=Object(l.useState)(!1),{common:L}=d.getLanguageFile(),[R,M]=Object(l.useState)(new I.a({})),B=Object(P.a)({companyRequired:!0,businessUnitRequired:!0});Object(l.useEffect)(()=>{f&&R.defaultCompany&&R.defaultBusinessUnit&&y(!1)},[f,y,R.defaultBusinessUnit,R.defaultCompany]);const F=(e,t)=>{"companyBusinessUnit"===e&&t.company&&t.businessUnit&&M(e=>Object.assign(Object.assign({},e),{defaultCompany:new j.a({key:t.company}),defaultBusinessUnit:new T.a({key:t.businessUnit})}))},U=(e,t)=>{h(t),M(t=>Object.assign(Object.assign({},t),{vesselCode:e}))},K=Object(l.useMemo)(()=>function(e,t,a,n,o,s,i,l){var r;const{common:c}=t.lang(),d=null!==(r=null==l?void 0:l.find(e=>{var t,a;return e.company===(null===(t=null==n?void 0:n.defaultCompany)||void 0===t?void 0:t.key)&&e.businessUnit===(null===(a=null==n?void 0:n.defaultBusinessUnit)||void 0===a?void 0:a.key)}))&&void 0!==r?r:null,u=Object(D.a)(o,[{fieldName:"vesselCode",textInputProps:{letterCase:m.a.UPPERCASE,onInputChange:i,validation:w.b.VesselCode}},{fieldName:"defaultCompany",formControlProps:{required:!0},label:c.companyBusinessUnit,typeaheadProps:{options:null!=l?l:[],defaultSelectedOptions:d,resolver:e=>null==e?void 0:e.label},onUpdateOverride:s.bind(null,"companyBusinessUnit")}]);return Object(x.a)({disableUpdate:!0,fieldOptions:u,object:n,type:S.a.vesselcode,userLocale:a,reactKeyPrefix:e})}(t,d,a,R,null!=i?i:new E.a({}),F,U,B),[B,d,t,i,a,R]);return r.a.createElement(g.a,{reactKeyPrefix:t,open:o,maxWidth:"xs",fullWidth:!0,onCloseModal:s,confirmBtnName:L.create,onConfirm:()=>{var e,t;u.createAction({data:{defaultBusinessUnit:null===(e=R.defaultBusinessUnit)||void 0===e?void 0:e.key,defaultCompany:null===(t=R.defaultCompany)||void 0===t?void 0:t.key,vessel:n.key,vesselCode:R.vesselCode},fields:Object.assign(Object.assign({},c.b.vesselCodes),{vessel:"*"}),type:S.a.vesselcode}),s()},title:L.createInternalData,fullscreenOnMobile:!0,disableConfirmBtn:p},r.a.createElement(C.a,{reactKeyPrefix:t+"-modal-fields",items:K,breakpoints:O.e}))};var R=a(75),M=a(86),B=a(28);const F=(e,t,a,n,o,s,i)=>{var l;const{common:r,model:d}=s.getLanguageFile(),u=a.vesselCodes.length>0?new I.a(a.vesselCodes[0]):new I.a({}),p=null!==(l=null==o?void 0:o.find(e=>{var t,a;return e.company===(null===(t=null==u?void 0:u.defaultCompany)||void 0===t?void 0:t.key)&&e.businessUnit===(null===(a=null==u?void 0:u.defaultBusinessUnit)||void 0===a?void 0:a.key)}))&&void 0!==l?l:null;return[Object(x.a)({fieldOptions:[{fieldName:"vesselCode",textInputProps:{letterCase:m.a.UPPERCASE,validation:w.b.VesselCode}},{fieldName:"vesselClass",typeaheadProps:{shouldPreload:!0}},{fieldName:"vesselSeries",typeaheadProps:{shouldPreload:!0}},{fieldName:"master",typeaheadProps:{shouldPreload:!0}},{fieldName:"masterUser",typeaheadProps:{shouldPreload:!0}},{fieldName:"technicalManager",typeaheadProps:{objectPaths:M.b.businessPartner,shouldPreload:!0}},{fieldName:"operator",typeaheadProps:{shouldPreload:!0}},{fieldName:"claimOperator",typeaheadProps:{shouldPreload:!0}},{fieldName:"accountantResponsible",label:d.responsibleAccountant,typeaheadProps:{shouldPreload:!0}}],object:u||new I.a({}),parentData:{type:S.a.vessel,key:a.key},type:S.a.vesselcode,updateResponseFields:c.b,userLocale:t,reactKeyPrefix:e}),Object(x.a)({fieldOptions:[{fieldName:"fleetEntryDate"},{fieldName:"fleetExitDate"},{fieldName:"fleetEntryPort"},{fieldName:"nextDryDockDate"},{fieldName:"runningCostPerDay",label:d.operatingCostDay,numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"isSchedulable",label:d.schedulable},{fieldName:"calcFolsEca",label:d.estimateFolsEca}],object:u||new I.a({}),parentData:{type:S.a.vessel,key:a.key},type:S.a.vesselcode,updateResponseFields:c.b,userLocale:t,reactKeyPrefix:e}),Object(x.a)({fieldOptions:[{fieldName:"pniClub",typeaheadProps:{shouldPreload:!0,objectPaths:M.b.businessPartner}},{fieldName:"pniEntryDate"},{fieldName:"pniExitDate"},{fieldName:"headOwnerPniClub",typeaheadProps:{shouldPreload:!0,objectPaths:M.b.businessPartner}},{fieldName:"hnmClub",typeaheadProps:{shouldPreload:!0,objectPaths:M.b.businessPartner}},{fieldName:"hnmGrossValue",numberInputProps:{maskSettings:B.a.mask2}}],object:u||new I.a({}),parentData:{type:S.a.vessel,key:a.key},type:S.a.vesselcode,updateResponseFields:c.b,userLocale:t,reactKeyPrefix:e}),Object(x.a)({fieldOptions:[{fieldName:"defaultCompany",formControlProps:{required:!1},label:r.companyBusinessUnit,typeaheadProps:{options:null!=o?o:[],defaultSelectedOptions:p,resolver:e=>null==e?void 0:e.label},breakpoints:O.e,onUpdateOverride:n.bind(null,"companyBusinessUnit")},{fieldName:"defaultBankAccount",label:d.bankAccountReceivable,typeaheadProps:{objectPaths:["bank.bankName","bankAccountNo"],shouldPreload:!0},breakpoints:O.i},{fieldName:"masterAccount",typeaheadProps:{objectPaths:M.b.businessPartner,shouldPreload:!0},breakpoints:O.i},{fieldName:"pool",typeaheadProps:{shouldPreload:!0},breakpoints:O.i}],object:u||new I.a({}),parentData:{type:S.a.vessel,key:a.key},type:S.a.vesselcode,updateResponseFields:c.b,userLocale:t,reactKeyPrefix:e})][i]};var U=a(111),K=a(71),V=a(374),H=a(21),q=a(47),_=a(20),z=a(2471),W=a(67),G=a(5);const[$]=Object(b.a)([v.a.IInternationalization]),{common:X,vessel:Q}=$.getLanguageFile(),Z={getHeaders:[{content:X.validFrom,contentType:G.a.DATE},{content:Q.earningPoint,contentType:G.a.NUMBER,numberFormatOptions:{maxDecimals:3}}],getRow:e=>{const{key:t,validFromDate:a,earningPoint:n}=e;return{content:[a,null!=n?n:0],id:t}}};var Y=a(100),J=a.n(Y),ee=a(51);function te(e,t,a,n,o){const{common:s,vessel:i}=o.getLanguageFile(),l=[{fieldName:"validFromDate",label:s.validFromDate,formControlProps:{required:!0},dateInputProps:{showTime:!0},onUpdateOverride:a.bind(null,"validFromDate")},{fieldName:"earningPoint",label:i.poolEarningPoint,numberInputProps:{maskSettings:B.a.mask1},onUpdateOverride:a.bind(null,"earningPoint")}],r={reactKeyPrefix:e,object:t,type:S.a.poolearningpoint,userLocale:n,fieldOptions:l};return Object(x.a)(r)}const ae=e=>{var t,a;const{reactKeyPrefix:n,showModal:o,onClose:s,poolEarningPoint:i,vesselCode:c}=e,[d,u]=Object(b.a)([v.a.IInternationalization,_.a.IPoolEarningPointController]),{common:p,vessel:m}=d.getLanguageFile(),g=Object(l.useCallback)(e=>!e.validFromDate,[]),y=Object(l.useMemo)(()=>{const e=(null==i?void 0:i.key)?m.editPoolEarningPoint:m.createPoolEarningPoint,t=(null==i?void 0:i.key)?p.save:p.create;return{reactKeyPrefix:n+"-create-edit-pool-earning-point-modal",title:e,maxWidth:"xs",open:o,confirmBtnName:t,onCloseModal:s,onDelete:()=>{c&&u.loadPoolEarningPoints(c.key)}}},[null==i?void 0:i.key,m,p,n,o,s,c,u]);return r.a.createElement(ee.a,{modalProps:y,breakpoints:O.e,getColSpec:te,selectedObject:i,propertiesToSet:{validFromDate:null!==(t=null==i?void 0:i.validFromDate)&&void 0!==t?t:(new Date).setHours(0,0),vesselCode:null!==(a=null==c?void 0:c.key)&&void 0!==a?a:0},isConfirmDisabled:g,createProps:(null==i?void 0:i.key)?void 0:{type:S.a.poolearningpoint},updateProps:(null==i?void 0:i.key)?{type:S.a.poolearningpoint}:void 0,allowDelete:!!(null==i?void 0:i.key)})};function ne(e){const{reactKeyPrefix:t,userLocale:a,vessel:n,onChange:o,companyBusinessUnits:s,i:i}=e,{common:c,vessel:d}=i.getLanguageFile(),u=null==n?void 0:n.vesselCodes[0],[p,m]=Object(l.useState)(!1),[g,b]=Object(l.useState)(),v=Object(l.useMemo)(()=>Z.getHeaders,[]),y=Object(l.useMemo)(()=>{var e;return null!==(e=null==u?void 0:u.poolEarningPoints.map(e=>Z.getRow(e)))&&void 0!==e?e:[]},[null==u?void 0:u.poolEarningPoints]),f=Object(l.useCallback)(()=>{m(!p)},[p]),h=Object(l.useCallback)(()=>{b(void 0),f()},[f]),O=[{disabled:!1,icon:J.a,iconButtonProps:{color:"primary"},label:c.create,onClick:h,reactKeyPrefix:t+"primary-actions"}],P=Object(l.useCallback)(e=>{const t=null==u?void 0:u.poolEarningPoints.find(t=>t.key===e);t&&(b(t),f())},[f,null==u?void 0:u.poolEarningPoints]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,null,r.a.createElement(z.a,{sx:{display:"flex",flexDirection:"row"}},r.a.createElement(z.a,{sx:{width:"100%"}},r.a.createElement(R.a,{title:d.miscellaneous}),r.a.createElement(C.a,{reactKeyPrefix:t+"-fields",items:F(t,a,null!=n?n:new U.a({}),o,s,i,3)})),r.a.createElement(z.a,{sx:{pl:2,pt:7,width:"100%"}},r.a.createElement(W.a,{title:d.poolEarningPoints,userLocale:a,headers:v,data:y,reactKeyPrefix:t+"-table",primaryActions:O,onRowClick:P})))),p&&r.a.createElement(ae,{reactKeyPrefix:t,userLocale:a,showModal:p,onClose:f,poolEarningPoint:g,vesselCode:null==n?void 0:n.vesselCodes[0]}))}const oe=e=>{var t;const{reactKeyPrefix:a,vesselId:n,userLocale:o,state:{vessel:s}}=e,[i,d,u]=Object(b.a)([v.a.IInternationalization,A.a.ITSModelActionsAsync,_.a.IVesselDrawerController]),p=i.getLanguageFile().vessel,m=null==s?void 0:s.vesselCodes[0];Object(l.useEffect)(()=>{u.loadVessel(c.b,n)},[]);const g=Object(P.a)(Object.assign({companyRequired:!1,businessUnitRequired:!1},s&&(null===(t=null==s?void 0:s.vesselCodes)||void 0===t?void 0:t.length)>0&&(null==m?void 0:m.defaultCompany)||(null==m?void 0:m.defaultBusinessUnit)?{selectedCompany:null==m?void 0:m.defaultCompany,selectedBusinessUnit:null==m?void 0:m.defaultBusinessUnit}:{})),y=(e,t)=>{var a,n;"companyBusinessUnit"===e&&s&&s.vesselCodes.length>0&&d.updateSingleAction({data:{defaultBusinessUnit:null!==(a=null==t?void 0:t.businessUnit)&&void 0!==a?a:null,defaultCompany:null!==(n=null==t?void 0:t.company)&&void 0!==n?n:null},fields:c.b.vesselCodes,type:S.a.vesselcode,key:s.vesselCodes[0].key})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,null,r.a.createElement(R.a,{title:p.responsiblePersons}),r.a.createElement(C.a,{reactKeyPrefix:a+"-fields",items:F(a,o,null!=s?s:new U.a({}),y,g,i,0),breakpoints:O.a})),r.a.createElement(K.a,null,r.a.createElement(R.a,{title:p.fleet}),r.a.createElement(C.a,{reactKeyPrefix:a+"-fields",items:F(a,o,null!=s?s:new U.a({}),y,g,i,1),breakpoints:O.a})),r.a.createElement(K.a,null,r.a.createElement(R.a,{title:p.insurance}),r.a.createElement(C.a,{reactKeyPrefix:a+"-fields",items:F(a,o,null!=s?s:new U.a({}),y,g,i,2),breakpoints:O.a})),r.a.createElement(ne,{reactKeyPrefix:a+"-pool-earning-point-section",userLocale:o,vessel:s,onChange:y,companyBusinessUnits:g,i:i}))};const se=Object(q.a)((function(e){const t=V.a.get(e);return{vessel:H.a.getTSModelBuilt(e,S.a.vessel,t||0,c.b)}}),Object(l.memo)(oe));a(268),a(269);var ie=a(1284),le=a(1231),re=a(139),ce=a(89),de=a(224),ue=a(130);function pe(e){const{reactKeyPrefix:t,userLocale:a,vesselId:n,state:{vessel:o}}=e,[s,i,d]=Object(b.a)([v.a.IInternationalization,A.a.ITSModelActionsAsync,_.a.IVesselDrawerController]),u=s.getLanguageFile();Object(l.useEffect)(()=>{d.loadVessel(c.h,n)},[]);const p=Object(l.useCallback)(({key:e,dwtMeasurement:n,scrubberFittedMe:s})=>{var i;return Object(x.a)({fieldOptions:[{fieldName:"vesselType",typeaheadProps:{shouldPreload:!0}},{InputProps:{endAdornment:null!==(i=null==n?void 0:n.measurementCode)&&void 0!==i?i:""},fieldName:"dwtSummer",numberInputProps:{maskSettings:B.a.mask4}},{InputProps:{style:{textAlign:"left"}},fieldName:"builtYear",label:u.model.built,numberInputProps:{maskSettings:{format:le.a.Year}}},{fieldName:"builtShipyard",label:u.model.yard},{fieldName:"flag"},{fieldName:"imoNumber"},{fieldName:"scrubberFittedMe",label:u.model.scrubberFitted},{fieldName:"isOpenLoopScrubber",label:u.model.openLoop,disabled:!s}],object:o||new U.a({}),parentData:{type:S.a.vessel,key:e},type:S.a.vessel,updateResponseFields:c.h,userLocale:a,reactKeyPrefix:t})},[u.model.built,u.model.openLoop,u.model.scrubberFitted,u.model.yard,t,a,o]),g=Object(l.useCallback)((e,a)=>{const n=t=>i.updateSingleAction({data:{contactInfo:[Object(ce.b)(t)],key:e.key},fields:c.h,key:e.key,type:S.a.vessel}),s={object:e||new U.a({}),parentData:{type:S.a.vessel,key:e.key},type:S.a.vessel,updateResponseFields:c.h,userLocale:a,reactKeyPrefix:t};return[o?p(o):[],Object(x.a)(Object.assign({fieldOptions:[{fieldName:"beam",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"loa",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"lpp",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"depth",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"airDraft",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"internationalGt",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"internationalNt",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"ntPanama",numberInputProps:{maskSettings:B.a.mask2}},{fieldName:"ntSuez",numberInputProps:{maskSettings:B.a.mask2}}]},s)),Object(x.a)(Object.assign({fieldOptions:[{fieldName:"capacityFo",numberInputProps:{maskSettings:B.a.mask8}},{fieldName:"capacityWater",numberInputProps:{maskSettings:B.a.mask8}},{fieldName:"capacityBallastWater",numberInputProps:{maskSettings:B.a.mask8}},{fieldName:"constantReduction",numberInputProps:{maskSettings:B.a.mask8}}]},s)),Object(x.a)(Object.assign({fieldOptions:[{fieldName:"mainEngine"},{fieldName:"auxEngine"},{fieldName:"bowThruster"},{fieldName:"sternThruster"},{fieldName:"shaftGenerator"}]},s)),Object(x.a)(Object.assign({fieldOptions:[{fieldName:"callSignal"}]},s)).concat(Object(x.a)({fieldOptions:[{fieldName:"phoneNo",onUpdateOverride:e.contactInfo[0]?void 0:e=>n(new re.a({phoneNo:e}))},{fieldName:"faxNo",onUpdateOverride:e.contactInfo[0]?void 0:e=>n(new re.a({faxNo:e}))},{fieldName:"mobileNo",onUpdateOverride:e.contactInfo[0]?void 0:e=>n(new re.a({mobileNo:e}))},{fieldName:"email",onUpdateOverride:e.contactInfo[0]?void 0:e=>n(new re.a({email:e})),textInputProps:{letterCase:m.a.LOWERCASE,validation:w.b.EmailOnClient}},{fieldName:"telexNo",onUpdateOverride:e.contactInfo[0]?void 0:e=>n(new re.a({telexNo:e}))}],object:e.contactInfo[0]||new re.a({}),parentData:{type:S.a.vessel,key:e.key},type:S.a.contactinfo,updateResponseFields:de.c,userLocale:a,reactKeyPrefix:t})),Object(x.a)(Object.assign({fieldOptions:[{fieldName:"cubicGrain",numberInputProps:{maskSettings:{decimalScale:0}}},{fieldName:"cubicDeck",numberInputProps:{maskSettings:{decimalScale:0}}},{fieldName:"cubicBales",numberInputProps:{maskSettings:{decimalScale:0}}},{fieldName:"gear"},{fieldName:"holdsHatches"},{fieldName:"hasGrabsOnboard"}]},s))]},[p,t,i,o]),y=Object(l.useMemo)(()=>{const e=[u.vessel.vesselDescription,u.vessel.dimensions,u.vessel.miscCapacities,u.vessel.machinery,u.vessel.contactDetails,u.vessel.cargoCapacity];return o&&a?g(o,a).flatMap((a,n)=>r.a.createElement(l.Fragment,{key:"getVesselOverviewColspec_"+n},r.a.createElement(ue.a,{variant:"h4",key:"sectionHeader_"+n},e[n]),r.a.createElement(C.a,{reactKeyPrefix:`${t}-vessel_overview_horizontal_list_${n}`,key:"vessel_overview_horizontal_list_"+n,items:a,breakpoints:O.a}))):[]},[g,u.vessel,t,a,o]);return r.a.createElement(l.Fragment,null,y,r.a.createElement(ie.a,{reactKeyPrefix:t+"-load-line-table",vessel:o,userLocale:a}))}const me=Object(q.a)((function(e){const t=V.a.get(e);return{vessel:H.a.getTSModelBuilt(e,S.a.vessel,t||0,c.h)}}),Object(l.memo)(pe));var ge=a(421),be=a(46),ve=a(208),ye=a(42),fe=a(27),he=a(214),Ce=a(2383),Oe=a(323),Pe=a(213),ke=a(187),Te=a(107),je=a(61),Se=a(136),Ee=a(937),Ie=(a(59),a(118),a(848)),Ne=a(212),Ae=a(60),xe=a(827),De=a.n(xe),we=a(40),Le=a(105),Re=a(58),Me=a(62),Be=a(742);const[Fe]=Object(b.a)([v.a.IInternationalization]),{common:Ue,model:Ke}=Fe.getLanguageFile(),Ve=[{content:Ke.sequence,flex:"1",contentType:Ne.a.TEXT},{content:Ke.reference,flex:"1",contentType:Ne.a.TEXT},{content:Ue.start,flex:"1",contentType:Ne.a.DATE},{content:Ke.charterer,flex:"1",contentType:Ne.a.TEXT},{content:Ke.ballast,flex:"1",contentType:Ne.a.TEXT},{content:Ue.firstLoad,flex:"1",contentType:Ne.a.TEXT},{content:Ue.lastDischarge,flex:"1",contentType:Ne.a.TEXT},{content:Ue.status,flex:"1",contentType:Ne.a.ELEMENT}];var He=a(983),qe=a(1580),_e=function(e,t,a,n){return new(a||(a=Promise))((function(o,s){function i(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}r((n=n.apply(e,t||[])).next())}))};function ze(e){var t,a;const{reactKeyPrefix:n,open:o,onClose:s,onResequence:i,fleetPlanVoyages:c,userLocale:d}=e,[u,p]=Object(l.useState)(c),[m,y]=Object(l.useState)([]),[f,h]=Object(l.useState)(!1),[C,O]=Object(b.a)([v.a.IInternationalization,A.a.IVoyageController]),P=null!==(a=null===(t=Object(Be.a)(c,"sequence"))||void 0===t?void 0:t.sequence)&&void 0!==a?a:1,k=Object(l.useMemo)(()=>function(e){var t,a;const n=null!==(a=null===(t=Object(Be.a)(e,"sequence"))||void 0===t?void 0:t.sequence)&&void 0!==a?a:0;return e.map(({key:e,voyage:t,sequence:a},o)=>{var s,i,l,c,d,u,p,m,g,b,v,y,f,h,C,O,P,k,T;const j=n-o,E=null!=t?t:new Me.a({}),I=Ae.a.getPerformanceCargo(E.cargos),N=Re.a.getFirstLoadCargoPort(I.cargoPorts),A=Re.a.getLastDischargeCargoPort(I.cargoPorts),x=E.isTc?null===(i=null===(s=E.tcs[0])||void 0===s?void 0:s.charterer)||void 0===i?void 0:i.businessPartnerName:null===(l=I.charterer)||void 0===l?void 0:l.businessPartnerName;return{content:[j!==a?`${n-o} (${a})`:a,null!==(d=null===(c=E.voyageHeader)||void 0===c?void 0:c.referenceNo)&&void 0!==d?d:"",null!==(p=null===(u=E.voyageHeader)||void 0===u?void 0:u.voyageStartDate)&&void 0!==p?p:"",null!=x?x:"",null!==(g=null===(m=E.ballastPort)||void 0===m?void 0:m.portName)&&void 0!==g?g:"",null!==(v=null===(b=null==N?void 0:N.port)||void 0===b?void 0:b.portName)&&void 0!==v?v:"",null!==(f=null===(y=null==A?void 0:A.port)||void 0===y?void 0:y.portName)&&void 0!==f?f:"",r.a.createElement(Oe.a,{key:null===(h=E.voyageHeader)||void 0===h?void 0:h.referenceNo,display:"flex",alignItems:"center",justifyContent:"space-between"},r.a.createElement(we.a,{label:null===(O=null===(C=E.voyageHeader)||void 0===C?void 0:C.voyageStatus)||void 0===O?void 0:O.statusTypeDesc,priority:Le.a.getStatusPriority(null!==(T=null===(k=null===(P=E.voyageHeader)||void 0===P?void 0:P.voyageStatus)||void 0===k?void 0:k.statusTypeDesc)&&void 0!==T?T:"",S.a.voyage)}),r.a.createElement(De.a,null))],id:e}})}(u),[u]),T=Object(l.useCallback)((e,t)=>{y(a=>Object(He.a)(a.concat(e[t].id))),p(t=>[...t].sort((t,a)=>Object(qe.a)(e,{id:t.key})-Object(qe.a)(e,{id:a.key})))},[]),j=Object(l.useCallback)(()=>_e(this,void 0,void 0,(function*(){let e=P;for(const t of u)t.voyage&&t.voyage.vessel&&m.includes(t.key)&&(h(!0),yield O.moveVoyage(t.voyage,t.voyage.vessel,t,e,!1,ge.e)),e--;i(),s()})),[m,P,s,i,u,O]);return r.a.createElement(g.a,{open:o,onCloseModal:s,maxWidth:"md",reactKeyPrefix:n+"-resequence-voyages-modal",title:C.lang().vessel.resequenceVoyages,confirmBtnName:C.lang().common.save,onConfirm:j,disableConfirmBtn:!!f,hideCancelBtn:!!f,fullWidth:!0,disableDraggable:!0},r.a.createElement(he.a,{container:!0,spacing:2},r.a.createElement(he.a,{item:!0,xs:12},r.a.createElement(Ie.a,{headers:Ve,data:k,enableRowDragDrop:!0,onRowReorder:T,reactKeyPrefix:n+"-voyage-list",userLocale:d,height:"100%",width:"100%"})),r.a.createElement(he.a,{item:!0,xs:12},r.a.createElement(ue.a,{variant:"body2"},C.lang().common.resequenceVoyagesHelperText))))}var We=a(695),Ge=a(125),$e=a.n(Ge),Xe=(a(1372),a(468)),Qe=a(893),Ze=a(2376),Ye=a(525);const Je=e=>Object(ke.a)({container:{maxHeight:"90vh",position:"relative",top:0,width:"100%",borderRadius:"5px",[e.breakpoints.down("md")]:{minHeight:"40vw"}},map:{position:"absolute",top:0,right:0,bottom:0,left:0,outline:"block",borderRadius:"5px"},noImoContainer:{alignContent:"center",position:"absolute",top:0,bottom:"0px",width:"100%",zIndex:Ye.a.vesselMap},noImoWarningContainer:{left:"50%",maxWidth:"400px",minHeight:"50px",padding:e.spacing(2),position:"absolute",textAlign:"center",top:"50%",transform:"translate(-50%, -50%)",width:"90%",[e.breakpoints.down(768)]:{width:"70%"},[e.breakpoints.up(768)]:{width:"60%"},"&>*:not(:last-child)":{marginBottom:e.spacing(1)}},noImoBackground:{backgroundColor:e.palette.common.black,height:"100%",opacity:.5,position:"absolute",width:"100%",borderRadius:"5px"}});const et=Object(We.a)(Je)((function(e){const{classes:t,errorMessage:a,isLoading:n}=e;return r.a.createElement("div",{className:t.noImoContainer},r.a.createElement("div",{className:t.noImoBackground}),r.a.createElement(Qe.a,{className:t.noImoWarningContainer},r.a.createElement(ue.a,{variant:"subtitle1"},a),n&&r.a.createElement(Ze.a,{size:50})))}));a(1003);var tt=a(181),at=a(38),nt=a(980),ot=a(265),st=a(691);const it=Object(b.b)([v.a.IInternationalization],Object(We.a)(Je)((function(e){const{classes:t,hasSubscription:a,nextPortCall:n,vessel:o,positionReports:s,ddtRoute:i=null}=e,c=e.deps[0].getLanguageFile(),[d,u]=Object(l.useState)(!0),[p,m]=Object(l.useState)(!1),g=tt.a.getAISTrack(o.aisPositions,n),b=Object(l.useRef)(void 0),v=Object(l.useRef)(void 0),y=Object(l.useRef)(void 0),f=Object(l.useRef)(void 0),h=Object(l.useRef)(void 0),C=Object(l.useRef)(void 0),O=Object(l.useCallback)(()=>{if(null!==o&&b.current&&y.current&&f.current&&C.current){const e=$e.a.layerGroup([y.current]),t=$e.a.layerGroup([f.current]),a=$e.a.layerGroup([C.current]);e.addTo(b.current),i&&i.length>1&&t.addTo(b.current),a.addTo(b.current);const n=i&&i.length>1?c.vessel.ddtRoute:c.vessel.ddtRouteNa,o=g&&g.length>1?c.vessel.aisTrack:c.vessel.aisTrackNa,s=g&&g.length>1?{[n]:t,[o]:e,[c.vessel.navAid]:a}:{[n]:t,[c.vessel.navAid]:a};h.current=$e.a.control.layers(void 0,s).addTo(b.current)}},[g,i,c.vessel.aisTrack,c.vessel.aisTrackNa,c.vessel.ddtRoute,c.vessel.ddtRouteNa,c.vessel.navAid,o]);Object(l.useEffect)(()=>{if(!b.current){b.current=$e.a.map("map",{fullscreenControl:{pseudoFullscreen:!0},worldCopyJump:!0,maxBounds:[[-90,-270],[90,360]]}).setView([0,0],Xe.a.zoom),$e.a.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>&copy; <a href="https://carto.com/attributions">CARTO</a>',maxZoom:Xe.a.maxZoom,minZoom:Xe.a.minZoom}).addTo(b.current),C.current=$e.a.tileLayer("https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",{attribution:'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a>',maxZoom:Xe.a.maxZoom,minZoom:Xe.a.minZoom}).addTo(b.current);const e=b.current.getZoom();null!==o&&(v.current=Object(st.a)(e,[o],s).addTo(b.current),f.current=Object(nt.a)(i,at.a.secondary,c.vessel.ddtRoute).addTo(b.current),y.current=Object(nt.a)(g,at.a.accents.priority5,c.vessel.aisTrack).addTo(b.current),O())}},[o,s,i,g,c.vessel.ddtRoute,c.vessel.aisTrack,O]);const P=()=>{null!==o&&b.current&&(v.current&&v.current.clearLayers(),f.current&&f.current.clearLayers(),y.current&&y.current.clearLayers(),f.current&&y.current&&h.current&&b.current.removeControl(h.current))};if(b.current){let e=b.current.getZoom();b.current.on("zoomend",()=>{null!==o&&v.current&&b.current&&(v.current.clearLayers(),e=b.current.getZoom(),v.current=Object(st.a)(e,[o],s).addTo(b.current))})}return Object(l.useEffect)(()=>{null!==o&&b.current&&(P(),ot.a.positionExists(o,s)&&(v.current=Object(st.a)(b.current.getZoom(),[o],s).addTo(b.current),f.current=Object(nt.a)(i,at.a.secondary,c.vessel.ddtRoute).addTo(b.current),y.current=Object(nt.a)(g,at.a.accents.priority5,c.vessel.aisTrack).addTo(b.current),O(),b.current.setView([ot.a.getLatitude(o,s),ot.a.increaseLongitudeIfBelowZero(ot.a.getLongitude(o,s))],Xe.a.zoom),u(!0),m(!0)))},[o,s,i,g,P,c.vessel.ddtRoute,c.vessel.aisTrack,O]),r.a.createElement("div",{className:t.container,id:"mapContainer"},(()=>{if(!o||!s)return r.a.createElement(et,{errorMessage:c.common.loadingVessel,isLoading:!0});if(!d||!p){let e;b.current&&v.current&&v.current.clearLayers();const t=parseInt(o.imoNumber,10);if(null===o.imoNumber||isNaN(t))e=c.common.imoNumberNotFound;else{const t=a?"":" "+c.common.pleaseSubscribeAis;e=c.common.noDataExistForVessel+t}return r.a.createElement(et,{errorMessage:e,isLoading:!1})}})(),r.a.createElement("div",{className:t.map,id:"map"}))})));var lt=a(2469),rt=a(2470),ct=a(2523),dt=a(202),ut=a(472);const pt={xs:4,sm:3,md:3,lg:2,xl:2},mt=({items:e})=>r.a.createElement(he.a,{container:!0,item:!0,spacing:2},e.map(({label:e,value:t},a)=>r.a.createElement(he.a,Object.assign({key:e+a,item:!0,container:!0,spacing:.5},pt,{direction:"column"}),r.a.createElement(he.a,{item:!0,fontWeight:"fontWeightBold"},e),r.a.createElement(he.a,{sx:{color:""===t?"text.disabled":void 0},item:!0},""===t?"":t))));function gt({vessel:e}){const[t,a]=Object(b.a)([v.a.IInternationalization,_.a.IVesselDrawerController]),[n,o]=Object(l.useState)(!1),s=n?lt.a:rt.a,{vessel:i,common:d}=t.getLanguageFile(),u=Object(l.useMemo)(()=>function(e,t){var a,n,o,s,i,l,r;const{cubicGrain:c,cubicMeasurement:d,draftMeasurement:u,draftSummer:p,draftTropical:m,dwtMeasurement:g,dwtSummer:b,dwtTropical:v,immersionMeasurement:y,immersionSummer:f,immersionTropical:h,internationalGt:C,internationalNt:O,owner:P,vesselCodes:k}=e,T=Object(ut.a)(k),j=null!==(a=null==g?void 0:g.measurementCode)&&void 0!==a?a:"",S=null!=u?u:"",E=null!==(n=null==d?void 0:d.measurementCode)&&void 0!==n?n:"",{common:I,model:N}=t.getLanguageFile();return[{label:N.dwtSummer,value:`${t.formatNumber(b,{maxDecimals:0})} ${j}`},{label:N.draft,value:`${t.formatNumber(p,{minDecimals:3,maxDecimals:3})} ${S}`},{label:N.immersion,value:`${t.formatNumber(f,{minDecimals:3,maxDecimals:3})} ${y}`},{label:N.dwtTropical,value:`${t.formatNumber(v,{maxDecimals:0})} ${j}`},{label:N.draft,value:`${t.formatNumber(m,{minDecimals:3,maxDecimals:3})} ${S}`},{label:N.immersion,value:`${t.formatNumber(h,{minDecimals:3,maxDecimals:3})} ${y}`},{label:N.internationalGt,value:t.formatNumber(C,{maxDecimals:0})},{label:N.internationalNt,value:t.formatNumber(O,{maxDecimals:0})},{label:I.class,value:null!==(s=null===(o=null==T?void 0:T.vesselClass)||void 0===o?void 0:o.vesselClassDesc)&&void 0!==s?s:""},{label:N.cubicGrain,value:`${t.formatNumber(c,{maxDecimals:0})} ${E}`},{label:N.headOwnerPniClub,value:null!==(l=null===(i=null==T?void 0:T.headOwnerPniClub)||void 0===i?void 0:i.businessPartnerName)&&void 0!==l?l:""},{label:N.owner,value:null!==(r=null==P?void 0:P.businessPartnerName)&&void 0!==r?r:""}]}(e,t),[t,e]),p=Object(l.useMemo)(()=>function(e,t){var a,n,o,s,i;const{callSignal:l,contactInfo:r}=e,{model:c}=t.getLanguageFile(),d=Object(ut.a)(r);return[{label:c.callSignal,value:null!=l?l:""},{label:c.phoneNo,value:null!==(a=null==d?void 0:d.phoneNo)&&void 0!==a?a:""},{label:c.faxNo,value:null!==(n=null==d?void 0:d.faxNo)&&void 0!==n?n:""},{label:c.mobileNo,value:null!==(o=null==d?void 0:d.mobileNo)&&void 0!==o?o:""},{label:c.email,value:null!==(s=null==d?void 0:d.email)&&void 0!==s?s:""},{label:c.telexNo,value:null!==(i=null==d?void 0:d.telexNo)&&void 0!==i?i:""}]}(e,t),[t,e]),m=Object(l.useCallback)(()=>{n||a.loadVessel(c.j,e.key),o(!n)},[n,e.key,a]);return r.a.createElement(K.a,null,r.a.createElement(R.a,{title:i.vesselDetails,HeaderActionIcon:r.a.createElement(s,{onClick:m}),sx:{justifyContent:"space-between"}}),r.a.createElement(mt,{items:u}),r.a.createElement(ct.a,{in:n},r.a.createElement(dt.a,null),r.a.createElement(R.a,{title:d.contact}),r.a.createElement(mt,{items:p})))}var bt=a(462),vt=a(216),yt=a(169),ft=a(14),ht=a(50);const Ct=ft.a.get(v.a.IInternationalization),{model:Ot,common:Pt}=Ct.getLanguageFile(),kt=({portCall:e,reactKeyPrefix:t,checked:a,eventCode:n,userLocale:o})=>{const s=Object(vt.c)(ht.a.getEventLogDateFromPC(e,n),o);return r.a.createElement(r.a.Fragment,null,r.a.createElement(yt.a,{reactKeyPrefix:t+"checkbox",disabled:!0,checked:a,sx:{py:0,px:.5}}),s)},Tt=[{content:Ot.port,contentType:G.a.TEXT},{content:Ot.reasonForCall,contentType:G.a.TEXT},{alignHeaderContent:G.c.LEFT,content:Pt.status,contentType:G.a.ELEMENT},{content:Ot.arrivalTime,contentType:G.a.ELEMENT},{content:Ot.berthedTime,contentType:G.a.ELEMENT},{content:Ot.departureTime,contentType:G.a.ELEMENT},{content:Ot.comments,contentType:G.a.TEXT},{content:Ot.portCost,contentType:G.a.TEXT,hiddenByDefault:!0,alignHeaderContent:G.c.RIGHT},{content:Ot.daysLoadingDischarging,contentType:G.a.NUMBER,hiddenByDefault:!0},{content:Ot.daysExtraInPort,contentType:G.a.NUMBER,hiddenByDefault:!0},{content:Ot.daysTotal,contentType:G.a.NUMBER,hiddenByDefault:!0}];var jt=a(218),St=a(2104),Et=a(1325),It=a(35);const Nt=ft.a.get(v.a.IInternationalization),{model:At,common:xt}=Nt.getLanguageFile(),Dt=["sequence","voyage.voyageHeader.leg.legDesc","voyage.vessel.vesselName","voyage.voyageHeader.referenceNo","voyage.cargos.cpDate","voyage.cargos.commodity.commodityName","voyage.cargos.charterer.businessPartnerName","voyage.cargos.cargoPorts.reasonForCall.reasonForCall","voyage.cargos.cargoPorts.cargoPortSequence","voyage.cargos.cargoPorts.port.portName","voyage.voyageHeader.charteringResponsible.userName","voyage.voyageHeader.operator.userName","voyage.voyageHeader.accountantResponsible.userName","voyage.voyageHeader.voyageStartDate","voyage.voyageHeader.voyageEndDate","voyage.isObjectActive","voyage.isTc","voyage.cargos.coaLine.coa","voyage.voyageHeader.voyageStatus.statusTypeCode","voyage.voyageHeader.voyageStatus.statusTypeDesc","voyage.voyageHeader.company.companyCode","voyage.voyageHeader.isLastVoyage","voyage.voyageHeader.isVoyageStartFixed","voyage.tcs.cpDate","voyage.tcs.charterer.businessPartnerName","voyage.tcs.deliveryPort.portName","voyage.tcs.redeliveryPort.portName","voyage.ballastPort.portName","voyage.tcResultDay","voyage.tcResult","voyage.voyageCurrency.currencyCode","voyage.voyageResult"];const wt=[{content:At.refNo,contentType:G.a.ELEMENT},{content:At.charterer,contentType:G.a.TEXT},{content:At.cpDate,contentType:G.a.DATE,dateTimeFormatOptions:It.a.shortLocalizedDate},{content:At.ballastPort,contentType:G.a.TEXT},{content:At.tce,contentType:G.a.TEXT,alignHeaderContent:G.c.RIGHT},{content:At.contribution,contentType:G.a.TEXT,alignHeaderContent:G.c.RIGHT,hiddenByDefault:!0},{content:At.result,contentType:G.a.TEXT,alignHeaderContent:G.c.RIGHT},{content:xt.type,contentType:G.a.TEXT},{content:At.sequence,contentType:G.a.TEXT},{content:At.respCharterer,contentType:G.a.TEXT,hiddenByDefault:!0},{content:At.respOpr,contentType:G.a.TEXT,hiddenByDefault:!0},{content:At.respAcct,contentType:G.a.TEXT,hiddenByDefault:!0},{content:At.companyCode,contentType:G.a.TEXT,hiddenByDefault:!0},{content:At.lockedStartDate,contentType:G.a.ELEMENT,hiddenByDefault:!0},{content:xt.status,contentType:G.a.ELEMENT,alignHeaderContent:G.c.LEFT},{content:At.voyageStartDate,contentType:G.a.DATE,hiddenByDefault:!0},{content:At.voyageEndDate,contentType:G.a.DATE,hiddenByDefault:!0},{content:At.isLastVoyage,contentType:G.a.ELEMENT,hiddenByDefault:!0},{content:At.loadPort,contentType:G.a.TEXT,hiddenByDefault:!0},{content:At.dischargePort,contentType:G.a.TEXT,hiddenByDefault:!0}];function Lt(e){const t=new Date;return e.find(({voyage:e})=>{var a,n,o,s;return(null!==(n=null===(a=null==e?void 0:e.voyageHeader)||void 0===a?void 0:a.voyageStartDate)&&void 0!==n?n:t)<t&&t<(null!==(s=null===(o=null==e?void 0:e.voyageHeader)||void 0===o?void 0:o.voyageEndDate)&&void 0!==s?s:t)})}var Rt=a(4);const Mt=[{field:"sequence",groupCode:"VESSEL_VOYAGES_LIST_SORT_GROUP_CODE",operator:a(16).b.DESC,queryParamName:"sequence"}],Bt=[{field:"fleetPlanCode",filterGroupCode:"VESSEL_VOYAGES_LIST_FILTER_GROUP_CODE",operator:Rt.c.EQUALS,queryParamName:"fleetPlan.fleetPlanCode",type:Rt.d.STRING,value:"MASTER"},{field:"statusTypeCode",filterGroupCode:"VESSEL_VOYAGES_LIST_FILTER_GROUP_CODE",operator:Rt.c.NOT_EQUALS,queryParamName:"voyage.voyageHeader.voyageStatus.statusTypeCode",type:Rt.d.STRING,value:"SCH"}];var Ft=a(1230),Ut=a.n(Ft),Kt=a(87),Vt=a(2354);function Ht({voyage:e}){var t,a;return null===(a=null===(t=null==e?void 0:e.voyageHeader)||void 0===t?void 0:t.voyageStatus)||void 0===a?void 0:a.statusTypeCode}function qt(e){return"FIN"!==Ht(e)}const _t={canResequenceVoyage:qt,canResequenceAnyVoyage:function(e){return!!e.length&&!!Ht(e[0])&&Object(Vt.a)(e,qt).length>1}};var zt=a(142);const Wt=e=>"VESSEL_VOYAGES_LIST_ID_"+e,Gt={responsive:!1,height:{type:G.d.ROWS,value:5},disableToolbar:!1},$t=Object(Pe.a)(e=>Object(ke.a)({ongoingVoyage:{"& > *:first-child":{boxShadow:"inset 4px 0px 0px 0px "+e.palette.primary.main}}}));function Xt({reactKeyPrefix:e,vessel:t,userLocale:a,positionReports:n,nextPortCall:o,hasSubscription:s,ddtRoute:c,state:{portCalls:d,fleetPlanVoyages:m,selectedVoyageId:g}}){var y;const[f,h,C,O]=Object(b.a)([v.a.IInternationalization,A.a.ITSModelActions,A.a.ISelectedTSModelActions,_.a.IVesselDrawerController]),{model:P,vessel:k}=f.getLanguageFile(),[T,j]=Object(l.useState)(!1),[E,I]=Object(l.useState)(!1),N=$t({}),x=Object(p.g)(),D=Object(p.h)();Object(l.useEffect)(()=>C.setAction(S.a.voyage,null),[]);const w=Object(l.useMemo)(()=>{var e;const t=Lt(m.slice(0,20));return void 0===t&&m.length>0?null!==(e=m[0])&&void 0!==e?e:void 0:t},[m]);Object(l.useEffect)(()=>{var e,t,a,n,o;(null===(e=null==w?void 0:w.voyage)||void 0===e?void 0:e.key)&&T&&(C.setAction(S.a.voyage,null!==(a=null===(t=null==w?void 0:w.voyage)||void 0===t?void 0:t.key)&&void 0!==a?a:null),O.getVoyageWithPortCalls(null!==(o=null===(n=null==w?void 0:w.voyage)||void 0===n?void 0:n.key)&&void 0!==o?o:0))},[null===(y=null==w?void 0:w.voyage)||void 0===y?void 0:y.key,T]);const L=Object(Vt.a)(m,_t.canResequenceVoyage),R=Object(l.useMemo)(()=>Lt(m),[m]),M=Object(l.useCallback)(e=>{var t,a;const n=Ee.a.getVoyageFromFPV(e,{key:"*"});C.setAction(S.a.voyage,null!==(t=null==n?void 0:n.key)&&void 0!==t?t:null),O.getVoyageWithPortCalls(null!==(a=null==n?void 0:n.key)&&void 0!==a?a:0)},[C,O]),B=Object(l.useCallback)(e=>fe.a.openDrawer(e,u.a.voyageDrawer,D,x),[x,D]),F=Object(l.useCallback)(e=>function(e,t,a){var n,o;const s=null!==(n=t.voyage)&&void 0!==n?n:new Me.a({}),{sequence:l}=t,{common:c}=a.getLanguageFile(),d=r.a.createElement(r.a.Fragment,null,r.a.createElement(jt.a,{title:c.goToVoyage,placement:"left"},r.a.createElement(St.a,{onClick:t=>{e(s.key),t.stopPropagation()}},null!==(o=Object(i.a)(s,"voyageHeader.referenceNo"))&&void 0!==o?o:c.missing))),u=e=>r.a.createElement(Et.a,{sx:{p:e=>e.spacing(0,.5)},checked:e,color:"primary",disabled:!0}),p=Ae.a.getPerformanceCargo(s.cargos),m=Object(i.a)(s,"ballastPort.portName"),g=s.isTc?Object(i.a)(s,"tcs[0].charterer.businessPartnerName",""):Object(i.a)(p,"charterer.businessPartnerName",""),b=Object(i.a)(s,"voyageHeader.charteringResponsible.userName",""),v=Object(i.a)(s,"voyageHeader.operator.userName",""),y=Object(i.a)(s,"voyageHeader.accountantResponsible.userName",""),f=Ae.a.getVoyageType(s),h=Object(i.a)(s,"voyageHeader.voyageStatus.statusTypeDesc",""),C=s.isTc&&s.tcs.length>0?Object(i.a)(s,"tcs[0].cpDate",""):Object(i.a)(p,"cpDate",""),O=Ae.a.getTceWithCurrency(s),P=Ae.a.getVoyageContributionWithCurrency(s),k=Ae.a.getVoyageResultWithCurrency(s),T=Object(i.a)(s,"voyageHeader.company.companyCode",""),j=Object(i.a)(s,"voyageHeader.isVoyageStartFixed",""),E=Object(i.a)(s,"voyageHeader.voyageStartDate",""),I=Object(i.a)(s,"voyageHeader.voyageEndDate",""),N=Object(i.a)(s,"voyageHeader.isLastVoyage",""),A=Re.a.getFirstLoadCargoPort(p.cargoPorts),x=Re.a.getFirstDischargeCargoPort(p.cargoPorts),D=s.isTc?Object(i.a)(s,"tcs[0].deliveryPort.portName",""):Object(i.a)(A,"port.portName",""),w=s.isTc?Object(i.a)(s,"tcs[0].redeliveryPort.portName",""):Object(i.a)(x,"port.portName","");return[{rawValue:Object(i.a)(s,"voyageHeader.referenceNo"),content:d},g,C,m,O,P,k,f,l,b,v,y,T,{rawValue:j,content:u(j)},{rawValue:h,content:r.a.createElement(we.a,{label:h,priority:Le.a.getStatusPriority(h,S.a.voyage)})},E,I,{rawValue:N,content:u(N)},D,w]}(B,e,f),[f,B]),U=Object(l.useCallback)(e=>fe.a.openDrawer(e,u.a.portCallDrawer,D,x),[x,D]),K=Object(l.useCallback)(e=>({className:(null==R?void 0:R.key)===e.key?N.ongoingVoyage:void 0}),[N.ongoingVoyage,R]),V=Object(l.useCallback)(()=>I(!E),[E]),H=Object(l.useCallback)(()=>j(!0),[]),q=Object(l.useMemo)(()=>((e,t,a)=>[...e].sort(ht.a.sortByPortCallSequence).map(e=>{var n,o,s,i,l,c,d;const u=`${Ct.formatNumber(e.portCostCurrency,{locale:a.isoCode,minDecimals:0,maxDecimals:0})} ${null!==(o=null===(n=e.currency)||void 0===n?void 0:n.currencyCode)&&void 0!==o?o:""}`,p=e.laytimeUsed+e.daysExtraInPort,m=(n,o)=>({portCall:e,reactKeyPrefix:`${t}-${n}`,checked:o,eventCode:n,userLocale:a});return{content:[null!==(i=null===(s=e.port)||void 0===s?void 0:s.portName)&&void 0!==i?i:"",null!==(c=null===(l=e.reasonForCall)||void 0===l?void 0:l.reasonForCallDesc)&&void 0!==c?c:"",{content:r.a.createElement(bt.a,{portCall:e,key:e.key}),rawValue:null!==(d=Object(bt.b)(e)[0])&&void 0!==d?d:""},{content:r.a.createElement(kt,Object.assign({},m("ARR",e.arrivalFixed))),rawValue:ht.a.getEventLogDateFromPC(e,"ARR")},{rawValue:ht.a.getEventLogDateFromPC(e,"BRT"),content:r.a.createElement(kt,Object.assign({},m("BRT",e.berthedFixed)))},{rawValue:ht.a.getEventLogDateFromPC(e,"DEP"),content:r.a.createElement(kt,Object.assign({},m("DEP",e.departureFixed)))},e.comments,u,e.laytimeUsed,e.daysExtraInPort,p],id:e.key}}))(d,e,a),[d,e,a]),z=Object(l.useMemo)(()=>{const t=!_t.canResequenceAnyVoyage(m);return[{disabled:t,icon:Ut.a,label:t&&m.length>1?k.cannotResequenceStartedVoyages:k.resequenceVoyages,onClick:V,reactKeyPrefix:e+"-resequence-voyages"}]},[m,e,V,k.cannotResequenceStartedVoyages,k.resequenceVoyages]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(he.a,{container:!0,spacing:2},r.a.createElement(he.a,{container:!0,item:!0,sm:12,md:7},r.a.createElement(gt,{vessel:t})),r.a.createElement(he.a,{container:!0,item:!0,sm:12,md:5},r.a.createElement(it,{positionReports:n,nextPortCall:o,ddtRoute:c,vessel:t,hasSubscription:s}))),r.a.createElement(je.a,{fields:Dt,listId:Wt(t.key),reactKeyPrefix:e+"-voyages-list",tsmodelType:S.a.fleetplanvoyage,getColSpec:F,queryStr:"filter=vessel.key(EQ)"+t.key,tableHeaders:wt,defaultSorts:Mt,queryFilters:Bt,pageItemLimit:20,tableCustomisation:Gt,onClickItem:M,hideLoadingMessage:!0,getRowCustomisation:K,preSelectedItem:null==w?void 0:w.key,onLoadedItems:H,hide:!T,primaryActions:z,title:P.voyages}),!T&&r.a.createElement(Ce.a,{variant:"rectangular",height:95.5}),g&&T&&d.length>0&&d[0].port&&r.a.createElement(Oe.a,{mt:-3},r.a.createElement(W.a,{title:P.portCalls,data:q,headers:Tt,reactKeyPrefix:e+"-port-call-list",userLocale:a,hideToolbar:!1,onRowClick:U,defaultComparator:Object(Se.e)()})),E&&r.a.createElement(ze,{reactKeyPrefix:e,open:E,onClose:V,fleetPlanVoyages:L,userLocale:a,onResequence:()=>{h.loadMultipleAction({type:S.a.fleetplanvoyage,fields:Object(Kt.a)(Dt),query:`filter=key(IN)(${L.map(({key:e})=>e).join(",")})`,identifier:Wt(null==t?void 0:t.key),overwriteKeysOnLoad:!0,sorts:Mt})}}))}const Qt=Object(q.a)((function(e,{vessel:t}){var a;const n=zt.a.get(e,S.a.voyage),o=H.a.getTSModelBuilt(e,S.a.voyage,n||0,Te.l);return{portCalls:null!==(a=null==o?void 0:o.portCalls)&&void 0!==a?a:[],fleetPlanVoyages:H.a.getTSModelsBuilt(e,S.a.fleetplanvoyage,Object(Kt.a)(Dt),Wt(t.key)),selectedVoyageId:n}}),Object(l.memo)(Xt)),Zt=ft.a.get(v.a.IInternationalization),{model:Yt}=Zt.getLanguageFile(),Jt={maxDecimals:2,minDecimals:2},ea=[{content:Yt.port,contentType:G.a.TEXT},{content:Yt.terminal,contentType:G.a.TEXT},{content:Yt.loadRate,contentType:G.a.NUMBER,numberFormatOptions:Jt},{content:Yt.dischargeRate,contentType:G.a.NUMBER,numberFormatOptions:Jt}];var ta=a(149),aa=a.n(ta),na=a(782);function oa(e,t,a,n,o){const{model:s,alerts:i}=o.getLanguageFile(),l={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{fieldName:"port",label:s.port,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!1,defaultSelectedOptions:t.port},onUpdateOverride:a.bind(null,"port")},{fieldName:"terminal",disabled:!t.port,label:s.terminal,typeaheadProps:{shouldPreload:!1,defaultSelectedOptions:t.terminal,query:t.port?"filter=port(EQ)"+t.port.key:void 0},onUpdateOverride:a.bind(null,"terminal")},{fieldName:"loadRate",label:s.loadRate,formHelperText:i.loadOrDischargeRateRequired,formControlProps:{required:!1},numberInputProps:{maskSettings:B.a.mask2,onChange:e=>{a("loadRate",e)},inputLabelProps:{required:!t.loadRate&&!t.dischargeRate}},breakpoints:O.d},{fieldName:"loadRateMeasurement",label:s.loadRateMeasurement,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!0,objectPaths:["laytimeTermsMeasurementName","laytimeTermsMeasurementCode"],defaultSelectedOptions:t.loadRateMeasurement,resolver:e=>e.laytimeTermsMeasurementName},onUpdateOverride:a.bind(null,"loadRateMeasurement"),breakpoints:O.d},{fieldName:"loadRateTerms",label:s.loadRateTerms,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!0,objectPaths:["laytimeTerms"],defaultSelectedOptions:t.loadRateTerms},onUpdateOverride:a.bind(null,"loadRateTerms"),breakpoints:O.d},{fieldName:"dischargeRate",label:s.dischargeRate,formHelperText:i.loadOrDischargeRateRequired,formControlProps:{required:!1},numberInputProps:{maskSettings:B.a.mask2,onChange:e=>{a("dischargeRate",e)},inputLabelProps:{required:!t.loadRate&&!t.dischargeRate}},breakpoints:O.d},{fieldName:"dischargeRateMeasurement",label:s.dischargeRateMeasurement,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!0,objectPaths:["laytimeTermsMeasurementName","laytimeTermsMeasurementCode"],defaultSelectedOptions:t.dischargeRateMeasurement,resolver:e=>e.laytimeTermsMeasurementName},onUpdateOverride:a.bind(null,"dischargeRateMeasurement"),breakpoints:O.d},{fieldName:"dischargeRateTerms",label:s.dischargeRateTerms,formControlProps:{required:!0},typeaheadProps:{shouldPreload:!0,objectPaths:["laytimeTerms"],defaultSelectedOptions:t.dischargeRateTerms},onUpdateOverride:a.bind(null,"dischargeRateTerms"),breakpoints:O.d}],object:new na.a(t),type:S.a.vesselcargohandlingrate,userLocale:n};return Object(x.a)(l)}var sa=a(733),ia=a(66),la=a(95);const ra=e=>{const{reactKeyPrefix:t,vesselId:a,userLocale:n,state:{vesselCargoHandlingRates:o,user:s,vessel:i}}=e,[d,u,p]=Object(b.a)([v.a.IInternationalization,_.a.ILoadAndDischargeRatesController,_.a.IVesselDrawerController]),{common:m,vessel:y}=d.getLanguageFile(),f=tt.a.getDefaultLaytimeTermsMeasurementFromVessel(i),h=new na.a({vessel:a,loadRateMeasurement:f,dischargeRateMeasurement:f}),[C,P]=Object(l.useState)(!1),[k,T]=Object(l.useState)(null),[j,E]=Object(l.useState)(!1),[I,N]=Object(l.useState)([]),[A,x]=Object(l.useState)(-1);Object(l.useEffect)(()=>{p.loadVessel(c.c,a),u.loadVesselCargoHandlingRatesData(a)},[]);const D=Object(l.useMemo)(()=>o.map(e=>(e=>{var t,a,n;const{port:o,terminal:s,loadRate:i,dischargeRate:l}=e;return{content:[null!==(t=null==o?void 0:o.portName)&&void 0!==t?t:"",null!==(a=null==s?void 0:s.terminalName)&&void 0!==a?a:"",i,l],id:null!==(n=e.key)&&void 0!==n?n:0}})(e)),[o]),w=Object(l.useCallback)(()=>{P(!1),k&&T(null)},[k]),L=Object(l.useCallback)(()=>P(!0),[]),R=Object(l.useCallback)(()=>E(!j),[j]),M=Object(l.useCallback)(e=>{var t;T(null!==(t=o.find(t=>t.key===e))&&void 0!==t?t:null),L()},[L,o]),B=Object(l.useCallback)(e=>{N(e),R()},[R]),F=Object(l.useCallback)(()=>{u.deleteSelectedVesselCargoHandligRates(I),R(),N([])},[u,I,R]),U=Object(l.useMemo)(()=>[{disabled:!1,icon:J.a,iconButtonProps:{color:"primary","aria-label":m.create},label:m.create,onClick:L,reactKeyPrefix:t+"primary-actions"}],[m.create,L,t]),K=Object(l.useMemo)(()=>[{disabled:!Object(ia.c)([la.a.VESSELS_CONTRIBUTOR,la.a.ADMINISTRATOR],s),icon:aa.a,iconButtonProps:{"aria-label":m.delete},label:m.delete,onClick:B,reactKeyPrefix:t+"-selected-actions"}],[m.delete,B,t,s]),V=Object(l.useMemo)(()=>k?y.editLoadAndDischargeRates:y.createLoadAndDischargeRates,[k,y.createLoadAndDischargeRates,y.editLoadAndDischargeRates]),H=Object(l.useCallback)(e=>!((e.loadRate||e.dischargeRate)&&e.port&&e.loadRateTerms&&e.loadRateMeasurement&&e.dischargeRateTerms&&e.dischargeRateMeasurement),[]),q={type:S.a.vesselcargohandlingrate,fields:{vesselCargoHandlingRates:sa.c},callback:(e,t)=>{x(t.key),w(),u.loadVesselCargoHandlingRatesData(a)}},z={type:S.a.vesselcargohandlingrate,fields:{vesselCargoHandlingRates:sa.c},callback:()=>w()},G=Object(l.useCallback)(e=>{var t,a,n,o;const s=Object(ce.a)(e);return(null===(t=e.loadRateMeasurement)||void 0===t?void 0:t.laytimeTermsMeasurementCode)&&(s.loadRateMeasurement=null===(a=e.loadRateMeasurement)||void 0===a?void 0:a.laytimeTermsMeasurementCode),(null===(n=e.dischargeRateMeasurement)||void 0===n?void 0:n.laytimeTermsMeasurementCode)&&(s.dischargeRateMeasurement=null===(o=e.dischargeRateMeasurement)||void 0===o?void 0:o.laytimeTermsMeasurementCode),s},[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{reactKeyPrefix:t+"-table",headers:ea,data:D,userLocale:n,customisation:{responsive:!0},primaryActions:U,selectable:!0,selectedActions:K,onRowClick:M,title:y.loadAndDischargeRates,preSelectedRow:A}),C&&r.a.createElement(ee.a,{modalProps:{reactKeyPrefix:t+"-create-edit-vessel-cargo-handling-rate-modal",confirmBtnName:k?m.save:m.create,onCloseModal:w,open:C,title:V,maxWidth:"md"},breakpoints:O.h,getColSpec:oa,isConfirmDisabled:H,overrideGetData:G,selectedObject:k,createProps:k?void 0:q,updateProps:k?z:void 0,propertiesToSet:h}),j&&r.a.createElement(g.a,{reactKeyPrefix:t+"-delete-vessel-cargo-handling-rates-modal",fullWidth:!0,maxWidth:"xs",onCloseModal:R,onConfirm:F,open:j,title:m.delete},m.deleteItemsConfirmation))};const ca=Object(q.a)((function(e){var t;const a=V.a.get(e),n=H.a.getTSModelBuilt(e,S.a.vessel,a||0,c.c),o=Object(N.a)(e);return{vessel:n,vesselCargoHandlingRates:null!==(t=H.a.getTSModelsBuilt(e,S.a.vesselcargohandlingrate,sa.c,sa.b))&&void 0!==t?t:[],user:o}}),Object(l.memo)(ra));var da=a(1408),ua=a(1407);function pa(e){const{userLocale:t,reactKeyPrefix:a,vessel:n}=e,[o]=Object(b.a)([v.a.IInternationalization]),s=o.getLanguageFile();return r.a.createElement(l.Fragment,null,(()=>{const e=[];if(n){const[o]=n.aisPositions,i=(e=>{let n="",o="",i="",l="",c="";return null!==e.courseOverGround&&(n=e.courseOverGround.toString()+s.ais.degrees),null!==e.speed&&(o=e.speed.toString()+s.ais.kt),null!==e.heading&&(i=e.heading.toString()+s.ais.degrees),null!==e.latitude&&(l=Object(ua.a)(e.latitude)),null!==e.longitude&&(c=Object(ua.b)(e.longitude)),e.aisNavStatus&&"5"===e.aisNavStatus.aisNavStatusCode&&(n=s.ais.noValue,o="0"),[[{value:r.a.createElement(m.b,{reactKeyPrefix:a+"destination",label:s.ais.destination,value:e.destination?e.destination:"",disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"eta",label:s.model.eta,value:e.etaUtc?Object(da.a)(e.etaUtc.toString(),t):"",disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"latitude",label:s.common.latitude,value:l,disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"longitude",label:s.common.longitude,value:c,disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"status",label:s.common.status,value:null!==e.aisNavStatus?e.aisNavStatus.aisNavStatusDesc:"",disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"speed",label:s.model.speed,value:o,disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"cog",label:s.ais.cog,value:n,disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"heading",label:s.ais.heading,value:i,disabled:!0})},{value:r.a.createElement(m.b,{reactKeyPrefix:a+"aisTime",label:s.ais.aisTime,value:e.aisReportDate?Object(da.a)(e.aisReportDate.toString(),t):"",disabled:!0})}]]})(o);for(let t=0;t<i.length;t++){const n=r.a.createElement(C.a,{reactKeyPrefix:`${a}-ais_data_horizontal_list_${t}`,key:"ais_data_"+t,items:i[t],breakpoints:{xs:6,sm:6,md:6,lg:6,xl:6}}),o=r.a.createElement(ue.a,{variant:"h4",key:"sectionHeader_"+t},s.ais.aisData);e.push(o,n)}}return e})())}function ma(e,t){const a=new Date;a.setUTCHours(e);const n=a.getUTCFullYear().toString(),o=(a.getUTCMonth()+1).toString(),s=a.getUTCDate().toString(),i=a.getUTCHours();let l,r,c;l=o.length<2?"0"+o:o.toString(),r=s.length<2?"0"+s:s.toString(),c=i.toString().length<2?"0"+i:i.toString();return new Date(n+"-"+l+"-"+r+"T"+c+":00:00")}function ga(e){let t="0";const a=parseFloat(e);return a<.5?t="0 - Calm":a<1.6?t="1 - Light air":a<3.4?t="2 - Light breeze":a<5.5?t="3 - Gentle breeze":a<8?t="4 - Moderate breeze":a<10.8?t="5 - Fresh breeze":a<13.9?t="6 - Strong breeze":a<17.2?t="7 - Moderate gale":a<20.8?t="8 - Fresh gale":a<24.5?t="9 - Strong gale":a<28.5?t="10 - Storm":a<32.7?t="11 - Violent storm":a>=32.7&&(t="12 - Hurricane force"),t.toString()}function ba(e,t){let a=0,n=1e4,o=0;for(let n=0;n<t;n++)a+=e[n].value;a/=t;for(let s=0;s<t;s++)Math.abs(e[s].value-a)<n&&(n=Math.abs(e[s].value-a),o=e[s].value);return a=o,a}function va(e,t){let a=0;for(let t=0;t<e.length;t++)a+=e[t];let n=(a/e.length).toFixed(t);return"0.000"===n.toString()&&(n="0"),n}var ya=function(e,t,a,n){return new(a||(a=Promise))((function(o,s){function i(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}r((n=n.apply(e,t||[])).next())}))};function fa(e,t,a,n){return ya(this,void 0,void 0,(function*(){const o=function(e){const t=new Date;t.setDate(t.getDate()+e);const a=t.getUTCFullYear().toString(),n=(t.getUTCMonth()+1).toString(),o=t.getUTCDate().toString();let s,i;return s=n.length<2?"0"+n:n.toString(),i=o.length<2?"0"+o:o.toString(),a+"-"+s+"-"+i+"T00:00:00.00"}(a);return yield fetch(`https://api.stormglass.io/v1/weather/point?lat=${e}&lng=${t}&params=precipitation,waveHeight,waveDirection,windDirection,windSpeed&end=${o}`,{headers:{Authorization:"b7ecd514-6a62-11e9-aad0-0242ac130004-b7ecd604-6a62-11e9-aad0-0242ac130004"}}).then(e=>e.json()).then(e=>{const t=[],o=[],s=[],i=[],l=[];for(let n=0;n<24*a+1;n++){const a=ba(e.hours[n].precipitation,e.hours[n].precipitation.length);t.push(a);const r=ba(e.hours[n].waveDirection,e.hours[n].waveDirection.length);o.push(r);const c=ba(e.hours[n].waveHeight,e.hours[n].waveHeight.length);s.push(c);const d=ba(e.hours[n].windDirection,e.hours[n].windDirection.length);i.push(d);const u=ba(e.hours[n].windSpeed,e.hours[n].windSpeed.length);l.push(u)}const r=[],c=[],d=[],u=[],p=[],m=[];for(let e=0;e<a*(24/n);e++){const a=e*n,m=[],g=[],b=[],v=[],y=[];for(let e=0;e<n;e++)m.push(t[a+e]),g.push(o[a+e]),b.push(s[a+e]),v.push(i[a+e]),y.push(l[a+e]);r.push(va(m,2)),c.push(va(g,0)),d.push(va(b,2)),u.push(va(v,0)),p.push(va(y,2))}for(let e=0;e<4*a;e++)m.push(ga(p[e]));return{beaufort:m,precipitation:r,waveDirection:c,waveHeight:d,windDirection:u,windSpeed:p}}).catch(e=>{})}))}class ha extends r.a.Component{constructor(e){super(e),this.state={days:5,interval:6,vessel:e.vessel,weather:null}}componentDidMount(){this.callGetWeatherData()}UNSAFE_componentWillReceiveProps(e){this.state.vessel&&e.vessel&&e.vessel.key!==this.state.vessel.key&&this.setState({vessel:e.vessel},()=>{this.callGetWeatherData()})}callGetWeatherData(){const{vessel:e,days:t,interval:a}=this.state;e&&fa(e.latitude,e.longitude,t,a).then(e=>{this.setState({weather:e})})}getHeaders(){const[e]=this.props.deps,t=e.getLanguageFile(),a={maxDecimals:3,minDecimals:3};return[{content:t.ais.time,contentType:G.a.DATE},{content:t.ais.precipitation,contentType:G.a.TEXT,numberFormatOptions:a},{content:t.ais.waveDirection,contentType:G.a.TEXT,numberFormatOptions:a},{content:t.ais.waveHeight,contentType:G.a.TEXT,numberFormatOptions:a},{content:t.ais.windDirection,contentType:G.a.TEXT,numberFormatOptions:a},{content:t.ais.windSpeed,contentType:G.a.TEXT,numberFormatOptions:a},{content:t.ais.beaufort,contentType:G.a.TEXT}]}renderRows(){const{weather:e,days:t,interval:a}=this.state,n=[];if(e)for(let o=0;o<t*(24/a);o++){const t=ma(o*a);n.push(this.getRow(t,e.beaufort[o],e.precipitation[o],e.waveDirection[o],e.waveHeight[o],e.windDirection[o],e.windSpeed[o],o))}return n}getRow(e,t,a,n,o,s,i,l){const[r]=this.props.deps,c=r.getLanguageFile();return{content:[e,a+c.ais.mm,n+c.ais.degrees,o+c.common.meterUnit,s+c.ais.degrees,i+c.ais.metresPerSec,t],id:l}}render(){const[e]=this.props.deps,t=e.getLanguageFile();return r.a.createElement(l.Fragment,null,r.a.createElement(W.a,{data:this.renderRows(),headers:this.getHeaders(),userLocale:this.props.userLocale,reactKeyPrefix:"weatherTable",customisation:{responsive:!0},title:t.ais.weatherReport}))}}const Ca=Object(b.b)([v.a.IInternationalization],Object(p.k)(ha));function Oa(e){const{reactKeyPrefix:t,vesselId:a,userLocale:n,state:{vessel:o}}=e,[s]=Object(b.a)([_.a.IVesselDrawerController]);if(Object(l.useEffect)(()=>{s.loadVessel(c.a,a)},[]),o){const[e]=o.aisPositions;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{marginBottom:"50px"}},r.a.createElement(pa,{reactKeyPrefix:t+"-ais-data",vessel:o,userLocale:n})),r.a.createElement(Ca,{vessel:e,userLocale:n}))}return null}const Pa=Object(q.a)((function(e){const t=V.a.get(e),a=H.a.getTSModelBuilt(e,S.a.vessel,t||0,c.a);return{vessel:tt.a.sortByAisDate(a)}}),Object(l.memo)(Oa));var ka=a(33);const Ta="doc-common-components-drawer-vessel-drawer";function ja(e){const{dispatchAction:t,state:{nextPortCall:a,authData:n,userLocale:i,vessel:m,positionReports:y}}=e,[C,O,P,k]=Object(b.a)([A.a.ISelectedVesselActions,v.a.IInternationalization,_.a.ISpeedAndConsumptionController,_.a.IVesselDrawerController]),T=O.getLanguageFile(),{drawerId:j,tabId:E}=Object(p.i)(),I=Object(p.g)(),N=Object(p.h)(),[x,D]=Object(l.useState)([]),[w,R]=Object(l.useState)(!1),[M,B]=Object(l.useState)(!1),[F,U]=Object(l.useState)(!1),[K,V]=Object(l.useState)(!1),[H,q]=Object(l.useState)(!1),[z,W]=Object(l.useState)(!1),[G,$]=Object(l.useState)(!1);Object(l.useEffect)(()=>()=>t(C.setAction(null)),[]);const X=Object(l.useCallback)(()=>{j&&(t(C.setAction(j)),k.loadVessel(c.i,Number(j),(e,t)=>{(null==t?void 0:t.imoNumber)&&n&&k.getSubscriptionToAisPositions(Number(j),n).then(e=>{R(e),e&&(k.loadPositionReports(Number(j)),k.loadNextPortCall(Number(j),n,D))})}))},[n,t,C,k,j]);Object(l.useEffect)(()=>{X()},[j]);const Q=Object(l.useCallback)(()=>{B(!M)},[M]),Z=Object(l.useCallback)(()=>{W(!z)},[z]),Y=Object(l.useCallback)(()=>{q(!H)},[H]),J=Object(l.useCallback)(()=>{U(!F)},[F]),ee=Object(l.useCallback)(()=>{V(!K)},[K]),te=Object(l.useCallback)(()=>{$(!G)},[G]),ae=Object(l.useCallback)(()=>{J(),k.onToggleIsActive(m)},[J,m,k]),ne=Object(l.useCallback)(()=>{m&&(k.permaDeleteVessel(m.key),I.push(ka.a.vessels.url),be.a.next())},[I,m,k]),oe=Object(l.useCallback)((e,t)=>{(null==t?void 0:t.key)&&(fe.a.openDrawer(t.key,u.a.vesselDrawer,N,I),be.a.next())},[I,N]),ie=Object(l.useCallback)(e=>k.onChangeVesselName(m,e),[m,k]),le=Object(l.useCallback)(e=>{m&&k.copyVesselFromExisting(m.key,e,oe),Q()},[oe,Q,m,k]),re=Object(l.useMemo)(()=>{const e=m?m.isObjectActive:void 0;return[{disabled:!1,onClick:J,text:e?T.common.disable:T.common.enable},{disabled:e,onClick:Y,text:T.common.delete},{disabled:!1,onClick:Z,text:T.common.editVesselName},{disabled:!1,onClick:Q,text:T.common.copyVessel},{disabled:!Object(s.a)(null==m?void 0:m.vesselCodes[0]),onClick:ee,text:T.common.createInternalData}]},[T.common,Q,ee,J,Y,Z,m]),ce=Object(l.useCallback)(()=>{w&&m&&m.imoNumber&&n?k.unsubscribeToAisPositions(m.key,n).then(()=>{k.getSubscriptionToAisPositions(m.key,n).then(e=>{R(e)})}):!w&&m&&m.imoNumber&&n&&k.subscribeToAisPositions(m.key,n).then(()=>{k.getSubscriptionToAisPositions(m.key,n).then(e=>{R(e)}),X()}),te()},[n,w,X,te,m,k]),de=Object(l.useMemo)(()=>{const e=w?T.vessel.unSubscribeFromAis:T.vessel.subscribeToAis,t=T.vessel.featureRequiresIMO,a=m&&m.imoNumber;return[{disabled:!a,icon:o.a,iconColorProps:{color:w?"primary":void 0},label:a?e:t,onClick:te}]},[w,T.vessel.featureRequiresIMO,T.vessel.subscribeToAis,T.vessel.unSubscribeFromAis,te,m]),ue=Object(l.useMemo)(()=>{if(!m)return[];const e=!(null==m?void 0:m.vesselCodes[0]);return[{id:"voyages-portcalls",content:()=>r.a.createElement(Qt,{reactKeyPrefix:Ta+"-voyages-and-port-calls",vessel:m,userLocale:i,positionReports:y,nextPortCall:a,ddtRoute:x,hasSubscription:w}),label:T.vessel.voyagesAndPortCalls},{id:"main-description",content:()=>r.a.createElement(me,{reactKeyPrefix:Ta+"-vessel-overview",userLocale:i,vesselId:Number(j)}),label:T.vessel.mainVesselDescription},{id:"speed-consumption",content:()=>r.a.createElement(h.a,{reactKeyPrefix:Ta+"-speed-and-consumption",vesselId:Number(j),userLocale:i,onChangeBunkerTypes:P.onUpdateBunkerTypes,onChangeMainEngines:P.onUpdateMainEngines}),label:T.model.speedAndConsumption},{id:"load-discharge-rates",content:()=>r.a.createElement(ca,{reactKeyPrefix:Ta+"-load-and-discharge-rates",vesselId:Number(j),userLocale:i}),label:T.vessel.loadAndDischargeRates},{id:"internal-data",content:()=>r.a.createElement(se,{reactKeyPrefix:Ta+"-vessel-internal-data",vesselId:Number(j),userLocale:i}),disabled:e,label:T.model.internalData},{id:"ais-weather",content:()=>r.a.createElement(Pa,{vesselId:Number(j),reactKeyPrefix:Ta+"-ais-weather",userLocale:i}),disabled:!w,label:T.ais.aisAndWeather}]},[x,w,T.ais.aisAndWeather,T.model.internalData,T.model.speedAndConsumption,T.vessel.loadAndDischargeRates,T.vessel.mainVesselDescription,T.vessel.voyagesAndPortCalls,a,y,P.onUpdateBunkerTypes,P.onUpdateMainEngines,i,m,j]);if(m){const e=r.a.createElement(we.a,{id:Ta+"-vessel-name-chip",label:m.vesselName,rounded:!0}),t=m.isObjectActive,a=fe.a.getSubjectName(m,["vesselType.vesselTypeDesc","imoNumber","flag.countryName"],{delimiter:" | ",default:T.common.na});return r.a.createElement(r.a.Fragment,null,r.a.createElement(d.a,{reactKeyPrefix:Ta,drawerKey:Number(j),drawerRoute:u.a.vesselDrawer,key:u.a.vesselDrawer+j,isObjectActive:m,size:"large",secondaryActions:re,primaryActions:de,subject:T.model.vessel,subjectLoaded:!!m,subjectComponentLeft:e,subjectName:a,windowTitleSubjectName:m.vesselName,tabs:ue,tabId:E,tsModelType:S.a.vessel}),z&&r.a.createElement(ve.a,{reactKeyPrefix:Ta+"-edit-vessel-name-modal",title:T.common.editVesselName,value:m.vesselName,showModal:z,onClose:Z,onConfirm:ie,required:!0}),K&&r.a.createElement(L,{reactKeyPrefix:Ta+"-create-internal-data-modal",onClose:ee,showDialog:K,userLocale:i,vessel:m}),H&&r.a.createElement(g.a,{reactKeyPrefix:Ta+"-perm-delete-modal",open:H,onCloseModal:Y,onConfirm:ne,confirmBtnName:T.common.delete,title:T.common.deleteVessel,maxWidth:"xs",fullWidth:!0},T.common.deleteConfirmationVessel),G&&r.a.createElement(g.a,{reactKeyPrefix:Ta+"-toggle-subscription",open:G,onCloseModal:te,onConfirm:ce,title:T.vessel.aisSubscription,maxWidth:"xs",fullWidth:!0},w?T.vessel.unSubscribeFromAis:T.vessel.subscribeToAis),F&&r.a.createElement(g.a,{reactKeyPrefix:Ta+"-disable-modal",open:F,onCloseModal:J,onConfirm:ae,maxWidth:"xs",confirmBtnName:t?T.common.disable:T.common.enable,title:T.common.disableEnableObjectTitle(t,T.model.vessel)},T.common.disableConfirmation(t)),M&&r.a.createElement(f,{reactKeyPrefix:Ta+"-copy-vessel-modal",onClose:Q,onCloseModalOnCreate:le,vessel:m,showDialog:M}))}return null}const Sa=Object(q.a)(e=>{var t;const a=V.a.get(e),n=H.a.getTSModelBuilt(e,S.a.vessel,a||0,c.i),o=Object(N.a)(e),s=null!==(t=null==o?void 0:o.authdata)&&void 0!==t?t:null,l=H.a.getTSModelsBuilt(e,S.a.portcall,c.d,ge.b+a);return{authData:s,nextPortCall:Object(i.a)(l,"[0]",null),positionReports:H.a.getTSModelsBuilt(e,S.a.positionreport,c.e,ge.c+a),userLocale:ye.a.getUserLocale(e),vessel:n}},Object(l.memo)(ja))},1915:function(e,t,a){"use strict";a.d(t,"a",(function(){return $}));a(10),a(11);var n=a(82),o=a(0),s=a.n(o),i=a(97),l=a(6),r=a(23),c=a(1),d=a(21),u=a(42),p=a(35),m=a(3),g=a(15),b=a(20),v=a(641),y=a(150),f=a(61),h=a(51),C=a(37),O=a(12),P=a(75),k=a(71),T=a(100),j=a.n(T),S=a(5);const[E]=Object(l.a)([m.a.IInternationalization]),{common:I,model:N}=E.lang(),A={table:{objectName:"*"},value:"*",currency:{currencyCode:"*"},onlyTcVoyage:"*",onlyVoyageCharter:"*"},x=[{content:I.usage,contentType:S.a.TEXT},{content:I.value,contentType:S.a.NUMBER,numberFormatOptions:{minDecimals:2,maxDecimals:2},alignHeaderContent:S.c.LEFT},{content:N.currency,contentType:S.a.TEXT}];function D(e){var t,a,n,o;const s=null!==(a=null===(t=e.table)||void 0===t?void 0:t.objectName)&&void 0!==a?a:"",i=null!==(o=null===(n=e.currency)||void 0===n?void 0:n.currencyCode)&&void 0!==o?o:"";return[s,e.value,i]}var w=a(19);const L=(e,t,a,n,o)=>{const{model:s,common:i}=n.getLanguageFile(),l=[{fieldName:"glAccount",label:s.glAccount}];t.isToBeAccrued&&l.push({fieldName:"glAccountAccrual",label:s.glAccountAccrual},{fieldName:"balanceAccountAccrual",label:i.accrualLiabilityAccount},{fieldName:"balanceAccountAccrualAsset",label:s.balanceAccountAccrualAsset});const r={updateResponseFields:v.a,reactKeyPrefix:e,fieldOptions:l.map(e=>Object.assign(Object.assign({},e),{disabled:!o})),object:t,type:c.a.varioustext,userLocale:a};return Object(w.a)(r)};a(93);var R=a(57);const M=(e,t,a,n,o)=>{const{common:s,model:i}=n.getLanguageFile(),l=[{label:s.description,fieldName:"variousText",formControlProps:{required:!0}},{label:s.code,fieldName:"variousCode",formControlProps:{required:!0},textInputProps:{letterCase:R.a.UPPERCASE}},{label:s.type,fieldName:"variousType",formControlProps:{required:!0},typeaheadProps:{objectPaths:["variousTypeDesc"],shouldPreload:!0}},{label:s.calculationRule,fieldName:"variousRule",formControlProps:{required:!0},typeaheadProps:{objectPaths:["variousRuleDesc"],shouldPreload:!0}},{label:s.usage,fieldName:"tables",typeaheadProps:{isMulti:!0,objectPaths:["objectName"],query:"filter=tableCode(IN)(BOL,CGO,CGOP,CLAIM,OFF,PCALL,VOY)",shouldPreload:!0,type:c.a.table}},{label:i.commissionBroker,fieldName:"hasCommission"},{label:i.hasManagementCommission,fieldName:"hasManagementCommission"},{label:s.accrue,fieldName:"isToBeAccrued"},{label:i.isNonVoyageRelated,fieldName:"isNonVoyageRelated"}].map(e=>Object.assign(Object.assign({},e),{disabled:!o})),r={updateResponseFields:v.a,reactKeyPrefix:e,fieldOptions:l,object:t,type:c.a.varioustext,userLocale:a};return Object(w.a)(r)};var B,F=a(28),U=a(312);function K(e,t,a,n,o){var i;const{common:l,model:r,various:d}=o.getLanguageFile(),u=t.onlyTcVoyage?B.Tc:t.onlyVoyageCharter?B.Charter:B.All,p="Voyage"!==(null===(i=t.table)||void 0===i?void 0:i.objectName),m={reactKeyPrefix:e,disableUpdate:!0,fieldOptions:[{label:l.usage,fieldName:"table",formControlProps:{required:!0},breakpoints:{lg:12,xl:12,md:12,sm:12,xs:12},typeaheadProps:{objectPaths:["objectName"],query:"filter=tableCode(IN)(BOL,CGO,CGOP,CLAIM,OFF,PCALL,VOY)",shouldPreload:!0,type:c.a.table},onUpdateOverride:a.bind(null,"table")},{fieldName:"value",label:l.value,breakpoints:{lg:6,xl:6,md:6,sm:6,xs:6},formControlProps:{required:!1},numberInputProps:{maskSettings:F.a.mask7},onUpdateOverride:a.bind(null,"value")},{fieldName:"currency",label:r.currency,breakpoints:{lg:6,xl:6,md:6,sm:6,xs:6},formControlProps:{required:!0},typeaheadProps:{objectPaths:["currencyCode"],shouldPreload:!0},onUpdateOverride:a.bind(null,"currency")},{breakpoints:{lg:12,xl:12,md:12,sm:12,xs:12},hidden:p,overrideComponent:s.a.createElement(U.a,{label:d.createVariousFor,reactKeyPrefix:e+"-create-radios",defaultValue:u,onChange:e=>{var a,n;const o=(null===(a=null==e?void 0:e.target)||void 0===a?void 0:a.value)?Number(null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.value):u;t.onlyTcVoyage=2===o,t.onlyVoyageCharter=3===o},options:[{label:d.allVoyages,value:B.All},{label:d.onlyTc,value:B.Tc},{label:d.onlyVoyageCharter,value:B.Charter}]})}],object:t,type:c.a.defaultvarious,userLocale:n};return Object(w.a)(m)}!function(e){e[e.All=1]="All",e[e.Tc=2]="Tc",e[e.Charter=3]="Charter"}(B||(B={}));var V=a(46);const H=({reactKeyPrefix:e,variousText:t,userLocale:a,i:n,authorized:i})=>{const{common:l,various:u}=n.getLanguageFile(),[p,m]=Object(o.useState)(!1),[g,b]=Object(o.useState)(),v=Object(r.a)(d.a.getTSModelsBuilt,c.a.defaultvarious,A),y=Object(o.useMemo)(()=>({mainDetails:M(e,t,a,n,i),glAccountMapping:L(e,t,a,n,i)}),[e,t,a,n,i]),T=Object(o.useMemo)(()=>[{icon:j.a,label:u.createDefaultVarious,onClick:()=>m(!0),iconButtonProps:{color:"primary"},reactKeyPrefix:e+"-create-action"}],[u.createDefaultVarious,e]),S=Object(o.useCallback)(e=>{if(v){const t=v.find(t=>t.key===e);b(t),m(!0)}},[v]),E=Object(o.useCallback)(()=>{m(!1),b(void 0)},[]),I=Object(o.useMemo)(()=>({type:c.a.defaultvarious,callback:e=>{e||V.a.next()}}),[]),N=Object(o.useCallback)(e=>!e.table||!e.currency,[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(k.a,null,s.a.createElement(P.a,{title:l.mainDetails}),s.a.createElement(C.a,{reactKeyPrefix:e+"-main-details-field-list",items:y.mainDetails,breakpoints:O.h})),s.a.createElement(k.a,null,s.a.createElement(P.a,{title:l.glAccountMapping}),s.a.createElement(C.a,{reactKeyPrefix:e+"-gl-account-mapping-field-list",items:y.glAccountMapping,breakpoints:O.h})),s.a.createElement(k.a,null,s.a.createElement(P.a,{title:u.defaultVarious}),s.a.createElement(f.a,{fields:A,listId:"LIST_ID_"+t.key,reactKeyPrefix:e+"-default-various-list",tsmodelType:c.a.defaultvarious,tableHeaders:x,getColSpec:D,primaryActions:T,tableCustomisation:{disableToolbar:!1},onClickItem:S,queryStr:"&filter=variousText.key(EQ)"+t.key})),p&&s.a.createElement(h.a,{modalProps:{reactKeyPrefix:e+"-create-edit-default-various",maxWidth:"xs",onCloseModal:E,open:p,title:(g?l.edit:l.create)+" "+u.defaultVarious,confirmBtnName:g?l.save:l.create},propertiesToSet:g?void 0:{variousText:t,value:0},getColSpec:K,selectedObject:g,allowDelete:!!g,createProps:g?void 0:I,updateProps:g?I:void 0,isConfirmDisabled:N}))};var q=a(43),_=a(32),z=a(66),W=a(30);const G=c.a.varioustext,$=()=>{var e,t,a;const[c,f]=Object(l.a)([m.a.IInternationalization,b.a.IVariousCRDrawerController]),h=null!==(e=Object(r.a)(u.a.getUserLocale))&&void 0!==e?e:p.f[0],{common:C}=c.getLanguageFile(),{drawerId:O,tabId:P}=Object(i.i)(),k=Object(r.a)(_.a),T=Object(o.useMemo)(()=>Object(z.a)([W.a.VariousTextPUT],null!=k?k:new q.a({})),[k]);Object(o.useEffect)(()=>{O&&f.loadVariousCROverview(O)},[f,O]);const j=Object(r.a)(d.a.getTSModelBuilt,G,null!=O?O:0,v.a),S=null!==(a=null===(t=null==j?void 0:j.variousType)||void 0===t?void 0:t.variousTypeDesc)&&void 0!==a?a:"",E=Object(o.useMemo)(()=>T?Object(y.a)({isActive:!!(null==j?void 0:j.isObjectActive),key:O,type:G,deleteTitle:S}):[],[T,null==j?void 0:j.isObjectActive,O,S]),I=Object(o.useMemo)(()=>j?[{id:"overview",label:C.overview,content:()=>s.a.createElement(H,{variousText:j,i:c,reactKeyPrefix:"doc-common-components-drawer-various-cost-and-revenue-drawer-overview",userLocale:h,authorized:T})}]:[],[T,C.overview,c,h,j]);return j?s.a.createElement(n.a,{reactKeyPrefix:"doc-common-components-drawer-various-cost-and-revenue-drawer",drawerKey:Number(O),drawerRoute:g.a.variousCostAndRevenueDrawer,key:g.a.businessUnitDrawer+O,isObjectActive:j,subject:S,subjectLoaded:!!j,subjectName:null==j?void 0:j.variousText,tabs:I,tabId:P,tsModelType:G,secondaryActions:E}):s.a.createElement(s.a.Fragment,null)}},2001:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));a(10),a(11);var n=a(0),o=a.n(n),s=a(97),i=a(821),l=a(6),r=a(23),c=a(1),d=a(21),u=a(42),p=a(35),m=a(3),g=a(150),b=a(82),v=a(15),y=a(37),f=a(12),h=a(75),C=a(71),O=(a(93),a(63)),P=a(28),k=a(57),T=a(19),j=a(154),S=a(70),E=a(85);const I=(e,t,a,n)=>{const{model:o,common:s}=t.getLanguageFile(),l=[{fieldName:"vesselTypeDesc",label:s.description},{fieldName:"vesselTypeCode",label:s.code,textInputProps:{characterRequirements:{maxLength:j.a.vesseltype.vesselTypeCode.limit},letterCase:k.a.UPPERCASE,validation:S.b.VesselTypeCode},formControlProps:{required:!0}},{fieldName:"vesselCategory",label:s.category,formControlProps:{required:!0}},{fieldName:"defaultPctOverage",label:o.defaultOverage,formControlProps:{required:!1},numberInputProps:{validation:[{type:E.a.RANGE,max:100}],maskSettings:P.a.mask6},InputProps:{endAdornment:O.a.Percent}},{fieldName:"laytimeTermsMeasurement",label:o.defaultLaytimeTermsMeasurement},{fieldName:"isReversibleDefault",label:o.reversibleLaytime},{fieldName:"isFreeDespatchDefault",label:o.isFreeDespatch}];return Object(T.a)({fieldOptions:l,object:n,type:c.a.vesseltype,updateResponseFields:i.a,userLocale:a,reactKeyPrefix:e})},N=({i:e,userLocale:t,reactKeyPrefix:a,vesselType:n})=>{const{common:s}=e.getLanguageFile();return o.a.createElement(C.a,null,o.a.createElement(h.a,{title:s.details}),o.a.createElement(y.a,{reactKeyPrefix:a+"-details",items:I(a,e,t,n),breakpoints:f.a}))};var A=a(20);const x=()=>{var e;const[t,a]=Object(l.a)([m.a.IInternationalization,A.a.IVesselTypeDrawerController]),{model:y,common:f}=t.getLanguageFile(),{drawerId:h,tabId:C}=Object(s.i)(),O=null!==(e=Object(r.a)(u.a.getUserLocale))&&void 0!==e?e:p.f[0];Object(n.useEffect)(()=>{h&&a.loadVesselTypeOverview(h)},[h,a]);const P=Object(r.a)(d.a.getTSModelBuilt,c.a.vesseltype,null!=h?h:0,i.a),k=!!(null==P?void 0:P.isObjectActive),T=Object(n.useMemo)(()=>P?[{id:"overview",label:f.overview,content:()=>o.a.createElement(N,{i:t,vesselType:P,reactKeyPrefix:"doc-common-components-drawer-vessel-type-drawer-overview",userLocale:O})}]:[],[f.overview,t,O,P]),j=Object(n.useMemo)(()=>Object(g.a)({isActive:k,key:h,type:c.a.vesseltype,deleteTitle:y.vesselType}),[k,y.vesselType,h]);return P?o.a.createElement(b.a,{drawerKey:Number(h),tabs:T,tabId:C,drawerRoute:v.a.vesselTypeDrawer,reactKeyPrefix:"doc-common-components-drawer-vessel-type-drawer",key:v.a.vesselTypeDrawer+h,subjectLoaded:!!P,subject:y.vesselType,subjectName:P.vesselTypeDesc,tsModelType:c.a.vesseltype,secondaryActions:j}):o.a.createElement(o.a.Fragment,null)}},2048:function(e,t,a){"use strict";a.d(t,"a",(function(){return ee}));a(109),a(10),a(11);var n=a(1780),o=a.n(n),s=a(1779),i=a.n(s),l=a(0),r=a.n(l),c=a(97),d=a(531),u=a(289),p=a(82),m=a(15),g=a(1419),b=a(1611),v=a(861),y=a(57),f=a(70),h=a(92),C=a(139),O=a(1),P=a(19),k=a(88),T=a(154),j=a(218),S=a(323),E=a(30),I=a(27);const N=(new k.a).getLanguageFile(),A={signature:{cursor:"pointer",width:"175px",height:"100%"},noSignature:{cursor:"pointer",width:"100%",height:"2.286rem",lineHeight:"2rem",backgroundColor:"#fafafa",borderColor:"#eeeeee",borderRadius:"4px",borderStyle:"dashed",color:"#bdbdbd",textAlign:"center",mt:"-9px"}},x=(e,t,a,n,o,s,i,l)=>{var c,d;if(t){const p="DATALOY"===s.userCode||"M2M"===s.userCode,k=t.lastLoginDate?Object(g.a)(t.lastLoginDate,new Date,{addSuffix:!0,locale:a.localeConfig}):void 0,x=h.a.getUpdateFieldFunction({fieldToSet:"userPassword",fields:u.c,key:t.key,type:O.a.user}),D=r.a.createElement(v.a,{reactKeyPrefix:e+"password-input",onInputBlur:x,user:t,disabled:i}),w=t.signature?r.a.createElement(j.a,{title:N.common.clickToChangeSignature},r.a.createElement(S.a,{onClick:o,sx:A.signature,component:"img",src:"data:image/png;base64, "+t.signature})):r.a.createElement(S.a,{sx:A.noSignature,onClick:o},N.common.clickToUploadSignature),L=t&&t.contactInfo&&t.contactInfo[0]?t.contactInfo[0]:void 0,R=[...Object(P.a)({fieldOptions:[{fieldName:"userCode",formControlProps:{required:!0},textInputProps:{characterRequirements:{maxLength:T.a.user.userCode.limit},letterCase:y.a.UPPERCASE,validation:f.b.UserCode}},{fieldName:"email",formControlProps:{required:!0},openObject:{permissions:[E.a.UserGET],onOpen:()=>window.open("mailto:"+t.email)},textInputProps:{letterCase:y.a.LOWERCASE,validation:f.b.Email}},{fieldName:"securityGroups",formControlProps:{required:!0},typeaheadProps:{isMulti:!0,shouldPreload:!0,objectPaths:["securityGroupName"],query:p?void 0:"filter=isInternal(EQ)false",overrideDefaultSelectedOptions:!0,defaultSelectedOptions:p?t.securityGroups:t.securityGroups.filter(e=>!e.isInternal)}},{fieldName:"company",typeaheadProps:{shouldPreload:!0},openObject:{permissions:[E.a.CompanyGET],onOpen:I.a.openDrawer.bind(null,null!==(d=null===(c=t.company)||void 0===c?void 0:c.key)&&void 0!==d?d:-1,m.a.companyDrawer)}},{fieldName:"office",typeaheadProps:{shouldPreload:!0}}],object:t,type:O.a.user,updateResponseFields:u.c,userLocale:a,reactKeyPrefix:e}),...Object(P.a)({fieldOptions:[{fieldName:"phoneNo"},{fieldName:"mobileNo"},{fieldName:"faxNo"},{fieldName:"telexNo"}],object:L||new C.a({}),type:O.a.contactinfo,updateResponseFields:u.a,userLocale:a,reactKeyPrefix:e}),...Object(P.a)({fieldOptions:l?[{fieldName:"groups",label:N.model.groupsOld,typeaheadProps:{isMulti:!0,shouldPreload:!0,objectPaths:["groupName"],defaultSelectedOptions:t.groups}}]:[],object:t,type:O.a.user,updateResponseFields:u.c,userLocale:a,reactKeyPrefix:e}),...Object(P.a)({fieldOptions:[{disabled:!0,fieldName:"lastLoginDate",formHelperText:k},{fieldName:"password",overrideComponent:D},{fieldName:"legs",typeaheadProps:{isMulti:!0,shouldPreload:!0,objectPaths:["legDesc"],defaultSelectedOptions:t.legs}},{fieldName:"businessUnits",typeaheadProps:{isMulti:!0,shouldPreload:!0,objectPaths:["businessUnitName"],defaultSelectedOptions:t.businessUnits}},{label:N.model.signature,fieldName:"signature",overrideComponent:w}],object:t,type:O.a.user,updateResponseFields:u.c,userLocale:a,reactKeyPrefix:e})];let M=[];if(n){const n=t.passwordLastChanged?Object(b.a)(new Date,t.passwordLastChanged):"",o=t.passwordLastChanged?Object(g.a)(t.passwordLastChanged,new Date,{addSuffix:!0,locale:a.localeConfig}):void 0;M=Object(P.a)({fieldOptions:[{fieldName:"maxAge"},{fieldName:"passwordLastChanged",formHelperText:o,InputProps:{disabled:!0,error:!!t.maxAge&&n>t.maxAge}}],object:t,type:O.a.user,updateResponseFields:u.c,userLocale:a,reactKeyPrefix:e})}return[...R,...M]}};var D=a(20),w=a(37),L=a(12),R=a(208),M=a(329),B=a(6),F=a(47),U=a(241),K=a(7),V=a(836),H=a(21),q=a(1226),_=a(42),z=a(3),W=a(46),G=a(44),$=a(839),X=a(892),Q=a(114),Z=a(43),Y=a(40);class J extends r.a.PureComponent{constructor(e){super(e),this.controller=e.controller,this.i=e.deps[1],this.state=Object.assign(Object.assign({},e.state),{showUserNameModal:!1,showUploadSignatureModal:!1,userId:void 0,isAzureInstallation:!1,jvmsMode:!1}),this.onChangeUserName=this.onChangeUserName.bind(this),this.toggleUserNameModal=this.toggleUserNameModal.bind(this),this.toggleUploadSignatureModal=this.toggleUploadSignatureModal.bind(this),this.secondaryUserActions=this.secondaryUserActions.bind(this),this.onClickToggleActive=this.onClickToggleActive.bind(this),this.onClickUserAuditLog=this.onClickUserAuditLog.bind(this),this.onUploadSignature=this.onUploadSignature.bind(this),this.onRemoveSignature=this.onRemoveSignature.bind(this),this.setisAzureInstallation=this.setisAzureInstallation.bind(this)}UNSAFE_componentWillMount(){this.getUserId(this.props.match),this.controller.getDataloyInfo().then(e=>{var t;return this.isJvmsMode(null!==(t=e.jvmsMode)&&void 0!==t&&t)})}UNSAFE_componentWillReceiveProps(e){this.getUserId(e.match),this.setState(Object.assign({},e.state))}isJvmsMode(e){this.setState({jvmsMode:e})}loadUser(){const{userId:e}=this.state;e&&this.controller.loadUserAndSetSelected(e);const[t,a,n]=this.props.deps;n.getDataloyInfo().then(e=>{var t;return this.setisAzureInstallation(null!==(t=e.isAzureInstallation)&&void 0!==t&&t)})}getUserId(e){if(e){const t=e.params.drawerId?e.params.drawerId:"0",a=parseInt(t,10);a!==this.state.userId&&this.setState({userId:a},()=>this.loadUser())}}onChangeUserName(e){this.state.user&&h.a.getUpdateFieldFunction({fieldToSet:"userName",fields:u.c,key:this.state.user.key,type:O.a.user})(e)}toggleUserNameModal(){this.state.user&&this.setState({showUserNameModal:!this.state.showUserNameModal})}toggleUploadSignatureModal(){this.setState({showUploadSignatureModal:!this.state.showUploadSignatureModal})}setisAzureInstallation(e){this.setState({isAzureInstallation:e})}onUnlockUser(e){e&&e.locked&&h.a.getUpdateFieldFunction({fieldToSet:"locked",fields:u.c,key:e.key,type:O.a.user})(!1)}onUploadSignature(e){this.toggleUploadSignatureModal();const{user:t}=this.state;!Object(X.a)(e)&&t&&this.controller.uploadSignature(e[0],t.key)}onRemoveSignature(){const{user:e,common:t}=this.i.lang();Object(Q.a)(e.removeSignature,e.confirmRemoveSignature,t.remove).then(e=>{if(e){const{user:e}=this.state;e&&this.controller.removeSignature(e.key)}})}toggleActiveUserCallback(e,t){t&&W.a.next()}onClickToggleActive(){const{user:e}=this.state;e&&h.a.getUpdateFieldFunction({fieldToSet:"isObjectActive",fields:u.c,key:e.key,type:O.a.user,callback:this.toggleActiveUserCallback})(!e.isObjectActive)}onClickUserAuditLog(){const{userId:e}=this.state;e&&this.controller.dispatchSetSelectedAuditLog(e)}secondaryUserActions(){const{user:e,userLoggedIn:t}=this.state,a=this.i.lang(),n=e?e.isObjectActive:void 0,o=e&&t?e.key===t.key:!!n;return[{disabled:!1,onClick:this.toggleUserNameModal,text:a.user.editUserName},{disabled:o,onClick:this.onClickToggleActive,text:n?a.user.disableUser:a.user.enableUser},{disabled:!(null==e?void 0:e.signature),onClick:this.onRemoveSignature,text:a.user.removeSignature}]}getStatus(){const e=this.i.lang();return r.a.createElement(Y.a,{label:e.common.disabled,labelColour:Y.b.Red})}render(){var e;const{user:t,userLocale:a,policyStrict:n,userLoggedIn:s,isAzureInstallation:l,jvmsMode:c}=this.state,d=this.i.lang();if(t){let u;u=t.locked;const g=[{disabled:!u,icon:u?i.a:o.a,label:u?d.user.unlockAccount:d.user.accountIsUnlocked,onClick:()=>this.onUnlockUser(t)}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{reactKeyPrefix:"doc-common-components-drawer-user-drawer",drawerKey:null!==(e=this.state.userId)&&void 0!==e?e:0,drawerRoute:m.a.userDrawer,key:m.a.userDrawer+this.state.userId,subject:d.menuGroup.user,subjectLoaded:this.state.userId===t.key,subjectName:t?t.userName:"",primaryActions:g,secondaryActions:this.secondaryUserActions(),tsModelType:O.a.user,subjectComponentLeft:(null==t?void 0:t.isObjectActive)?void 0:this.getStatus(),tabs:[{id:"main-details",content:()=>r.a.createElement(w.a,{reactKeyPrefix:"user_details_horizontal_list",key:"user_details_horizontal_list",items:x("doc-common-components-drawer-user-drawer",t,a,n,this.toggleUploadSignatureModal,null!=s?s:new Z.a({}),l,c),breakpoints:L.a}),label:d.common.mainDetails}],tabId:this.props.match.params.tabId}),r.a.createElement(R.a,{reactKeyPrefix:"doc-common-components-drawer-user-draweruser-name-modal",title:d.user.editUserName,value:t.userName,showModal:this.state.showUserNameModal,onClose:this.toggleUserNameModal,onConfirm:this.onChangeUserName,required:!0}),r.a.createElement(G.a,{reactKeyPrefix:"doc-common-components-drawer-user-drawersignature-upload-modal",title:d.user.uploadSignature,open:this.state.showUploadSignatureModal,onCloseModal:this.toggleUploadSignatureModal,maxWidth:"sm",fullWidth:!0,hideConfirmBtn:!0,hideCancelBtn:!0},r.a.createElement($.a,{onUploadFiles:this.onUploadSignature})))}return null}}const ee=Object(F.a)(e=>{const t=q.a.get(e),a={dataloyPropertyName:"com.dataloy.policy.strict",fields:d.a},n=!!V.a.getDataloyProperty(a)(e)&&!1,o=U.a.getUserData(e);return{policyStrict:n,user:H.a.getTSModelBuilt(e,O.a.user,t||0,u.c),userLocale:_.a.getUserLocale(e),userLoggedIn:o}},Object(B.b)([K.a.ITSModelActionsAsync,z.a.IInternationalization,D.a.IDataloyInfoController],Object(M.a)(D.a.IUserDrawerController,Object(c.k)(J))))},2049:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));a(59),a(109),a(10),a(11);var n=a(0),o=a.n(n),s=a(97),i=a(342),l=a(82),r=a(15),c=a(19),d=a(1),u=a(111),p=a(96),m=a(310);var g=a(37),b=a(12),v=a(6),y=a(47),f=a(7),h=a(21),C=a(1783),O=a(42),P=a(3),k=a(329),T=function(e,t,a,n){return new(a||(a=Promise))((function(o,s){function i(e){try{r(n.next(e))}catch(e){s(e)}}function l(e){try{r(n.throw(e))}catch(e){s(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}r((n=n.apply(e,t||[])).next())}))};class j extends n.Component{constructor(e){super(e),this.state=Object.assign(Object.assign({},e.state),{vesselOpenPositionId:void 0}),this.i=e.deps[0],this.controller=e.controller,this.getVesselOpenPositionId=this.getVesselOpenPositionId.bind(this),this.loadVesselOpenPosition=this.loadVesselOpenPosition.bind(this),this.onChangePort=this.onChangePort.bind(this),this.onChangeDate=this.onChangeDate.bind(this)}componentDidMount(){this.getVesselOpenPositionId(this.props.match)}UNSAFE_componentWillReceiveProps(e){this.getVesselOpenPositionId(e.match),this.setState(Object.assign({},e.state))}loadVesselOpenPosition(){const{vesselOpenPositionId:e}=this.state,[t,a]=this.props.deps;e&&this.props.dispatchAction(a.setAction(e))}onChangePort(e){const{deps:[,,t,,]}=this.props;if(e&&this.state.vesselOpenPositionId){const a={openPositionPort:{key:e.key}};t.updateSingleAction({callback:()=>{this.refreshBoard()},data:a,fields:{openPositionPort:"*"},key:this.state.vesselOpenPositionId,type:d.a.vesselopenposition})}}onChangeDate(e){var t,a;return T(this,void 0,void 0,(function*(){const{deps:[,,n,o]}=this.props,s={openPositionPortDate:e};if(e&&this.state.vesselOpenPositionId){yield n.updateSingleAction({data:s,fields:{openPositionPortDate:"*"},key:this.state.vesselOpenPositionId,type:d.a.vesselopenposition});const e=m.a.getSelectedScenarioKey(),i=null===(a=null===(t=this.state.vesselOpenPosition)||void 0===t?void 0:t.vessel)||void 0===a?void 0:a.key;if(e&&i){const t=this.controller.getFleetPlanVoyageFields();o.loadFleetPlanVoyages(e,t,[i])}}}))}refreshBoard(){var e,t;const a=null===(t=null===(e=this.state.vesselOpenPosition)||void 0===e?void 0:e.vessel)||void 0===t?void 0:t.key;a&&this.controller.refreshScenarioFleetPlanData([a])}getVesselOpenPositionId(e){if(e){const t=e.params.drawerId?e.params.drawerId:"0",a=parseInt(t,10);a!==this.state.vesselOpenPositionId&&this.setState({vesselOpenPositionId:a},()=>this.loadVesselOpenPosition())}}render(){var e;const t=this.i.lang(),{vesselOpenPosition:a,userLocale:n}=this.state,s=a?((e,t,a,n,o)=>{const s=t.vessel?t.vessel:new u.a({}),l=m.a.isMasterScenario(t.scenario);return[...Object(c.a)({fieldOptions:[{fieldName:"vesselName",disabled:!0}],object:s,parentData:{key:t.key,type:d.a.vesselopenposition},type:d.a.vessel,userLocale:a,reactKeyPrefix:e}),...Object(c.a)({fieldOptions:[{fieldName:"openPositionPort",disabled:l,typeaheadProps:{query:p.d},onUpdateOverride:e=>n(e)},{fieldName:"openPositionPortDate",disabled:l,onUpdateOverride:e=>o(e)}],object:t,parentData:{type:d.a.vesselopenposition,key:t.key},type:d.a.vesselopenposition,updateResponseFields:i.a,userLocale:a,reactKeyPrefix:e})]})("doc-common-components-drawer-vessel-open-position-drawer",a,n,this.onChangePort,this.onChangeDate):[];return a?o.a.createElement(l.a,{reactKeyPrefix:"doc-common-components-drawer-vessel-open-position-drawer",subject:t.model.vesselOpenPosition,subjectName:a.vessel?a.vessel.vesselName:"",subjectLoaded:!!a,drawerKey:null!==(e=this.state.vesselOpenPositionId)&&void 0!==e?e:0,key:r.a.vesselOpenPositionDrawer+this.state.vesselOpenPositionId,drawerRoute:r.a.vesselOpenPositionDrawer,tsModelType:d.a.vesselopenposition,reloadParentDrawer:()=>{},tabs:[{id:"main-details",content:()=>o.a.createElement(g.a,{breakpoints:b.a,items:s,reactKeyPrefix:"vesselOpenPositionData"}),label:t.common.mainDetails}],tabId:this.props.match.params.tabId}):null}}const S=Object(y.a)(e=>{const t=C.a.get(e),a=h.a.getTSModelBuilt(e,d.a.vesselopenposition,null!=t?t:0,i.a);return{userLocale:O.a.getUserLocale(e),vesselOpenPosition:a}},Object(v.b)([P.a.IInternationalization,f.a.ISelectedVesselOpenPositionActions,f.a.ITSModelActionsAsync,f.a.IFasFleetPlanVoyageApi],Object(k.a)(f.a.IScenarioActions,Object(s.k)(j))))},421:function(e,t,a){"use strict";a.d(t,"a",(function(){return S})),a.d(t,"c",(function(){return E})),a.d(t,"b",(function(){return I})),a.d(t,"e",(function(){return N})),a.d(t,"d",(function(){return A}));var n,o,s,i,l=a(31),r=a(1),c=a(237),d=a(29),u=a(48),p=a(90),m=a(3),g=a(107),b=a(140),v=a(78),y=a(138),f=a(892),h=a(92),C=a(46),O=a(9),P=a(7),k=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},T=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},j=function(e,t){return function(a,n){t(a,n,e)}};const S="VESSEL_LIST_ID",E="VESSEL_POSITION_REPORTS_IDENTIFIER",I="VESSEL_NEXT_PORT_CALL_IDENTIFIER",N={voyage:g.l};let A=class{constructor(e,t,a,n){this.store=e,this.tsmodelActions=t,this.keySetActions=a,this.http=n}loadVessel(e,t,a){this.tsmodelActions.loadSingleAction({callback:a,fields:e,key:t,type:r.a.vessel})}removeItemFromState(e){const t=Number(e.toString());this.store.dispatch(this.keySetActions.removeKeysAction({identifier:S,keys:[t]})),this.store.dispatch(this.tsmodelActions.removeSingleAction(r.a.vessel,e))}permaDeleteVessel(e){this.tsmodelActions.deleteAction({key:e,type:r.a.vessel})}copyVesselFromExisting(e,t,a){this.tsmodelActions.copySingleAction({callback:a,data:{vesselName:t},key:e,type:r.a.vessel})}getSubscriptionToAisPositions(e,t){return this.http.get(`${u.a.API_BASE_URL}/Vessel/isVesselSubscribed/${e}`,{headers:new Headers({authorization:t})}).then(e=>e.json(),e=>!1)}unsubscribeToAisPositions(e,t){return this.http.put(`${u.a.API_BASE_URL}/Vessel/unsubscribeVessel/${e}`,void 0,{headers:new Headers({authorization:t})})}subscribeToAisPositions(e,t){return this.http.post(`${u.a.API_BASE_URL}/Vessel/subscribeVessel/${e}`,void 0,{headers:new Headers({authorization:t})})}getVoyageWithPortCalls(e){this.tsmodelActions.loadSingleAction({fields:g.l,type:r.a.voyage,key:e})}loadPositionReports(e){this.tsmodelActions.loadMultipleAction({fields:b.e,identifier:E+e,query:"pageNumber=1&limit=1&filter=portCall.voyage.vessel(EQ)"+e+"&sort=createdDate(DS)",type:r.a.positionreport})}loadRouteFromDdt(e,t,a){var n,o,s;const i=null!==(n=null==e?void 0:e.port)&&void 0!==n?n:null,l=null!==(s=null===(o=null==e?void 0:e.previousPortCall)||void 0===o?void 0:o.port)&&void 0!==s?s:null,r=[];i&&l&&t?this.http.get(`${u.a.API_BASE_URL}/rest/ddt?port=${i.key}&port=${l.key}`,{headers:new Headers({authorization:t,fields:JSON.stringify("*")})}).then(e=>e.json()).then(e=>e.terminalList.forEach(e=>{r.push([e.lon,e.lat])})).then(()=>{a(r)}):e||a([])}loadNextPortCall(e,t,a){const n=v.a.getDateStringWithoutUTC(new Date);this.tsmodelActions.loadMultipleAction({fields:b.d,identifier:I+e,query:"pageNumber=1&limit=1&filter=voyage.vessel(EQ)"+e+"&filter=voyage.fleetPlanVoyages.fleetPlan.fleetPlanCode(EQ)MASTER&filter=voyage.voyageHeader.isEstimate(EQ)0&filter=voyage.voyageHeader.isBudget(EQ)0&filter=voyage.voyageHeader.isTemplate(EQ)0&filter=voyage.voyageHeader.isUnallocated(EQ)0&filter=eventLogs.event.eventCode(EQ)ARR&filter=eventLogs.eventLogDate(GT)"+n+"&sort=eventLogs.eventLogDate(AS)&sort=portCallSequence(AS)",type:r.a.portcall}).then(e=>{const n=e.entities;Object(y.a)(n)&&!Object(f.a)(n)&&this.loadRouteFromDdt(n[0],t,a)})}onChangeVesselName(e,t){e&&t&&h.a.getUpdateFieldFunction({fieldToSet:"vesselName",fields:{vesselName:"*"},key:e.key,type:r.a.vessel})(t)}onToggleIsActive(e){e&&h.a.updateField(!e.isObjectActive,{fieldToSet:"isObjectActive",fields:{isObjectActive:"*"},key:e.key,type:r.a.vessel,callback:()=>{C.a.next()}})}};A=k([Object(O.injectable)(),j(0,Object(O.inject)(P.a.Store)),j(1,Object(O.inject)(P.a.ITSModelActionsAsync)),j(2,Object(O.inject)(P.a.KeySetActions)),j(3,Object(O.inject)(m.a.IHttp)),T("design:paramtypes",["function"==typeof(n=void 0!==l.Store&&l.Store)?n:Object,"function"==typeof(o=void 0!==d.ITSModelActionsAsync&&d.ITSModelActionsAsync)?o:Object,"function"==typeof(s=void 0!==c.IKeySetActions&&c.IKeySetActions)?s:Object,"function"==typeof(i=void 0!==p.IHttp&&p.IHttp)?i:Object])],A)},468:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={maxZoom:13,minZoom:3,zoom:3.5}},733:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return C})),a.d(t,"a",(function(){return O}));a(10),a(11);var n,o,s,i,l=a(9),r=a(29),c=a(104),d=a(7),u=a(83),p=a(1),m=a(31),g=a(3),b=a(90),v=function(e,t,a,n){var o,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(i=(s<3?o(i):s>3?o(t,a,i):o(t,a))||i);return s>3&&i&&Object.defineProperty(t,a,i),i},y=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(e,t){return function(a,n){t(a,n,e)}};const h="VESSEL_CARGO_HANDLING_RATE",C={dischargeRate:"*",dischargeRateMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},dischargeRateTerms:{laytimeTerms:"*"},loadRate:"*",loadRateMeasurement:{laytimeTermsMeasurementName:"*",laytimeTermsMeasurementCode:"*"},loadRateTerms:{laytimeTerms:"*"},port:{portName:"*"},terminal:{terminalName:"*"}};let O=class{constructor(e,t,a,n){this.tsmodelActions=e,this.objectApi=t,this.store=a,this.http=n}loadVesselCargoHandlingRatesData(e){this.tsmodelActions.loadMultipleAction({fields:C,query:"filter=vessel.key(EQ)"+e,type:p.a.vesselcargohandlingrate,identifier:h,overwriteKeysOnLoad:!0})}deleteSelectedVesselCargoHandligRates(e){for(const t of e)this.tsmodelActions.updateSingleAction({data:{isObjectActive:!1},key:t,type:p.a.vesselcargohandlingrate}).then(()=>{this.tsmodelActions.deleteAction({key:t,type:p.a.vesselcargohandlingrate})})}};O=v([Object(l.injectable)(),f(0,Object(l.inject)(d.a.ITSModelActionsAsync)),f(1,Object(l.inject)(u.a.ITSModelApi)),f(2,Object(l.inject)(d.a.Store)),f(3,Object(l.inject)(g.a.IHttp)),y("design:paramtypes",["function"==typeof(n=void 0!==r.ITSModelActionsAsync&&r.ITSModelActionsAsync)?n:Object,"function"==typeof(o=void 0!==c.ITSModelApi&&c.ITSModelApi)?o:Object,"function"==typeof(s=void 0!==m.Store&&m.Store)?s:Object,"function"==typeof(i=void 0!==b.IHttp&&b.IHttp)?i:Object])],O)}}]);