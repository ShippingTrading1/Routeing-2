(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1166:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));a(59);var o,n,r,l,i,c,s,u=a(9),d=a(1),y=a(316),g=a(29),p=a(7),m=a(122),f=a(20),v=a(87),b=a(16),C=a(83),O=a(104),h=a(46),E=a(84),S=a(432),j=a(31),P=a(387),T=a(32),A=a(317),I=a(168),N=a(21),k=a(164),R=a(206),F=a(1167),_=a(570),L=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},D=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},w=function(e,t){return function(a,o){t(a,o,e)}},x=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const M=Object(v.a)(["portCallsFromVoyage.port.portName","portCallsFromVoyage.portCallSequence","portCallsFromVoyage.vesselPcSequence","portCallsFromVoyage.reasonForCall.reasonForCall","portCallsFromVoyage.reasonForCall.reasonForCallDesc","portCallsFromVoyage.terminal.terminalName","portCallsFromVoyage.voyage","partOfSchedule.port.portName","partOfSchedule.portCallSequence","partOfSchedule.vesselPcSequence","partOfSchedule.reasonForCall.reasonForCall","partOfSchedule.reasonForCall.reasonForCallDesc","partOfSchedule.terminal.terminalName","partOfSchedule.voyage","voyageHeader.businessUnit.key","voyageHeader.businessUnit.businessUnitName","voyageHeader.company.key","voyageHeader.company.companyName","voyageHeader.isUnallocated","voyageHeader.leg.legDesc","voyageHeader.referenceNo","voyageHeader.voyageStartDate","voyageHeader.voyageStatus.statusTypeDesc"]);let V=class{constructor(e,t,a,o,n,r,l){this.tsmodelActions=e,this.objectApi=t,this.ctrlVoyage=a,this.store=o,this.fasCargoApi=n,this.statusController=r,this.scenarioActions=l}onConfirm(e){return x(this,void 0,void 0,(function*(){const{allocateToVoyage:t,cargoToAllocate:a,maxQuantity:o,quantity:n,isOpenedFromFas:r}=e,l=o?n/o:1;return yield this.allocateCargo(a,t,l,r)}))}allocateCargo(e,t,a,o){return x(this,void 0,void 0,(function*(){return 1===a?yield this.allocateCargoToVoyage(e,a,t,o,void 0,!0):yield this.copyCargoAndAllocate(e,t,a,o)}))}allocateCargoToVoyage(e,t,a,o,n,r){var l,i,c;return x(this,void 0,void 0,(function*(){try{const s={leg:null!==(i=null===(l=e.leg)||void 0===l?void 0:l.key)&&void 0!==i?i:null,bookedQuantity:e.bookedQuantity*t,voyage:{key:a.key},cargoPorts:Object(S.c)(e,a,t,n)};if(0===s.cargoPorts.length)throw new Error("CargoPorts data missing or incorrect.");return yield this.tsmodelActions.updateSingleAction({data:s,fields:m.c,key:null!==(c=null==n?void 0:n.key)&&void 0!==c?c:e.key,type:d.a.cargo,callback:()=>{r&&this.refreshData(e,o,a)}})}catch(e){return E.a.error("Failed to create postable cargo data."),Promise.reject()}}))}copyCargoAndAllocate(e,t,a,o){return x(this,void 0,void 0,(function*(){return yield this.tsmodelActions.copySingleAction({key:e.key,data:{voyage:null},fields:m.c,type:d.a.cargo,callback:this.allocateAndUpdateQuantities(e,t,a,o)})}))}allocateAndUpdateQuantities(e,t,a,o){return(n,r)=>x(this,void 0,void 0,(function*(){return r&&e&&(yield this.allocateCargoToVoyage(e,a,t,!1,r,!1),yield this.updateCargoAndCargoPorts(e,1-a),yield this.refreshData(e,o,t)),Promise.resolve()}))}refreshData(e,t,a){return x(this,void 0,void 0,(function*(){if(t){const t=N.a.getTSModelsBuilt(this.store.getState(),d.a.fleetplanvoyage,this.scenarioActions.getFleetPlanVoyageFields(),k.b).find(t=>{var a,o;return(null===(a=t.voyage)||void 0===a?void 0:a.key)===(null===(o=e.voyage)||void 0===o?void 0:o.key)}),o=F.a.get(this.store.getState())||_.c;yield this.scenarioActions.reloadColumnData(o,t,a.vessel)}else h.a.next();return Promise.resolve()}))}updateCargoAndCargoPorts(e,t){return x(this,void 0,void 0,(function*(){yield this.tsmodelActions.updateSingleAction({key:e.key,data:{bookedQuantity:e.bookedQuantity*t,cargoPorts:e.cargoPorts.map(e=>({key:e.key,cargoQuantity:e.cargoQuantity*t}))},type:d.a.cargo})}))}loadVoyages(e,t,a,o){var n,r;return x(this,void 0,void 0,(function*(){const l=Object(T.a)(this.store.getState());if(!e||!(null==l?void 0:l.authdata)||!t)return[];const i=null!==(r=null===(n=null==t?void 0:t.voyage)||void 0===n?void 0:n.key)&&void 0!==r?r:-1,c=a&&o?"scenarios.key(EQ)"+o:"scenarios.scenarioCode(EQ)MASTER",s=["filter=vessel.key(EQ)"+e.key,"filter=voyageHeader.voyageStatus.statusTypeCode(IN)(EST,SCU,SCH,NOM,OPR)","filter=voyageHeader.isTemplate(EQ)0","filter=isTc(EQ)0","filter="+c,i>-1?"filter=key(NE)"+i:""].filter(Boolean).join("&");return this.objectApi.getMultiple({authdata:l.authdata,fields:Object(v.a)(["voyageHeader.referenceNo","voyageHeader.leg.legDesc","voyageHeader.voyageStatus"]),query:s,sorts:[{field:"voyageHeader.voyageStartDate",groupCode:"",operator:b.b.DESC,queryParamName:"voyageHeader.voyageStartDate"}],type:d.a.voyage}).then(e=>{const t=this.statusController.getStatuses(d.a.voyage);return e.map(e=>Object(I.e)(e,"voyageHeader.voyageStatus",t.find(t=>{var a,o;return t.key===(null===(o=null===(a=e.voyageHeader)||void 0===a?void 0:a.voyageStatus)||void 0===o?void 0:o.key)})))}).catch(()=>[])}))}loadVoyage(e){return x(this,void 0,void 0,(function*(){const t=Object(T.a)(this.store.getState());return(null==t?void 0:t.authdata)&&void 0!==e?this.objectApi.getSingle({authdata:t.authdata,fields:M,type:d.a.voyage,key:e}).then(e=>e).catch(()=>null):null}))}};V=L([Object(u.injectable)(),w(0,Object(u.inject)(p.a.ITSModelActionsAsync)),w(1,Object(u.inject)(C.a.ITSModelApi)),w(2,Object(u.inject)(f.a.ICargoDrawerControllerVoyage)),w(3,Object(u.inject)(p.a.Store)),w(4,Object(u.inject)(p.a.IFasCargoApi)),w(5,Object(u.inject)(f.a.IDrawerStatusController)),w(6,Object(u.inject)(p.a.IScenarioActions)),D("design:paramtypes",["function"==typeof(o=void 0!==g.ITSModelActionsAsync&&g.ITSModelActionsAsync)?o:Object,"function"==typeof(n=void 0!==O.ITSModelApi&&O.ITSModelApi)?n:Object,"function"==typeof(r=void 0!==y.ICargoDrawerControllerVoyage&&y.ICargoDrawerControllerVoyage)?r:Object,"function"==typeof(l=void 0!==j.Store&&j.Store)?l:Object,"function"==typeof(i=void 0!==P.IFasCargoApi&&P.IFasCargoApi)?i:Object,"function"==typeof(c=void 0!==A.IDrawerStatusController&&A.IDrawerStatusController)?c:Object,"function"==typeof(s=void 0!==R.IScenarioActions&&R.IScenarioActions)?s:Object])],V)},1169:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var o,n,r=a(9),l=a(29),i=a(7),c=a(1),s=a(122),u=a(147),d=a(508),y=a(84),g=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},m=function(e,t){return function(a,o){t(a,o,e)}};let f=o=class{constructor(e){this.tsmodelActions=e}initiateRelet(e,t,a,o,n,r){try{e===d.a.Relet?this.reletCargo(t,a,r):e===d.a.Transship?this.transshipCargo(t,a,o,n,o.cargoQuantity,r):e===d.a.Preship&&this.preshipCargo(t,a,o,n,n.cargoQuantity,r)}catch(e){y.a.error("Can't relet, data missing or incorrect.")}}reletCargo(e,t,a){this.copyCargoForRelet(e.key,(n,r)=>{r&&this.updateCargo(r,o.getDataObjForRelet(r,e,t),a)})}transshipCargo(e,t,a,n,r,l){this.copyCargoForRelet(e.key,(i,c)=>{c&&(this.updateCargo(e,{finalDestination:n.portName}),this.updateCargo(c,o.getDataObjForTransship(t,a,n,r),l))})}preshipCargo(e,t,a,n,r,l){this.copyCargoForRelet(e.key,(i,c)=>{c&&(this.updateCargo(e,{placeOfOrigin:a.portName}),this.updateCargo(c,o.getDataObjForPreship(t,a,n,r),l))})}copyCargoForRelet(e,t){this.tsmodelActions.copySingleAction({key:e,data:{variouses:[],commissions:[]},fields:s.e,type:c.a.cargo,callback:t})}updateCargo(e,t,a){this.tsmodelActions.updateSingleAction({key:e.key,data:t,fields:s.e,type:c.a.cargo,callback:a})}static getDataObjForRelet(e,t,a){return{cargoPorts:e.cargoPorts.map(e=>({key:e.key,variouses:[],handlingCost:0,handlingCostRate:0,handlingCostCurrencyAmount:0})),charterer:a.key,coaLine:null,commissionBroker:0,commissions:[],handlingCost:0,reletOfCargo:t.key,tsOfCargoPort:null,variouses:[],vc:null}}static getDataObjForTransship(e,t,a,o){var n;const r={cargoQuantity:o,variouses:[],handlingCost:0,handlingCostRate:0,handlingCostCurrencyAmount:0};return{cargoPorts:[Object.assign(Object.assign({},r),{port:null===(n=t.port)||void 0===n?void 0:n.key,reasonForCall:"L"}),Object.assign(Object.assign({},r),{port:null==a?void 0:a.key,reasonForCall:"D"})],charterer:e.key,coaLine:null,commissionBroker:0,commissions:[],handlingCost:0,reletOfCargo:null,tsOfCargoPort:t.key,variouses:[],vc:null}}static getDataObjForPreship(e,t,a,o){var n;const r={cargoQuantity:o,variouses:[],handlingCost:0,handlingCostRate:0,handlingCostCurrencyAmount:0};return{cargoPorts:[Object.assign(Object.assign({},r),{port:null==t?void 0:t.key,reasonForCall:"L"}),Object.assign(Object.assign({},r),{port:null===(n=a.port)||void 0===n?void 0:n.key,reasonForCall:"D"})],charterer:e.key,coaLine:null,commissionBroker:0,commissions:[],handlingCost:0,reletOfCargo:null,tsOfCargoPort:a.key,variouses:[],vc:null}}static getCargoPortsForTransshipOrPreship(e,t){const a=t===d.a.Transship?"D":"",o=t===d.a.Preship?"L":"";return a||o?u.a.getCargoPortsByReasonForCall(e,a||o):[]}};f=o=g([Object(r.injectable)(),m(0,Object(r.inject)(i.a.ITSModelActionsAsync)),p("design:paramtypes",["function"==typeof(n=void 0!==l.ITSModelActionsAsync&&l.ITSModelActionsAsync)?n:Object])],f)},1194:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));a(59);var o=a(964),n=a(712),r=a(0),l=a.n(r),i=a(203),c=a.n(i),s=a(977),u=a(1323),d=a(137);const y=(e,t)=>{const a=document.querySelector(".dl-allocate-cargo");a&&(c.a.unmountComponentAtNode(a),a.remove()),((e,t)=>{e.destroy(),e.removeHotkeyEventHandler("Enter",t)})(e,t)};function g(e,t,a,r,i){return new Promise((g,p)=>{const m=document.createElement("div");m.className="dl-allocate-cargo",document.body.appendChild(m);const f=new n.a,v=()=>{y(f,v),g(!0)},b=l.a.createElement(s.a,{injectFirst:!0},l.a.createElement(u.a,{theme:d.a},l.a.createElement(o.a,{reactKeyPrefix:"doc-allocate-cargo",showDialog:!0,onCloseDialog:()=>{y(f,v),g(!1)},onConfirmDialog:v,cargo:e,voyage:t,vessel:a,showQuantitySelector:r,isOpenedFromFas:i})));c.a.render(b,document.querySelector(".dl-allocate-cargo"))})}},1199:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));const o={vesselFields:{vesselName:"*",vesselType:{vesselTypeDesc:"*"},vesselCodes:{operator:"*"}}}},1200:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const o={reasonForCall:"*",reasonForCallDesc:"*"},n={voyageCommitmentsFields:{isTc:"*",tcs:{deliveryPort:{portName:"*"},redeliveryPort:{portName:"*"}},ballastPort:{portName:"*"},cargos:{cargoPorts:{cargoPortSequence:"*",port:{portName:"*"},reasonForCall:o},cargoQuantity:"*",cargoType:{cargoTypeCode:"*",cargoTypeName:"*"},charterer:{businessPartnerName:"*",businessPartnerCode:"*",businessPartnerType:{businessPartnerTypeDesc:"*"}},commodity:{commodityName:"*",commodityGroup:{commodityClass:{commodityClassDesc:"*"}}},isPerformanceCargo:"*",tsOfCargoPort:{reasonForCall:o,cargo:{key:"*",voyage:{key:"*"}}},reletOfCargo:"*",voyage:{key:"*"}},portCallsFromVoyage:{portCallSequence:"*",reasonForCall:o,port:{portAreas:{area:{areaCode:"*",areaDescription:"*"},areaReport:"*"},portName:"*"}},vessel:{vesselName:"*",vesselType:{vesselTypeDesc:"*"}},voyageHeader:{charteringResponsible:"*",leg:{legDesc:"*"},referenceNo:"*",voyageStartDate:"*",voyageEndDate:"*",voyageStatus:{statusTypeCode:"*",statusTypeDesc:"*"}}}}},1201:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));const o={cargoCommitmentsFields:{bookingStatus:{statusTypeDesc:"*"},cargoReference:"*",cargoPorts:{port:{portName:"*",portAreas:{area:{areaDescription:"*"},areaReport:"*"}},reasonForCall:{reasonForCall:"*"},cargoPortSequence:"*"},cargoQuantity:"*",cargoType:{cargoTypeName:"*",cargoTypeCode:"*"},bookedQuantity:"*",charterer:{businessPartnerName:"*"},commodity:{commodityName:"*",commodityGroup:{commodityClass:{commodityClassDesc:"*"}}},leg:{legDesc:"*"},laycanFrom:"*",reletOfCargo:"*",coaLine:"*",tsOfCargoPort:{cargo:"*",reasonForCall:{reasonForCall:"*"}},voyage:"*"}}},1250:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));a(59),a(10),a(11);var o=a(214),n=a(0),r=a.n(n),l=a(102),i=a(114),c=a(215),s=a(44),u=a(6),d=a(1),y=a(3),g=a(20),p=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};function m({reactKeyPrefix:e,open:t,onClose:a,userLocale:m,fields:f,identifier:v,modalTitle:b,documentTypes:C,accrual:O}){const[h,E]=Object(u.a)([y.a.IInternationalization,g.a.IBatchPostModalController]),{common:S,model:j,accruals:P}=h.getLanguageFile(),[T,A]=Object(n.useState)(null),[I,N]=Object(n.useState)([]),k=Object(n.useCallback)(e=>{A(e)},[]),R=Object(n.useCallback)(()=>p(this,void 0,void 0,(function*(){const e=yield E.fetchDocuments(null!=T?T:new Date,I,C),t=e.length,o=E.isSumBalanced(e);Object(i.a)(0===t?P.nothingToBatchPostWarningTitle(O):o?"":S.error,0===t?P.nothingToBatchPostWarning(O):o?S.documentsToBePosted(t):P.batchPostWarning,S.post,S.cancel,0===t||!o).then(e=>{e&&(E.batchPostObjects({date:null!=T?T:new Date,businessUnits:I,fields:f,identifier:v,documentTypes:C}),a())})})),[O,P,E,I,S,T,C,f,v,a]);return r.a.createElement(s.a,{title:b,confirmBtnName:S.post,open:t,reactKeyPrefix:e+"-modal",onCloseModal:a,onConfirm:R,fullWidth:!0,maxWidth:"xs",disableConfirmBtn:!T},r.a.createElement(o.a,{container:!0,spacing:2},r.a.createElement(o.a,{item:!0,xs:6},r.a.createElement(c.a,{reactKeyPrefix:e+"-date",label:S.month,onBlur:k,value:T,locale:m,showDay:!1,showShortDate:!1,required:!0})),r.a.createElement(o.a,{item:!0,xs:12},r.a.createElement(l.b,{reactKeyPrefix:e+"-business-units",label:j.businessUnits,type:d.a.businessunit,objectPaths:["businessUnitName"],onChange:N,shouldPreload:!0,isMulti:!0}))))}},1257:function(e,t,a){"use strict";a.d(t,"a",(function(){return Me}));a(10),a(11);var o=a(2361),n=a(0),r=a.n(n),l=a(97),i=a(46),c=a(6),s=a(277),u=a(310),d=a(15),y=a(27),g=a(20),p=a(470),m=a(1621),f=a(57),v=a(44),b=a(154),C=a(70),O=a(3);function h(e){const{showModal:t,onClose:a,onConfirm:o,reactKeyPrefix:l,scenarioToCopy:i}=e,[s]=Object(c.a)([O.a.IInternationalization]),{common:d,model:y,fas:g}=s.getLanguageFile(),h=Object(n.useMemo)(()=>{if(u.a.isMasterScenario(i)){const e=Object(p.a)(Object(m.a)((new Date).toISOString()),"dd-MM-yyyy HH:mm");return`${g.masterFleetPlan} ${e}`}return i.scenarioName},[g.masterFleetPlan,i]),[E,S]=Object(n.useState)(d.copyOf(h)),[j,P]=Object(n.useState)(!0),T=Object(n.useCallback)((e,t)=>{P(t),S(e)},[]),A=Object(n.useCallback)(()=>{o(E.trim())},[E,o]);return r.a.createElement(v.a,{reactKeyPrefix:l,title:y.scenarioName,open:t,onCloseModal:a,maxWidth:"xs",fullWidth:!0,confirmBtnName:d.next,onConfirm:A,disableConfirmBtn:!j||void 0===E||0===E.length},r.a.createElement(f.b,{reactKeyPrefix:l+"-name-input",onInputChange:T,value:E,characterRequirements:{maxLength:b.a.scenario.scenarioName.limit},validation:C.b.ScenarioName,autoFocus:!0,required:!0,preValidateValue:!0,onFocus:e=>{e.target.select()}}))}a(59);var E=a(1136),S=a(1578),j=a(130),P=a(473),T=a(2531),A=a(2504),I=a(2508);const N={buttonsContainer:{display:"flex",justifyContent:"flex-end",paddingTop:"8px"},container:{display:"flex",flexDirection:"column",height:"100%",paddingBottom:0},helperText:{fontSize:"12.25px",paddingBottom:1},nextButton:{ml:1},stepper:{width:"75%",paddingBottom:1,"& .MuiStepLabel-label":{fontSize:"16px"}}};function k(e){var t,a;const{reactKeyPrefix:o,onCopy:l,onStepChange:i,content:s,disableConfirmBtn:u,steps:d}=e,[y]=Object(c.a)([O.a.IInternationalization]),{common:g}=y.getLanguageFile(),[p,m]=Object(n.useState)(0),[f,v]=Object(n.useState)({}),b=()=>d.length,C=()=>p===b()-1,h=()=>Object.keys(f).length===b();return r.a.createElement("div",{style:N.container},r.a.createElement(I.a,{nonLinear:!0,activeStep:p,sx:N.stepper},d.map((e,t)=>{return r.a.createElement(T.a,{key:e},r.a.createElement(A.a,{onClick:(a=t,()=>{const e=f;e[p]=!0,v(e),i(a),m(a)})},e));var a})),r.a.createElement(j.a,{sx:N.helperText,color:"textSecondary"},null===(t=s[p])||void 0===t?void 0:t.helperText),null===(a=s[p])||void 0===a?void 0:a.content(),r.a.createElement("div",{style:N.buttonsContainer},!(0===p)&&r.a.createElement(P.a,{id:o+"-back-btn",variant:"outlined",color:"primary",onClick:()=>{i(p-1),m(e=>e-1)}},g.back),r.a.createElement(P.a,{id:o+"-next-btn",variant:C()?"contained":"outlined",color:"primary",onClick:()=>{C()&&l();const e=f;e[p]=!0,v(e),(()=>{const e=C()&&!h()?d.findIndex((e,t)=>!(t in f)):p+1;i(e),m(e)})()},sx:N.nextButton,disabled:!!C()&&u},C()?g.copy:g.next)))}var R=a(323),F=a(5),_=a(67),L=a(47),D=a(1),w=a(21),x=a(647),M=a(373),V=a(24),G=a(4),H=a(14),q=a(119);const K=H.a.get(O.a.IInternationalization),{common:U,model:B}=K.lang(),Y=(e,t)=>{const a={field:"key",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"vesselFilter"};return[{label:B.vessel,filterObjectValuePath:"key",typeaheadProps:{options:t,objectPaths:["vesselName"],resolver:e=>{var t;return null!==(t=e.vesselName)&&void 0!==t?t:" "}},filters:[a]}]},Q=(e,t)=>[{label:U.myVessels,filterObjectValuePath:"key",filters:[{field:"userId",filterGroupCode:e,operator:G.c.EQUALS,queryParamName:"vesselCodes[0].operator.key",type:G.d.STRING,value:t,filterCode:"operator",resolveField:"vesselCodes[0].operator.key"}]}],z=(e,t)=>{const a={field:"vesselType.key",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"vesselTypeFilter"};return[{label:B.vesselType,filterObjectValuePath:"key",typeaheadProps:{options:Object(q.l)(t),objectPaths:["vesselType"],resolver:e=>{var t;return null!==(t=e.vesselTypeDesc)&&void 0!==t?t:" "}},filters:[a]}]},$=r.a.memo(e=>{const{groupCode:t,vessels:a,i:o,user:n}=e,{common:l,model:i}=o.getLanguageFile();return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{reactKeyPrefix:t,configs:Q(t,n.key),type:G.b.BOOLEAN,label:l.myVessels,filterCode:t+"_MY_VESSELS"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:Y(t,a),type:G.b.TYPEAHEAD,label:i.vessel,filterCode:t+"_VESSEL_NAME"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:z(t,a),type:G.b.TYPEAHEAD,label:i.vesselType,filterCode:t+"_VESSEL_TYPE"}))});var W=a(32),X=a(132),J=a(94),Z=a(1199),ee=a(330);var te=a(2383);const ae=e=>{const t=[{content:r.a.createElement(te.a,{variant:"rectangular",width:24,height:24}),contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT},{content:r.a.createElement(te.a,{variant:"text",width:e?300:150}),contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT},{content:r.a.createElement(te.a,{variant:"text",width:e?300:150}),contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT}];return e||t.push({content:r.a.createElement(te.a,{variant:"text",width:150}),contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT},{content:r.a.createElement(te.a,{variant:"text",width:150}),contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT}),t};function oe(e){return[...Array(e?5:8).keys()].map(t=>{const a={content:r.a.createElement(te.a,{variant:"rectangular",width:24,height:24}),rawValue:null},o={content:r.a.createElement(te.a,{variant:"text",width:e?200:100}),rawValue:null};return{content:e?[a,o,o]:[a,o,o,o,o],id:t}})}function ne(e){var t,a;const{reactKeyPrefix:o,userLocale:l,scenario:i,updateSelected:c,isLoading:s,state:{vessels:u,user:d,unfilteredVessels:y},deps:[g]}=e,{height:p}=Object(M.a)(),m=(e=>({container:{display:"flex",flexDirection:"column",height:e?.6*e:"500px"}}))(p),f=Object(n.useMemo)(()=>(e=>{const{model:t}=e.getLanguageFile();return[{content:t.vessel,contentType:F.a.TEXT},{content:t.vesselType,contentType:F.a.TEXT}]})(g),[g]),v=Object(n.useMemo)(()=>function(e){return e.map(e=>{var t,a,o;return{content:[null!==(t=null==e?void 0:e.vesselName)&&void 0!==t?t:"",null!==(o=null===(a=null==e?void 0:e.vesselType)||void 0===a?void 0:a.vesselTypeDesc)&&void 0!==o?o:""],id:e.key}})}(u),[u]),b=Object(n.useCallback)(e=>{c(e,"vessels")},[c]);return r.a.createElement(R.a,{style:m.container},r.a.createElement(ee.a,null,r.a.createElement($,{groupCode:"COPY_SCENARIO_VESSELS_FILTER_CODE",vessels:y,user:d,i:g})),r.a.createElement(_.a,{headers:s?ae(!0):f,data:s?oe(!0):v,reactKeyPrefix:o+"-table",userLocale:l,customisation:{responsive:!0,compactCheckbox:!0,height:{type:F.d.PX,value:p?.6*p:900}},selectable:!s,onRowSelect:b,overrideSelected:null!==(a=null===(t=null==i?void 0:i.vessels)||void 0===t?void 0:t.map(e=>e.key))&&void 0!==a?a:[]}))}const re=Object(L.a)(e=>{var t,a;const o=null!==(t=J.a.getFiltersByGroupCode(e,"COPY_SCENARIO_VESSELS_FILTER_CODE"))&&void 0!==t?t:[],n=null!==(a=w.a.getTSModelsBuilt(e,D.a.vessel,Z.a.vesselFields,x.b))&&void 0!==a?a:[],r=Object(W.a)(e);return{vessels:Object(X.e)(n,o),user:r,unfilteredVessels:n}},Object(c.b)([O.a.IInternationalization],Object(l.k)(Object(n.memo)(ne))));var le=a(58),ie=a(60),ce=a(40),se=a(105);var ue=a(372),de=a(1200);function ye(e,t){const a=H.a.get(O.a.IInternationalization),o={field:"voyageHeader.referenceNo",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"referenceNoFilter"},n={field:"voyageHeader.voyageStatus.key",filterGroupCode:e,operator:G.c.IN,type:G.d.NUMBER,optionCode:"statusTypeFilter"};return[{label:a.lang().model.referenceNumber,filterObjectValuePath:"referenceNo",typeaheadProps:{label:a.lang().model.referenceNumber,options:Object(q.n)(t).filter(e=>{var t,a;return(null!==(a=null===(t=e.referenceNo)||void 0===t?void 0:t.length)&&void 0!==a?a:-1)>0}),resolver:e=>{var t;return null!==(t=e.referenceNo)&&void 0!==t?t:" "}},filters:[o]},{label:a.lang().model.voyageStatus,filterObjectValuePath:"key",typeaheadProps:{label:a.lang().model.voyageStatus,options:Object(q.j)(t),resolver:e=>{var t;return null!==(t=e.statusTypeDesc)&&void 0!==t?t:" "}},filters:[n]}]}function ge(e,t){const a=H.a.get(O.a.IInternationalization),o={field:"vessel.key",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"vesselNameFilter"},n={field:"vessel.vesselType.key",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"vesselTypeFilter"};return[{label:a.lang().model.name,filterObjectValuePath:"key",typeaheadProps:{label:a.lang().model.name,options:t,resolver:e=>{var t;return null!==(t=e.vesselName)&&void 0!==t?t:" "}},filters:[o]},{label:a.lang().common.type,filterObjectValuePath:"key",typeaheadProps:{label:a.lang().common.type,options:Object(q.l)(t),resolver:e=>{var t;return null!==(t=e.vesselTypeDesc)&&void 0!==t?t:" "}},filters:[n]}]}var pe=a(186);function me(e,t,a){!function(e){const t=H.a.get(O.a.FilterResolver);t.addFilterResolver("COPY_SCENARIO_LOAD_AREA_FILTER_RESOLVER_VOYAGE",t=>pe.a.getArea(ie.a.getFirstLoadPort(t.portCallsFromVoyage),null!=e?e:-1)),t.addFilterResolver("COPY_SCENARIO_DISCHARGE_AREA_FILTER_RESOLVER_VOYAGE",t=>pe.a.getArea(ie.a.getLastDischargePort(t.portCallsFromVoyage),null!=e?e:-1))}(a);const o=H.a.get(O.a.IInternationalization),n={field:"portCallsFromVoyage.port.portAreas.area.areaDescription",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"loadAreaFilter",resolveField:"COPY_SCENARIO_LOAD_AREA_FILTER_RESOLVER_VOYAGE"},r={field:"portCallsFromVoyage.port.portAreas.area.areaDescription",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"dischargeAreaFilter",resolveField:"COPY_SCENARIO_DISCHARGE_AREA_FILTER_RESOLVER_VOYAGE"};return[{label:o.lang().model.loading,filterObjectValuePath:"key",typeaheadProps:{label:o.lang().model.loading,options:Object(q.a)(t,null!=a?a:-1),resolver:e=>`${e.areaDescription} ${e.areaCode}`},filters:[n]},{label:o.lang().model.discharging,filterObjectValuePath:"key",typeaheadProps:{label:o.lang().model.discharging,options:Object(q.a)(t,null!=a?a:-1),resolver:e=>`${e.areaDescription} ${e.areaCode}`},filters:[r]}]}var fe=a(86);function ve(e,t){!function(){const e=H.a.get(O.a.FilterResolver);e.addFilterResolver("COPY_SCENARIO_COMMODITY_FILTER_RESOLVER_VOYAGE",e=>{var t;return null===(t=e.cargos)||void 0===t?void 0:t.map(e=>{var t,a;return null!==(a=null===(t=e.commodity)||void 0===t?void 0:t.key)&&void 0!==a?a:-1})}),e.addFilterResolver("COPY_SCENARIO_CHARTERER_FILTER_RESOLVER_VOYAGE",e=>{var t;return null===(t=e.cargos)||void 0===t?void 0:t.map(e=>{var t,a;return null!==(a=null===(t=e.charterer)||void 0===t?void 0:t.key)&&void 0!==a?a:-1})}),e.addFilterResolver("COPY_SCENARIO_CARGO_TYPE_FILTER_RESOLVER_VOYAGE",e=>{var t;return null===(t=e.cargos)||void 0===t?void 0:t.map(e=>{var t,a;return null!==(a=null===(t=e.cargoType)||void 0===t?void 0:t.key)&&void 0!==a?a:-1})}),e.addFilterResolver("COPY_SCENARIO_COMMODITY_CLASS_FILTER_RESOLVER_VOYAGE",e=>{var t;return null===(t=e.cargos)||void 0===t?void 0:t.map(e=>{var t,a,o,n;return null!==(n=null===(o=null===(a=null===(t=e.commodity)||void 0===t?void 0:t.commodityGroup)||void 0===a?void 0:a.commodityClass)||void 0===o?void 0:o.key)&&void 0!==n?n:-1})})}();const a=Object(q.f)(t),o=Object(q.e)(t),n=Object(q.k)(t),r=Object(q.g)(t),l=Object(q.d)(t),i=H.a.get(O.a.IInternationalization),c={field:"cargos.commodity.key",resolveField:"COPY_SCENARIO_COMMODITY_FILTER_RESOLVER_VOYAGE",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"commodityFilter"},s={field:"cargos.charterer.key",resolveField:"COPY_SCENARIO_CHARTERER_FILTER_RESOLVER_VOYAGE",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"chartererFilter"},u={field:"voyageHeader.leg.key",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"tradeFilter"},d={field:"cargos.cargoGroup.commodityClass.key",resolveField:"COPY_SCENARIO_COMMODITY_CLASS_FILTER_RESOLVER_VOYAGE",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"commodityClassFilter"},y={field:"cargos.cargoType.key",resolveField:"COPY_SCENARIO_CARGO_TYPE_FILTER_RESOLVER_VOYAGE",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"cargoTypeFilter"};return[{label:i.lang().model.commodity,filterObjectValuePath:"key",typeaheadProps:{label:i.lang().model.commodity,options:a,resolver:e=>e.commodityName},filters:[c]},{label:i.lang().model.charterer,filterObjectValuePath:"key",typeaheadProps:{label:i.lang().model.charterer,options:o,resolver:e=>Object(fe.c)(e,fe.b.businessPartner)},filters:[s]},{label:i.lang().model.trade,filterObjectValuePath:"key",typeaheadProps:{label:i.lang().model.trade,options:n,resolver:e=>e.legDesc},filters:[u]},{label:i.lang().model.commodityClass,filterObjectValuePath:"key",typeaheadProps:{label:i.lang().model.commodityClass,options:r,resolver:e=>e.commodityClassDesc},filters:[d]},{label:i.lang().model.cargoType,filterObjectValuePath:"key",typeaheadProps:{label:i.lang().model.cargoType,options:l,resolver:e=>e.cargoTypeName},filters:[y]}]}const be=r.a.memo(e=>{const{groupCode:t,vessels:a,areaReportKey:o,voyages:n}=e,l=H.a.get(O.a.IInternationalization);return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{reactKeyPrefix:t,configs:ye(t,n),type:G.b.TYPEAHEAD,label:l.lang().model.voyage,filterCode:t+"_VOYAGE"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:ge(t,a),type:G.b.TYPEAHEAD,label:l.lang().model.vessel,filterCode:t+"_VESSEL"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:me(t,n,o),type:G.b.TYPEAHEAD,label:l.lang().model.areaDescription,filterCode:t+"_AREA"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:ve(t,n),type:G.b.TYPEAHEAD,label:l.lang().common.more,filterCode:t+"_MORE"}))});function Ce(e){var t,a;const{reactKeyPrefix:o,userLocale:l,scenario:i,updateSelected:c,isLoading:s,state:{voyages:u,selectedAreaReport:d,unfilteredVoyages:y,vessels:g},deps:[p]}=e,{height:m}=Object(M.a)(),f=(e=>({container:{display:"flex",flexDirection:"column",height:e?.6*e:"500px"}}))(m),v=Object(n.useMemo)(()=>(e=>{const{model:t,fas:a}=e.getLanguageFile();return[{content:t.referenceNumber,contentType:F.a.TEXT},{alignHeaderContent:F.c.LEFT,content:t.voyageStatus,contentType:F.a.ELEMENT},{content:t.trade,contentType:F.a.TEXT},{content:a.startDate,contentType:F.a.DATE},{content:a.endDate,contentType:F.a.DATE},{content:t.ballastPort,contentType:F.a.TEXT},{content:t.loadPort,contentType:F.a.TEXT},{content:t.dischargePort,contentType:F.a.TEXT}]})(p),[p]),b=Object(n.useMemo)(()=>function(e){return e.map((e,t)=>{var a,o,n,l,i,c,s,u,d,y,g,p,m,f,v,b,C,O,h,E,S,j,P,T;const A=ie.a.getPerformanceCargo(e.cargos),I=le.a.getFirstLoadCargoPort(A.cargoPorts),N=le.a.getLastDischargeCargoPort(A.cargoPorts),k=null!==(o=null===(a=e.voyageHeader)||void 0===a?void 0:a.voyageStartDate)&&void 0!==o?o:new Date,R=null!==(l=null===(n=e.voyageHeader)||void 0===n?void 0:n.voyageEndDate)&&void 0!==l?l:new Date,F=null!==(s=null===(c=null===(i=e.voyageHeader)||void 0===i?void 0:i.voyageStatus)||void 0===c?void 0:c.statusTypeDesc)&&void 0!==s?s:" - ",_=e.isTc?null!==(y=null===(d=null===(u=e.tcs[0])||void 0===u?void 0:u.deliveryPort)||void 0===d?void 0:d.portName)&&void 0!==y?y:" - ":null!==(p=null===(g=null==I?void 0:I.port)||void 0===g?void 0:g.portName)&&void 0!==p?p:" - ",L=e.isTc?null!==(v=null===(f=null===(m=e.tcs[0])||void 0===m?void 0:m.redeliveryPort)||void 0===f?void 0:f.portName)&&void 0!==v?v:" - ":null!==(C=null===(b=null==N?void 0:N.port)||void 0===b?void 0:b.portName)&&void 0!==C?C:" - ";return{content:[null!==(h=null===(O=e.voyageHeader)||void 0===O?void 0:O.referenceNo)&&void 0!==h?h:" - ",{rawValue:F,content:r.a.createElement(ce.a,{key:t,label:F,priority:se.a.getStatusPriority(F,D.a.voyage)})},null!==(j=null===(S=null===(E=e.voyageHeader)||void 0===E?void 0:E.leg)||void 0===S?void 0:S.legDesc)&&void 0!==j?j:" - ",null!=k?k:" - ",null!=R?R:" - ",null!==(T=null===(P=e.ballastPort)||void 0===P?void 0:P.portName)&&void 0!==T?T:" - ",_,L],id:e.key}})}(u),[u]),C=Object(n.useCallback)(e=>{c(e,"voyages")},[c]);return r.a.createElement(R.a,{style:f.container},r.a.createElement(ee.a,null,r.a.createElement(be,{groupCode:"COPY_SCENARIO_VOYAGES_FILTER_CODE",vessels:g,areaReportKey:null==d?void 0:d.key,voyages:y})),r.a.createElement(_.a,{headers:s?ae(!1):v,data:s?oe(!1):b,userLocale:l,reactKeyPrefix:o+"-table",customisation:{responsive:!0,compactCheckbox:!0,height:{type:F.d.PX,value:m?.6*m:900}},selectable:!s,onRowSelect:C,overrideSelected:null!==(a=null===(t=null==i?void 0:i.voyages)||void 0===t?void 0:t.map(e=>e.key))&&void 0!==a?a:[]}))}const Oe=Object(L.a)(e=>{var t,a;const o=null!==(t=J.a.getFiltersByGroupCode(e,"COPY_SCENARIO_VOYAGES_FILTER_CODE"))&&void 0!==t?t:[],n=null!==(a=w.a.getTSModelsBuilt(e,D.a.voyage,de.a.voyageCommitmentsFields,x.c))&&void 0!==a?a:[],r=ue.a.getSelectedAreaReport(e),l=n.map(e=>e.vessel);return{unfilteredVoyages:n,voyages:Object(X.e)(n,o),selectedAreaReport:r,vessels:l}},Object(c.b)([O.a.IInternationalization],Object(l.k)(Object(n.memo)(Ce))));const he={getSteps:function(e,t){const{fas:a}=t.getLanguageFile();return e.isBudget?[a.selectVessels]:[a.selectVessels,a.selectVoyageCommitments,a.selectCargoCommitments]},disableConfirmBtn:function(e){return!(e.vessels.length||e.voyages.length||e.cargos.length)}};var Ee=a(1201),Se=a(487);const je={getHeaders:e=>{const{model:t}=e.getLanguageFile();return[{content:t.cargoReference,contentType:F.a.TEXT},{content:t.cargoStatus,contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT},{content:t.cargoType,contentType:F.a.ELEMENT,alignHeaderContent:F.c.LEFT},{content:t.loadPort,contentType:F.a.TEXT},{content:t.dischargePort,contentType:F.a.TEXT},{content:t.charterer,contentType:F.a.TEXT},{content:t.cargoQuantity,contentType:F.a.TEXT},{content:t.commodity,contentType:F.a.TEXT},{content:t.trade,contentType:F.a.TEXT}]},getRows:function(e){return e.map((e,t)=>{var a,o,n,l,i,c,s,u,d,y,g,p,m;const{cargoReference:f,cargoQuantity:v}=e,b=null!==(o=null===(a=e.bookingStatus)||void 0===a?void 0:a.statusTypeDesc)&&void 0!==o?o:" - ",C=r.a.createElement(Se.a,{cargo:e}),O=le.a.getFirstLoadCargoPort(e.cargoPorts),h=null!==(l=null===(n=null==O?void 0:O.port)||void 0===n?void 0:n.portName)&&void 0!==l?l:" - ",E=le.a.getLastDischargeCargoPort(e.cargoPorts),S=null!==(c=null===(i=null==E?void 0:E.port)||void 0===i?void 0:i.portName)&&void 0!==c?c:" - ",j=null!==(u=null===(s=e.charterer)||void 0===s?void 0:s.businessPartnerName)&&void 0!==u?u:" - ",P=null!==(y=null===(d=e.commodity)||void 0===d?void 0:d.commodityName)&&void 0!==y?y:" - ",T=null!==(p=null===(g=e.leg)||void 0===g?void 0:g.legDesc)&&void 0!==p?p:" - ";return{content:[null!=f?f:" - ",{rawValue:b,content:r.a.createElement(ce.a,{key:t,label:b,priority:se.a.getStatusPriority(b,D.a.cargo)})},{rawValue:null===(m=e.cargoType)||void 0===m?void 0:m.cargoTypeName,content:null!=C?C:" - "},h,S,j,null!=v?v:" - ",P,T],id:e.key}})}};function Pe(e,t){const a=H.a.get(O.a.IInternationalization),o={field:"charterer.businessPartnerName",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING};return[{label:a.lang().model.charterer,filterObjectValuePath:"charterer.businessPartnerName",typeaheadProps:{options:t.filter(e=>{var t;return null===(t=e.charterer)||void 0===t?void 0:t.businessPartnerName}),objectPaths:["charterer.businessPartnerName"]},filters:[o]}]}function Te(e,t){const a=H.a.get(O.a.IInternationalization),o={field:"commodity.commodityName",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"commodityFilter"},n={field:"commodity.commodityGroup.commodityClass.commodityClassDesc",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"commodityClassFilter"},r={field:"cargoType.cargoTypeName",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"cargoTypeFilter"};return[{label:a.lang().model.commodity,filterObjectValuePath:"commodity.commodityName",typeaheadProps:{label:a.lang().model.commodity,options:t.filter(e=>{var t;return null===(t=e.commodity)||void 0===t?void 0:t.commodityName}),objectPaths:["commodity.commodityName"]},filters:[o]},{label:a.lang().model.commodityClass,filterObjectValuePath:"commodity.commodityGroup.commodityClass.commodityClassDesc",typeaheadProps:{label:a.lang().model.commodityClass,options:t.filter(e=>{var t,a,o;return null===(o=null===(a=null===(t=e.commodity)||void 0===t?void 0:t.commodityGroup)||void 0===a?void 0:a.commodityClass)||void 0===o?void 0:o.commodityClassDesc}),objectPaths:["commodity.commodityGroup.commodityClass.commodityClassDesc"]},filters:[n]},{label:a.lang().model.cargoType,filterObjectValuePath:"cargoType.cargoTypeName",typeaheadProps:{label:a.lang().model.cargoType,options:t.filter(e=>{var t;return null===(t=e.cargoType)||void 0===t?void 0:t.cargoTypeName}),objectPaths:["cargoType.cargoTypeName"]},filters:[r]}]}function Ae(e,t){const a=H.a.get(O.a.IInternationalization),o={field:"leg.legDesc",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING};return[{label:a.lang().model.trade,filterObjectValuePath:"leg.legDesc",typeaheadProps:{options:t.filter(e=>{var t;return null===(t=e.leg)||void 0===t?void 0:t.legDesc}),objectPaths:["leg.legDesc"]},filters:[o]}]}var Ie=a(64),Ne=a(91),ke=a(391);function Re(e,t,a){!function(e){const t=H.a.get(O.a.FilterResolver);t.addFilterResolver("CARGO_COMMITMENTS_LOAD_AREA_FILTER_RESOLVER",t=>{var a,o;const n=null!==(a=le.a.getFirstLoadCargoPort(t.cargoPorts))&&void 0!==a?a:new Ie.a({});return pe.a.getArea(null!==(o=null==n?void 0:n.port)&&void 0!==o?o:new Ne.a({}),null!=e?e:-1)}),t.addFilterResolver("CARGO_COMMITMENTS_DISCHARGE_AREA_FILTER_RESOLVER",t=>{var a,o;const n=null!==(a=le.a.getLastDischargeCargoPort(t.cargoPorts))&&void 0!==a?a:new Ie.a({});return pe.a.getArea(null!==(o=null==n?void 0:n.port)&&void 0!==o?o:new Ne.a({}),null!=e?e:-1)})}(a);const o=H.a.get(O.a.IInternationalization),n={field:"cargoPorts.port.portAreas.area.areaDescription",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"loadingFilter",resolveField:"CARGO_COMMITMENTS_LOAD_AREA_FILTER_RESOLVER"},r={field:"cargoPorts.port.portAreas.area.areaDescription",filterGroupCode:e,operator:G.c.IN,type:G.d.STRING,optionCode:"dischargingFilter",resolveField:"CARGO_COMMITMENTS_DISCHARGE_AREA_FILTER_RESOLVER"};return[{label:o.lang().model.loading,filterObjectValuePath:"key",typeaheadProps:{label:o.lang().model.loading,options:Object(ke.a)(t,null!=a?a:-1),objectPaths:["areaDescription"]},filters:[n]},{label:o.lang().model.discharging,filterObjectValuePath:"key",typeaheadProps:{label:o.lang().model.discharging,options:Object(ke.a)(t,null!=a?a:-1),objectPaths:["areaDescription"]},filters:[r]}]}const Fe=r.a.memo(e=>{const{filterGroupCode:t,cargoes:a,areaReportKey:o}=e,n=H.a.get(O.a.IInternationalization);return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{reactKeyPrefix:t,configs:Pe(t,a),type:G.b.TYPEAHEAD,label:n.lang().model.charterer,filterCode:t+"_CHARTERER"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:Te(t,a),type:G.b.TYPEAHEAD,label:n.lang().model.cargo,filterCode:t+"_CARGO"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:Ae(t,a),type:G.b.TYPEAHEAD,label:n.lang().model.trade,filterCode:t+"_TRADE"}),r.a.createElement(V.a,{reactKeyPrefix:t,configs:Re(t,a,o),type:G.b.TYPEAHEAD,label:n.lang().model.areaDescription,filterCode:t+"_AREA"}))});function _e(e){var t,a;const{reactKeyPrefix:o,userLocale:l,scenario:i,updateSelected:c,isLoading:s,state:{cargoes:u,unfilteredCargoes:d,selectedAreaReport:y},deps:[g]}=e,{height:p}=Object(M.a)(),m=(e=>({container:{display:"flex",flexDirection:"column",height:e?.6*e:"500px"}}))(p),f=Object(n.useMemo)(()=>je.getHeaders(g),[g]),v=Object(n.useMemo)(()=>je.getRows(u),[u]),b=Object(n.useCallback)(e=>{c(e,"cargos")},[c]);return r.a.createElement(R.a,{style:m.container},r.a.createElement(ee.a,null,r.a.createElement(Fe,{filterGroupCode:"COPY_SCENARIO_CARGO_FILTER_CODE",cargoes:d,areaReportKey:null==y?void 0:y.key})),r.a.createElement(_.a,{headers:s?ae(!1):f,data:s?oe(!1):v,reactKeyPrefix:o+"-table",userLocale:l,customisation:{responsive:!0,compactCheckbox:!0,height:{type:F.d.PX,value:p?.6*p:900}},selectable:!s,onRowSelect:b,overrideSelected:null!==(a=null===(t=null==i?void 0:i.cargos)||void 0===t?void 0:t.map(e=>e.key))&&void 0!==a?a:[]}))}const Le=Object(L.a)(e=>{var t,a;const o=null!==(t=w.a.getTSModelsBuilt(e,D.a.cargo,Ee.a.cargoCommitmentsFields,x.a))&&void 0!==t?t:[],n=null!==(a=J.a.getFiltersByGroupCode(e,"COPY_SCENARIO_CARGO_FILTER_CODE"))&&void 0!==a?a:[],r=ue.a.getSelectedAreaReport(e);return{cargoes:Object(X.e)(o,n),unfilteredCargoes:o,selectedAreaReport:r}},Object(c.b)([O.a.IInternationalization],Object(l.k)(Object(n.memo)(_e))));var De=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const we={modal:{["& ."+E.a.root]:{paddingBottom:0},["& ."+S.a.root]:{paddingBottom:0},height:"100%"},title:{paddingTop:0,paddingBottom:3}};function xe(e){const{reactKeyPrefix:t,scenario:a,scenarioToCopy:o,onClose:l,onCopy:i,userLocale:s,updateSelected:u}=e,[d,y]=Object(c.a)([O.a.IInternationalization,g.a.ICopyScenarioController]),{fas:p}=d.getLanguageFile(),[m,f]=Object(n.useState)(0),b=Object(n.useRef)(!1),C=Object(n.useRef)(!1),h=Object(n.useRef)(!1),E=Object(n.useCallback)((e,t,a)=>{if(a){const t=a.map(e=>e.key);e.name===D.a.vessel.name?(u(t,"vessels"),b.current=!0):e.name===D.a.voyage.name?(u(t,"voyages"),C.current=!0):e.name===D.a.cargo.name&&(u(t,"cargos"),h.current=!0)}},[u]),S=Object(n.useCallback)(()=>De(this,void 0,void 0,(function*(){0!==m||b.current?1!==m||C.current?2!==m||h.current||y.loadCargoCommitments(o,E.bind(null,D.a.cargo)):y.loadVoyageCommitments(o,E.bind(null,D.a.voyage)):yield y.loadVessels(o,E.bind(null,D.a.vessel))})),[y,o,E,m]);Object(n.useEffect)(()=>{S()},[m]);const P=[{content:()=>r.a.createElement(re,{reactKeyPrefix:t+"-vessels",userLocale:s,scenario:a,updateSelected:u,isLoading:!b.current}),helperText:o.isBudget?p.copyScenarioBudgetSelectVessel:p.copyScenarioSelectVesselsHelperText},{content:()=>r.a.createElement(Oe,{reactKeyPrefix:t+"-voyage-commitments",userLocale:s,scenario:a,updateSelected:u,isLoading:!C.current}),helperText:p.copyScenarioSelectVoyageCommitments},{content:()=>r.a.createElement(Le,{reactKeyPrefix:t+"-cargo-commitments",userLocale:s,scenario:a,updateSelected:u,isLoading:!h.current}),helperText:p.copyScenarioSelectCargoCommitments}],T=he.getSteps(o,d);return r.a.createElement(v.a,{reactKeyPrefix:t,title:p.copyScenario,open:!0,onCloseModal:l,maxWidth:"lg",fullWidth:!0,hideCancelBtn:!0,hideConfirmBtn:!0,sx:we.modal},r.a.createElement(j.a,{sx:we.title},a.scenarioName),r.a.createElement(k,{reactKeyPrefix:t+"-stepper",onCopy:i,content:P,onStepChange:f,disableConfirmBtn:he.disableConfirmBtn(a),steps:T}))}function Me(e){const{reactKeyPrefix:t,scenarioToCopy:a,onClose:p,userLocale:m}=e,[f]=Object(c.a)([g.a.ICopyScenarioController]),[v,b]=Object(n.useState)(!0),[C,O]=Object(n.useState)(!1),[E,S]=Object(n.useState)(null),[j,P]=Object(n.useState)(a);Object(n.useEffect)(()=>{const e=u.a.getMasterScenario();!a&&e&&P(e)},[]);const T=Object(l.g)(),A=Object(l.h)(),I=Object(n.useCallback)(()=>{b(!1),p()},[p]),N=Object(n.useCallback)(e=>{b(!1),O(!0),S(new s.a({scenarioName:e}))},[]),k=Object(n.useCallback)(()=>{O(!1),p()},[p]),R=Object(n.useCallback)((e,t)=>{if(E){const a=e.map(e=>({key:e}));S(new s.a(Object(o.a)(E,t,a)))}},[E]),F=Object(n.useCallback)(e=>{y.a.openDrawer(e,d.a.scenarioDrawer,A,T),i.a.next()},[T,A]),_=Object(n.useCallback)(()=>{k(),E&&j&&f.onCopy(j,E,F)},[f,k,F,E,j]);return r.a.createElement(r.a.Fragment,null,j&&v&&r.a.createElement(h,{reactKeyPrefix:t+"-edit-name-modal",scenarioToCopy:j,showModal:v,onClose:I,onConfirm:N}),j&&C&&E&&r.a.createElement(xe,{reactKeyPrefix:t+"-select-content-modal",scenario:E,scenarioToCopy:j,onClose:k,userLocale:m,updateSelected:R,onCopy:_}))}},1606:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));a(59),a(109);var o,n,r,l,i=a(130),c=a(2351),s=a(9),u=a(81),d=a(0),y=a.n(d),g=a(31),p=a(83),m=a(104),f=a(114),v=a(4),b=a(16),C=a(1),O=a(32),h=a(21),E=a(7),S=a(87),j=a(192),P=a(3),T=a(317),A=a(20),I=a(684),N=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},k=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},R=function(e,t){return function(a,o){t(a,o,e)}},F=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const _=Object(S.a)(["fleetPlan.fleetPlanName","voyage.cargos.charterer.businessPartnerName","voyage.cargos.laycanFrom","voyage.cargos.laycanTo","voyage.cargos.reletOfCargo","voyage.cargos.cargoQuantity","voyage.cargos.isPerformanceCargo","voyage.comments","voyage.portCallsFromVoyage.eventLogs.event.eventCode","voyage.portCallsFromVoyage.eventLogs.eventLogDate","voyage.portCallsFromVoyage.reasonForCall.reasonForCall","voyage.portCallsFromVoyage.reasonForCall.reasonForCallDesc","voyage.portCallsFromVoyage.port.portName","voyage.portCallsFromVoyage.portCallSequence","voyage.portCallsFromVoyage.terminal.terminalName","voyage.tcIn","voyage.voyageHeader.isLastVoyage","voyage.voyageHeader.referenceNo","voyage.voyageHeader.voyageStatus.statusTypeSequence","voyage.voyageHeader.voyageStatus.statusTypeCode","voyage.voyageHeader.voyageStartDate","sequence","vessel"]);let L=class{constructor(e,t,a,o){this.i=e,this.statusController=t,this.store=a,this.objectApi=o}onAllocate(e,t,a,o,n,r,l){return F(this,void 0,void 0,(function*(){const c=Object(u.a)(null==o?void 0:o.scenarios[0],"fleetPlan.fleetPlanCode",null);if(!a.length&&!n&&"MASTER"===c)return void this.allocateToMaster(o,l,e,r);const{common:s,voyages:d}=this.i.getLanguageFile(),g=I.a.isStartDateAfterLastEndDate(a,o),p=I.a.lastPortMatchesAllocateBallast(a,o);let m;const v=I.a.getNewFleetPlanSequence(t,a,o,n),b=h.a.getAllTSModelsBuilt(this.store.getState(),C.a.fleetplanvoyage,{fleetPlan:{fleetPlanCode:"*"},sequence:"*",voyage:{voyageHeader:"*"},vessel:"*"}).filter(e=>{var t;return(null===(t=e.fleetPlan)||void 0===t?void 0:t.fleetPlanCode)===c}).filter(e=>{var t;return(null===(t=e.voyage)||void 0===t?void 0:t.key)===(null==o?void 0:o.key)}).find(()=>!0);let O=Object(u.a)(null==o?void 0:o.scenarios[0],"fleetPlan.key",null);if(null===O&&(O=Object(u.a)(n,"fleetPlan.key",null)),p){const t=this.statusController.getStatuses(C.a.voyage);m=I.a.getIsLastVoyageForCurrentCp(a,t),l(e,v,m,O,b),r()}else Object(f.a)(d.allocateVoyage,y.a.createElement(i.a,null,d.autoUpdateBallastPort),s.yes,s.no).then(t=>{if(t)m=!1;else{if(!g)return Object(f.a)(d.allocateVoyage,y.a.createElement(i.a,null,d.pleaseChangeStartDate),"",s.ok,!0,"xs"),void r();m=!0}l(e,v,m,O,b),r()})}))}allocateToMaster(e,t,a,o){const n=h.a.getTSModelsBuilt(this.store.getState(),C.a.fleetplan,{key:"*",fleetPlanCode:"*"}).find(e=>"MASTER"===e.fleetPlanCode);if(!n)throw new Error("Failed to fetch master fleet plan.");t(a,1,!1,n.key,void 0),o()}getOnGoingAndFutureFleetPlanVoyagesForVessel(e,t){return F(this,void 0,void 0,(function*(){const a="ALLOCATE_VOYAGE_MODAL_FILTER",o=[{field:"voyage.portCallsFromVoyage.eventLogs.event.eventCode",operator:v.c.EQUALS,queryParamName:"voyage.portCallsFromVoyage.eventLogs.event.eventCode",type:v.d.STRING,value:"ARR",filterGroupCode:a},{field:"voyage.portCallsFromVoyage.eventLogs.eventLogDate",operator:v.c.GREATER_THAN_OR_EQUAL,queryParamName:"voyage.portCallsFromVoyage.eventLogs.eventLogDate",type:v.d.DATE,value:new Date(Object(c.a)().toString().split("GMT")[0]+" UTC").toISOString().split(".")[0],filterGroupCode:a},{field:"fleetPlan.key",operator:v.c.EQUALS,queryParamName:"fleetPlan.key",type:v.d.STRING,value:t,filterGroupCode:a},{field:"vessel",operator:v.c.EQUALS,queryParamName:"vessel",type:v.d.NUMBER,value:e.key,filterGroupCode:a}],n=[{field:"sequence",groupCode:"ALLOCATE_VOYAGE_MODAL_SORT",operator:b.b.ASC,queryParamName:"sequence"}];return yield this.objectApi.getMultiple({authdata:Object(O.a)(this.store.getState()).authdata||"",fields:_,type:C.a.fleetplanvoyage,filters:Object.values(o),sorts:Object.values(n)})}))}getLastFleetPlanVoyageOnFleetPlan(e,t){return F(this,void 0,void 0,(function*(){const a=[{field:"fleetPlan.key",operator:v.c.EQUALS,queryParamName:"fleetPlan.key",type:v.d.STRING,value:t,filterGroupCode:"ALLOCATE_VOYAGE_MODAL_FILTER_LAST_VOYAGE"},{field:"vessel",operator:v.c.EQUALS,queryParamName:"vessel",type:v.d.NUMBER,value:e.key,filterGroupCode:"ALLOCATE_VOYAGE_MODAL_FILTER_LAST_VOYAGE"}],o=[{field:"sequence",groupCode:"ALLOCATE_VOYAGE_MODAL_SORT_LAST_VOYAGE",operator:b.b.DESC,queryParamName:"sequence"}],n=yield this.objectApi.getMultiple({authdata:Object(O.a)(this.store.getState()).authdata||"",fields:{sequence:"*",fleetPlan:"*"},type:C.a.fleetplanvoyage,filters:Object.values(a),sorts:Object.values(o),query:"pageNumber=1&limit=1"});return null!==n&&1===n.length?n[0]:null}))}};L=N([Object(s.injectable)(),R(0,Object(s.inject)(P.a.IInternationalization)),R(1,Object(s.inject)(A.a.IDrawerStatusController)),R(2,Object(s.inject)(E.a.Store)),R(3,Object(s.inject)(p.a.ITSModelApi)),k("design:paramtypes",["function"==typeof(o=void 0!==j.IInternationalization&&j.IInternationalization)?o:Object,"function"==typeof(n=void 0!==T.IDrawerStatusController&&T.IDrawerStatusController)?n:Object,"function"==typeof(r=void 0!==g.Store&&g.Store)?r:Object,"function"==typeof(l=void 0!==m.ITSModelApi&&m.ITSModelApi)?l:Object])],L)},1607:function(e,t,a){"use strict";a.d(t,"a",(function(){return E}));a(59);var o,n,r,l,i=a(9),c=a(31),s=a(83),u=a(104),d=a(16),y=a(1),g=a(29),p=a(7),m=a(131),f=a(938),v=a(20),b=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},C=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},O=function(e,t){return function(a,o){t(a,o,e)}},h=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};let E=class{constructor(e,t,a,o){this.tsmodelActions=e,this.objectApi=t,this.ctrlVoyage=a,this.store=o}loadVoyagesRefNos(e,t){return h(this,void 0,void 0,(function*(){if(!(null==e?void 0:e.authdata))return[];if(t){const{voyage:a}=t;if(null!==a){const{vessel:t}=a,o=null!==a.fleetPlanVoyages&&a.fleetPlanVoyages.length>0?a.fleetPlanVoyages[0].fleetPlan:null,n=["filter=vessel.key(EQ)"+(null==t?void 0:t.key),"filter=voyageHeader.voyageStatus.statusTypeCode(IN)(SCH,NOM,OPR)","filter=voyageHeader.isTemplate(EQ)false","filter=voyageHeader.referenceNo(NOTNULL)","filter=fleetPlanVoyages.fleetPlan.key(EQ)"+(null==o?void 0:o.key),"filter=voyageHeader.isTemplate(EQ)false"].join("&");return this.objectApi.getMultiple({authdata:e.authdata,fields:{key:"*",voyageHeader:{referenceNo:"*"}},query:n,sorts:[{field:"fleetPlanVoyages.sequence",groupCode:"",operator:d.b.DESC,queryParamName:"fleetPlanVoyages.sequence"}],type:y.a.voyage}).then(e=>e).catch(()=>[])}}return[]}))}updateOwnedByVoyageOnPortCall(e,t){this.tsmodelActions.updateSingleAction({key:e.key,type:y.a.portcall,data:{ownedByVoyage:t.key},headers:Object.assign({},m.a.smartJson)})}};E=b([Object(i.injectable)(),O(0,Object(i.inject)(p.a.ITSModelActionsAsync)),O(1,Object(i.inject)(s.a.ITSModelApi)),O(2,Object(i.inject)(v.a.ICargoDrawerControllerVoyage)),O(3,Object(i.inject)(p.a.Store)),C("design:paramtypes",["function"==typeof(o=void 0!==g.ITSModelActionsAsync&&g.ITSModelActionsAsync)?o:Object,"function"==typeof(n=void 0!==u.ITSModelApi&&u.ITSModelApi)?n:Object,"function"==typeof(r=void 0!==f.IPortCallDrawerController&&f.IPortCallDrawerController)?r:Object,"function"==typeof(l=void 0!==c.Store&&c.Store)?l:Object])],E)},1708:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));a(59),a(158),a(10),a(11);var o=a(9),n=a(345),r=a(2360),l=a(122),i=a(14),c=a(64),s=a(74),u=a(1),d=a(58),y=a(89),g=a(84),p=a(3),m=a(15),f=a(27),v=a(1166),b=a(432),C=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},O=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};let h=class extends v.a{transfer(e,t,a,o,r,i){var s,p;return O(this,void 0,void 0,(function*(){const v=yield new Promise((t,a)=>this.ctrlVoyage.onUpdateVoyage(e,e=>{t(e)})),b=d.a.getLastDischargeCargoPort(t.cargoPorts),C=a.cargoPorts.reduce((e,t)=>{var a,o,r,l;const i=v.portCallsFromVoyage.find(e=>{var a;return e.vesselPcSequence===(null===(a=t.portCall)||void 0===a?void 0:a.vesselPcSequence)});if(i){const s=Object(y.a)(new c.a(Object.assign(Object.assign({},t),{portCall:{key:i.key}})));e.push(Object.assign(Object.assign({},Object(n.a)(s,"key","cargo",..."L"===(null===(a=s.reasonForCall)||void 0===a?void 0:a.reasonForCall)?["freightRate"]:["laytimeTermsValue"])),{reasonForCall:null!==(r=null===(o=s.reasonForCall)||void 0===o?void 0:o.reasonForCall)&&void 0!==r?r:"L",port:null===(l=s.port)||void 0===l?void 0:l.key}))}return e},[]);yield this.tsmodelActions.copySingleAction({type:u.a.cargo,key:t.key,fields:l.c,data:{cargoPorts:[],tsOfCargoPort:null!==(s=null==b?void 0:b.key)&&void 0!==s?s:null,reletOfCargo:null,voyage:null===(p=a.voyage)||void 0===p?void 0:p.key,charterer:o.key},callback:(e,o)=>O(this,void 0,void 0,(function*(){var e,n,c;if(o)try{yield Promise.all([this.tsmodelActions.updateSingleAction({type:u.a.cargo,key:o.key,fields:l.c,data:{cargoPorts:C}}),this.tsmodelActions.updateSingleAction({type:u.a.cargo,key:t.key,fields:l.c,data:{finalDestination:null!==(c=null===(n=null===(e=d.a.getLastDischargeCargoPort(a.cargoPorts))||void 0===e?void 0:e.port)||void 0===n?void 0:n.portName)&&void 0!==c?c:"Transfer "+o.key}})]),r&&i&&f.a.openDrawer(o.key,m.a.cargoDrawer,i,r)}catch(e){g.a.error(e)}}))})}))}copyCargoAndAllocateToVoyageOnClient(e,t,a){const o=new s.a(e),l=d.a.getLastDischargeCargoPort(e.cargoPorts);if(!l)throw new Error("Last discharge port of cargo to be transferred is null");const u=Object(n.a)(l,"key","_key","_reasonForCall"),y=i.a.get(p.a.IKeyGen),g=[new c.a(Object.assign(Object.assign({},u),{key:-Math.abs(y.getNextKey()),reasonForCall:{reasonForCall:"L",reasonForCallDesc:"Loading"},cargoPortSequence:1})),new c.a(Object.assign(Object.assign({},u),{key:-Math.abs(y.getNextKey()),port:a,reasonForCall:{reasonForCall:"D",reasonForCallDesc:"Discharge"},cargoPortSequence:1}))];return g.forEach(e=>{Object(r.a)(e,{portCall:t.portCallsFromVoyage.find(t=>Object(b.g)(e,t,!0))})}),new s.a(Object.assign(Object.assign({},o),{voyage:t,cargoPorts:g}))}};h=C([Object(o.injectable)()],h)},1709:function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));a(59),a(158);var o,n,r,l,i=a(429),c=a(870),s=a(1310),u=a(9),d=a(31),y=a(46),g=a(205),p=a(1),m=a(32),f=a(29),v=a(21),b=a(7),C=a(48),O=a(78),h=a(90),E=a(3),S=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},j=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(e,t){return function(a,o){t(a,o,e)}},T=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};let A=class{constructor(e,t,a,o){this.store=e,this.http=t,this.tsmodelActionsAsync=a,this.tsmodelActions=o}getBasicHeader(){var e;return{headers:new Headers({authorization:null!==(e=Object(m.a)(this.store.getState()).authdata)&&void 0!==e?e:"","content-type":"application/json"})}}getDocumentsFromStore(e,t){return v.a.getTSModelsBuilt(this.store.getState(),p.a.document,e,t)}getQueryString(e,t,a){const o=new Date(e.getTime());return o.setMonth(o.getMonth()+1),["documentDate >= $"+O.a.getDateStringWithoutUTC(Object(i.a)(Object(c.a)(e))),"documentDate <= $"+O.a.getDateStringWithoutUTC(Object(i.a)(Object(s.a)(o))),t.length>0?`documentLines.voyage.voyageHeader.businessUnit in (${t.map(e=>e.key)})`:void 0,"invoicingStatus.statusTypeCode = 'PEN'",`documentType.documentType in ('${a[0]}','${a[1]}')`].filter(Boolean).join(" and ")}loadDocumentSelection({date:e,businessUnits:t,fields:a,identifier:o,documentTypes:n},r){return T(this,void 0,void 0,(function*(){return this.tsmodelActionsAsync.loadMultipleAction({callback:r,type:p.a.document,identifier:o,fields:a,overwriteKeysOnLoad:!0,query:"expression="+this.getQueryString(e,t,n)}).then(()=>Promise.resolve())}))}batchPostObjects({date:e,businessUnits:t,fields:a,identifier:o,documentTypes:n}){return T(this,void 0,void 0,(function*(){this.loadDocumentSelection({date:e,businessUnits:t,fields:a,identifier:o,documentTypes:n}).then(()=>{const r=this.getDocumentsFromStore(a,o);this.http.put(`${C.a.API_BASE_URL}/Document/bulkUpdate?expression=${this.getQueryString(e,t,n)}`,JSON.stringify({invoicingStatus:"RFP"}),this.getBasicHeader()).then(()=>{this.tsmodelActions.addMultipleAction(r.map(({key:e})=>new g.a({key:e,invoicingStatus:"RFP"}))),y.a.next()})})}))}fetchDocuments(e,t,a){var o;return T(this,void 0,void 0,(function*(){try{const n=yield this.http.get(`${C.a.API_BASE_URL}/Document?expression=${this.getQueryString(e,t,a)}`,{headers:new Headers({authorization:null!==(o=Object(m.a)(this.store.getState()).authdata)&&void 0!==o?o:"",fields:JSON.stringify({documentLines:{documentAmount:"*"},documentAmount:"*"})})});let r=yield n.json();return r=r.map(e=>new g.a(e)),r}catch(e){throw e instanceof Error?new Error(e.message):new Error("API call failed")}}))}isSumBalanced(e){if(0!==e.filter(e=>0===e.documentLines.length).length)return!1;{const t=e.reduce((e,t)=>e+Number(t.documentLines[0].documentAmount.toFixed(2)),0);return 0===Number(Math.abs(t).toFixed(2))}}};A=S([Object(u.injectable)(),P(0,Object(u.inject)(b.a.Store)),P(1,Object(u.inject)(E.a.IHttp)),P(2,Object(u.inject)(b.a.ITSModelActionsAsync)),P(3,Object(u.inject)(b.a.ITSModelActions)),j("design:paramtypes",["function"==typeof(o=void 0!==d.Store&&d.Store)?o:Object,"function"==typeof(n=void 0!==h.IHttp&&h.IHttp)?n:Object,"function"==typeof(r=void 0!==f.ITSModelActionsAsync&&f.ITSModelActionsAsync)?r:Object,"function"==typeof(l=void 0!==f.ITSModelActions&&f.ITSModelActions)?l:Object])],A)},1715:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));a(59);var o,n,r,l=a(9),i=a(31),c=a(7),s=a(3),u=a(90),d=a(32),y=a(48),g=a(29),p=a(1),m=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(a,o){t(a,o,e)}},b=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};let C=class{constructor(e,t,a){this.store=e,this.http=t,this.tsmodelActions=a}convertToTemplate(e,t,a){return b(this,void 0,void 0,(function*(){const o=Object(d.a)(this.store.getState()).authdata||"",n=`${y.a.API_BASE_URL}/Voyage/convertToTemplate/${e}?createCoa=${t}&createUnallocatedVoyage=${a}`;try{yield this.http.post(n,{},{headers:new Headers({authorization:o,"content-type":"application/json"})}),this.tsmodelActions.loadSingleAction({fields:{voyageHeader:{isTemplate:"*"}},key:e,type:p.a.voyage})}catch(e){throw e instanceof Error?new Error(e.message):new Error("API call failed")}}))}getVoyageCargos(e,t){this.tsmodelActions.loadSingleAction({fields:{cargos:{coaLine:"*"}},key:e.key,type:p.a.voyage,callback:t})}};C=m([Object(l.injectable)(),v(0,Object(l.inject)(c.a.Store)),v(1,Object(l.inject)(s.a.IHttp)),v(2,Object(l.inject)(c.a.ITSModelActionsAsync)),f("design:paramtypes",["function"==typeof(o=void 0!==i.Store&&i.Store)?o:Object,"function"==typeof(n=void 0!==u.IHttp&&u.IHttp)?n:Object,"function"==typeof(r=void 0!==g.ITSModelActionsAsync&&g.ITSModelActionsAsync)?r:Object])],C)},1806:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));a(59),a(10),a(11);var o=a(130),n=a(0),r=a.n(n),l=a(44),i=a(1807),c=a(848),s=a(102),u=a(1),d=a(6),y=a(3),g=a(684),p=a(20),m=a(81),f=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};function v(e){const[t,a]=Object(d.a)([y.a.IInternationalization,p.a.IAllocateVoyageModalController]),{common:v,fas:b}=t.getLanguageFile(),{reactKeyPrefix:C,onClose:O,onAllocate:h,toStatus:E,selectedVoyage:S,userLocale:j}=e,[P,T]=Object(n.useState)(null),[A,I]=Object(n.useState)([]),[N,k]=Object(n.useState)(g.a.generateTableRows(A,S)),[R,F]=Object(n.useState)(null),[_,L]=Object(n.useState)(!1);Object(n.useEffect)(()=>{E&&k(g.a.generateTableRows(A,S))},[A,S,E]);const D=Object(n.useMemo)(()=>N.findIndex(e=>e.id===S.key),[S.key,N]),w=Object(n.useCallback)(e=>f(this,void 0,void 0,(function*(){e||I([]),T(e);const t=Object(m.a)(S.scenarios[0],"fleetPlan.key",null),o=yield a.getOnGoingAndFutureFleetPlanVoyagesForVessel(e,t);if(o.length>0)I(o);else{const o=yield a.getLastFleetPlanVoyageOnFleetPlan(e,t);o||F(null),F(o)}L(!0)})),[a,S]);Object(n.useEffect)(()=>{S.vessel&&w(S.vessel)},[]);const x=Object(n.useCallback)(()=>{O(),T(null),I([]),k([]),F(null),L(!1)},[O]),M=Object(n.useCallback)(()=>{h&&P&&a.onAllocate(P,N,A,S,R,x,h)},[x,a,A,R,h,P,S,N]),V=Object(n.useCallback)(e=>{k(e)},[]);return r.a.createElement(l.a,{reactKeyPrefix:C,open:!!E,onCloseModal:x,title:v.allocate,confirmBtnName:v.allocate,onConfirm:M,maxWidth:"md",fullWidth:!0,disableConfirmBtn:!(P&&_),disableDraggable:!0},r.a.createElement(o.a,{variant:"h6"},b.selectVessel),r.a.createElement(s.b,{defaultSelectedOptions:P,reactKeyPrefix:"vesselList",onChange:w,type:u.a.vessel,objectPaths:["vesselName"],shouldPreload:!0,fields:{vesselName:"*",vesselCodes:"*"}}),r.a.createElement(o.a,{variant:"h6"},b.selectPosition),r.a.createElement(c.a,{headers:i.a,data:N,enableRowDragDrop:!0,onRowReorder:V,selectedIndex:D,reactKeyPrefix:"voyageList",height:"100%",userLocale:j,width:"100%"}))}},1814:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));a(10),a(11);var o=a(2383),n=a(130),r=a(0),l=a.n(r),i=a(169),c=a(44),s=a(6),u=a(3),d=a(20);const y={text:{pb:"20px"}};function g(e){const{open:t,voyage:a,reactKeyPrefix:g,onClose:p}=e,[m,f]=Object(s.a)([u.a.IInternationalization,d.a.IConvertToVoyageTemplateController]),{common:v,coa:b}=m.getLanguageFile(),C=(null==a?void 0:a.isTc)&&0===(null==a?void 0:a.cargos.length),[O,h]=Object(r.useState)({key:a.key,createNewCoa:!1,createUnallocatedVoyage:!1}),[E,S]=Object(r.useState)(!1),j=0===(null==a?void 0:a.cargos.length),P=!O.createNewCoa;Object(r.useEffect)(()=>{f.getVoyageCargos(a,(function(e,t){S(!0),h({key:a.key,createNewCoa:!!t.cargos.some(e=>!!e.coaLine),createUnallocatedVoyage:!1})}))},[]);const T=Object(r.useCallback)(()=>{f.convertToTemplate(O.key,O.createNewCoa,O.createUnallocatedVoyage),p()},[f,O,p]),A=Object(r.useCallback)((e,t)=>{h(Object.assign(Object.assign({},O),{[e]:t}))},[O]),I=Object(r.useCallback)(e=>{h(Object.assign(Object.assign({},O),{createNewCoa:e,createUnallocatedVoyage:!!e&&O.createUnallocatedVoyage}))},[O]);return l.a.createElement(c.a,{open:t,reactKeyPrefix:g+"-modal",onConfirm:T,onCloseModal:p,title:v.convertToTemplate,disableConfirmBtn:!E},E?l.a.createElement(l.a.Fragment,null,l.a.createElement(n.a,{sx:y.text},b.doYouWantToConvert),C?l.a.createElement(l.a.Fragment,null):l.a.createElement(l.a.Fragment,null,l.a.createElement(i.a,{reactKeyPrefix:g+"-modal-create-new-coa",checked:O.createNewCoa,onInputChange:I,label:v.createNewCoA,disabled:j}),l.a.createElement(i.a,{reactKeyPrefix:g+"-modal-create-unallocated-voyage",checked:O.createUnallocatedVoyage,onInputChange:A.bind(null,"createUnallocatedVoyage"),label:v.createUnallocatedVoyage,disabled:P}))):l.a.createElement(o.a,{variant:"text",width:400,height:100}))}},1818:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));a(59),a(10),a(11);var o=a(0),n=a.n(o),r=a(102),l=a(44),i=a(6),c=a(23),s=a(62),u=a(32),d=a(3),y=a(20),g=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};function p(e){var t;const a=Object(c.a)(u.a),[p,m]=Object(i.a)([d.a.IInternationalization,y.a.IChangeVoyageModalController]),{reactKeyPrefix:f,title:v,portCall:b,showModal:C,onClose:O}=e,[h,E]=Object(o.useState)(null!==(t=null==b?void 0:b.voyage)&&void 0!==t?t:new s.a({})),[S,j]=Object(o.useState)([]),{common:P,model:T}=p.getLanguageFile(),A=Object(o.useCallback)(()=>{E(null),O()},[O]),I=Object(o.useCallback)(()=>g(this,void 0,void 0,(function*(){const e=yield m.loadVoyagesRefNos(a,b);j(e)})),[m,b,a]),N=Object(o.useCallback)(e=>{e&&E(e)},[]),k=Object(o.useCallback)(()=>{b&&h&&m.updateOwnedByVoyageOnPortCall(b,h),O()},[b,h,m,O]);return Object(o.useEffect)(()=>{a&&b&&0===S.length&&I()},[a,b,I,S.length]),n.a.createElement(l.a,{title:v,reactKeyPrefix:f+"modal",onCloseModal:A,open:C,onConfirm:k,maxWidth:"xs",fullWidth:!0},S.length>0?n.a.createElement(r.a,{label:T.voyageReference,placeholder:P.typeToSearch,options:S,onChange:N,objectPaths:["voyageHeader.referenceNo"],reactKeyPrefix:"doc-change-voyage-selector",isClearable:!0,defaultSelectedOptions:null==b?void 0:b.voyage,noOptionsMessage:()=>P.voyagesNotFound,disabled:0===S.length}):P.loading)}},1932:function(e,t,a){"use strict";a.d(t,"a",(function(){return B}));a(10),a(11);var o=a(0),n=a.n(o),r=a(97),l=a(46),i=a(61),c=a(73),s=a(1),u=a(15),d=a(80),y=a(27),g=a(6),p=a(3);const m={measurementDesc:"*",measurementCode:"*"};a(93);var f=a(5),v=a(14),b=a(16);const C=v.a.get(p.a.IInternationalization),{common:O}=C.getLanguageFile(),h="MEASUREMENT_UNITS_LIST_SORT_GROUP_CODE",E=[{field:O.description,groupCode:h,operator:b.b.ASC,queryParamName:"measurementDesc"}],S={description:{field:O.description,groupCode:h,operator:b.b.ASC,queryParamName:"measurementDesc"},code:{field:O.code,groupCode:h,operator:b.b.ASC,queryParamName:"measurementCode"}},j=v.a.get(p.a.IInternationalization),{common:P}=j.getLanguageFile(),T=[{content:P.description,contentType:f.a.TEXT,sortConfig:S.description},{content:P.code,contentType:f.a.TEXT,sortConfig:S.code}],A=e=>[e.measurementDesc,e.measurementCode];var I=a(24),N=a(4);const k=v.a.get(p.a.IInternationalization),{common:R}=k.lang(),F=e=>({label:R.disabled,filters:[{field:"isObjectActive",filterGroupCode:e,operator:N.c.NOT_EQUALS,queryParamName:"isObjectActive",type:N.d.BOOLEAN,value:!0}]}),_=({reactKeyPrefix:e,filterGroupCode:t})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(I.a,{reactKeyPrefix:e+"-disabled",configs:[F(t)],type:N.b.BOOLEAN,label:R.disabled,filterCode:t+"_DISABLED"}));var L=a(2024),D=a(76),w=a(65),x=a(41),M=a(33),V=a(66),G=a(30),H=a(23),q=a(32),K=a(43);const U={authorizationType:x.a.PERMISSION,authorizedPermissions:M.a.measurementUnits.authorizedPermissions,behaviorOnAuthorizationFail:w.a.REDIRECT_NO_AUTHORIZATION};function B(){var e;Object(D.b)(U);const t=Object(r.g)(),a=Object(r.h)(),f=null!==(e=Object(H.a)(q.a))&&void 0!==e?e:new K.a({}),v=Object(o.useCallback)(e=>{y.a.openDrawer(e,u.a.measurementUnitDrawer,a,t)},[t,a]),[b,C]=Object(o.useState)(!1),O=Object(o.useCallback)(()=>C(e=>!e),[]),[h]=Object(g.a)([p.a.IInternationalization]),{common:S}=h.getLanguageFile(),j=[{onClick:O,text:S.createMeasurementUnit,disabled:!Object(V.a)([G.a.MeasurementPOST],f)}],P=Object(o.useCallback)((e,{key:t})=>{t&&(v(t),l.a.next())},[v]);return n.a.createElement(c.a,{reactKeyPrefix:"doc-modules-measurement-units-pages-list-page",createObject:j},b&&n.a.createElement(L.a,{reactKeyPrefix:"doc-modules-measurement-units-pages-list",showModal:b,closeModal:O,onCreate:P}),n.a.createElement(i.a,{fields:m,listId:"MEASUREMENT_UNITS_LIST_ID",reactKeyPrefix:"doc-modules-measurement-units-pages-list-tsmodel-list",tsmodelType:s.a.measurement,tableHeaders:T,defaultSorts:E,onClickItem:v,getColSpec:A,tableCustomisation:{disableCardSorting:!0,disableSorting:!1},quickFilters:n.a.createElement(_,{reactKeyPrefix:"doc-modules-measurement-units-pages-list-quick-filters",filterGroupCode:"MEASUREMENT_UNITS_LIST_FILTER_GROUP_CODE"}),quickFiltersGroupCode:"MEASUREMENT_UNITS_LIST_FILTER_GROUP_CODE"}),n.a.createElement(d.a,null))}},1950:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));a(10),a(11);var o=a(323),n=a(214),r=a(473),l=a(130),i=a(0),c=a.n(i),s=a(330),u=a(44),d=a(5),y=a(67),g=a(6),p=a(47),m=a(1),f=a(21),v=a(42),b=a(7),C=a(262),O=a(159),h=a(3),E=a(105),S=a(40),j=a(14),P=a(87),T=a(35);const A=j.a.get(h.a.IInternationalization).lang();const I={fields:Object(P.a)(["coa.charterer.businessPartnerName","coa.coaDate","coa.contractNo","terminationDate","coa.coaStatus.statusTypeDesc"]),returnFields:{cargoType:{cargoTypeCode:"*"},coaLine:"*"},getTableRow:function({key:e,terminationDate:t,coa:a}){var o,n,r,l,i,s;const u=null!==(n=null===(o=null==a?void 0:a.charterer)||void 0===o?void 0:o.businessPartnerName)&&void 0!==n?n:"",d=null!==(r=null==a?void 0:a.coaDate)&&void 0!==r?r:null,y=null!==(l=null==a?void 0:a.contractNo)&&void 0!==l?l:"",g=null!==(s=null===(i=null==a?void 0:a.coaStatus)||void 0===i?void 0:i.statusTypeDesc)&&void 0!==s?s:"";return{content:[u,d,y,t,{content:c.a.createElement(S.a,{label:g,priority:E.a.getStatusPriority(g,m.a.coa)}),rawValue:g}],id:e}},headers:[{content:A.model.charterer,contentType:d.a.TEXT},{content:A.coa.coaDate,dateTimeFormatOptions:T.a.shortLocalizedDate,contentType:d.a.DATE},{content:A.model.contractNo,contentType:d.a.TEXT},{content:A.model.terminationDate,dateTimeFormatOptions:T.a.shortLocalizedDate,contentType:d.a.DATE},{content:A.coa.coaStatus,contentType:d.a.ELEMENT}]};var N=a(4),k=a(24);const R=j.a.get(h.a.IInternationalization),F=({reactKeyPrefix:e})=>{const t=j.a.get(h.a.IInternationalization),{model:a,coa:o}=t.lang(),{chartererConfig:n,contractConfig:r,coaStatusConfig:l}=(e=>{const{coa:t,model:a}=R.lang(),o={field:"coa.charterer.key",filterGroupCode:e,operator:N.c.IN,queryParamName:"coa.charterer.key",type:N.d.STRING,filterCode:e+"_CHARTERER"},n={label:a.charterer,filterObjectValuePath:"key",typeaheadProps:{type:m.a.businesspartner,objectPaths:["businessPartnerName"],includeDisabledQuery:!0},filters:[o]},r={field:"coa.contractNo",filterGroupCode:e,operator:N.c.IN,queryParamName:"coa.contractNo",type:N.d.STRING},l={label:a.contractNo,filterObjectValuePath:"contractNo",typeaheadProps:{type:m.a.coa,objectPaths:["contractNo"],itemsToShow:10,query:"filter=contractNo(NOTNULL)"},filters:[r]},i={field:"coa.coaStatus.key",filterGroupCode:e,operator:N.c.IN,queryParamName:"coa.coaStatus.key",type:N.d.STRING};return{chartererFilter:o,chartererConfig:n,contractFilter:r,contractConfig:l,coaStatusFilter:i,coaStatusConfig:{label:t.coaStatus,filterObjectValuePath:"key",typeaheadProps:{type:m.a.statustype,objectPaths:["statusTypeDesc"],query:"filter=statusClass.statusClassCode(EQ)COA",itemsToShow:10},filters:[i]}}})("CONNECT_CARGO_COA_LINE_FILTER_CODE");return c.a.createElement(c.a.Fragment,null,c.a.createElement(k.a,{reactKeyPrefix:e+"-charterer",configs:[n],type:N.b.TYPEAHEAD,label:a.charterer,filterCode:"CONNECT_CARGO_COA_LINE_FILTER_CODE_CHARTERER",clearOnMount:!1}),c.a.createElement(k.a,{reactKeyPrefix:e+"-coa-number",configs:[r],type:N.b.TYPEAHEAD,label:a.contractNo,filterCode:"CONNECT_CARGO_COA_LINE_FILTER_CODE_COA_NUMBER",clearOnMount:!1}),c.a.createElement(k.a,{reactKeyPrefix:e+"-coa-status",configs:[l],type:N.b.TYPEAHEAD,label:o.coaStatus,filterCode:"CONNECT_CARGO_COA_LINE_FILTER_CODE_COA_STATUS",clearOnMount:!1}))},_=c.a.memo(F);var L=a(94),D=a(422);const w={container:{display:"flex",flexDirection:"column",height:"100%"},quickFilterItem:{marginRight:1},helperText:{fontStyle:"italic"},footer:{height:"50px",marginTop:1}};const x=Object(p.a)((function(e){return{userLocale:v.a.getUserLocale(e),coaLines:f.a.getTSModelsBuilt(e,m.a.coaline,I.fields,"CONNECT_CARGO_TO_COA_LINE_IDENTIFIER"),storedFilters:L.a.getFiltersByGroupCode(e,"CONNECT_CARGO_COA_LINE_FILTER_CODE")}}),(function(e){const{cargo:t,reactKeyPrefix:a,open:p,onClose:f,state:{userLocale:v,coaLines:E,storedFilters:S}}=e,[j,P,T,A]=Object(g.a)([h.a.IInternationalization,b.a.ITSModelActionsAsync,b.a.Store,b.a.IFilterActions]),[k,R]=Object(i.useState)(1),[F,L]=Object(i.useState)(!1),[x,M]=Object(i.useState)(null),[V,G]=Object(i.useState)(S),[H,q]=Object(i.useState)(Object(D.a)(V,S)),K=j.getLanguageFile(),U=Object(i.useCallback)(e=>{L(!0),P.loadMultipleAction({fields:I.fields,type:m.a.coaline,identifier:"CONNECT_CARGO_TO_COA_LINE_IDENTIFIER",filters:V,pageItemLimit:15,pageNumber:e}).then(()=>{L(!1),q(!1)})},[V,P]);Object(i.useEffect)(()=>{V.forEach(e=>T.dispatch(A.removeFilterAction(e))),t.charterer?T.dispatch(A.putFilterAction(((e,t)=>{var a,o,n,r,l,i;return{field:"coa.charterer.key",filterGroupCode:e,operator:N.c.IN,queryParamName:"coa.charterer.key",type:N.d.STRING,value:null!==(o=null===(a=t.charterer)||void 0===a?void 0:a.key)&&void 0!==o?o:"",selectedObj:[{key:null!==(r=null===(n=t.charterer)||void 0===n?void 0:n.key)&&void 0!==r?r:0,businessPartnerName:null!==(i=null===(l=null==t?void 0:t.charterer)||void 0===l?void 0:l.businessPartnerName)&&void 0!==i?i:""}],filterCode:e+"_CHARTERER"}})("CONNECT_CARGO_COA_LINE_FILTER_CODE",t))):U(1)},[]),Object(i.useEffect)(()=>{Object(D.a)(V,S)&&!H&&(R(1),q(!0),G(S))},[V,S]),Object(i.useEffect)(()=>{H&&(Object(C.a)("CONNECT_CARGO_TO_COA_LINE_IDENTIFIER"),U(k))},[H]);const B=Object(i.useCallback)(()=>{V.forEach(e=>T.dispatch(A.removeFilterAction(e))),Object(C.a)("CONNECT_CARGO_TO_COA_LINE_IDENTIFIER"),f()},[A,V,f,T]),Y=Object(i.useCallback)(()=>{t.key&&x&&(P.updateSingleAction({key:t.key,type:m.a.cargo,fields:I.returnFields,data:{coaLine:x,cargoType:O.a.COA}}),B())},[t.key,B,x,P]),Q=Object(i.useMemo)(()=>E.map(e=>I.getTableRow(e)),[E]),z=Object(i.useCallback)(()=>{const e=k+1;R(e),U(e)},[U,k]),$=!x&&Q.length>0;return c.a.createElement(u.a,{reactKeyPrefix:a,title:K.coa.connectToCoa,open:p,onCloseModal:B,maxWidth:"lg",fullWidth:!0,onConfirm:Y,disableConfirmBtn:$||F},c.a.createElement(o.a,{sx:w.container},c.a.createElement(s.a,null,c.a.createElement(_,{reactKeyPrefix:a+"-filters"})),c.a.createElement(y.a,{data:Q,headers:I.headers,userLocale:v,reactKeyPrefix:a+"-table",onRowClick:M,selectable:!0,singleSelect:!0,customisation:{responsive:!0,disableToolbar:!0,disableSorting:!0,height:{type:d.d.PX,value:500}}}),c.a.createElement(o.a,{sx:w.footer},c.a.createElement(n.a,{justifyContent:"center",container:!0},c.a.createElement(r.a,{id:a+"-load-more",variant:"outlined",color:"primary",onClick:z,disabled:F},K.common.loadMore)),$&&c.a.createElement(l.a,{sx:w.helperText},K.common.selectAnItem))))}))},1957:function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));a(10),a(11);var o=a(0),n=a.n(o),r=a(97),l=a(61),i=a(73),c=a(76),s=a(65),u=a(6),d=a(23),y=a(1),g=a(43),p=a(33),m=a(32),f=a(66),v=a(41),b=a(15),C=a(27),O=a(3),h=a(80),E=a(20),S=a(1980);const j={userName:"*",auth0User:"*"};var P=a(14),T=a(5);const A=P.a.get(O.a.IInternationalization),{model:I}=A.getLanguageFile();function N(e){var t,a;return[null!==(t=e.userName)&&void 0!==t?t:"",null!==(a=e.auth0User)&&void 0!==a?a:""]}const k=[{content:`${I.m2m} ${I.name}`,contentType:T.a.TEXT},{content:I.clientId,contentType:T.a.TEXT}];var R=a(394),F=a(24),_=a(4);function L({reactKeyPrefix:e}){const t=P.a.get(O.a.IInternationalization),{common:a,model:o}=t.lang();return n.a.createElement(n.a.Fragment,null,n.a.createElement(F.a,{reactKeyPrefix:e+"-m2m-user-name",configs:R.b.getM2mUserNameFilterConfig(R.a),type:_.b.TYPEAHEAD,label:`${o.m2m} ${o.name}`,filterCode:R.a+"_M2M_USER_NAME",clearOnMount:!1}),n.a.createElement(F.a,{reactKeyPrefix:e+"-DISABLED-M2M",configs:R.b.getM2mDisabledUsersFilterConfig(R.a),type:_.b.BOOLEAN,label:a.disabled,filterCode:R.a+"_DISABLED_M2M",clearOnMount:!1}))}var D=a(30),w=a(46);const x={authorizationType:v.a.PERMISSION,authorizedPermissions:p.a.users.authorizedPermissions,behaviorOnAuthorizationFail:s.a.REDIRECT_NO_AUTHORIZATION};function M(){var e;const t="doc-modules-m2m-users-list-page",a=Object(r.g)(),s=Object(r.h)(),[p,v]=Object(u.a)([O.a.IInternationalization,E.a.IM2MUserController]),{common:P,model:T}=p.getLanguageFile(),A=null!==(e=Object(d.a)(m.a))&&void 0!==e?e:new g.a({}),[I,F]=Object(o.useState)(!1);Object(c.b)(x);const _=Object(o.useCallback)(e=>{C.a.openDrawer(e,b.a.m2mUserDrawer,s,a)},[a,s]),M=Object(o.useCallback)(()=>{F(!0)},[]),V=Object(o.useCallback)(()=>{F(!1)},[]),G=Object(o.useMemo)(()=>!Object(f.a)([D.a.M2MPOST],A),[A]),H=Object(o.useMemo)(()=>[{onClick:M,text:`${P.create} ${T.m2m} ${T.user}`,disabled:G}],[P.create,G,T.m2m,T.user,M]),q=Object(o.useCallback)(e=>{v.post(e).then(e=>{V();const t=e.userKey?e.userKey:0;_(t),w.a.next()})},[v,V,_]);return n.a.createElement(i.a,{reactKeyPrefix:t,createObject:H},n.a.createElement(h.a,null),n.a.createElement(l.a,{getColSpec:N,tsmodelType:y.a.user,quickFilters:n.a.createElement(L,{reactKeyPrefix:t}),quickFiltersGroupCode:R.a,fields:j,listId:"M2M_USERS_LIST_ID",reactKeyPrefix:t+"m2m-users-tsmodel-list",tableHeaders:k,defaultSorts:R.c,sortOptions:R.d,selectorMiddleware:e=>e.filter(e=>e.auth0User&&!e.auth0User.includes("auth0")&&!e.auth0User.includes("waad")),onClickItem:_}),I&&n.a.createElement(S.a,{reactKeyPrefix:t+"-create-modal",closeModal:V,showModal:I,i:p,onCreateM2MUser:q}))}},394:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return y})),a.d(t,"b",(function(){return g}));var o=a(4),n=a(16),r=a(1),l=a(88);const i="M2M_USERS_LIST_FILTER_GROUP_CODE",c=new l.a,{common:s,model:u}=c.getLanguageFile(),d=[{field:`${u.m2m} ${u.name}`,groupCode:"M2M_USERS_LIST_SORT_GROUP_CODE",operator:n.b.ASC,queryParamName:"userName"}],y=[{field:`${u.m2m} ${u.name}`,groupCode:"M2M_USERS_LIST_SORT_GROUP_CODE",operator:n.b.ASC,queryParamName:"userName"}],g={getM2mUserNameFilterConfig:e=>{const t={field:"key",filterGroupCode:e,operator:o.c.IN,type:o.d.STRING};return[{label:`${u.m2m} ${u.name}`,filterObjectValuePath:"key",typeaheadProps:{type:r.a.user,objectPaths:["userName"]},filters:[t]}]},getM2mDisabledUsersFilterConfig:e=>{const t={field:"isObjectActive",filterGroupCode:e,operator:o.c.NOT_EQUALS,type:o.d.BOOLEAN,value:!0};return[{label:s.disabled,typeaheadProps:{type:r.a.user,objectPaths:["isObjectActive"]},filters:[t]}]}}},432:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"g",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return f})),a.d(t,"e",(function(){return v})),a.d(t,"d",(function(){return b})),a.d(t,"f",(function(){return C}));a(10),a(11),a(109);var o=a(715),n=a(62),r=a(74),l=a(64),i=a(68),c=a(248),s=a(336),u=a(147),d=a(742),y=a(50);function g(e,t){const{pcList:a}=o.a.pairCargoPortsAndPortCalls(e,t);return a.every(Boolean)}function p(e,t,a=!1){var o,n,r,l,i,c;const s=(null===(o=e.reasonForCall)||void 0===o?void 0:o.reasonForCall)===(null===(n=t.reasonForCall)||void 0===n?void 0:n.reasonForCall),u=(null===(r=e.port)||void 0===r?void 0:r.key)===(null===(l=t.port)||void 0===l?void 0:l.key),d=!e.terminal&&!t.terminal||(null===(i=e.terminal)||void 0===i?void 0:i.key)===(null===(c=t.terminal)||void 0===c?void 0:c.key);return a?s&&u&&d:u&&d}function m(e,t,a,o){var s,u;let y=new n.a(Object.assign({},t)),g=new r.a(Object.assign({},e));if(e&&t){const{cargoPorts:m}=e,{portCallsFromVoyage:f}=t;let v=Array.from(m),b=Array.from(f);const C=function(e,t){return e.filter(e=>t.filter(t=>p(e,t,!0)).length>1)}(m,f);if(C.length>0&&C.forEach(e=>{const t=v.findIndex(t=>t.key===e.key);v.splice(t,1)}),!o){let e=(null!==(u=null===(s=Object(d.a)(y.portCallsFromVoyage,"vesselPcSequence"))||void 0===s?void 0:s.vesselPcSequence)&&void 0!==u?u:0)+1;v=v.map(o=>{const r=b.find(e=>{var t,a,n,r,l,i;return(null===(t=o.port)||void 0===t?void 0:t.portName)===(null===(a=e.port)||void 0===a?void 0:a.portName)&&(null===(n=o.reasonForCall)||void 0===n?void 0:n.reasonForCall)===(null===(r=e.reasonForCall)||void 0===r?void 0:r.reasonForCall)&&(null===(l=o.terminal)||void 0===l?void 0:l.key)===(null===(i=e.terminal)||void 0===i?void 0:i.key)});if(null!=r)o=new l.a(Object.assign(Object.assign({},o),{portCall:{key:r.key,portCallSequence:r.portCallSequence,vesselPcSequence:r.vesselPcSequence}}));else{const r=new i.a({port:o.port,reasonForCall:o.reasonForCall,portCallSequence:y.portCallsFromVoyage.length+1,vesselPcSequence:e,terminal:o.terminal?new c.a({key:o.terminal.key,terminalName:o.terminal.terminalName}):void 0,voyage:t.key,key:a.getNextKey()});e++,o=new l.a(Object.assign(Object.assign({},o),{portCall:r})),b=[...b,r],y=new n.a(Object.assign(Object.assign({},y),{portCallsFromVoyage:[...y.portCallsFromVoyage,r],partOfSchedule:[...y.partOfSchedule,r]}))}return o})}C.forEach(e=>{v.push(e)}),g=new r.a(Object.assign(Object.assign({},g),{cargoPorts:v}))}return{cargo:g,voyage:y}}function f(e,t,a,o){var n;const r=Array.from(t.portCallsFromVoyage),l=u.a.sortByCargoPortSequence(Array.from(e.cargoPorts)),i=u.a.sortByCargoPortSequence(Array.from(null!==(n=null==o?void 0:o.cargoPorts)&&void 0!==n?n:[])),c=[];return l.forEach((e,n)=>{r.forEach(r=>{var l,s,u,d,g,p,m,f,v,b,C,O,h,E,S,j;e.portCall&&e.portCall.key>0&&e.portCall.key===r.key?c.push({key:o?i[n].key:e.key,portCall:{key:e.portCall.key,portCallSequence:e.portCall.portCallSequence},cargoQuantity:e.cargoQuantity*a}):(null===(l=e.reasonForCall)||void 0===l?void 0:l.key)===(null===(s=r.reasonForCall)||void 0===s?void 0:s.key)&&(null===(u=e.port)||void 0===u?void 0:u.key)===(null===(d=r.port)||void 0===d?void 0:d.key)&&null!==(p=null===(g=null==e?void 0:e.portCall)||void 0===g?void 0:g.key)&&void 0!==p&&p&&c.push({key:o?i[n].key:e.key,portCall:{portCallSequence:null===(m=null==e?void 0:e.portCall)||void 0===m?void 0:m.portCallSequence,eventLogs:y.a.getDefaultEventLogs(),reasonForCall:(null===(v=null===(f=null==e?void 0:e.portCall)||void 0===f?void 0:f.reasonForCall)||void 0===v?void 0:v.key)?null===(b=null==e?void 0:e.portCall)||void 0===b?void 0:b.reasonForCall.key:null===(O=null===(C=null==e?void 0:e.portCall)||void 0===C?void 0:C.reasonForCall)||void 0===O?void 0:O.reasonForCall,port:null===(E=null===(h=null==e?void 0:e.portCall)||void 0===h?void 0:h.port)||void 0===E?void 0:E.key,terminal:null===(j=null===(S=null==e?void 0:e.portCall)||void 0===S?void 0:S.terminal)||void 0===j?void 0:j.key,voyage:t.key},cargoQuantity:e.cargoQuantity*a})})}),c}function v(e,t){var a,o,n;return(null===(a=null==e?void 0:e.leg)||void 0===a?void 0:a.key)===(null===(n=null===(o=null==t?void 0:t.voyageHeader)||void 0===o?void 0:o.leg)||void 0===n?void 0:n.key)}function b(e,t){var a,o,n,r,l,i;return(null===(a=null==e?void 0:e.company)||void 0===a?void 0:a.key)===(null===(n=null===(o=null==t?void 0:t.voyageHeader)||void 0===o?void 0:o.company)||void 0===n?void 0:n.key)&&(null===(r=null==e?void 0:e.businessUnit)||void 0===r?void 0:r.key)===(null===(i=null===(l=null==t?void 0:t.voyageHeader)||void 0===l?void 0:l.businessUnit)||void 0===i?void 0:i.key)}function C(e,t,a,o){if("LEFT_ITEM"===e.type&&e.destination){const n=function(e,t,a){const{portCallsFromVoyage:o}=a,{cargoPorts:n}=t,r=Array.from(n);let c;const s=e.destination?e.destination.droppableId.split("-")[1]:void 0;return o.forEach(e=>{s&&e.portCallSequence===Number(s)+1&&(c=new i.a(Object.assign({},e)))}),r.map(t=>{var a,o,n,r,i;return c&&t.terminal&&null===c.terminal||c&&null===t.terminal&&c.terminal?t:e.draggableId&&e.draggableId===t.key.toString()&&c&&c.port&&(null===(a=t.port)||void 0===a?void 0:a.portName)===c.port.portName&&(null===(o=t.reasonForCall)||void 0===o?void 0:o.reasonForCall)===(null===(n=c.reasonForCall)||void 0===n?void 0:n.reasonForCall)&&(null===(r=t.terminal)||void 0===r?void 0:r.key)===(null===(i=c.terminal)||void 0===i?void 0:i.key)?new l.a(Object.assign(Object.assign({},t),{portCall:{key:c.key,portCallSequence:c.portCallSequence,vesselPcSequence:c.vesselPcSequence}})):t})}(e,t,a),{voyage:c,cargo:s}=m(new r.a(Object.assign(Object.assign({},t),{cargoPorts:n})),a,o,!0);return{cargo:s,voyage:c}}if(a.partOfSchedule&&"ROW"===e.type&&e.destination){const o=s.a.reorderPortCallSequence(a.partOfSchedule,e,!1);if(o){const e=u.a.synchCargoPortPortCallSequences(o,[...t.cargoPorts]),l=a.portCallsFromVoyage.map(e=>{const t=o.find(t=>e.key===t.key);return t?new i.a(Object.assign(Object.assign({},e),{portCallSequence:t.portCallSequence,vesselPcSequence:t.vesselPcSequence})):e});return{cargo:new r.a(Object.assign(Object.assign({},t),{cargoPorts:e})),voyage:new n.a(Object.assign(Object.assign({},a),{portCallsFromVoyage:l,partOfSchedule:o}))}}}return{cargo:t,voyage:a}}},508:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return O}));a(10),a(11);var o=a(44),n=a(0),r=a.n(n),l=a(6),i=a(3),c=a(20),s=a(102),u=a(1),d=a(1169),y=a(86),g=a(96);function p(e){const[t]=Object(l.a)([i.a.IInternationalization]),{model:a}=t.lang(),{cargo:o,actionType:c,onChangeFromPort:p,onChangeOwner:f,onChangeToPort:v,reactKeyPrefix:b}=e,C=Object(n.useMemo)(()=>c?d.a.getCargoPortsForTransshipOrPreship(o,c):[],[c,o]),O=1===C.length?C[0]:null;O&&c===m.Transship?p(O):O&&c===m.Preship&&v(O);const h=Object(n.useMemo)(()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,{options:C,onChange:p,objectPaths:["port.portName"],reactKeyPrefix:b+"select-from-port",label:a.fromPort,defaultSelectedOptions:O}),r.a.createElement(s.b,{query:g.d,type:u.a.port,onChange:v,objectPaths:["portName"],label:a.toPort,reactKeyPrefix:b+"select-to-port"})),[C,O,a.fromPort,a.toPort,p,v,b]),E=Object(n.useMemo)(()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{type:u.a.port,onChange:p,objectPaths:["portName"],label:a.fromPort,reactKeyPrefix:b+"select-from-port",query:g.d}),r.a.createElement(s.a,{options:C,onChange:v,objectPaths:["port.portName"],reactKeyPrefix:b+"select-to-port",label:a.toPort,defaultSelectedOptions:O})),[C,O,a.fromPort,a.toPort,p,v,b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.b,{type:u.a.businesspartner,onChange:f,objectPaths:y.b.businessPartner,label:a.owner,reactKeyPrefix:b+"select-owner",shouldPreload:!0,fields:y.a.businessPartner}),c===m.Transship?h:null,c===m.Preship?E:null)}var m,f=a(97),v=a(27),b=a(15),C=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(a[o[n]]=e[o[n]])}return a};function O(e){const[t,a]=Object(l.a)([c.a.IReletTransshipCargoController,i.a.IInternationalization]),{model:s}=a.lang(),{cargo:u,reactKeyPrefix:d,onCloseModal:y,actionType:g}=e,O=C(e,["cargo","reactKeyPrefix","onCloseModal","actionType"]),[h,E]=Object(n.useState)(null),[S,j]=Object(n.useState)(null),[P,T]=Object(n.useState)(null),A=Object(f.h)(),I=Object(f.g)(),N=Object(n.useCallback)((e,t)=>v.a.openDrawer(t.key,b.a.cargoDrawer,A,I),[I,A]),k=Object(n.useCallback)(()=>{h&&y&&(t.initiateRelet(g,u,h,S,P,N),y())},[g,N,u,t,S,y,h,P]),R=Object(n.useCallback)(e=>E(e),[]),F=Object(n.useCallback)(e=>j(e),[]),_=Object(n.useCallback)(e=>T(e),[]),L=Object(n.useMemo)(()=>g===m.Relet?`${s.relet} ${s.cargo}`:g===m.Transship?`${s.transship} ${s.cargo}`:g===m.Preship?`${s.preship} ${s.cargo}`:"",[g,s.cargo,s.preship,s.relet,s.transship]),D=Object(n.useMemo)(()=>g===m.Relet?!h:g!==m.Transship&&g!==m.Preship||!(h&&S&&P),[g,S,h,P]);return r.a.createElement(o.a,Object.assign({reactKeyPrefix:d,title:L,disableConfirmBtn:D,onConfirm:k,onCloseModal:y},O),r.a.createElement(p,{reactKeyPrefix:d+"selectors",actionType:g,cargo:u,onChangeFromPort:F,onChangeToPort:_,onChangeOwner:R}))}!function(e){e[e.Relet=0]="Relet",e[e.Transship=1]="Transship",e[e.Preship=2]="Preship"}(m||(m={}))},647:function(e,t,a){"use strict";a.d(t,"b",(function(){return C})),a.d(t,"c",(function(){return O})),a.d(t,"a",(function(){return h})),a.d(t,"d",(function(){return E}));a(59);var o,n,r=a(9),l=a(31),i=a(7),c=a(29),s=a(4),u=a(1),d=a(1200),y=a(1201),g=a(89),p=a(1199),m=function(e,t,a,o){var n,r=arguments.length,l=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,a,l):n(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(e,t){return function(a,o){t(a,o,e)}},b=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const C="COPY_SCENARIO_VESSELS_TABLE",O="COPY_SCENARIO_VOYAGES_TABLE",h="COPY_SCENARIO_CARGOES_TABLE";let E=class{constructor(e,t){this.store=e,this.tsmodelActions=t}loadVessels(e,t){return b(this,void 0,void 0,(function*(){const a=[{field:"vesselCodes.isSchedulable",queryParamName:"vesselCodes.isSchedulable",value:!0,operator:s.c.EQUALS,type:s.d.BOOLEAN,filterGroupCode:""}];yield this.tsmodelActions.loadMultipleAction({fields:p.a.vesselFields,filters:"MASTER"===(null==e?void 0:e.scenarioCode)?a:void 0,type:u.a.vessel,identifier:C,overwriteKeysOnLoad:!0,query:`filter=scenarios.key(EQ)${e.key}&sort=vesselName(ASI)`,callback:t})}))}loadVoyageCommitments(e,t){const a=[{field:"voyageHeader.voyageStatus.statusTypeCode",queryParamName:"voyageHeader.voyageStatus.statusTypeCode",value:"SCU",operator:s.c.EQUALS,type:s.d.STRING,filterGroupCode:""}];this.tsmodelActions.loadMultipleAction({fields:d.a.voyageCommitmentsFields,filters:a,type:u.a.voyage,identifier:O,overwriteKeysOnLoad:!0,query:`filter=scenarios.key(EQ)${e.key}&sort=voyageHeader.voyageStartDate(ASI)`,callback:t})}loadCargoCommitments(e,t){this.tsmodelActions.loadMultipleAction({fields:y.a.cargoCommitmentsFields,type:u.a.cargo,identifier:h,overwriteKeysOnLoad:!0,query:`filter=scenarios.key(EQ)${e.key}&filter=voyage(NULL)&sort=laycanFrom(ASI)&sort=charterer%2B.businessPartnerName(ASI)`,callback:t})}onCopy(e,t,a){const o=Object(g.a)(t);this.tsmodelActions.copySingleAction({key:e.key,data:o,type:u.a.scenario,callback:(e,{key:t})=>{t&&a(t)}})}};E=m([Object(r.injectable)(),v(0,Object(r.inject)(i.a.Store)),v(1,Object(r.inject)(i.a.ITSModelActionsAsync)),f("design:paramtypes",["function"==typeof(o=void 0!==l.Store&&l.Store)?o:Object,"function"==typeof(n=void 0!==c.ITSModelActionsAsync&&c.ITSModelActionsAsync)?n:Object])],E)},684:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));a(10),a(11),a(118);var o=a(81),n=a(74),r=a(91),l=a(937),i=a(60);const c={generateTableRows:function(e,t){return[...e.filter(e=>e.voyage&&e.voyage.key!==t.key),t].map((e,t)=>{let a=null;e.voyage?a=e.voyage:e.voyageHeader&&(a=e);const l=a?i.a.getFirstLoadPort(a.portCallsFromVoyage):new r.a({}),c=a?i.a.getLastDischargePort(a.portCallsFromVoyage):new r.a({}),s=(a?i.a.getLastDischargePortDeparture(a.portCallsFromVoyage):new Date)||new Date,u=a?i.a.getPerformanceCargo(a.cargos):new n.a({}),d=i.a.getLastPortCall((null==a?void 0:a.portCallsFromVoyage)||[]);return{content:[Object(o.a)(a,"voyageHeader.referenceNo",""),Object(o.a)(a,"voyageHeader.voyageStartDate",""),Object(o.a)(u,"charterer.businessPartnerName",""),l.portName,c.portName,s,u.laycanFrom,u.laycanTo,Object(o.a)(d,"port.portName",""),Object(o.a)(a,"comments","")],id:a?a.key:t}})},lastPortMatchesAllocateBallast:function(e,t){var a;const o=l.a.getLastVoyage(e),n=i.a.getLastPortCall((null==o?void 0:o.portCallsFromVoyage)||[]);return!!n.port&&n.port.key===(null===(a=t.ballastPort)||void 0===a?void 0:a.key)},isStartDateAfterLastEndDate:(e,t)=>{var a;const o=l.a.getLastVoyage(e),n=i.a.getLastPortDeparture((null==o?void 0:o.portCallsFromVoyage)||[]);return!!n&&!!(null===(a=null==t?void 0:t.voyageHeader)||void 0===a?void 0:a.voyageStartDate)&&t.voyageHeader.voyageStartDate>=n},getIsLastVoyageForCurrentCp:function(e,t){var a,o,n;const r=t.find(e=>"NOM"===e.statusTypeCode),l=e.filter(e=>{var t,a;return(null===(a=null===(t=e.voyage)||void 0===t?void 0:t.voyageHeader)||void 0===a?void 0:a.voyageStatus)&&r&&e.voyage.voyageHeader.voyageStatus.statusTypeSequence>=r.statusTypeSequence}).sort((e,t)=>e.sequence-t.sequence),i=l[l.length-1];return!!i&&!!(null===(o=null===(a=i.voyage)||void 0===a?void 0:a.voyageHeader)||void 0===o?void 0:o.isLastVoyage)&&!!(null===(n=i.voyage)||void 0===n?void 0:n.tcIn)},getNewFleetPlanSequence:function(e,t,a,o){if(null===t)return null;const n=e.findIndex(e=>e.id===a.key),r=n+1<e.length?e[n+1].id:null,l=t.find(e=>{var t;return(null===(t=e.voyage)||void 0===t?void 0:t.key)===r}),i=t[t.length-1];return void 0!==l?l.sequence:void 0!==i?i.sequence+1:null!==o?o.sequence+1:1}}},964:function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));a(59),a(10),a(11);var o=a(214),n=a(887),r=a(345),l=a(0),i=a.n(l),c=a(1698),s=a(660),u=a(102),d=a(44),y=a(71),g=a(6),p=a(23),m=a(74),f=a(1),v=a(142),b=a(96),C=a(86),O=a(3),h=a(20),E=a(432),S=a(323),j=a(130),P=a(114);var T=function(e,t,a,o){return new(a||(a=Promise))((function(n,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const A=i.a.memo(e=>{var t,a;const[A,I,N,k]=Object(g.a)([O.a.IInternationalization,O.a.IKeyGen,h.a.IAllocateCargoModalController,h.a.ITransferCargoModalController]),{cargo:R,vessel:F,isOpenedFromFas:_,voyage:L,onCloseDialog:D,onConfirmDialog:w,showDialog:x,showQuantitySelector:M=!1,reactKeyPrefix:V,isTransfer:G=!1,cargoTemplateToUse:H,history:q,location:K}=e,{cargoes:U,common:B,model:Y}=A.getLanguageFile(),[Q,z]=Object(l.useState)(null),[$,W]=Object(l.useState)(null),[X,J]=Object(l.useState)(x),[Z,ee]=Object(l.useState)(null),[te,ae]=Object(l.useState)(null),[oe,ne]=Object(l.useState)(null),[re,le]=Object(l.useState)(new m.a(R)),[ie,ce]=Object(l.useState)([]),[se,ue]=Object(l.useState)(!1),de=Object(p.a)(v.a.get,f.a.scenario),ye=null!==(t=null==re?void 0:re.weight)&&void 0!==t?t:0,[ge,pe]=Object(l.useState)(ye),me=Object(l.useCallback)(e=>{pe(e||0)},[]),fe=Object(l.useCallback)(e=>T(void 0,void 0,void 0,(function*(){ue(!0),ce([]);const t=yield N.loadVoyages(null!=e?e:Z,R,_,de);return ce(t),ue(!1),t})),[N,R,_,de,Z]),ve=Object(l.useCallback)(e=>{ne(null),ae(null),le(new m.a(R)),ee(e)},[R]),be=Object(l.useCallback)((e,t=!0)=>T(void 0,void 0,void 0,(function*(){le(null);const a=yield N.loadVoyage(null==e?void 0:e.key);if(le(new m.a(R)),!a)return;let o=null;if(G&&$)o=k.copyCargoAndAllocateToVoyageOnClient(R,a,$);else if(re){const e=Object(n.a)(re.cargoPorts,e=>Object(r.a)(e,["portCall","_portCall"]));o=new m.a(Object.assign(Object.assign({},re),{cargoPorts:e}))}const{voyage:l,cargo:c}=Object(E.b)(o,a,I,!1);ne(l),le(c),!t||Object(E.e)(c,a)&&Object(E.d)(c,a)||((e,t)=>{var a,o,n,r,l,c,s,u,d;const[y]=Object(g.a)([O.a.IInternationalization]),{common:{noBusinessUnit:p,noCompany:m,ok:f},alerts:{companiesBusinessUnitsNotEqualBody:v,companiesBusinessUnitsTradesNotEqualHeader:b,tradesNotEqualBody:C,tradesNotEqualNullBody:h}}=y.getLanguageFile(),T=!!(null===(a=null==t?void 0:t.voyageHeader)||void 0===a?void 0:a.leg),A=!Object(E.e)(e,t),I=!Object(E.d)(e,t),N=i.a.createElement(i.a.Fragment,null,A?T?i.a.createElement(j.a,{variant:"body1"},C," ",i.a.createElement(S.a,{component:"span",fontWeight:"fontWeightMedium"},null===(n=null===(o=null==t?void 0:t.voyageHeader)||void 0===o?void 0:o.leg)||void 0===n?void 0:n.legDesc)):i.a.createElement(j.a,{variant:"body1"},h):void 0),k=i.a.createElement(i.a.Fragment,null,I?i.a.createElement(i.a.Fragment,null,i.a.createElement("br",null),i.a.createElement(j.a,{variant:"body1"},v,i.a.createElement(S.a,{component:"span",fontWeight:"fontWeightMedium"},null!==(c=null===(l=null===(r=null==t?void 0:t.voyageHeader)||void 0===r?void 0:r.company)||void 0===l?void 0:l.companyName)&&void 0!==c?c:m),i.a.createElement(S.a,{component:"span",fontWeight:"fontWeightMedium"}," - "),i.a.createElement(S.a,{component:"span",fontWeight:"fontWeightMedium"},null!==(d=null===(u=null===(s=null==t?void 0:t.voyageHeader)||void 0===s?void 0:s.businessUnit)||void 0===u?void 0:u.businessUnitName)&&void 0!==d?d:p))):void 0),R=i.a.createElement(i.a.Fragment,null,N,k);return Object(P.a)(b,R,void 0,f,!0)})(c,l).then(()=>le(e=>{var t,a;return new m.a(Object.assign(Object.assign({},e),{leg:null!==(a=null===(t=null==l?void 0:l.voyageHeader)||void 0===t?void 0:t.leg)&&void 0!==a?a:null}))}))})),[N,R,re,G,I,$,k]),Ce=Object(l.useCallback)(e=>{W(e),ne(null)},[]);Object(l.useEffect)(()=>{te&&be(te)},[te]),Object(l.useEffect)(()=>{$&&te&&be(te,!1)},[$]);const Oe=Object(l.useCallback)(()=>T(void 0,void 0,void 0,(function*(){if(F&&ve(F),L&&F){const e=yield fe(F);if(e.length){const t=e.find(e=>e.key===(null==L?void 0:L.key));be(null!=t?t:null)}}})),[fe,ve,be,F,L]);Object(l.useEffect)(()=>{Oe()},[]);const he=Object(l.useCallback)(()=>{ee(null),ae(null),ne(null),le(new m.a(R)),ce([]),J(!1)},[R]),Ee=Object(l.useCallback)(()=>{he(),D()},[he,D]),Se=Object(l.useCallback)(()=>T(void 0,void 0,void 0,(function*(){re&&oe&&(J(!1),G?Q&&$&&(yield k.transfer(oe,R,re,Q,q,K)):yield N.onConfirm({allocateToVoyage:oe,cargoToAllocate:re,maxQuantity:ye,quantity:ge,isOpenedFromFas:_}),w?(he(),w()):Ee())})),[re,oe,G,w,Q,$,q,k,R,K,N,ye,ge,_,he,Ee]),je=Object(l.useCallback)(e=>{if(re&&oe){const t=Object(E.f)(e,re,oe,I);le(t.cargo),ne(t.voyage)}},[oe,re,I]),Pe=Object(l.useMemo)(()=>G&&(!Q||!$||!oe||!Z),[oe,G,Q,$,Z]),Te=Object(l.useMemo)(()=>{const e=re&&oe&&Object(E.a)(re.cargoPorts,oe.portCallsFromVoyage);return 0!==ye&&0===ge||!e||Pe},[oe,re,ye,ge,Pe]);return i.a.createElement(d.a,{reactKeyPrefix:V,title:G?U.transferCargo:U.allocateCargo,open:X,onCloseModal:Ee,maxWidth:"sm",fullWidth:!0,confirmBtnName:G?B.transfer:B.allocate,disableConfirmBtn:Te,onConfirm:Se,disableDraggable:!0},i.a.createElement(o.a,{container:!0,item:!0,spacing:2},G&&i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,{item:!0,xs:6},i.a.createElement(u.b,{label:A.lang().model.owner,type:f.a.businesspartner,onChange:z,objectPaths:C.b.businessPartner,reactKeyPrefix:V+"-transfer-owner",shouldPreload:!0,isClearable:!1})),i.a.createElement(o.a,{item:!0,xs:6},i.a.createElement(u.b,{label:A.lang().model.toPort,type:f.a.port,onChange:Ce,objectPaths:["portName"],query:b.d,reactKeyPrefix:V+"-transfer-to-port",shouldPreload:!0,isClearable:!1}))),i.a.createElement(o.a,{item:!0,xs:6},i.a.createElement(u.b,{type:f.a.vessel,onChange:ve,onBlur:fe,objectPaths:["vesselName"],isClearable:!1,label:Y.vessel,reactKeyPrefix:V+"-vessel",overrideDefaultSelectedOptions:!0,defaultSelectedOptions:Z,shouldPreload:!0,disabled:!!F})),i.a.createElement(o.a,{item:!0,xs:6},i.a.createElement(u.a,{disabled:!Z||!!L,options:ie,onChange:ae,objectPaths:["voyageHeader.referenceNo","voyageHeader.leg.legDesc","voyageHeader.voyageStatus.statusTypeDesc"],reactKeyPrefix:V+"-voyage",formHelperText:Z?"":B.pleaseSelectAVessel,label:Y.voyage,isClearable:!1,overrideDefaultSelectedOptions:!0,defaultSelectedOptions:null!=L?L:te,noOptionsMessage:()=>U.noVoyage,loading:se})),i.a.createElement(o.a,{item:!0,xs:12},oe&&!Pe&&i.a.createElement(y.a,{heightFitsContainer:!0},i.a.createElement(s.a,{reactKeyPrefix:V,voyage:oe,selectedCargo:null!=re?re:void 0,onDropped:je,hasTemplateCargo:!!H,enableDragOnLeftSide:!0,hideToolbar:!0}))),M&&i.a.createElement(o.a,{item:!0,xs:12},i.a.createElement(c.a,{reactKeyPrefix:V+"-move-cargo",onChange:me,max:null!==(a=null==re?void 0:re.weight)&&void 0!==a?a:0}))))})}}]);