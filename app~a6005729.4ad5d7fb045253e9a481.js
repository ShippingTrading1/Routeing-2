(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{1802:function(e,a,t){"use strict";t.d(a,"a",(function(){return g}));t(10),t(11);var r=t(0),n=t.n(r),o=t(1),i=t(850),l=t(6),c=t(20),s=t(23),u=t(21),d=t(62),m=t(74),v=t(285),y=t(107);const g=({voyageKey:e,currency:a,userLocale:t,reactKeyPrefix:g})=>{var b;const[f]=Object(l.a)([c.a.IVoyageDrawerController]),p=Object(r.useRef)(!1),E=Object(s.a)(u.a.getTSModelBuilt,o.a.voyage,e,y.u),O=Object(r.useMemo)(()=>{var a,t,r;return new d.a({key:e,variouses:null!==(a=null==E?void 0:E.variouses)&&void 0!==a?a:[],tcIn:null!==(t=null==E?void 0:E.tcIn)&&void 0!==t?t:{},tcs:null!==(r=null==E?void 0:E.tcs)&&void 0!==r?r:[]})},[e,E]),C=Object(r.useMemo)(()=>{var e,a,t,r,n;return[...null!==(a=(null!==(e=null==E?void 0:E.cargos)&&void 0!==e?e:[]).filter(e=>e.variouses.length>0).map(e=>new m.a({key:e.key,variouses:e.variouses})))&&void 0!==a?a:[],...null!==(n=(null!==(r=null===(t=null==E?void 0:E.voyageHeader)||void 0===t?void 0:t.offhires)&&void 0!==r?r:[]).filter(e=>e.variouses.length>0).map(e=>new v.a({key:e.key,variouses:e.variouses})))&&void 0!==n?n:[],...[new d.a({key:O.key,variouses:O.variouses})]]},[O.key,O.variouses,null==E?void 0:E.cargos,null===(b=null==E?void 0:E.voyageHeader)||void 0===b?void 0:b.offhires]);Object(r.useEffect)(()=>{f.loadVariouses(e,()=>p.current=!0)},[f,e]);const T={userLocale:t,rootObject:O,defaults:{currency:a},tsModelType:o.a.voyage,subObjects:C,smartResponse:!0,disableRoot:!0};return E&&p.current?n.a.createElement(i.a,{variousTables:[Object.assign(Object.assign({},T),{reactKeyPrefix:g+"-cost",typeCode:"C"}),Object.assign(Object.assign({},T),{reactKeyPrefix:g+"-revenue",typeCode:"R"})]}):n.a.createElement(n.a.Fragment,null)}},1803:function(e,a,t){"use strict";t.d(a,"a",(function(){return D}));t(59),t(10),t(11);var r,n=t(0),o=t.n(n),i=t(97),l=t(6),c=t(3),s=t(15),u=t(27),d=t(1274),m=t(46),v=t(81),y=t(66),g=t(30),b=t(858),f=t(2104),p=t(214),E=t(33),O=t(236),C=t(7),T=t(83),h=t(2071),k=t(2072),x=t(1952),R=t(423),N=t(112),j=t(94),A=t(60),I=function(e,a,t,r){return new(t||(t=Promise))((function(n,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function l(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(i,l)}c((r=r.apply(e,a||[])).next())}))};function D({reactKeyPrefix:e,voyage:a,user:t,userLocale:D}){const[P,_,S]=Object(l.a)([c.a.IInternationalization,C.a.IFilterActions,T.a.IDocumentApi]),{model:K}=P.getLanguageFile(),{voyageHeader:L}=a,F=Object(y.a)([g.a.OffhirePAGE],t),w=Object(y.a)([g.a.LaytimeCalculationsPAGE],t),B=Object(y.a)([g.a.BunkerTransactionsPAGE],t),[M,U]=Object(n.useState)(!1),[H,G]=Object(n.useState)(!1),V=Object(i.g)(),Y=Object(i.h)(),z=Object(n.useCallback)((e,a)=>u.a.openDrawer(a,e,Y,V),[Y,V]),W=Object(n.useCallback)(()=>U(!M),[M]),q=Object(n.useCallback)(()=>G(!H),[H]),J=z.bind(null,s.a.offhireDrawer),$=z.bind(null,s.a.laytimeCalculationDrawer),X=z.bind(null,s.a.bunkerTransactionDrawer),Q=Object(n.useCallback)((e,a)=>{a&&(z(s.a.offhireDrawer,a.key),m.a.next())},[z]),Z=Object(n.useCallback)((e,a)=>{a&&(z(s.a.laytimeCalculationDrawer,a.key),m.a.next())},[z]),ee=Object(n.useCallback)(()=>{var e,a,t,r;const n=Object.assign(Object.assign({},R.a),{value:[null!==(e=null==L?void 0:L.referenceNo)&&void 0!==e?e:""],selectedObj:[{key:null!==(a=null==L?void 0:L.key)&&void 0!==a?a:0,referenceNo:null!==(t=null==L?void 0:L.referenceNo)&&void 0!==t?t:""}]});(null!==(r=j.a.getFiltersByGroupCode(O.b.getState(),N.a))&&void 0!==r?r:[]).forEach(e=>O.b.dispatch(_.removeFilterAction(e))),O.b.dispatch(_.putFilterAction(n))},[_,null==L?void 0:L.key,null==L?void 0:L.referenceNo]),ae=Object(n.useCallback)(e=>I(this,void 0,void 0,(function*(){var r;e&&(yield S.refreshBunkerTransactions(null!==(r=t.authdata)&&void 0!==r?r:"",a.key))})),[S,t.authdata,a]),te=Object(n.useCallback)(()=>{var e;S.refreshBunkerTransactions(null!==(e=t.authdata)&&void 0!==e?e:"",a.key),ee()},[ee,S,t.authdata,a.key]),re=o.a.createElement(f.a,Object.assign({},{onClick:ne=e=>{e.stopPropagation(),te()},onAuxClick:ne,target:"_blank",rel:"noopener noreferrer"},{href:`#${E.a.bunkerTransactions.url}/tab/`+r.PENDING_BUNKER_TRANSACTIONS}),K.pending);var ne;return o.a.createElement(o.a.Fragment,null,o.a.createElement(p.a,{container:!0,spacing:2},F&&o.a.createElement(h.a,{reactKeyPrefix:e,voyageHeaderKey:null==L?void 0:L.key,onClick:J,i:P,user:t,onToggleCreateOffhireModal:W}),!a.isTc&&w&&o.a.createElement(k.a,{reactKeyPrefix:e,voyageKey:a.key,onClick:$,i:P,user:t,onToggleCreateLaytimeCalculationModal:q}),B&&A.a.getIsNominatedOrHigher(a)&&o.a.createElement(x.b,{reactKeyPrefix:e,i:P,voyageKey:a.key,onToggleBunkerTransactions:ae,onClick:X,pendingLinks:re,userLocale:D})),M&&o.a.createElement(d.a,{reactKeyPrefix:e+"create-offhire-modal",onCloseModal:W,open:M,onCreate:Q,voyageHeader:Object(v.a)(a,"voyageHeader"),vessel:Object(v.a)(a,"vessel")}),H&&o.a.createElement(b.b,{reactKeyPrefix:e+"-create-laytime-calculation",open:H,onCreate:Z,onCloseModal:q,voyage:a}))}!function(e){e.PENDING_BUNKER_TRANSACTIONS="2"}(r||(r={}))},2067:function(e,a,t){"use strict";t.d(a,"a",(function(){return L}));t(10),t(11),t(118);var r=t(0),n=t.n(r),o=t(6),i=t(3),l=t(60),c=t(261),s=t(28),u=t(210),d=t(1410),m=t(143),v=t(7),y=t(23),g=t(414),b=t(58),f=t(137),p=t(2538);function E(e,a){return{[m.a.FREIGHT_RATE]:e=>{var a,t,r;return null!==(r=null===(t=b.a.getFirstDischargeCargoPort(l.a.getPerformanceCargo(null!==(a=e.cargos)&&void 0!==a?a:[]).cargoPorts))||void 0===t?void 0:t.freightRate)&&void 0!==r?r:0},[m.a.BUNKER_DO]:e=>e.doPrice,[m.a.BUNKER_DO_LS]:e=>e.dlPrice,[m.a.BUNKER_FO]:e=>e.foPrice,[m.a.BUNKER_FO_LS]:e=>e.flPrice,[m.a.TCE]:e=>e.tcResultDay}[a](e)}function O(e){switch(e){case m.a.TCE:return m.a.FREIGHT_RATE;default:return m.a.TCE}}function C(e,a,t,r){return e===m.a.TCE&&Object(p.a)(Math.abs(a),1e4,1e6)?t.formatNumber(Math.round(a/1e3),{maxDecimals:0,locale:r.isoCode})+t.getLanguageFile().common.thousandAbbreviated:e===m.a.TCE&&Math.abs(a)>=1e6?t.formatNumber(a/1e6,{maxDecimals:2,locale:r.isoCode})+t.getLanguageFile().common.millionAbbreviated:a>100||a<-100||e===m.a.TCE?t.formatNumber(a,{maxDecimals:0,locale:r.isoCode}):t.formatNumber(a,{maxDecimals:2,locale:r.isoCode})}function T(e){const{voyages:a,parameter:t,userLocale:l,currentVoyage:c}=e,[s]=Object(o.a)([i.a.IInternationalization]),u=O(t),d=Math.max(...a.map(e=>Math.abs(E(e,u))))>999999,v=a.length?Math.round(100*(E(c,t)+Number.EPSILON))/100:void 0,y=Object(r.useMemo)(()=>((e,a,{i:t,userLocale:r,currentValue:n,doFormatYAxis:o})=>({chart:{height:400,type:"line",zoom:{enabled:!1}},colors:[f.a.palette.secondary.main],dataLabels:{enabled:!0,offsetX:6,offsetY:-8,formatter:function(e,{dataPointIndex:n,w:o}){return o.globals.stackedSeriesTotals[n]?C(a,o.globals.stackedSeriesTotals[n],t,r):""},style:{colors:[f.a.palette.secondary.main]},background:{enabled:!0,borderRadius:3,opacity:.9,dropShadow:{enabled:!1}}},stroke:{curve:"straight"},markers:{size:6},xaxis:{title:{text:e},type:"category",labels:{formatter:function(a){return C(e,parseFloat(a),t,r)}}},yaxis:{title:{text:a},min:e=>e>0?0:e,max:e=>e<0?0:e,labels:{minWidth:a===m.a.TCE&&o?55:45,formatter:function(e){return C(a,e,t,r)}}},tooltip:{enabled:!1},grid:{show:!0,padding:{right:50,top:10}},annotations:{position:"back",xaxis:[{opacity:void 0===n?0:1,x:n,borderColor:f.a.palette.primary.main,label:{borderColor:f.a.palette.primary.main,offsetY:150,style:{color:f.a.palette.primary.contrastText,background:f.a.palette.primary.main},text:t.lang().voyages.voyageSensitivityChartCurrentValueText}}]}}))(t,u,{i:s,userLocale:l,currentValue:v,doFormatYAxis:d}),[v,s,d,t,l,u]),b=Object(r.useMemo)(()=>[{name:u,data:a.map(e=>({y:E(e,u),x:E(e,t)})).sort((e,a)=>e.x-a.x)}],[t,a,u]);return n.a.createElement(g.a,{elevation:2,reactKeyPrefix:"doc-voyage-drawer-voyage-sensitivity-chart",type:"line",height:400,options:y,series:b})}var h=t(42),k=t(245),x=t(214),R=t(130),N=t(473),j=t(323),A=t(213),I=t(187),D=t(44),P=t(67),_=t(5);const S=[m.a.FREIGHT_RATE,m.a.BUNKER_DO,m.a.BUNKER_DO_LS,m.a.BUNKER_FO,m.a.BUNKER_FO_LS,m.a.TCE],K=Object(A.a)(e=>Object(I.a)({currentValue:{background:Object(k.a)(e.palette.primary.main,e.palette.action.selectedOpacity)}}));function L(e){var a,t,l;const{voyage:g,open:b,onClose:f,reactKeyPrefix:p}=e,[C,k,A]=Object(o.a)([v.a.IVoyageSensitivityAnalysisActions,i.a.IInternationalization,v.a.ISimpleReducerActions]),I=Object(y.a)(h.a.getUserLocale),L=K({}),w=null!==(a=Object(y.a)(d.a.getVoyageSensitivityAnalysisParams))&&void 0!==a?a:{parameter:m.a.FREIGHT_RATE,variance:F(m.a.FREIGHT_RATE,g)},B=Object(y.a)(d.b,g.key,w.parameter),M=Object(r.useCallback)(a=>{if("string"==typeof a){const t={parameter:a,variance:F(a,e.voyage)};A.setAction(m.d,t)}else{const e={parameter:w.parameter,variance:a};A.setAction(m.d,e)}},[A,w,e.voyage]),U=Object(r.useCallback)(()=>{C.calculate(g,w)},[C,g,w]),H=Object(r.useMemo)(()=>B&&void 0!==B.voyages&&0!==B.voyages.length?null:n.a.createElement(x.a,{item:!0,xs:12},n.a.createElement(R.a,{color:"error"},k.lang().voyages.voyageSensitivityCalculationHelperText)),[k,B]),G=[{content:w.parameter,contentType:_.a.NUMBER,alignHeaderContent:_.c.RIGHT,numberFormatOptions:{minDecimals:w.parameter===m.a.TCE?0:2,maxDecimals:w.parameter===m.a.TCE?0:2}},{content:O(w.parameter),contentType:_.a.NUMBER,numberFormatOptions:{minDecimals:O(w.parameter)===m.a.TCE?0:2,maxDecimals:O(w.parameter)===m.a.TCE?0:2},alignHeaderContent:_.c.RIGHT}],V=(null!==(t=null==B?void 0:B.voyages)&&void 0!==t?t:[]).map(e=>({content:[E(e,w.parameter),E(e,O(w.parameter))],id:e.key,customisation:{className:E(e,w.parameter)===E(g,w.parameter)?L.currentValue:void 0}})).sort((e,a)=>parseFloat(e.content[0])-parseFloat(a.content[0]));return n.a.createElement(D.a,{reactKeyPrefix:p+"modal",open:b,onCloseModal:f,title:k.lang().voyages.voyageSensitivityAnalysis,actionButtons:n.a.createElement(N.a,{color:"primary",onClick:f},k.lang().common.close),fullWidth:!0,fullscreenOnMobile:!0,maxWidth:"lg"},n.a.createElement(x.a,{container:!0,spacing:2},n.a.createElement(x.a,{item:!0,xs:2,md:2},n.a.createElement(c.a,{reactKeyPrefix:p+"select",label:k.lang().common.parameter,options:S,value:w.parameter,onInputChange:M,variant:"standard"})),n.a.createElement(x.a,{item:!0,xs:2,md:2},n.a.createElement(u.a,{reactKeyPrefix:p+"number-input",label:k.lang().common.variance,value:null==w?void 0:w.variance,userLocale:I,maskSettings:(null==w?void 0:w.parameter)===m.a.TCE?s.a.mask3:s.a.mask7,onBlur:M})),n.a.createElement(x.a,{item:!0,xs:1,mt:1.7},n.a.createElement(j.a,{display:"flex",height:"100%",alignItems:"center",justifyContent:"flex-end"},n.a.createElement(N.a,{id:p+"calculate-btn",variant:"contained",color:"primary",fullWidth:!1,onClick:U},k.lang().common.calculate))),H,n.a.createElement(x.a,{item:!0,xs:10},n.a.createElement(T,{voyages:null!==(l=null==B?void 0:B.voyages)&&void 0!==l?l:[],parameter:w.parameter,userLocale:I,currentVoyage:g})),n.a.createElement(x.a,{item:!0,xs:2},n.a.createElement(P.a,{customisation:{disableToolbar:!0,responsive:!0,disableSorting:!0},headers:G,data:V,userLocale:I,reactKeyPrefix:p+"-sensitivity-analysis-table"}))))}function F(e,a){const t=l.a.getPerformanceCargo(a.cargos);switch(e){case m.a.FREIGHT_RATE:return.05*t.freightRate;case m.a.TCE:return.05*a.tcResultDay;case m.a.BUNKER_FO:return.05*a.foPrice;case m.a.BUNKER_DO:return.05*a.doPrice;case m.a.BUNKER_FO_LS:return.05*a.flPrice;case m.a.BUNKER_DO_LS:return.05*a.dlPrice;default:return 0}}},593:function(e,a,t){"use strict";t.d(a,"b",(function(){return c})),t.d(a,"a",(function(){return s}));var r=t(16),n=t(14),o=t(3);const i=n.a.get(o.a.IInternationalization),{model:l}=i.lang();var c;function s(e){const a=`VOYAGE_RELATED_${e}_LISTS_SORT_GROUP_CODE`,t={createdDateAsc:{field:l.createdDate,groupCode:a,operator:r.b.ASC,queryParamName:"key"},createdDateDesc:{field:l.createdDate,groupCode:a,operator:r.b.DESC,queryParamName:"key"},offhireStartDate:{field:l.createdDate,groupCode:a,operator:r.b.DESC,queryParamName:"offhireStartDate"}};switch(e){case c.OFFHIRE:return[t.offhireStartDate];case c.LAYTIME_CALCULATION:return[t.createdDateAsc];case c.BUNKER_TRANSACTION:return[t.createdDateDesc];default:return[]}}!function(e){e[e.OFFHIRE=0]="OFFHIRE",e[e.LAYTIME_CALCULATION=1]="LAYTIME_CALCULATION",e[e.BUNKER_TRANSACTION=2]="BUNKER_TRANSACTION"}(c||(c={}))}}]);