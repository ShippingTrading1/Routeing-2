(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{1164:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));const a={businessPartner:{businessPartnerName:"*"},documentLineText:"*",documentCurrency:{currencyCode:"*"},documentAmount:"*",exchangeRate:"*",exchangeRateDate:"*",sourceCurrency:{currencyCode:"*"},vatRate:{vatRate:"*",vat:{vatCode:"*"}}},o=Object.assign(Object.assign({},a),{account:{accountDesc:"*"},quantity:"*",unitPrice:"*",companyCurrencyAmount:"*",sourceCurrencyAmount:"*",isAccountsPayable:"*",cargo:{cargoReference:"*"},voyage:{voyageHeader:{company:{companyCurrency:"*"},referenceNo:"*"},tcIn:{key:"*"}},cargoPort:{port:{portName:"*"},terminal:{terminalName:"*"}},portCall:{port:{portName:"*"},terminal:{terminalName:"*"}}})},1211:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(10),n(11);var a=n(0),o=n.n(a),i=n(213),r=n(187),c=n(100),l=n.n(c),s=n(218),u=n(246),d=n(600),m=n(474),p=n(6),b=n(3),g=n(135);const v=Object(i.a)(e=>Object(r.a)({addIconCircle:{height:e.spacing(4.5),width:e.spacing(4.5),borderRadius:"50%",display:"flex",marginRight:e.spacing(2),justifyContent:"center",alignItems:"center",cursor:"pointer"}})),f=Object(a.memo)((function(e){const t=v({}),{createObject:n,reactKeyPrefix:i}=e,[r]=Object(p.a)([b.a.IInternationalization]),{common:c}=r.getLanguageFile(),[f,y]=Object(a.useState)(null),h=Object(a.useCallback)(e=>{y(e.currentTarget)},[]),O=Object(a.useCallback)(()=>{y(null)},[]),C=Object(a.useCallback)(e=>{e(),O()},[O]);if(1===n.length){const{onClick:e,text:a,disabled:r}=n[0];return o.a.createElement(s.a,{title:a,enterDelay:300,disableFocusListener:!0},o.a.createElement("div",null,o.a.createElement(u.a,{id:i+"-icon-btn",className:t.addIconCircle,onClick:C.bind(null,e),disabled:r,color:"primary"},o.a.createElement(l.a,null))))}return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,{title:f?c.create:"",enterDelay:300,disableFocusListener:!0},o.a.createElement(u.a,{id:i+"-add-icon-btn",className:t.addIconCircle,onClick:h,color:"primary"},o.a.createElement(l.a,null))),o.a.createElement(d.a,{id:i+"-create-object-menu",anchorEl:f,open:Boolean(f),onClose:O,disableRestoreFocus:!0},n.map(e=>o.a.createElement(m.a,{id:i+Object(g.b)(e.text,"-")+"-menu-item",key:e.text,onClick:C.bind(null,e.onClick),disabled:e.disabled},e.text))))}))},1215:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n(10),n(11);var a=n(0),o=n.n(a),i=n(218),r=n(216),c=n(50);function l(e,t,n){const a=e.eventLogs?e.eventLogs:[],{arrivalFixed:l,berthedFixed:s,departureFixed:u}=e;let d=o.a.createElement("div",null),m=o.a.createElement("div",null),p=o.a.createElement("div",null);for(const b of a)b.event&&("ARR"===b.event.eventCode?d=o.a.createElement(i.a,{title:l?t.lang().model.ataLong:t.lang().model.etaLong,enterDelay:300},o.a.createElement("div",null,Object(r.c)(c.a.getEventLogDateFromPC(e,"ARR"),n))):"BRT"===b.event.eventCode?m=o.a.createElement(i.a,{title:s?t.lang().model.atbLong:t.lang().model.etbLong,enterDelay:300},o.a.createElement("div",null,Object(r.c)(c.a.getEventLogDateFromPC(e,"BRT"),n))):"DEP"===b.event.eventCode&&(p=o.a.createElement(i.a,{title:u?t.lang().model.atdLong:t.lang().model.etdLong,enterDelay:300},o.a.createElement("div",null,Object(r.c)(c.a.getEventLogDateFromPC(e,"DEP"),n)))));return{eta:d,etb:m,etd:p}}},1263:function(e,t,n){"use strict";n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return B}));n(10),n(11),n(158);var a=n(0),o=n.n(a),i=n(130),r=n(169);const c=e=>{const{onChange:t,setting:n,reactKeyPrefix:a}=e,i=!n.value;return o.a.createElement(r.a,{reactKeyPrefix:a+"checkbox-input",key:`${n.moduleCode}.${n.subModuleCode}.${n.settingName}`,checked:!!n.value,onChange:e=>t(Object.assign(Object.assign({},n),{value:i})),label:n.settingName})};var l=n(1328),s=n(2375),u=n(2345),d=n(281);class m extends o.a.PureComponent{constructor(e){super(e),this.state={setting:e.setting},this.onBlur=this.onBlur.bind(this),this.onChange=this.onChange.bind(this)}onChange(e){this.setState({setting:Object.assign(Object.assign({},this.state.setting),{value:e.target.value})})}onBlur(){this.props.onChange(this.state.setting)}render(){const{type:e}=this.props,{setting:t}=this.state,n=e===d.a.NUMBER_INPUT?"number":"string",a=e===d.a.NUMBER_INPUT?t.value?t.value:0:t.value?t.value:"";return o.a.createElement(l.a,null,o.a.createElement(s.a,null,t.settingName),o.a.createElement(u.a,{key:`${t.moduleCode}.${t.subModuleCode}.${t.settingName}`,value:a,onBlur:this.onBlur,onChange:this.onChange,type:n}))}}var p=n(81),b=n(102);class g extends o.a.PureComponent{constructor(e){super(e),this.onItemSelected=this.onItemSelected.bind(this),this.resolveFunction=this.resolveFunction.bind(this)}onItemSelected(e){this.props.onChange(Object.assign(Object.assign({},this.props.setting),{value:this.resolveFunction(e)}))}resolveFunction(e){const{setting:t}=this.props;return t.clientSideOptions&&t.clientSideOptionNameField&&t.clientSideOptions.length>0&&"object"==typeof t.clientSideOptions[0]&&!(t.clientSideOptions[0]instanceof Date)?Object(p.a)(e,t.clientSideOptionNameField,""):e}render(){const{setting:e,reactKeyPrefix:t}=this.props,n=this.props.setting.clientSideOptions||[],a=e.value?[n.find(t=>this.resolveFunction(t)===e.value)]:[];return o.a.createElement(b.a,{key:`${e.moduleCode}.${e.subModuleCode}.${e.settingName}`,label:e.settingName,options:n,defaultSelectedOptions:a,reactKeyPrefix:`${t}${e.moduleCode}.${e.subModuleCode}.${e.settingName}`,resolver:this.resolveFunction,onChange:this.onItemSelected,isClearable:!1})}}n(109),n(163);var v=n(6),f=n(47),y=n(4),h=n(1),O=n(1319),C=n(7),j=n(21),k=n(543);const E=n(2308);class P extends o.a.PureComponent{constructor(e){super(e),this.apiCallIdentifier="",this.state={data:[]},this.apiCallIdentifier=e.setting.moduleCode+e.setting.subModuleCode+e.setting.settingName,this.onItemSelected=this.onItemSelected.bind(this),this.onQueryChanged=E(this.onQueryChanged.bind(this),300)}UNSAFE_componentWillMount(){this.loadOptions()}loadOptions(e){const{setting:t,dispatchAction:n}=this.props,[a]=this.props.deps,{data:o}=this.state;if(t.tsModelType){const n=h.a[t.tsModelType];if(e){const t=Object(k.b)(o[0]);a.loadMultipleAction({fields:O.a[n.name],filters:[{field:t,filterGroupCode:"settingstypeahead",operator:y.c.LIKE,queryParamName:t.replace("_",""),type:y.d.STRING,value:e}],headers:{},identifier:this.apiCallIdentifier,pageItemLimit:30,pageNumber:0,type:n})}else a.loadMultipleAction({fields:O.a[n.name],headers:{},identifier:this.apiCallIdentifier,pageItemLimit:30,pageNumber:0,type:n})}}UNSAFE_componentWillReceiveProps(e){const{setting:t}=this.props;let{data:n}=this.state;if(t.tsModelType){const a=h.a[t.tsModelType];n=j.a.getTSModelsBuiltFromTSModelRootState(a,e.state.entityState,O.a[a.name],this.apiCallIdentifier)}this.setState(Object.assign(Object.assign({},e.state),{data:n}))}onItemSelected(e){this.props.onChange(Object.assign(Object.assign({},this.props.setting),{value:e.key}))}onQueryChanged(e){this.loadOptions(e)}render(){const{setting:e,reactKeyPrefix:t}=this.props,{data:n}=this.state,a=e.value?[n.find(t=>"key"in t&&t.key===e.value)]:[];return o.a.createElement(b.a,{key:`${e.moduleCode}.${e.subModuleCode}.${e.settingName}`,label:e.settingName,options:n,defaultSelectedOptions:a,reactKeyPrefix:`${t}${e.moduleCode}.${e.subModuleCode}.${e.settingName}`,resolver:k.c,onChange:this.onItemSelected,isClearable:!1,overrideDefaultSelectedOptions:!0})}}const x=Object(f.a)(e=>({entityState:j.a.getTSModelRootState(e)}),Object(v.b)([C.a.ITSModelActionsAsync,C.a.Store],P));class T extends o.a.PureComponent{constructor(){super(...arguments),this.style={padding:"10px"}}render(){const{setting:e,onChange:t,reactKeyPrefix:n}=this.props;return o.a.createElement("div",{style:this.style},function(e,t,n){switch(e.type){case d.a.CHECKBOX:return o.a.createElement(c,{reactKeyPrefix:n+"checkbox",setting:e,onChange:t,type:d.a.CHECKBOX});case d.a.DATEPICKER:return o.a.createElement("div",null,"Not yet implemented!");case d.a.DROPDOWN_LIST:return e.clientSideOptions?o.a.createElement(g,{reactKeyPrefix:n+"typeahead-client",setting:e,onChange:t,type:d.a.DROPDOWN_LIST}):o.a.createElement(x,{reactKeyPrefix:n+"typeahead-tsmodel",setting:e,onChange:t,type:d.a.DROPDOWN_LIST});case d.a.STRING_INPUT:return o.a.createElement(m,{reactKeyPrefix:n+"string-input",setting:e,onChange:t,type:d.a.STRING_INPUT});case d.a.NUMBER_INPUT:return o.a.createElement(m,{reactKeyPrefix:n+"number-input",setting:e,onChange:t,type:d.a.NUMBER_INPUT});default:return o.a.createElement("div",null)}}(e,t,n))}}const A={marginTop:"35px",padding:"10px"},S=e=>{const t=e.settings.map(t=>{const n="setting"+t.moduleCode+t.subModuleCode+t.settingName;return o.a.createElement(T,{reactKeyPrefix:"doc-common-components-setting-module-setting"+n,key:n,setting:t,onChange:e.onChange})}),n=e.settings.length>0?e.settings[0].subModuleCode:"Submodule Settings";return o.a.createElement("div",{style:A},o.a.createElement(i.a,{variant:"h4"},n),t)},N={padding:"30px",boxShadow:"-2px 2px 8px -2px darkgray",borderRadius:"5px"},I=e=>{const t=e.settings.reduce((e,t)=>(t.subModuleCode in e?e[t.subModuleCode].push(t):e[t.subModuleCode]=[t],e),{}),n=Object.keys(t).map(n=>{const a=t[n],i="submodule"+a[0].moduleCode+a[0].subModuleCode+a[0].settingName;return o.a.createElement(S,{key:i,settings:a,onChange:e.onChange})}),a=e.settings.length>0?e.settings[0].moduleCode:"Module Settings";return o.a.createElement("div",{style:N},o.a.createElement(i.a,{variant:"h3"},a),n)};var R=n(76),L=n(65),D=n(482),w=n(30),M=n(41);class B extends o.a.PureComponent{constructor(e){super(e),this.style={marginLeft:"auto",marginRight:"auto",marginTop:"16px",maxWidth:500,width:"100%"},this.state=Object.assign({},e.state),this.onChange=this.onChange.bind(this)}onChange(e){const[t]=this.props.deps;this.props.dispatchAction(t.putSettingsAction(e))}UNSAFE_componentWillReceiveProps(e){this.setState(Object.assign({},e.state))}render(){const{settings:e}=this.state,t=e.reduce((e,t)=>(t.moduleCode in e?e[t.moduleCode].push(t):e[t.moduleCode]=[t],e),{}),n=Object.keys(t).map(e=>{const n=t[e],a="module"+n[0].moduleCode+n[0].subModuleCode+n[0].settingName;return o.a.createElement(I,{key:a,settings:n,onChange:this.onChange})});return o.a.createElement("div",{style:this.style},n)}}const K={authorizationType:M.a.PERMISSION,authorizedPermissions:[w.a.ApplicationSettingsPAGE],behaviorOnAuthorizationFail:L.a.REDIRECT_NO_AUTHORIZATION},F=Object(R.a)(K,Object(f.a)(e=>({settings:D.a.getSettingsState(e)}),Object(v.b)([C.a.ISettingActions],B)))},1288:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));n(10),n(11);var a=n(2095),o=n(2085),i=n(1327),r=n(2106),c=n(2330),l=n(246),s=n(218),u=n(130),d=n(2357),m=n(213),p=n(187),b=n(1748),g=n.n(b),v=n(26),f=n(0),y=n.n(f),h=n(97),O=n(635),C=n(1211),j=n(6),k=n(7),E=n(649),P=n(341),x=n(230),T=n(66);function A(e){var t;const{action:n,reactKeyPrefix:a,user:o}=e,[i]=Object(f.useState)(n),[r,c]=Object(f.useState)(!1),[l,s]=Object(f.useState)(!1),u=Object(f.useRef)(r),d=Object(f.useCallback)(()=>{c(!u.current),null==i||i.onClick(!u.current)},[u,c,i]);return Object(f.useEffect)(()=>{i.authorizedRoles&&Object(T.c)(i.authorizedRoles,o)&&s(!0)},[i.authorizedRoles,l,o]),Object(f.useEffect)(()=>{u.current=r},[r]),y.a.createElement(y.a.Fragment,null,l?y.a.createElement(x.a,{reactKeyPrefix:a+"quick-filter-boolean-filter",selected:r,label:null!==(t=null==i?void 0:i.text)&&void 0!==t?t:"",onClick:d,disabled:!1,isClearable:!0}):null)}var S=n(33),N=n(47),I=n(32),R=n(412),L=n(915),D=n(650),w=n.n(D),M=n(3);const B=Object(m.a)(e=>Object(p.a)({appBar:{paddingTop:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},bottomContainer:{display:"flex",alignItems:"center",overflowX:"auto",justifyContent:"space-between",flexWrap:"nowrap","&::-webkit-scrollbar":{display:"none"},scrollbarWidth:"none","-ms-overflow-style":"none"},whiteSpaceNoWrap:{whiteSpace:"nowrap"},title:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"1.4rem",[e.breakpoints.up("sm")]:{fontSize:"1.65rem"}},menuIcon:{marginRight:e.spacing(1)},right:{flexDirection:"row",display:"flex",marginLeft:"auto",alignItems:"center"},topContainer:{display:"flex",alignItems:"center",marginBottom:e.spacing(1),[e.breakpoints.up("sm")]:{marginBottom:e.spacing(1.5)}},tabIndicator:{height:e.spacing(.5),borderRadius:"500px",borderBottomLeftRadius:0,borderBottomRightRadius:0},tabs:{overflow:"unset"},tabsExist:{marginBottom:0,[e.breakpoints.up("sm")]:{marginBottom:e.spacing(1.5)}},middleContainer:{marginLeft:"auto"},borderBottom:{borderBottom:"1px solid "+e.palette.grey[300]}})),K=e=>{const{createObject:t,secondaryActions:n,primaryAction:m,tabs:p,activeTab:b,onChangeTab:E,onActivateTab:x,activateInitialTab:T=!0,reactKeyPrefix:N,middleContent:I,rightContent:D,bottomRightContent:K,showFullBottomBorder:F,hideCreateForTab:U,overrideTitle:$,onClickBack:z,state:{menuOpen:_,user:G}}=e,[q,W,Q,H]=Object(j.a)([k.a.Store,k.a.ISideNavActions,M.a.IInternationalization,k.a.ISimpleReducerActions]),[V,X]=Object(f.useState)(!0),J=Object(h.h)(),{common:Z}=Q.getLanguageFile(),Y=B({props:{menuOpen:_}}),ee=Object(R.a)(),te=Object(f.useMemo)(()=>null!=$?$:Object(P.a)(S.a,J.pathname),[J.pathname,$]);Object(f.useEffect)(()=>{var e,t;const n=null!==(t=null===(e=null==p?void 0:p[null!=b?b:0])||void 0===e?void 0:e.label)&&void 0!==t?t:"",a=Object(P.c)(n,S.a,J.pathname);H.setAction(L.a,a),0===ee.length&&(document.title=a),X(!1)},[ee.length,b]),Object(f.useEffect)(()=>{V&&!T||(p&&null!==b&&p[b].onActivate&&p[b].onActivate(),p&&null===b||x&&x(!0))},[b]);const ne=Object(f.useCallback)(()=>{q.dispatch(W.setAction(!0))},[W,q]),ae=Object(f.useCallback)((e,t)=>{E(t)},[E]),oe=Object(f.useMemo)(()=>p?y.a.createElement(a.a,{id:N+"tabs",className:Y.tabs,value:null!=b&&b,onChange:ae,TabIndicatorProps:{className:Y.tabIndicator},variant:"fullWidth"},p.map((e,t)=>y.a.createElement(o.a,{id:N+"tab",className:Y.whiteSpaceNoWrap,key:"page_tab_"+t,label:e.label,disabled:e.disabled,value:t,disableTouchRipple:!0}))):y.a.createElement(i.a,null),[b,Y.tabIndicator,Y.tabs,Y.whiteSpaceNoWrap,ae,N,p]),ie=Object(f.useMemo)(()=>I?y.a.createElement("div",{className:Y.middleContainer},I):null,[Y.middleContainer,I]),re=U&&U.includes(null!=b?b:0);return y.a.createElement(y.a.Fragment,null,y.a.createElement(r.a,{position:"sticky",className:Y.appBar,elevation:0,color:"inherit"},y.a.createElement("div",{className:Object(v.default)(Y.topContainer,{[Y.tabsExist]:p})},y.a.createElement(c.a,{in:!_,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:1e3}},y.a.createElement(l.a,{id:N+"user-menu-toggle",onClick:ne,className:Y.menuIcon,color:"inherit"},y.a.createElement(g.a,null))),z&&y.a.createElement(s.a,{title:Z.back,"aria-label":Z.back},y.a.createElement(l.a,{id:N+"-back-btn",onClick:z},y.a.createElement(w.a,null))),y.a.createElement(u.a,{variant:"h1",className:Y.title},te),ie,y.a.createElement("div",{className:Y.right},n&&y.a.createElement(O.a,{actions:n,reactKeyPrefix:N+"page-header-secondary-actions-menu"}),m&&y.a.createElement(A,{action:m,reactKeyPrefix:N+"page-header-primary-action-menu",user:G}),!re&&t&&y.a.createElement(C.a,{reactKeyPrefix:N+"page-header-create",createObject:t}),D)),y.a.createElement("div",{className:Object(v.default)(Y.bottomContainer,{[Y.borderBottom]:!F})},oe,K&&y.a.createElement(d.a,{direction:"row",spacing:1},K))),F&&y.a.createElement("span",{className:Y.borderBottom}))},F=Object(N.a)(e=>({menuOpen:E.a.get(e),user:Object(I.a)(e)}),Object(f.memo)(K))},1295:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));n(10),n(11);var a=n(0),o=n.n(a),i=n(6),r=n(3),c=n(37),l=n(1),s=n(14),u=n(50),d=n(102);const m=(e,t,n,a,i,c,m)=>{const p=s.a.get(r.a.IInternationalization),{model:b}=p.getLanguageFile();return[{value:o.a.createElement(d.b,{reactKeyPrefix:c+"typeahead-async",label:b.vessel,type:l.a.vessel,onChange:n,objectPaths:["vesselName"],formControlProps:{required:!0},shouldPreload:!m,defaultSelectedOptions:t,overrideDefaultSelectedOptions:!0,disabled:m})},{value:o.a.createElement(d.a,{label:b.portCall,options:i,defaultSelectedOptions:e,overrideDefaultSelectedOptions:!0,reactKeyPrefix:c+"typeahead",resolver:u.a.getPortCallValueStr,formControlProps:{required:!0},onChange:a,noOptionsMessage:()=>b.noPortCallsForVessel,disabled:m})}]};var p=n(47),b=n(7),g=n(12),v=n(21);const f=Object(p.a)((function(e,t){const{fields:n,identifier:a}=t;return{portCalls:v.a.getTSModelsBuilt(e,l.a.portcall,n,a)}}),Object(i.b)([b.a.ITSModelActionsAsync,r.a.IInternationalization,b.a.KeySetActions],(function(e){var t,n;const{portCalls:i}=e.state,{reactKeyPrefix:r,onSelectPortCall:s,onSelectVessel:u,getQueryStringToLoadPortCalls:d,fields:p,identifier:b,dispatchAction:v,preSelectedPortCall:f}=e,[y,,h]=e.deps,[O,C]=Object(a.useState)(null!=f?f:null),[j,k]=Object(a.useState)(null!==(n=null===(t=null==f?void 0:f.voyage)||void 0===t?void 0:t.vessel)&&void 0!==n?n:null),E=Object(a.useCallback)(e=>{y.loadMultipleAction({fields:p,headers:{},identifier:b,query:d(e),type:l.a.portcall})},[p,d,b,y]),P=Object(a.useCallback)(()=>{v(h.setKeysAction({identifier:b,keys:[]}))},[v,b,h]);Object(a.useEffect)(()=>(j&&!f&&E(j),P),[j]),Object(a.useEffect)(()=>{s(O)},[s,O]);const x=Object(a.useCallback)(e=>{C(e)},[]),T=Object(a.useCallback)(e=>{(!e||!j||!!e&&e.key!==j.key)&&(k(e),C(null)),u&&u(e)},[u,j]);return o.a.createElement(c.a,{reactKeyPrefix:r,items:m(O,j,T,x,i,r,!!f),breakpoints:g.h})})))},1418:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(213),o=n(187),i=n(0),r=n.n(i),c=n(1269),l=n(1),s=n(50),u=n(78),d=n(130),m=n(454),p=n(470);const b=Object(a.a)(Object(o.a)(e=>({leftContainer:{display:"flex",flexDirection:"column",textAlign:"right",backgroundColor:e.palette.grey[100],height:"100%",padding:e.spacing(1),borderRadius:"4px",justifyContent:"center",alignItems:"flex-end"}})));function g(e){const{portCall:{eventLogs:t},userLocale:n,isPlaceholder:a}=e,o=b({}),{cardWidth:c}=Object(i.useContext)(m.a),l=Object(i.useMemo)(()=>!!(c&&c<250),[c]),g=Object(i.useMemo)(()=>s.a.getEventLogDate(t,"ARR"),[t]),v=Object(i.useMemo)(()=>u.a.getFormattedDateString(g,n,!0,l),[g,l,n]);return r.a.createElement("div",{className:o.leftContainer},r.a.createElement(d.a,{variant:"subtitle2"},!a&&v),r.a.createElement(d.a,{variant:"subtitle2"},!a&&g&&Object(p.a)(g,"HH:mm")))}n(10),n(11);var v=n(2494),f=n(6),y=n(3),h=n(58);const O=Object(a.a)(Object(o.a)(e=>({smallText:{fontSize:"12.25px"},rightContainer:{display:"flex",flexDirection:"column",backgroundColor:e.palette.grey[100],height:"100%",padding:e.spacing(1),borderRadius:e.spacing(.5),justifyContent:"center",alignItems:"start"}})));function C(e){var t,n;const{portCall:a,cargoQtyOnBoard:o,isPlaceholder:i,cargos:c}=e,[l]=Object(f.a)([y.a.IInternationalization]),{common:s}=l.getLanguageFile(),u=O({});if(i)return r.a.createElement("div",{className:u.rightContainer},r.a.createElement(d.a,{className:u.smallText,color:"textSecondary"},s.additionalPorts));if(!(null==a?void 0:a.eventLogs)||!(null==a?void 0:a.reasonForCall))return null;const m=(null==a?void 0:a.port)?Object(v.a)(null==a?void 0:a.port.portName.toLowerCase()):"",p=h.a.getCargoPorts(null!=c?c:[]),b=h.a.getCargo(p,c,a.key),g=null!==(n=null===(t=null==b?void 0:b.cargoMeasurement)||void 0===t?void 0:t.measurementCode)&&void 0!==n?n:l.lang().common.mt,{reasonForCall:C}=a,j=`${l.formatNumber(null!=o?o:0,{maxDecimals:0})} ${g}`;return r.a.createElement("div",{className:u.rightContainer},r.a.createElement(d.a,{variant:"subtitle2"},m),r.a.createElement(d.a,{className:u.smallText,color:"textSecondary"},"B"===C.reasonForCall?C.reasonForCallDesc:j))}var j=n(38),k=n(218),E=n(1829),P=n(197);const x=Object(a.a)(Object(o.a)(e=>({left:{gridArea:e=>e.index+1+" / 1 / span 1 / 2",margin:e.spacing(.5)},center:{gridArea:e=>e.index+1+" / 2 / span 1 / 3",margin:e.spacing(.5)},right:{gridArea:e=>`${e.index+1}  / 3 / span 1 / ${e.cargoAmount+5}`,margin:e.spacing(.5)},tooltip:{width:e.spacing(36),marginTop:e.spacing(1),marginBottom:e.spacing(1)},divider:{background:e.palette.common.white,marginRight:e.spacing(1),marginLeft:e.spacing(.75),marginTop:e.spacing(.5),marginBottom:e.spacing(.5)},comment:{fontStyle:"italic",marginLeft:e.spacing(1),marginRight:e.spacing(1)}})));function T(e){var t;const{portCall:n,isLastPortCall:a,isPlaceholder:o,additionalPorts:s,boardType:u,cargos:d,cargoQtyOnBoardTransit:m,hideLeft:p}=e,b=x(e),v=o?{color:j.b.bergenRain.secondary[1],backgroundColor:j.a.primary}:void 0,f=Object(i.useMemo)(()=>Object(E.a)(n,b,d,m),[m,d,b,n]);return r.a.createElement(r.a.Fragment,null,!p&&r.a.createElement("div",{className:b.left},r.a.createElement(g,Object.assign({},e))),r.a.createElement("div",{className:b.center},r.a.createElement(c.a,{reactKeyPrefix:"doc-common-components-port-call-row-capline",id:void 0,type:l.a.portcall,showLine:!a,hovered:!1,iconSize:o?void 0:"small",index:-1,fillCap:"D"!==(null===(t=n.reasonForCall)||void 0===t?void 0:t.reasonForCall),overrideCapColor:v,capContent:s,isGrid:!0})),r.a.createElement(k.a,{title:f,placement:"top-start",disableHoverListener:u!==P.a.CargoManagement},r.a.createElement("div",{className:b.right},r.a.createElement(C,Object.assign({},e)))))}},1602:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a,o=n(9),i=n(1),r=n(29),c=n(7),l=function(e,t,n,a){var o,i=arguments.length,r=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(i<3?o(r):i>3?o(t,n,r):o(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},s=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t){return function(n,a){t(n,a,e)}};let d=class{constructor(e){this.tsmodelActions=e}loadCompanyBankAccounts(e,t){this.tsmodelActions.loadMultipleAction({fields:{bankAccountNo:"*"},query:"filter=companies(EQ)"+e,type:i.a.bankaccount,callback(e,n){t(n||[])}})}loadBusinessPartnerBankAccounts(e,t){this.tsmodelActions.loadMultipleAction({fields:{bankAccountNo:"*"},query:"filter=businessPartners(EQ)"+e,type:i.a.bankaccount,callback(e,n){t(n||[])}})}};d=l([Object(o.injectable)(),u(0,Object(o.inject)(c.a.ITSModelActionsAsync)),s("design:paramtypes",["function"==typeof(a=void 0!==r.ITSModelActionsAsync&&r.ITSModelActionsAsync)?a:Object])],d)},1664:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));n(10),n(11);var a=n(0),o=n.n(a),i=n(130),r=n(246),c=n(272),l=n.n(c),s=n(243),u=n(102),d=n(23),m=n(21),p=n(6),b=n(7),g=n(87),v=n(168),f=n(3),y=n(135),h=n(142),O=n(213),C=n(187);const j=Object(O.a)(Object(C.a)(e=>({selectorContainer:{display:"flex",alignItems:"center"},textContainer:{marginLeft:t=>t.leftIcon?e.spacing(1):0}})));function k(e){const[t,n,c]=Object(p.a)([b.a.ISelectedTSModelActions,b.a.ITSModelActions,f.a.IInternationalization]),{typeaheadAsyncProps:O,leftIcon:C,onChangeSelectedItem:k,reactKeyPrefix:E}=e,{type:P,fields:x,objectPaths:T}=e.typeaheadAsyncProps,{common:{select:A}}=c.getLanguageFile(),S=j(e),N=Object(a.useMemo)(()=>x||Object(g.a)(T),[x,T]),[I,R]=Object(a.useState)(null),[L,D]=Object(a.useState)(`${A} ${Object(y.e)(P.name)}`),w=Object(d.a)(h.a.get,P),M=Object(d.a)(m.a.getTSModelBuilt,P,w,N);Object(a.useEffect)(()=>{w&&n.loadSingleAction({type:P,key:w,fields:N,callback:e=>{e&&(t.setAction(P,null),D(`${A} ${Object(y.e)(P.name)}`))}})},[A,N,w,t,n,P]),Object(a.useEffect)(()=>{if(M){const e=Object(v.a)(M,T,", ");D(e)}},[T,M]);const B=Object(a.useCallback)(e=>R(e.currentTarget),[R]),K=Object(a.useCallback)(()=>R(null),[R]),F=Object(a.useCallback)(e=>{k&&k(e),t.setAction(P,e.key),K()},[k,K,t,P]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:S.selectorContainer},C,o.a.createElement("div",{className:S.textContainer},o.a.createElement(i.a,null,L)),o.a.createElement(r.a,{onClick:B},o.a.createElement(l.a,{fontSize:"small"}))),o.a.createElement(s.a,{reactKeyPrefix:E+"action-menu",anchorEl:I,open:!!I,onCloseActionMenu:K,showCloseButton:!1,paddingTop:!0},o.a.createElement(u.b,Object.assign({onChange:F,defaultSelectedOptions:M,isClearable:!1,shouldPreload:!0},O))))}},1710:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));n(59);var a,o,i=n(9),r=n(31),c=n(83),l=n(104),s=n(1),u=n(32),d=n(7),m=function(e,t,n,a){var o,i=arguments.length,r=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(i<3?o(r):i>3?o(t,n,r):o(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},p=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(e,t){return function(n,a){t(n,a,e)}};let g=class{constructor(e,t){this.store=e,this.objectApi=t}reloadSecurityPermissions(e){try{const{authdata:t}=Object(u.a)(this.store.getState());return this.objectApi.put({authdata:null!=t?t:"",data:"",key:e[0].key,query:"reloadEndpoint=true",type:s.a.entityrelease}),Promise.resolve()}catch(e){return Promise.reject()}}};g=m([Object(i.injectable)(),b(0,Object(i.inject)(d.a.Store)),b(1,Object(i.inject)(c.a.ITSModelApi)),p("design:paramtypes",["function"==typeof(a=void 0!==r.Store&&r.Store)?a:Object,"function"==typeof(o=void 0!==l.ITSModelApi&&l.ITSModelApi)?o:Object])],g)},341:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s}));n(109),n(163),n(2276);var a=n(48);function o(e){return e.replace(/\/*$/,"")}function i(e,t){var n;return null===(n=c(e,t))||void 0===n?void 0:n.url}function r(e,t){var n,a;return null!==(a=null===(n=c(e,t))||void 0===n?void 0:n.name)&&void 0!==a?a:""}function c(e,t){return Object.values(e).find(({url:e})=>l(t,e))}function l(e,t,n="/"){const a=t.toLocaleLowerCase();return new RegExp("^"+a+n+"|^"+a+"$").test(e.toLocaleLowerCase())}function s(e,t,n){let o=r(t,n)+(e?": ":"");return o+=e,o+=(o?" - ":"")+a.a.APPLICATION_NAME,o}},462:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));n(10),n(11);var a=n(0),o=n(40),i=n(14),r=n(3);const c=e=>{const t=i.a.get(r.a.IInternationalization);return e.departureFixed?[t.lang().model.departed,o.c.Low]:e.berthedFixed?[t.lang().model.berthed,o.c.NoPriority]:e.arrivalFixed?[t.lang().model.arrived,o.c.MediumLow]:[void 0,o.c.NoPriority]},l=({portCall:e})=>{const[t,n]=c(e);return t?a.createElement(o.a,{label:t,priority:n}):a.createElement("div",null)}},464:function(e,t,n){"use strict";n.d(t,"a",(function(){return se})),n.d(t,"b",(function(){return me}));n(59),n(10),n(11);var a=n(323),o=n(473),i=n(2483),r=n(1330),c=n(1381),l=n(892),s=n(0),u=n.n(s),d=n(6),m=n(1329),p=n(472),b=n(250),g=n.n(b),v=n(126),f=n(5),y=n(67),h=n(3),O=n(196);function C(e){var t,n;const{documentLines:a,userLocale:o,reactKeyPrefix:i,onRowClick:r,onAssemble:c,onSelectRow:b,isHirePayable:C}=e,[j]=Object(d.a)([h.a.IInternationalization]),{invoices:k,model:E}=j.getLanguageFile(),P=Object(s.useMemo)(()=>Object(m.a)(a,"key").map(e=>function(e,t){var n,a,o,i,r,c,l,s,d,m,p,b,v,f,y,h,O,C,j,k,E,P,x,T;const A=null!==(c=null!==(o=null===(a=null===(n=e.cargoPort)||void 0===n?void 0:n.port)||void 0===a?void 0:a.portName)&&void 0!==o?o:null===(r=null===(i=e.portCall)||void 0===i?void 0:i.port)||void 0===r?void 0:r.portName)&&void 0!==c?c:"",S=null!==(b=null!==(d=null===(s=null===(l=e.cargoPort)||void 0===l?void 0:l.terminal)||void 0===s?void 0:s.terminalName)&&void 0!==d?d:null===(p=null===(m=e.portCall)||void 0===m?void 0:m.terminal)||void 0===p?void 0:p.terminalName)&&void 0!==b?b:"";return{content:[A.concat(A&&S?" - "+S:""),t?null!==(y=null===(f=null===(v=e.voyage)||void 0===v?void 0:v.voyageHeader)||void 0===f?void 0:f.referenceNo)&&void 0!==y?y:"":null!==(O=null===(h=e.cargo)||void 0===h?void 0:h.cargoReference)&&void 0!==O?O:"",null!==(j=null===(C=e.account)||void 0===C?void 0:C.accountDesc)&&void 0!==j?j:"",e.documentLineText,e.quantity,e.unitPrice,null!==(E=null===(k=e.documentCurrency)||void 0===k?void 0:k.currencyCode)&&void 0!==E?E:"",e.documentAmount,null!==(T=null===(x=null===(P=e.vatRate)||void 0===P?void 0:P.vat)||void 0===x?void 0:x.vatCode)&&void 0!==T?T:"",{content:u.a.createElement(g.a,{key:e.key,fontSize:"inherit"}),rawValue:null}],id:e.key}}(e,C)),[a,C]),x=!(null===(n=null===(t=Object(p.a)(a))||void 0===t?void 0:t.businessPartner)||void 0===n?void 0:n.businessPartnerName),T=Object(v.a)(e=>[{content:e.lang().model.port,contentType:f.a.TEXT,textLengthFactor:5,wrap:!0},C?{content:e.lang().model.voyage,contentType:f.a.TEXT}:{content:e.lang().model.bookingNo,contentType:f.a.TEXT},{content:e.lang().menu.account,contentType:f.a.TEXT},{content:e.lang().model.documentLineText,contentType:f.a.TEXT,textLengthFactor:10,wrap:!0},{content:e.lang().model.quantity,contentType:f.a.NUMBER,numberFormatOptions:{minDecimals:3,maxDecimals:3}},{content:e.lang().model.unitPrice,contentType:f.a.NUMBER,numberFormatOptions:{minDecimals:2,maxDecimals:2}},{content:e.lang().model.currency,contentType:f.a.TEXT},{content:e.lang().common.amount,contentType:f.a.NUMBER,numberFormatOptions:{minDecimals:2,maxDecimals:2}},{content:e.lang().model.vatCode,contentType:f.a.TEXT},{content:"",contentType:f.a.ELEMENT}]),A=Object(s.useMemo)(()=>[{disabled:Object(l.a)(a),label:E.assemble,onClick:e=>{x?O.a.next({type:"snackbar",notification:{id:666,message:k.businessPartnerMissingDocumentLine,type:"error"}}):c(e)},reactKeyPrefix:i+"-primary-actions"}],[a,k.businessPartnerMissingDocumentLine,x,E.assemble,c,i]);return u.a.createElement(y.a,{data:P,onRowSelect:b,headers:T(j),reactKeyPrefix:i,userLocale:o,title:k.pendingDocumentLines,onRowClick:r,selectable:!0,selectedActions:A,preSelectAll:!0,keepSelectedWhenDataChanges:!0})}var j=n(1392),k=n(92),E=n(123);function P(e,t,n){var a,o,i,r,c,l,s;const[u]=Object(d.a)([h.a.IInternationalization]),{model:m,common:p}=u.lang(),b=e.filter(e=>t.includes(e.key)),g=Object(j.a)(e,"documentAmount"),v=Object(j.a)(b,"documentAmount"),f=E.a.formatNumber(g,Object.assign(Object.assign({},k.b.format2),{locale:n.isoCode})),y=E.a.formatNumber(v,Object.assign(Object.assign({},k.b.format2),{locale:n.isoCode}));let O;return O=(null===(a=e[0])||void 0===a?void 0:a.isAccountsPayable)?v>=0?m.invoiceIn:m.creditIn:v>=0?m.invoiceOut:m.creditOut,[{label:m.documentType,value:O},{label:m.businessPartner,value:null!==(r=null===(i=null===(o=e[0])||void 0===o?void 0:o.businessPartner)||void 0===i?void 0:i.businessPartnerName)&&void 0!==r?r:""},{label:m.currency,value:null!==(s=null===(l=null===(c=e[0])||void 0===c?void 0:c.documentCurrency)||void 0===l?void 0:l.currencyCode)&&void 0!==s?s:""},{label:p.amount,value:""+f},{label:p.amountToAssemble,value:""+y}]}var x=n(2379),T=n(2380),A=n(2530),S=n(272),N=n.n(S),I=n(37);const R=e=>{const{summary:t,children:n,reactKeyPrefix:a,breakpoints:o,expanded:i,onChange:r}=e;return u.a.createElement(x.a,{expanded:i,onChange:r},u.a.createElement(T.a,{expandIcon:u.a.createElement(N.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},u.a.createElement(I.a,{reactKeyPrefix:a+"expansion-panel-item",items:t,breakpoints:o})),u.a.createElement(A.a,null,n))},L=e=>{var t;const{reactKeyPrefix:n,documentLines:o,onClickAssemble:i,onRowClick:r,userLocale:c,isHirePayable:l,autoExpand:d,disableGutters:m}=e,[p,b]=Object(s.useState)(o.map(e=>e.key)),[g,v]=Object(s.useState)(!!d),f=Object(s.useCallback)(e=>{const t=o.map(e=>e.key).filter(t=>e.includes(t));b(t)},[o]),y=Object(s.useCallback)((e,t)=>{v(t)},[]);return u.a.createElement(a.a,{sx:{mb:m?0:2}},u.a.createElement(R,{breakpoints:{sm:2,lg:2,md:2,xl:2,xs:2},reactKeyPrefix:n+"-expansion-panel",summary:P(o,p||[],c),key:null===(t=o[0])||void 0===t?void 0:t.key,expanded:g,onChange:y},u.a.createElement(C,{reactKeyPrefix:n+"-document-lines-table",documentLines:o,onAssemble:i,onRowClick:r,onSelectRow:f,userLocale:c,isHirePayable:l})))};var D=n(205),w=n(2383);function M({reactKeyPrefix:e,count:t,disableGutters:n}){return u.a.createElement(u.a.Fragment,null,u.a.createElement(a.a,{sx:{paddingTop:n?0:2,paddingBottom:2},display:"flex",justifyContent:"flex-end"},u.a.createElement(w.a,{variant:"rectangular",width:74,height:34,sx:{borderRadius:1}})),[...Array(t).keys()].map(t=>u.a.createElement(w.a,{sx:{marginBottom:n?0:2,borderRadius:1},key:`${e}-${t}`,variant:"rectangular",height:72})))}var B=n(51),K=n(12),F=n(1),U=n(19),$=n(1409),z=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function c(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((a=a.apply(e,t||[])).next())}))};function _(e,t,n,a,o){const{model:i,common:r}=o.getLanguageFile(),{companyCurrencyAmount:c,sourceCurrencyAmount:l,documentCurrency:s,sourceCurrency:u}=t,d={fieldOptions:[{fieldName:"documentLineText",label:i.documentLineText,breakpoints:K.e,onUpdateOverride:n.bind(null,"documentLineText")},{fieldName:"documentCurrency",label:i.currency,breakpoints:K.f,onUpdateOverride:e=>z(this,void 0,void 0,(function*(){var a,o,i,r;n("documentCurrency",e);let s=1,d=void 0;if((null===(r=null===(i=null===(o=null===(a=t.voyage)||void 0===a?void 0:a.voyageHeader)||void 0===o?void 0:o.company)||void 0===i?void 0:i.companyCurrency)||void 0===r?void 0:r.key)===e.key)s=c/l,n("exchangeRate",s),n("documentAmount",c);else if(u){const t=yield $.a.getExchangeRate(u,e,null!=d?d:new Date);s=t.exchangeRate,d=t.exchangeRateDate,n("exchangeRate",s),n("documentAmount",l*s),n("exchangeRateDate",d)}}))},{fieldName:"exchangeRate",label:i.exchangeRate,breakpoints:K.f,numberInputProps:{maskSettings:{decimalScale:5}},onUpdateOverride:e=>{n("exchangeRate",e),n("documentAmount",l*e)}},{fieldName:"exchangeRateDate",label:i.exchangeRateDate,breakpoints:K.h,dateInputProps:{showTime:!0},onUpdateOverride:e=>z(this,void 0,void 0,(function*(){let t=1,a=void 0;if(u&&s){const o=yield $.a.getExchangeRate(u,s,e);t=o.exchangeRate,a=o.exchangeRateDate,n("exchangeRate",t),n("documentAmount",l*t),n("exchangeRateDate",a)}}))},{fieldName:"vatRate",label:i.vatRate,breakpoints:K.h,onUpdateOverride:n.bind(null,"vatRate")},{fieldName:"businessPartner",label:r.invoiceParty,breakpoints:K.h,onUpdateOverride:n.bind(null,"businessPartner")}],object:t,type:F.a.documentline,userLocale:a,reactKeyPrefix:e};return Object(U.a)(d)}var G=n(1164);function q({reactKeyPrefix:e,i:t,open:n,selectedDocumentLine:a,onCloseModal:o,onUpdate:i}){return u.a.createElement(B.a,{modalProps:{confirmBtnName:t.lang().common.save,maxWidth:"sm",onCloseModal:o,onConfirm:o,open:n,title:t.lang().invoices.editDocumentLine,reactKeyPrefix:e},getColSpec:_,selectedObject:a,breakpoints:K.e,updateProps:{fields:G.a,objToUpdate:a,objToUpdateType:F.a.documentline,type:F.a.documentline,callback:i}})}n(2306);var W=n(2471),Q=n(1235),H=n(572),V=n(2484),X=n(168);function J(e,t,n){const a=[].concat(t),o=[].concat(e);for(let t=0;t<e.length;t++)n=new D.a(Object(X.e)(n,o[t],a[t]));return n}const Z=(e,t)=>`documentPaymentTerms[${e}]${t?"."+t:""}`;var Y=n(379);const ee=u.a.memo(e=>{const{reactKeyPrefix:t,userLocale:n,document:a,onChange:o,bankAccountOptions:i,isBankAccountMandatory:r}=e,c=((e,t,n,a,o,i)=>{const r={required:!0};return Object(U.a)({fieldOptions:[{fieldName:"documentText",breakpoints:K.e,onUpdateOverride:a.bind(null,"documentText")},{fieldName:"documentDate",dateInputProps:{value:new Date,required:!0},formControlProps:r,onUpdateOverride:e=>{var t;const{paymentTerms:o}=new Y.a(n.documentPaymentTerms[0]);a([Z(0,"baselineDate"),"documentDate",Z(0,"dueDate")],[e,e,Object(H.a)(e,null!==(t=null==o?void 0:o.numberOfDays)&&void 0!==t?t:0)])}},{fieldName:"issuingOffice",onUpdateOverride:a.bind(null,"issuingOffice")},{fieldName:"issuingCompany",formControlProps:r,onUpdateOverride:a.bind(null,"issuingCompany")},{fieldName:"bankAccount",formControlProps:Object.assign(Object.assign({},r),{required:i}),onUpdateOverride:a.bind(null,"bankAccount"),typeaheadProps:{options:o,resolver:e=>{var t;return null!==(t=e.bankAccountNo)&&void 0!==t?t:""}}},{fieldName:"externalDocumentNo",onUpdateOverride:a.bind(null,"externalDocumentNo")},{fieldName:"invoiceText",onUpdateOverride:a.bind(null,"invoiceText"),breakpoints:K.e,textInputProps:{multiline:!0}}],object:n,type:F.a.document,userLocale:t,reactKeyPrefix:e})})(t,n,a,o,i,r);return u.a.createElement(I.a,{reactKeyPrefix:t,items:c,breakpoints:K.h})});var te=n(81),ne=n(63),ae=n(202),oe=n(85);const ie=e=>{const{reactKeyPrefix:t,userLocale:n,document:o,onChange:i,i:r,contextData:c}=e,l=Object(s.useMemo)(()=>function(e,t,n,o,i,r){const c=Z.bind(null,r.index),l=new Y.a(Object(te.a)(t,c(),{})),s=F.a.documentpaymentterms,d={required:!0},m={fieldOptions:[{overrideComponent:u.a.createElement(ae.a,null)},0===r.index?{overrideComponent:u.a.createElement(a.a,{fontWeight:"bold",fontSize:"10pt"},i.lang().common.paymentTerms)}:{overrideComponent:u.a.createElement(a.a,null)},{fieldName:"percentage",label:0===r.index?i.lang().common.prePaid:i.lang().common.balance,onUpdateOverride:e=>{n(["documentPaymentTerms[0].percentage","documentPaymentTerms[1].percentage"],[e,100-e])},breakpoints:K.f,InputProps:{endAdornment:ne.a.Percent},numberInputProps:{validation:[{type:oe.a.RANGE,max:100}],maskSettings:{decimalScale:0,allowNegative:!1}},formControlProps:d,disabled:1===r.index,overrideObject:l,overrideType:s},{overrideComponent:u.a.createElement(a.a,null)},{fieldName:"paymentTerms",label:i.lang().common.paymentTerm,breakpoints:K.h,onUpdateOverride:e=>{const{baselineDate:a}=new Y.a(t.documentPaymentTerms[r.index]);n([c("paymentTerms"),a?c("dueDate"):""],[e,a?Object(H.a)(a,e.numberOfDays):void 0])},formControlProps:d,overrideObject:l,overrideType:s,typeaheadProps:{fields:{numberOfDays:"*",paymentTermsDesc:"*"}}},{fieldName:"baselineTerm",label:i.lang().model.baselineTerm,breakpoints:K.h,onUpdateOverride:n.bind(null,c("baselineTerm")),overrideObject:l,overrideType:s},{fieldName:"baselineDate",label:i.lang().model.baselineDate,dateInputProps:{value:new Date},breakpoints:K.h,onUpdateOverride:e=>{const{paymentTerms:a}=new Y.a(t.documentPaymentTerms[r.index]);n([c("baselineDate"),a?c("dueDate"):""],[e,a?Object(H.a)(e,a.numberOfDays):void 0])},formControlProps:d,overrideObject:l,overrideType:s},{fieldName:"dueDate",label:i.lang().common.dueDate,dateInputProps:{value:new Date},breakpoints:K.h,onUpdateOverride:n.bind(null,c("dueDate")),formControlProps:d,overrideObject:l,overrideType:s}],object:t,type:F.a.document,userLocale:o,reactKeyPrefix:e};return Object(U.a)(m)}(t,o,i,n,r,c),[c,o,r,i,t,n]);return u.a.createElement(I.a,{reactKeyPrefix:t,items:l,breakpoints:K.e})};var re=n(114),ce=n(173);const le=e=>{var t,n,a,o;const{reactKeyPrefix:i,showModal:r,userLocale:c,onClose:l,onConfirm:m,defaultValues:p,isReceivable:b}=e,[g,v]=Object(d.a)([h.a.IInternationalization,ce.a.IAssembleInvoiceController]),{common:f,model:y,invoices:O}=g.lang(),[C,k]=Object(s.useState)(p),[E,P]=Object(s.useState)([]),[x,T]=Object(s.useState)(!0),[A,S]=Object(s.useState)([]),[N,I]=Object(s.useState)(!1),R=null===(t=C.documentLines[0])||void 0===t?void 0:t.businessPartner,L=e=>{S([...e])},D=Object(j.a)(C.documentLines,"documentAmount");Object(s.useEffect)(()=>{var e,t,n,a;b?D>0&&(null===(e=C.issuingCompany)||void 0===e?void 0:e.key)?v.loadCompanyBankAccounts(null===(t=C.issuingCompany)||void 0===t?void 0:t.key,L):!N&&D<0&&(null==R?void 0:R.key)&&(v.loadBusinessPartnerBankAccounts(R.key,L),I(!0)):!N&&D>0&&(null==R?void 0:R.key)?(v.loadBusinessPartnerBankAccounts(R.key,L),I(!0)):D<0&&(null===(n=C.issuingCompany)||void 0===n?void 0:n.key)&&v.loadCompanyBankAccounts(null===(a=C.issuingCompany)||void 0===a?void 0:a.key,L)},[null===(n=C.issuingCompany)||void 0===n?void 0:n.key]);const w=C.documentLines.reduceRight((e,t)=>e+t.documentAmount,0),M=b&&w>=0||!b&&w<0;Object(s.useEffect)(()=>{k(p)},[p]);const K=Object(s.useCallback)(()=>{P([]),l()},[l]),F=Object(s.useCallback)(()=>{m(C,E),K()},[E,C,K,m]),U=Object(s.useCallback)((e,t)=>{const n=J(e,t,C);if("issuingCompany"!==e||(b&&D<0||!b&&D>0))k(n);else{const e=J("bankAccount",null,n);k(e)}},[C,b,D]),$=Object(s.useCallback)(e=>{P(e)},[]),z=Object(s.useCallback)(()=>function(e,t){const{0:n,1:a}=e.documentPaymentTerms,o=!(!e.documentDate||!e.issuingCompany||(null==t||t)&&!e.bankAccount),i=!!((null==n?void 0:n.percentage)&&(null==n?void 0:n.paymentTerms)&&(null==n?void 0:n.baselineDate)&&(null==n?void 0:n.dueDate)),r=100===(null==n?void 0:n.percentage)||!!((null==a?void 0:a.percentage)&&(null==a?void 0:a.paymentTerms)&&(null==a?void 0:a.baselineDate)&&(null==a?void 0:a.dueDate));return!(o&&i&&r)}(C,M),[C,M]);!((e,t)=>{var n,a,o;const i=Object(j.a)(e.documentLines,"documentAmount"),r=null===(n=e.documentLines[0])||void 0===n?void 0:n.businessPartner;return t&&(i>=0&&t&&Object(V.a)(null===(a=e.issuingCompany)||void 0===a?void 0:a.key)||i<0&&Object(V.a)(null==r?void 0:r.key))||!t&&(i>=0&&!t&&Object(V.a)(null==r?void 0:r.key)||!t&&i<0&&Object(V.a)(null===(o=e.issuingCompany)||void 0===o?void 0:o.key))})(C,b)&&x&&(T(!1),Object(re.a)(O.missingBankAccountDataTitle,O.missingBankAccountDataBody,void 0,f.ok,!0));const _=(null!==(o=null===(a=C.documentPaymentTerms[0])||void 0===a?void 0:a.percentage)&&void 0!==o?o:100)<100;return u.a.createElement(B.a,{modalProps:{open:r,reactKeyPrefix:i,onCloseModal:K,title:y.assemble},isConfirmDisabled:z,overrideOnConfirm:F},u.a.createElement(ee,{reactKeyPrefix:i+"-main-section",userLocale:c,document:C,onChange:U,bankAccountOptions:A,isBankAccountMandatory:M}),u.a.createElement(ie,{reactKeyPrefix:i+"payment-terms-one-section",document:C,userLocale:c,onChange:U,i:g,contextData:{index:0}}),_?u.a.createElement(ie,{reactKeyPrefix:i+"payment-terms-two-section",document:C,userLocale:c,onChange:U,i:g,contextData:{index:1}}):u.a.createElement(u.a.Fragment,null),u.a.createElement(W.a,{marginTop:2},u.a.createElement(Q.a,{reactKeyPrefix:i+"attachments",sourceId:C.key,onAttachCallback:$})))};var se,ue=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function c(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((a=a.apply(e,t||[])).next())}))};function de(e){var t,n,a,o;return[null!==(n=null===(t=e.businessPartner)||void 0===t?void 0:t.businessPartnerName)&&void 0!==n?n:"unknown-partner",null!==(o=null===(a=e.documentCurrency)||void 0===a?void 0:a.currencyCode)&&void 0!==o?o:"unknown-currency"].join("-")}!function(e){e[e.Voyage=0]="Voyage",e[e.Tc=1]="Tc"}(se||(se={}));const me=e=>{const{group:{key:t,type:n},isAccountsPayable:m,isHirePayable:p,reactKeyPrefix:b,userLocale:g,autoExpandSizeOneList:v,onAssemble:f,disableGutters:y,filters:O}=e,[C,j]=Object(d.a)([ce.a.IPendingDocumentLinesGroupController,h.a.IInternationalization]),[k,E]=Object(s.useState)([]),[P,x]=Object(s.useState)(null),[T,A]=Object(s.useState)(!1),[S,N]=Object(s.useState)(new D.a({})),[I,R]=Object(s.useState)(!1),w=Object(s.useRef)(!0),{common:B,invoices:K}=j.lang(),F=Object(s.useCallback)(()=>ue(void 0,void 0,void 0,(function*(){var e;const n=yield C.loadDocumentLines(t,m,p,null!=O?O:[],()=>w.current=!1);E(Object.values(null!==(e=Object(i.a)(n,de))&&void 0!==e?e:[]))})),[C,O,m,p,t]),U=Object(s.useCallback)((e=!0)=>ue(void 0,void 0,void 0,(function*(){w.current=e,n===se.Tc?yield C.refreshTcDocumentLines(t):n===se.Voyage&&(yield C.refreshDocumentLines(t,m)),yield F()})),[C,F,m,t,n]),$=Object(s.useCallback)(e=>ue(void 0,void 0,void 0,(function*(){e.key&&f&&f(e),x(null),yield F()})),[F,f]),z=Object(s.useCallback)((e,t)=>C.onConfirmAssemble(e,p,t,$),[$,C,p]);Object(s.useEffect)(()=>{U()},[U]);const _=Object(s.useCallback)(()=>{A(!1),x(null)},[]),G=Object(s.useCallback)(()=>R(!I),[I]),W=Object(s.useCallback)(e=>ue(void 0,void 0,void 0,(function*(){const t=yield C.getInvoiceDefaults(e);N(t),t.key?G():Object(re.a)(K.outdatedDocumentLinesTitle,K.outdatedDocumentLinesBody,void 0,B.ok,!0,"xs")})),[B,C,K,G]),Q=Object(s.useCallback)(e=>{const t=Object(r.a)(Object(c.a)(k),{key:Number(e)});t&&(x(t),A(!0))},[k]),H=Object(s.useMemo)(()=>k.map(e=>!Object(l.a)(e)&&u.a.createElement(L,{reactKeyPrefix:`${b}_pending_document_lines_${t}_${e[0].key}`,documentLines:e,onClickAssemble:W,onRowClick:Q,userLocale:g,isHirePayable:p,autoExpand:!!v&&1===k.length,disableGutters:y})),[v,y,k,p,t,W,Q,b,g]);return u.a.createElement(u.a.Fragment,null,w.current?u.a.createElement(M,{count:Math.max(k.length,1),reactKeyPrefix:b+"-skeleton",disableGutters:y}):u.a.createElement(u.a.Fragment,null,u.a.createElement(a.a,{sx:{pt:y?0:2,pb:2},display:"flex",justifyContent:"flex-end"},u.a.createElement(o.a,{variant:"contained",color:"primary",onClick:U},B.refresh)),H),I&&u.a.createElement(le,{showModal:I,reactKeyPrefix:b+"_assemble_modal",userLocale:g,onClose:G,onConfirm:z,defaultValues:S,isReceivable:!m}),T&&u.a.createElement(q,{reactKeyPrefix:b+"-document-line-modal",i:j,open:T,selectedDocumentLine:P,onCloseModal:_,onUpdate:F}))}},73:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));n(10),n(11);var a=n(213),o=n(187),i=n(0),r=n.n(i),c=n(97),l=n(1288),s=n(834),u=n(341),d=n(1265),m=n(1210),p=n(33);const b=Object(a.a)(e=>Object(o.a)({root:{display:"flex",flexDirection:"column",position:"relative",paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)},marginTop:e.spacing(1),flex:"1 0"}}));function g(e){const t=b({}),n=Object(c.g)(),a=Object(c.h)(),{bottomRightContent:o,createObject:g,tabs:v,reactKeyPrefix:f,rightHeaderContent:y,secondaryActions:h,middleContent:O,primaryAction:C,hideCreateForTab:j,overrideTitle:k,onClickBack:E}=e,[P,x]=Object(i.useState)(null),[T,A]=Object(i.useState)(!1),S=Object(u.b)(p.a,Object(u.e)(a.pathname)),N=Object(i.useCallback)(e=>{e!==P&&(A(!1),n.push(S+"/tab/"+(e+1)),x(e))},[P,n,S]);Object(i.useEffect)(()=>{const e=(()=>{var e;if(S&&a.pathname.includes("/tab/")){const t=Object(c.f)(a.pathname,{path:S+"/tab/:tabId?"});return null!==(e=null==t?void 0:t.params)&&void 0!==e?e:{}}return{}})();e.tabId?x(Number(e.tabId)-1):a.pathname.includes("/tab/")||x(0)},[a.pathname]),Object(i.useEffect)(()=>{const e=Object(u.a)(p.a,a.pathname);window.totango_options&&(window.totango_options.module=e,window.totango.go(window.totango_options))},[]);const I=Object(i.useMemo)(()=>[...null!=y?y:[],r.a.createElement(d.a,{key:"notifications-panel",reactKeyPrefix:"notifications-panel"}),r.a.createElement(m.a,{key:"user-menu"})],[y]),R=Object(i.useMemo)(()=>v&&null!==P&&T?v[P].content():null,[P,T,v]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(s.a,null,r.a.createElement(l.a,{reactKeyPrefix:f+"page-header",createObject:g,tabs:v,secondaryActions:h,primaryAction:C,activeTab:P,onActivateTab:A,onChangeTab:N,rightContent:I,middleContent:O,bottomRightContent:o,hideCreateForTab:j,overrideTitle:k,onClickBack:E})),r.a.createElement("div",{className:t.root,style:e.style},R,e.children))}},936:function(e,t,n){"use strict";n.d(t,"b",(function(){return L}));n(59),n(10),n(11),n(1002);var a,o,i,r,c,l=n(9),s=n(7),u=n(29),d=n(1),m=n(32),p=n(31),b=n(83),g=n(589),v=n(84),f=n(62),y=n(172),h=n(104),O=n(205),C=n(1395),j=n(4),k=n(887),E=n(345),P=n(472),x=n(21),T=n(1164),A=function(e,t,n,a){var o,i=arguments.length,r=i<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(r=(i<3?o(r):i>3?o(t,n,r):o(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r},S=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},N=function(e,t){return function(n,a){t(n,a,e)}},I=function(e,t,n,a){return new(n||(n=Promise))((function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function c(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}l((a=a.apply(e,t||[])).next())}))};const R={documentAmount:"*",externalDocumentNo:"*",issuingCompany:{companyCode:"*",companyName:"*"},issuingOffice:{officeCode:"*",officeName:"*"},documentText:"*",documentDate:"*",bankAccount:{bankAccountNo:"*"},exchangeRate:"*",exchangeRateDate:"*",documentPaymentTerms:{percentage:"*",dueDate:"*",baselineDate:"*",baselineTerm:{baselineTermCode:"*",baselineTermDesc:"*"},paymentTerms:{numberOfDays:"*",paymentTermsCode:"*",paymentTermsDesc:"*"}},documentLines:{businessPartner:{key:"*"},documentCurrency:{key:"*"},documentAmount:"*",tc:{key:"*"},voyage:{key:"*",tcIn:{key:"*"}}}};let L=class{constructor(e,t,n,a,o){this.store=e,this.tsmodelActions=t,this.tsmodelApi=n,this.documentApi=a,this.remarkApi=o}getAuthorization(){var e;return null!==(e=Object(m.a)(this.store.getState()).authdata)&&void 0!==e?e:""}refreshTcDocumentLines(e){return I(this,void 0,void 0,(function*(){yield this.documentApi.refreshTcDocumentLines(this.getAuthorization(),new y.a({key:e}))}))}refreshDocumentLines(e,t){return I(this,void 0,void 0,(function*(){const n=this.getAuthorization();if(n&&e)try{yield this.documentApi.refreshDocumentLines(n,[new f.a({key:e})],t)}catch(e){v.a.error(e)}}))}getVoyageFilterString(e,t){var n,a,o,i;const r=x.a.getTSModelBuilt(this.store.getState(),d.a.voyage,e,{tcIn:{owner:{businessPartnerName:"*"}}});return[...(null===(a=null===(n=null==r?void 0:r.tcIn)||void 0===n?void 0:n.owner)||void 0===a?void 0:a.key)?[{field:"businessPartner",filterGroupCode:"",operator:j.c.NOT_EQUALS,type:j.d.NUMBER,value:null===(i=null===(o=null==r?void 0:r.tcIn)||void 0===o?void 0:o.owner)||void 0===i?void 0:i.key,queryParamName:"businessPartner"}]:[],{field:"key",queryParamName:"voyage.key",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.NUMBER,value:e},{field:"document",filterGroupCode:"",operator:j.c.NULL,type:j.d.STRING,value:"",queryParamName:"document"},{field:"statusTypeCode",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.STRING,value:"PEN",queryParamName:"invoicingStatus.statusTypeCode"},{field:"isAccountsPayable",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.BOOLEAN,value:!!t,queryParamName:"isAccountsPayable"}]}getTcFilterString(e){var t,n;const a=x.a.getTSModelBuilt(this.store.getState(),d.a.tc,e,{owner:{businessPartnerName:"*"},commissions:{broker:"*",creditCharterer:"*"}});return[...(null===(t=null==a?void 0:a.owner)||void 0===t?void 0:t.key)?[{field:"businessPartner",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.NUMBER,queryParamName:"businessPartner",value:null===(n=null==a?void 0:a.owner)||void 0===n?void 0:n.key}]:[],{field:"key",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.NUMBER,value:e,queryParamName:"voyage.tcIn.key"},{field:"document",filterGroupCode:"",operator:j.c.NULL,type:j.d.STRING,value:""},{field:"statusTypeCode",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.STRING,value:"PEN",queryParamName:"invoicingStatus.statusTypeCode"},{field:"isAccountsPayable",filterGroupCode:"",operator:j.c.EQUALS,type:j.d.BOOLEAN,value:!0,queryParamName:"isAccountsPayable"}]}loadDocumentLines(e,t,n,a,o){return I(this,void 0,void 0,(function*(){const i=this.getAuthorization();if(i){let r;return r=n?this.getTcFilterString(e):this.getVoyageFilterString(e,t),this.tsmodelApi.getMultiple({type:d.a.documentline,fields:T.b,filters:[...r,...a],authdata:i}).then(e=>e).catch(()=>[]).finally(o)}return[]}))}getInvoiceDefaults(e){return I(this,void 0,void 0,(function*(){const t=this.getAuthorization();return t&&e?this.documentApi.getInvoiceDefaults(t,R,e).then(e=>e).catch(()=>new O.a({})):new O.a({})}))}assembleInvoice(e,t){return I(this,void 0,void 0,(function*(){const n=this.getAuthorization();if(n&&e){const a=e.documentPaymentTerms.filter(e=>e.percentage>0);e.documentPaymentTerms=a;try{return yield this.documentApi.assembleInvoice(n,e,t).then(e=>e).catch(()=>new O.a({}))}catch(e){v.a.error(e)}}return new O.a({})}))}attach(e,t){return I(this,void 0,void 0,(function*(){const n=this.getAuthorization();if(n)try{yield this.remarkApi.attach(n,e,t)}catch(e){v.a.error(e)}}))}onConfirmAssemble(e,t,n,a){var o,i,r,c;const l=Object(k.a)(e.documentPaymentTerms,e=>Object(E.a)(e,["key","_key"])),s=new O.a(Object.assign(Object.assign({},e),{documentPaymentTerms:l})),u=Object(P.a)(s.documentLines);if(u){const e=(null===(i=null===(o=u.voyage)||void 0===o?void 0:o.tcIn)||void 0===i?void 0:i.key)?null===(r=u.voyage.tcIn)||void 0===r?void 0:r.key:null===(c=u.tc)||void 0===c?void 0:c.key;s.businessPartner=u.businessPartner,s.documentCurrency=u.documentCurrency,this.assembleInvoice(s,t?e:void 0).then(e=>{a(e),e.key&&n.length&&this.attach(e.key,n)})}}};L=A([Object(l.injectable)(),N(0,Object(l.inject)(s.a.Store)),N(1,Object(l.inject)(s.a.ITSModelActionsAsync)),N(2,Object(l.inject)(b.a.ITSModelApi)),N(3,Object(l.inject)(b.a.IDocumentApi)),N(4,Object(l.inject)(b.a.IRemarkApi)),S("design:paramtypes",["function"==typeof(a=void 0!==p.Store&&p.Store)?a:Object,"function"==typeof(o=void 0!==u.ITSModelActionsAsync&&u.ITSModelActionsAsync)?o:Object,"function"==typeof(i=void 0!==h.ITSModelApi&&h.ITSModelApi)?i:Object,"function"==typeof(r=void 0!==g.IDocumentApi&&g.IDocumentApi)?r:Object,"function"==typeof(c=void 0!==C.IRemarkApi&&C.IRemarkApi)?c:Object])],L)}}]);